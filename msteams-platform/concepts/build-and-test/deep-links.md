---
title: Создание глубоких ссылок на содержимое
description: Описывает глубокие ссылки и их использование в приложениях
ms.topic: how-to
keywords: глубокая ссылка teams
ms.openlocfilehash: d6efe7332035320d2114e0e834d1c971ccc7108c
ms.sourcegitcommit: e3b6bc31059ec77de5fbef9b15c17d358abbca0f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2021
ms.locfileid: "50231563"
---
# <a name="create-deep-links-to-content-and-features-in-microsoft-teams"></a>Создание глубоких ссылок на контент и функции в Microsoft Teams

Вы можете создавать ссылки на сведения и функции в Teams. Примеры, в которых полезно создавать глубокие ссылки:

* Переход пользователя к содержимому на одной из вкладок приложения. Например, ваше приложение может иметь бота, который отправляет сообщения, уведомляющие пользователя о важном действии. Когда пользователь нажмет уведомление, глубокая ссылка переходит на вкладку, чтобы пользователь получал дополнительные сведения о действии.
* Ваше приложение автоматизирует или упрощает определенные задачи пользователя, такие как создание чата или планирование собрания, предварительно заполнив глубокие ссылки требуемыми параметрами. Это позволяет избежать необходимости ввода сведений вручную пользователями.

> [!NOTE]
>
> Глубокая связь сначала запускает браузер перед переходом к содержимому и сведениям следующим образом:
>
> **Tab**:  
> ✔ непосредственно переходит по URL-адресу глубокой ссылки.
>
> **Бот**:  
> ✔ Deeplink в теле карточки — сначала открывается в браузере.  
> ✔ Deeplink, добавленный в действие OpenURL в адаптивной карточке— прямой переход по URL-адресу глубокой ссылки.  
> ✔ разметки гиперссылки в карточке — сначала открывается в браузере.  
>
> **Чат**:  
> ✔ разметка гиперссылки текстового сообщения: прямой переход по URL-адресу глубокой ссылки.  
> ✔ ссылку, в которая в pasted в общей беседе чата— непосредственно переходит по URL-адресу глубокой ссылки.

## <a name="deep-linking-to-your-tab"></a>Глубокая ссылка на вкладку

Вы можете создавать глубокие ссылки на сущности в Teams. Как правило, это используется для создания ссылок, которые переходят к содержимому и сведениям на вкладке. Например, если вкладка содержит список задач, участники группы могут создавать и делиться ссылками на отдельные задачи. При выборе ссылки она переходит на вкладку, которая фокусируется на определенном элементе. Для реализации этого действия необходимо добавить действие "копировать ссылку" для каждого элемента, любым способом, наилучшим образом подходит для вашего пользовательского интерфейса. Когда пользователь принимает это действие, вызовите диалоговое окно, содержащее ссылку, которую пользователь может `shareDeepLink()` скопировать в буфер обмена. При этом вызове также передается ИД элемента, который возвращается [](~/tabs/how-to/access-teams-context.md) в контексте при перезагрузке ссылки и перезагрузке вкладки.

Кроме того, вы также можете создавать глубокие ссылки программным путем, используя формат, указанный далее в этом разделе. Их можно использовать в [](~/webhooks-and-connectors/what-are-webhooks-and-connectors.md) [сообщениях](~/bots/what-are-bots.md) бота и соединители, которые информируют пользователей об изменениях в вашей вкладке или элементов в ней.

> [!NOTE]
> Эта глубокая ссылка отличается от  ссылок, предоставляемых ссылкой "Копировать" в пункт меню "Вкладка", которая просто создает глубокую ссылку, которая указывает на эту вкладку.

>[!NOTE]
> В настоящее время shareDeepLink не работает на мобильных платформах.

### <a name="showing-a-deep-link-to-an-item-within-your-tab"></a>Отображение глубокой ссылки на элемент на вкладке

Чтобы показать диалоговое окно с глубокой ссылкой на элемент на вкладке, вызовите `microsoftTeams.shareDeepLink({ subEntityId: <subEntityId>, subEntityLabel: <subEntityLabel>, subEntityWebUrl: <subEntityWebUrl> })`

У вас есть указанные здесь поля.

* `subEntityId`&emsp;Уникальный идентификатор элемента на вкладке, с которым вы устанавливаете глубокую связь
* `subEntityLabel`&emsp;Метка элемента, используемая для отображения глубокой ссылки
* `subEntityWebUrl`&emsp;Необязательное поле с использованием дополнительного URL-адреса, если клиент не поддерживает отрисовку вкладки

### <a name="generating-a-deep-link-to-your-tab"></a>Создание глубокой ссылки на вкладку

> [!NOTE]
> Личные вкладки имеют область, а вкладки каналов и групп `personal` используют `team` или `group` области. Синтаксис двух типов вкладок немного отличается, так как только настраиваемая вкладка имеет свойство, связанное `channel` с объектом контекста. Дополнительные [сведения об области](~/resources/schema/manifest-schema.md) вкладок см. в справочнике по манифесту.

> [!NOTE]
> Глубокие ссылки работают правильно только в том случае, если вкладка была настроена с помощью библиотеки v0.4 или более поздней и поэтому имеет ИД сущности. Глубокие ссылки на вкладки без иных сущений по-прежнему переходят на вкладку, но не могут предоставлять на нее ид подустанавливания.

Используйте следующий формат для прямой ссылки, которую можно использовать в карточке бота, соединители или карточки расширения для обмена сообщениями:

`https://teams.microsoft.com/l/entity/<appId>/<entityId>?webUrl=<entityWebUrl>&label=<entityLabel>&context=<context>`

> [!NOTE]
> Если бот отправляет сообщение с глубокой ссылкой, при выборе ссылки открывается новая вкладка `TextBlock` браузера. Это происходит в Chrome и в классических приложениях Microsoft Teams, работающих в Linux.
> Если бот отправляет такой же URL-адрес прямой ссылки в адрес, то вкладка Teams открывается на текущей вкладке браузера, когда пользователь выбирает `Action.OpenUrl` ссылку. Новая вкладка браузера не открывается.

Параметры запроса:

* `appId`&emsp;ИД из манифеста; например, "fe4a8eba-2a31-4737-8e33-e5fae6fee194"
* `entityId`&emsp;ИД элемента на вкладке, который вы предоставили при [настройке вкладки;](~/tabs/how-to/create-tab-pages/configuration-page.md) например, "tasklist123"
* `entityWebUrl`или `subEntityWebUrl` &emsp; необязательное поле с использованием дополнительного URL-адреса, если клиент не поддерживает отрисовку вкладки, например " https://tasklist.example.com/123 или https://tasklist.example.com/list123/task456 "
* `entityLabel`или метка для элемента на вкладке, которая будет отображаться при отображе глубокой ссылки, например "Список задач `subEntityLabel` &emsp; 123" или "Задача 456"
* `context`&emsp;Объект JSON, содержащий следующие поля:
  * `subEntityId`&emsp;ИД элемента на _вкладке;_ например, "task456"
  * `channelId`&emsp;ИД канала Microsoft Teams, доступный из контекста [вкладки;](~/tabs/how-to/access-teams-context.md) например, "19:cbe3683f25094106b826c9cada3afbe0@thread.skype". Это свойство доступно только на настраиваемых вкладок с областью "команда". Он не доступен на статических вкладок, имеющих область "personal".

Примеры:

* Ссылка на настраиваемую вкладку: `https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123&label=Task List 123&context={"channelId": "19:cbe3683f25094106b826c9cada3afbe0@thread.skype"}`
* Ссылка на элемент задачи на настраиваемой вкладке: `https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123/456&label=Task 456&context={"subEntityId": "task456","channelId": "19:cbe3683f25094106b826c9cada3afbe0@thread.skype"}`
* Ссылка на самую статическую вкладку: `https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123&label=Task List 123`
* Ссылка на элемент задачи на статической вкладке: `https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123/456&label=Task 456&context={"subEntityId": "task456"}`

> [!IMPORTANT]
> Убедитесь, что все параметры запроса правильно закодированы в коде URI. Необходимо следовать предварительным примерам, используя последний пример:
> ```javascript
> var encodedWebUrl = encodeURI('https://tasklist.example.com/123/456&label=Task 456');
> var encodedContext = encodeURI('{"subEntityId": "task456"}');
> var taskItemUrl = 'https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=' + encodedWebUrl + '&context=' + encodedContext;
> ```

### <a name="consuming-a-deep-link-from-a-tab"></a>Глубокое связывание со вкладки

При переходе по глубокой ссылке Microsoft Teams просто переходит на вкладку и предоставляет механизм через библиотеку JavaScript Microsoft Teams для получения кода подуровни, если он существует.

Вызов возвращает контекст, включающим поле, если вкладка проходит по [`microsoftTeams.getContext`](/javascript/api/@microsoft/teams-js#getcontext--context--context-----void-) `subEntityId` глубокой ссылке.

## <a name="deep-linking-from-your-tab"></a>Глубокая ссылка со вкладки

На вкладке вы можете глубоко со ссылкой на контент в Teams. Это полезно, если вкладка должна ссылаться на другой контент в Teams, например канал, сообщение, другую вкладку или даже открывать диалоговое окно планирования. Чтобы вызвать глубокую ссылку со своей вкладки, необходимо вызвать:

```Javascript
microsoftTeams.executeDeepLink(/*deepLink*/);
```

Этот вызов позволяет перейти по правильному URL-адресу или активировать действие клиента, например открыть диалоговое окно планирования или установки приложения. Пример приведен в следующей статье:

```Javascript
// Open a scheduling dialog from your tab
microsoftTeams.executeDeepLink("https://teams.microsoft.com/l/meeting/new?subject=test%20subject&attendees=joe@contoso.com,bob@contoso.com&startTime=10%2F24%2F2018%2010%3A30%3A00&endTime=10%2F24%2F2018%2010%3A30%3A00&content=test%3Acontent");

// Open an app install dialog from your tab
microsoftTeams.executeDeepLink("https://teams.microsoft.com/l/app/f46ad259-0fe5-4f12-872d-c737b174bcb4");
```

## <a name="deep-linking-to-a-chat"></a>Глубокая ссылка на чат

Вы можете создавать глубокие ссылки на приватные чаты между пользователями, указав набор участников. Если чат не существует с указанными участниками, ссылка перемещает пользователя в пустой новый чат. Новые чаты создаются в состоянии черновика, пока пользователь не отправит первое сообщение. В противном случае можно указать имя чата, если он еще не существует, а также текст, который необходимо вставить в поле составить пользователя. Эту функцию можно использовать в качестве ярлыка для пользователя, который вручную переходит к чату или создает его, а затем введет сообщение.

Например, если вы возвращаете профиль пользователя Office 365 из бота в качестве карточки, эта глубокая ссылка позволяет пользователю легко общаться с этим пользователем.

### <a name="generating-a-deep-link-to-a-chat"></a>Создание глубокой ссылки на чат

Используйте этот формат для прямой ссылки, которую можно использовать в карточке бота, соединители или карточки расширения для обмена сообщениями:

`https://teams.microsoft.com/l/chat/0/0?users=<user1>,<user2>,...&topicName=<chat name>&message=<precanned text>`

Пример: `https://teams.microsoft.com/l/chat/0/0?users=joe@contoso.com,bob@contoso.com&topicName=Prep%20For%20Meeting%20Tomorrow&message=Hi%20folks%2C%20kicking%20off%20a%20chat%20about%20our%20meeting%20tomorrow`

Параметры запроса:

* `users`: разделенный запятой список ИД пользователей, представляющих участников чата. Пользователь, который выполняет действие, всегда включается в качестве участника. В настоящее время поле User ID поддерживает Azure AD UserPrincipalName, обычно только адрес электронной почты.
* `topicName`: необязательное поле для отображаемого имени чата, в случае чата с 3 или более пользователями. Если это поле не указано, отображаемая имя чата основывается на именах участников.
* `message`: необязательное поле для текста сообщения, которое вы хотите вставить в поле составить текущего пользователя, пока чат находится в черновике.

Чтобы использовать эту глубокую ссылку с ботом, можно указать ее в качестве целевого URL-адреса в кнопке карточки или нажать действие с помощью `openUrl` типа действия.

### <a name="generating-a-deep-link-to-a-call"></a>Создание глубокой ссылки на вызов

Используйте этот формат для прямой ссылки, которую можно использовать в карточке бота, соединители или карточки расширения для обмена сообщениями:

`https://teams.microsoft.com/l/call/0/0?users=<user1>,<user2>`

Пример: `https://teams.microsoft.com/l/call/0/0?users=joe@contoso.com,bob@contoso.com&topicName=Prep%20For%20Meeting%20Tomorrow&message=Hi%20folks%2C%20kicking%20off%20a%20chat%20about%20our%20meeting%20tomorrow`

Параметры запроса:

* `users`: разделенный запятой список пользовательских ИД, представляющих участников вызова. Пользователь, который выполняет действие, всегда включается в качестве участника. В настоящее время поле User ID поддерживает Azure AD UserPrincipalName, обычно только адрес электронной почты.

## <a name="linking-to-the-scheduling-dialog"></a>Ссылка на диалоговое окно планирования

> [!Note]
> В настоящее время эта функция находится в предварительной версии для разработчиков.

Вы можете создавать глубокие ссылки на диалоговое окно планирования, встроенное в Teams. Это особенно полезно, если ваше приложение помогает пользователю выполнять задачи, связанные с календарем или планированием.

### <a name="generating-a-deep-link-to-the-scheduling-dialog"></a>Создание глубокой ссылки на диалоговое окно планирования

Используйте следующий формат для прямой ссылки, которую можно использовать в карточке бота, соединитела или карточки расширения для обмена сообщениями: `https://teams.microsoft.com/l/meeting/new?subject=<meeting subject>&startTime=<date>&endTime=<date>&content=<content>&attendees=<user1>,<user2>,<user3>,...`

Пример: `https://teams.microsoft.com/l/meeting/new?subject=test%20subject&attendees=joe@contoso.com,bob@contoso.com&startTime=10%2F24%2F2018%2010%3A30%3A00&endTime=10%2F24%2F2018%2010%3A30%3A00&content=test%3Acontent`

Параметры запроса:

* `attendees`: необязательный разделенный запятой список пользовательских ИД, представляющих участников собрания. Пользователь, который выполняет действие, является организатором собрания. Поле "ИД пользователя" в настоящее время поддерживает только Azure AD UserPrincipalName, обычно это адрес электронной почты.
* `startTime`: необязательное время начала события. Это должен быть длинный формат [ISO 8601,](https://en.wikipedia.org/wiki/ISO_8601)например "2018-03-12T23:55:25+02:00".
* `endTime`: необязательное время окончания события, также в формате ISO 8601.
* `subject`: необязательное поле для темы собрания.
* `content`: необязательное поле для поля сведений о собрании.

В настоящее время указание расположения не поддерживается. Необходимо указать смещение ВТС, т. е. часовой пояс при создании времени начала и окончания.

Чтобы использовать эту глубокую ссылку с ботом, можно указать ее в качестве целевого URL-адреса в кнопке карточки или нажать действие с помощью `openUrl` типа действия.
