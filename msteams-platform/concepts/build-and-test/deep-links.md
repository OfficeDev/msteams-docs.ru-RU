---
title: Создание глубоких ссылок
description: Описание глубоких ссылок и способов их использования в приложениях
keywords: Прямая ссылка на ссылку Teams
ms.openlocfilehash: 03580c4d15c82da70402d68d85b0d28f8afa670e
ms.sourcegitcommit: fdcd91b270d4c2e98ab2b2c1029c76c49bb807fa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "44801245"
---
# <a name="create-deep-links-to-content-and-features-in-microsoft-teams"></a>Создание глубоких ссылок на контент и функции в Microsoft Teams

Вы можете создавать ссылки на сведения и функции в клиенте Teams. Примеры того, где это может пригодиться:

* Переходить от пользователя к содержимому на одной из вкладок приложения. Например, ваше приложение может иметь Bot, который отправляет сообщения, уведомляющие пользователя о важном действии. Когда пользователь насматривает уведомление, ссылка глубоко переходит на вкладку, чтобы пользователь мог просмотреть дополнительные сведения о действии.
* Приложение автоматизирует или упрощает выполнение определенных задач пользователя, например создание разговора или планирование собрания, предварительно заполнив ссылки с необходимыми параметрами. Это позволяет избежать необходимости вручную вводить данные вручную.

## <a name="deep-linking-to-your-tab"></a>Глубокая ссылка на вкладку

Можно создавать глубокие ссылки на объекты в Teams. Обычно это используется для создания ссылок, которые позволяют перейти к содержимому и сведениям на вкладке. Например, если вкладка содержит список задач, участники группы могут создавать ссылки на отдельные задачи и предоставлять к ним общий доступ. При нажатии ссылка переходит на вкладку, которая специализируется на определенном элементе. Чтобы реализовать эту возможность, вы можете добавить действие "Копировать ссылку" для каждого элемента, как угодно лучше всего подходит вашему пользовательскому интерфейсу. Когда пользователь выполняет это действие, вызывается `shareDeepLink()` Отображение диалогового окна, содержащего ссылку, которую пользователь может скопировать в буфер обмена. При совершении этого вызова вы также передаете идентификатор элемента, который возвращается в [контексте](~/tabs/how-to/access-teams-context.md) , когда ссылка соблюдается, а вкладка перегружается.

Кроме того, вы также можете создавать глубокие ссылки программным способом, используя формат, указанный далее в этом разделе. Их можно использовать в сообщениях [Bot](~/bots/what-are-bots.md) и [соединителей](~/webhooks-and-connectors/what-are-webhooks-and-connectors.md) , которые сообщают пользователям об изменениях вкладки или элементах в ней.

> [!NOTE]
> Это отличается от ссылок, предоставленных элементом меню **Копировать ссылку на вкладку** , что только создает глубокую ссылку, указывающую на эту вкладку.

### <a name="showing-a-deep-link-to-an-item-within-your-tab"></a>Как показать ссылку на элемент на вкладке

Чтобы отобразить диалоговое окно, содержащее детальную ссылку на элемент на вкладке, вызовите метод`microsoftTeams.shareDeepLink({ subEntityId: <subEntityId>, subEntityLabel: <subEntityLabel>, subEntityWebUrl: <subEntityWebUrl> })`

Предоставьте следующие поля:

* `subEntityId`&emsp;Уникальный идентификатор элемента на вкладке, к которому выполняется глубокая компоновка
* `subEntityLabel`&emsp;Метка элемента, который будет использоваться для отображения глубокой ссылки
* `subEntityWebUrl`&emsp;Необязательное поле с резервным URL-адресом, которое будет использоваться, если клиент не поддерживает отрисовку вкладки

### <a name="generating-a-deep-link-to-your-tab"></a>Создание глубокой ссылки на вкладку

> [!NOTE]
> Статические вкладки имеют область "персональный" и настраиваемые вкладки имеют область "Team". Два типа вкладок имеют слегка отличающийся синтаксис, так как только настраиваемые вкладки имеют свойство, `channel` связанное с объектом context. В справке по [манифесту](~/resources/schema/manifest-schema.md) представлены дополнительные сведения о личных областях и областях группы.
> [!NOTE]
> Глубокие ссылки работают правильно только в том случае, если вкладка была настроена с использованием библиотеки v 0,4 или более поздней версии, а также имеет идентификатор сущности. Глубокие ссылки на вкладки без идентификатора сущностей продолжают переходить на вкладку, но не могут предоставлять идентификатор вложенного объекта на вкладку.

Используйте этот формат для глубокой ссылки, которую можно использовать в карточке почтовых роботов, соединителей или модулей обмена сообщениями:

`https://teams.microsoft.com/l/entity/<appId>/<entityId>?webUrl=<entityWebUrl>&label=<entityLabel>&context=<context>`

Параметры запроса:

* `appId`&emsp;ИДЕНТИФИКАТОР из манифеста; Например, "fe4a8eba-2a31-4737-8e33-e5fae6fee194"
* `entityId`&emsp;Идентификатор элемента на вкладке, который был указан при [настройке вкладки](~/tabs/how-to/create-tab-pages/configuration-page.md); Например, "tasklist123"
* `entityWebUrl`или `subEntityWebUrl` &emsp; необязательное поле с резервным URL-адресом, которое будет использоваться, если клиент не поддерживает отрисовку вкладки, например, " https://tasklist.example.com/123 " или " https://tasklist.example.com/list123/task456 "
* `entityLabel`или `subEntityLabel` &emsp; метку для элемента на вкладке, который будет использоваться при отображении глубокой ссылки, например "task List 123" или "Task 456"
* `context`&emsp;Объект JSON, содержащий следующие поля:
  * `subEntityId`&emsp;Идентификатор _элемента на_ вкладке; Например, "task456"
  * `channelId`&emsp;Идентификатор канала Microsoft Teams (доступен в [контексте](~/tabs/how-to/access-teams-context.md)вкладки, например "19: cbe3683f25094106b826c9cada3afbe0@thread. Skype". Это свойство доступно только в настраиваемых вкладках с областью "Team". Она недоступна в статических вкладках, имеющих область "персональный".

Примеры:

* Ссылка на настраиваемую вкладку:`https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123&label=Task List 123&context={"channelId": "19:cbe3683f25094106b826c9cada3afbe0@thread.skype"}`
* Ссылка на элемент задачи в настраиваемой вкладке:`https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123/456&label=Task 456&context={"subEntityId": "task456","channelId": "19:cbe3683f25094106b826c9cada3afbe0@thread.skype"}`
* Ссылка на статическую вкладку:`https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123&label=Task List 123`
* Ссылка на элемент задачи в статической вкладке:`https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=https://tasklist.example.com/123/456&label=Task 456&context={"subEntityId": "task456"}`

> [!IMPORTANT]
> Убедитесь, что все параметры запроса правильно кодируются в URI. В целях удобства чтения приведенные выше примеры не являются допустимыми, но это необходимо. В последнем примере:
> ```javascript
> var encodedWebUrl = encodeURI('https://tasklist.example.com/123/456&label=Task 456');
> var encodedContext = encodeURI('{"subEntityId": "task456"}');
> var taskItemUrl = 'https://teams.microsoft.com/l/entity/fe4a8eba-2a31-4737-8e33-e5fae6fee194/tasklist123?webUrl=' + encodedWebUrl + '&context=' + encodedContext;
> ```

### <a name="consuming-a-deep-link-from-a-tab"></a>Использование глубокой ссылки из вкладки

При переходе к глубокой ссылке Microsoft Teams просто переходит на вкладку и предоставляет механизм с помощью библиотеки JavaScript Microsoft Teams для получения идентификатора вложенного объекта (если он существует).

[`microsoftTeams.getContext`](/javascript/api/@microsoft/teams-js#getcontext--context--context-----void-)При вызове возвращается контекст, включающий в себя `subEntityId` поле, если перейти к вкладке с помощью глубокой ссылки.

## <a name="deep-linking-from-your-tab"></a>Глубокая компоновка на вкладке

На вкладке можно выполнить ссылки на контент в Teams. Это полезно, если для вкладки требуется связать с другим контентом в таких командах, как канал, сообщение, другая вкладка или даже открыть диалоговое окно расписания. Для запуска прямой ссылки на вкладке необходимо вызвать:

```Javascript
microsoftTeams.executeDeepLink(/*deepLink*/);
```

Откроется правильный URL-адрес или действие клиента, например открытие диалогового окна установки расписания или приложения. Пример:

```Javascript
// Open a scheduling dialog from your tab
microsoftTeams.executeDeepLink("https://teams.microsoft.com/l/meeting/new?subject=test%20subject&attendees=joe@contoso.com,bob@contoso.com&startTime=10%2F24%2F2018%2010%3A30%3A00&endTime=10%2F24%2F2018%2010%3A30%3A00&content=test%3Acontent");

// Open an app install dialog from your tab
microsoftTeams.executeDeepLink("https://teams.microsoft.com/l/app/f46ad259-0fe5-4f12-872d-c737b174bcb4");
```

## <a name="deep-linking-to-a-chat"></a>Глубокая ссылка на чат

Можно создавать глубокие ссылки на частные беседы между пользователями, указывая набор участников. Если чат не существует для указанных участников, ссылка вернет пользователя в пустое новое обсуждение. Новые сеансы будут создаваться в состоянии черновика до тех пор, пока пользователь не получит первое сообщение. При необходимости можно указать имя чата (если она еще не существует), а также текст, который должен быть вставлен в поле создания пользователя. Эту функцию можно представить как ярлык для пользователя, который выполняет ручное перемещение или создание разговора, а затем вводит сообщение.

В качестве примера варианта использования при возврате профиля пользователя Office 365 из ленты в качестве карточки эта прямая ссылка позволяет пользователю легко общаться с этим пользователем.

### <a name="generating-a-deep-link-to-a-chat"></a>Создание глубокой ссылки на чат

Используйте этот формат для глубокой ссылки, которую можно использовать в карточке почтовых роботов, соединителей или модулей обмена сообщениями:

`https://teams.microsoft.com/l/chat/0/0?users=<user1>,<user2>,...&topicName=<chat name>&message=<precanned text>`

Пример: `https://teams.microsoft.com/l/chat/0/0?users=joe@contoso.com,bob@contoso.com&topicName=Prep%20For%20Meeting%20Tomorrow&message=Hi%20folks%2C%20kicking%20off%20a%20chat%20about%20our%20meeting%20tomorrow`

Параметры запроса:

* `users`&emsp;Разделенный запятыми список идентификаторов пользователей, представляющих участников чата. Пользователь, выполняющий действие, всегда включается в качестве участника. Поле идентификатора пользователя в настоящее время поддерживает только Azure AD UserPrincipalName (обычно это адрес электронной почты).
* `topicName`&emsp;Необязательное поле для отображаемого имени чата, в случае беседы с тремя или более пользователями. Если это поле не указано, отображаемое имя чата будет основано на именах участников.
* `message`&emsp;Необязательное поле для текста сообщения, которое необходимо вставить в поле создания текущего пользователя, когда чат находится в состоянии черновика.

Чтобы использовать эту ссылку с роботом, вы можете указать ее как целевой URL-адрес на кнопке карточки или действие касания, используя `openUrl` тип действия.

## <a name="linking-to-the-scheduling-dialog"></a>Связывание с диалоговым окном планирования

> [!Note]
> Эта функция в настоящее время находится в предварительной версии для разработчиков.

Можно создавать детальные ссылки на встроенное диалоговое окно планирования клиента Teams. Это особенно полезно, если ваше приложение помогает пользователю выполнить задачи, связанные с календарем или планированием.

### <a name="generating-a-deep-link-to-the-scheduling-dialog"></a>Создание глубокой ссылки на диалоговое окно планирования

Используйте этот формат для глубокой ссылки, которую можно использовать в карточке почтовых роботов, соединителей или модулей обмена сообщениями:`https://teams.microsoft.com/l/meeting/new?subject=<meeting subject>&startTime=<date>&endTime=<date>&content=<content>&attendees=<user1>,<user2>,<user3>,...`

Пример: `https://teams.microsoft.com/l/meeting/new?subject=test%20subject&attendees=joe@contoso.com,bob@contoso.com&startTime=10%2F24%2F2018%2010%3A30%3A00&endTime=10%2F24%2F2018%2010%3A30%3A00&content=test%3Acontent`

Параметры запроса:

* `attendees`&emsp;Необязательный разделенный запятыми список идентификаторов пользователей, представляющих участников собрания. Пользователь, выполняющий действие, является организатором собрания. Поле идентификатора пользователя в настоящее время поддерживает только Azure AD UserPrincipalName (обычно это адрес электронной почты).
* `startTime`&emsp;Необязательное время начала события. Это должен быть [длинный формат ISO 8601](https://en.wikipedia.org/wiki/ISO_8601), например "2018 г.-03-12T23:55:25 + 02:00".
* `endTime`&emsp;Необязательное время окончания события, также в формате ISO 8601.
* `subject`&emsp;Необязательное поле для темы собрания.
* `content`&emsp;Необязательное поле для поля сведений о собрании.

В настоящее время указание расположения не поддерживается. При создании времени начала и окончания обязательно указывайте смещение UTC (часовые пояса).

Чтобы использовать эту ссылку с роботом, вы можете указать ее как целевой URL-адрес на кнопке карточки или действие касания, используя `openUrl` тип действия.
