---
title: Интеграция средства "Выбор людей"
author: Rajeshwari-v
description: Использование SDK Teams JavaScript для интеграции управления выбором людей
keywords: управлением выборщика людей
ms.topic: conceptual
ms.localizationpriority: medium
ms.author: surbhigupta
ms.openlocfilehash: 7a7a229bdeab7d83f71f8dbe3b24da8b44b3db32
ms.sourcegitcommit: 90587b1ec04bf20d716ed6feb8ccca4313e87f8c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2022
ms.locfileid: "62518144"
---
# <a name="integrate-people-picker"></a>Интеграция средства "Выбор людей"  

Выбор людей — это управление для поиска и выбора людей. Это родной потенциал, доступный в Teams платформе. Вы можете интегрировать Teams управления входными данными пользователей с веб-приложениями. Можно выбрать между одним или несколькими выборами и конфигурациями, например ограничением поиска в чате, каналах или во всей организации.

Вы можете использовать [Microsoft Teams JavaScript клиента SDK](/javascript/api/overview/msteams-client?view=msteams-client-js-latest&preserve-view=true), `selectPeople` который предоставляет API для интеграции выборщика людей в вашем веб-приложении. 

## <a name="advantages-of-integrating-the-native-people-picker"></a>Преимущества интеграции родного выборщика людей 

* Управление выборщиком людей работает во всех Teams, таких как модуль задач, чат, канал, вкладка собраний и личное приложение.
* Этот контроль позволяет искать и выбирать пользователей в чате, канале или всей организации.
* Выбор людей помогает в сценариях, связанных с назначением задач, тегами, оповещать пользователя. 
* Этот легкодоступный контроль можно использовать в веб-приложении. Это значительно экономит усилия и время для создания такого управления самостоятельно.

Необходимо вызвать API `selectPeople` для интеграции управления выборщиком людей в Teams приложении. Для эффективной интеграции необходимо иметь представление о фрагменте кода [для вызова](#code-snippet) API. Важно ознакомиться с ошибками [ответа API](#error-handling) для обработки ошибок в веб-приложении.

> [!NOTE] 
> В настоящее время Microsoft Teams для людей Picker доступна только для мобильных клиентов.

## <a name="selectpeople-api"></a>`selectPeople` API 

`selectPeople`API позволяет добавлять Teams в `People Picker input control` веб-приложения.  
Описание API следующим образом:

| API      | Description  |
| --- | --- |
|**selectPeople**|Запускает выбор людей и позволяет пользователю искать и выбирать одного или несколько человек из списка.<br/><br/>Этот API возвращает ID, имя и адрес электронной почты выбранных пользователей в вызываемом веб-приложении.<br/><br/>В случае личного приложения управление выполняет поиск по всей организации. Если приложение добавляется в чат или канал, контекст поиска настраивается в зависимости от сценария. Поиск ограничен членами этого чата, канала или доступен в организации.|

API `selectPeople` поставляется вместе со следующими конфигурациями ввода:

|Параметр Конфигурация|Тип|Описание| Значение по умолчанию|
|-----|------|--------------|------|
|`title`| String| Это необязательный параметр. Он задает название для управления выборщиком людей. | Выбор людей|
|`setSelected`|String| Это необязательный параметр. Необходимо передать Microsoft Azure Active Directory (Azure AD) для предварительного отсеяна. Этот параметр предварительно отбирает людей при запуске управления выборщиком людей. В случае единого выбора только первый допустимый пользователь будет предварительно заселяться, игнорируя остальные. |Null| 
|`openOrgWideSearchInChatOrChannel`|Логический | Это необязательный параметр. Если установлено, что это верно, он запускает выбор людей в широкой области организации, даже если приложение добавлено в чат или канал. |Неверно|
|`singleSelect`|Логический|Это необязательный параметр. Когда установлено, что это верно, запускается выборщик людей, ограничивающий выбор только для одного пользователя. |Неверно|

На следующем изображении описывается опыт выборки людей в примере веб-приложения:

![Веб-приложение выборщика людей](../../assets/images/tabs/people-picker-control-capability.png)

### <a name="code-snippet"></a>Фрагмент кода

**Вызов `selectPeople` API** для выбора людей из списка:

```javascript
 microsoftTeams.people.selectPeople((error: microsoftTeams.SdkError, people: microsoftTeams.people.PeoplePickerResult[]) => 
 {
    if (error) 
    {
        if (error.message) 
           {
             alert(" ErrorCode: " + error.errorCode + error.message);
           }
            else 
            {
              alert(" ErrorCode: " + error.errorCode);
            }
      }
    if (people)
     {
            output(" People length: " + people.length + " " + JSON.stringify(people));
      }
  });
```

## <a name="error-handling"></a>Обработка ошибок

Необходимо обеспечить надлежащее обработку ошибок в веб-приложении. В следующей таблице перечислены коды ошибок и условия, при которых создаются ошибки: 

|Код ошибки |  Имя ошибки     | Условие|
| --------- | --------------- | -------- |
| **100** | NOT_SUPPORTED_ON_PLATFORM | API не поддерживается на текущей платформе.|
| **500** | INTERNAL_ERROR | Внутренняя ошибка встречается при запуске выборщика людей.|
| **4000** | INVALID_ARGUMENTS | API вызывается с неправильными или недостаточными обязательными аргументами.|
| **8000** | USER_ABORT |Пользователь отменил операцию.|
| **9000** | OLD_PLATFORM | Пользователь находится на старой сборке платформы, где нет реализации API.  Обновление сборки устраняет проблему.|

## <a name="see-also"></a>См. также

* [Интеграция возможностей мультимедиа в Teams](mobile-camera-image-permissions.md)
* [Интеграция QR-кода или возможности сканера штрихкодов в Teams](qr-barcode-scanner-capability.md)
* [Интеграция возможностей расположения в Teams](location-capability.md)
