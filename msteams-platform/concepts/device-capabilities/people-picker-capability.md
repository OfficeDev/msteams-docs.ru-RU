---
title: Интеграция возможностей выборщика людей
author: Rajeshwari-v
description: Использование SDK Teams JavaScript для интеграции возможностей выборщика людей
keywords: управлением выборщика людей
ms.topic: conceptual
localization_priority: Normal
ms.author: surbhigupta
ms.openlocfilehash: 8399eeb1a088e4b60c466d51c223b9405ebf1711
ms.sourcegitcommit: 059d22c436ee9b07a61561ff71e03e1c23ff40b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2021
ms.locfileid: "53211643"
---
# <a name="integrate-people-picker-capability"></a>Интеграция возможностей выборщика людей 

Выбор людей — это управление для поиска и выбора людей. Это родной потенциал, доступный в Teams платформе. Вы можете интегрировать Teams управления входными данными пользователей с веб-приложениями. Можно выбрать между одним или несколькими выборами и конфигурациями, например ограничением поиска в чате, каналах или во всей организации.

Вы можете использовать [Microsoft Teams JavaScript клиента SDK,](/javascript/api/overview/msteams-client?view=msteams-client-js-latest&preserve-view=true)который предоставляет API для интеграции возможностей выборщика людей `selectPeople` в вашем веб-приложении. 

## <a name="advantages-of-integrating-people-picker-capability"></a>Преимущества интеграции возможностей выборщика людей

* Управление выборщиком людей работает во всех Teams, таких как модуль задач, чат, канал, вкладка собраний и личное приложение.
* Этот контроль позволяет искать и выбирать пользователей в чате, канале или всей организации.
*  Возможность выборки людей помогает в сценариях, связанных с назначением задач, тегами, уведомлением пользователя. 
* Этот легкодоступный контроль можно использовать в веб-приложении. Это значительно экономит усилия и время для создания такого управления самостоятельно.

Необходимо вызвать `selectPeople` API для интеграции управления выборщиком людей в Teams приложении. Для эффективной интеграции необходимо иметь представление о фрагменте кода для [вызова](#code-snippet) API. Важно ознакомиться с ошибками [ответа API](#error-handling) для обработки ошибок в веб-приложении.

> [!NOTE] 
> В настоящее время Microsoft Teams поддержка возможностей выборщика людей доступна только для мобильных клиентов.

## <a name="selectpeople-api"></a>`selectPeople` API 

`selectPeople`API позволяет добавлять Teams в `People Picker input control` веб-приложения.  
Описание API следующим образом:

| API      | Описание  |
| --- | --- |
|**selectPeople**|Запускает выбор людей и позволяет пользователю искать и выбирать одного или несколько человек из списка.<br/><br/>Этот API возвращает ID, имя и адрес электронной почты выбранных пользователей в вызываемом веб-приложении.<br/><br/>В случае личного приложения управление выполняет поиск по всей организации. Если приложение добавляется в чат или канал, контекст поиска настраивается в зависимости от сценария. Поиск ограничен членами этого чата, канала или доступен в организации.|

API `selectPeople` поставляется вместе со следующими конфигурациями ввода:

|Параметр Конфигурация|Тип|Описание| Значение по умолчанию|
|-----|------|--------------|------|
|`title`| String| Это необязательный параметр. Он задает название для управления выборщиком людей. | Выбор людей|
|`setSelected`|String| Это необязательный параметр. Необходимо передать AAD-ID людей, которые будут предварительно отбираться. Этот параметр предварительно отбирает людей при запуске управления выборщиком людей. В случае единого выбора только первый допустимый пользователь будет предварительно заселяться, игнорируя остальные. |Null| 
|`openOrgWideSearchInChatOrChannel`|Логический | Это необязательный параметр. Если установлено, что это верно, он запускает выбор людей в широкой области организации, даже если приложение добавлено в чат или канал. |Неверно|
|`singleSelect`|Логический|Это необязательный параметр. Когда установлено, что это верно, запускается выборщик людей, ограничивающий выбор только для одного пользователя. |Неверно|

На следующем изображении показана возможность выборки людей в примере веб-приложения:

![Опыт работы веб-приложения с возможностями выборщика людей](../../assets/images/tabs/people-picker-control-capability.png)

### <a name="code-snippet"></a>Фрагмент кода

**Вызов `selectPeople` API** для выбора людей из списка:

```javascript
 microsoftTeams.people.selectPeople((error: microsoftTeams.SdkError, people: microsoftTeams.people.PeoplePickerResult[]) => 
 {
    if (error) 
    {
        if (error.message) 
           {
             alert(" ErrorCode: " + error.errorCode + error.message);
           }
            else 
            {
              alert(" ErrorCode: " + error.errorCode);
            }
      }
    if (people)
     {
            output(" People length: " + people.length + " " + JSON.stringify(people));
      }
  });
```

## <a name="error-handling"></a>Обработка ошибок

Необходимо обеспечить надлежащее обработку ошибок в веб-приложении. В следующей таблице перечислены коды ошибок и условия, при которых создаются ошибки: 

|Код ошибки |  Имя ошибки     | Condition|
| --------- | --------------- | -------- |
| **100** | NOT_SUPPORTED_ON_PLATFORM | API не поддерживается на текущей платформе.|
| **500** | INTERNAL_ERROR | Внутренняя ошибка встречается при запуске выборщика людей.|
| **4000** | INVALID_ARGUMENTS | API вызывается с неправильными или недостаточными обязательными аргументами.|
| **8000** | USER_ABORT |Пользователь отменил операцию.|
| **9000** | OLD_PLATFORM | Пользователь находится на старой сборке платформы, где нет реализации API.  Обновление сборки устраняет проблему.|

## <a name="see-also"></a>См. также

* [Интеграция возможностей мультимедиа в Teams](mobile-camera-image-permissions.md)
* [Интеграция QR-кода или возможности сканера штрихкодов в Teams](qr-barcode-scanner-capability.md)
* [Интеграция возможностей расположения в Teams](location-capability.md)
