---
title: Интеграция средства "Выбор людей"
description: Из этой статьи вы узнаете, как использовать клиентский пакет SDK Teams JavaScript для интеграции элемента управления "Выбор людей" и получения преимуществ использования средства выбора людей.
ms.topic: conceptual
ms.localizationpriority: high
ms.author: surbhigupta
ms.openlocfilehash: 0da107c4086d7eae568990746a877b79f030a564
ms.sourcegitcommit: b4986bf529c74444db67b7ce522b3b0d2c2a8e28
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/16/2022
ms.locfileid: "66130447"
---
# <a name="integrate-people-picker"></a>Интеграция средства "Выбор людей"

"Выбор людей" — это входной контроль в Teams, позволяющий пользователям искать и выбирать пользователей. Вы можете интегрировать элемент управления вводом в средство "Выбор людей" в веб-приложении, что позволит конечным пользователям выполнять различные функции, такие как поиск и выбор пользователей в чате, канале или в организации в Teams. Элемент управления "Выбор людей" доступен во всех клиентах Teams, таких как веб-приложения, настольные компьютеры и мобильные устройства.

Вы можете использовать [клиентский SDK JavaScript для Microsoft Teams](/javascript/api/overview/msteams-client?view=msteams-client-js-latest&preserve-view=true), который предоставляет API `selectPeople` для интеграции управления входными данными средства "Выбор людей" в веб-приложении.

## <a name="advantages-of-using-people-picker"></a>Преимущества использования средства "Выбор людей"

* Работает со всеми возможностями Teams, такими как модуль задач, чат, канал, вкладка собраний и личное приложение.
* Позволяет пользователю искать и выбирать пользователей в чате, канале или всей организации в Teams.
* Помогает в сценариях, связанных с назначением задач, добавлением тегов и уведомлением пользователя.
* Экономит значительное время и усилия по сравнению с созданием аналогичного элемента управления.

Чтобы интегрировать управление вводом в средство "Выбор людей" в приложении Teams, используйте API [`selectPeople`](#selectpeople-api). Для интеграции и вызова API необходимо хорошо знать прилагаемый [фрагмент кода](#code-snippet). Кроме того, вам необходимо ознакомиться с [ошибками ответов API](#error-handling).

## <a name="selectpeople-api"></a>API `selectPeople`

API `selectPeople` позволяет добавлять в веб-приложения элемент управления вводом в средстве "Выбор людей" в Teams, а также помогает со следующими задачами.

* Позволяет пользователю искать и выбирать одного или несколько пользователей из списка.
* Возвращает в веб-приложение идентификатор, имя и адрес электронной почты выбранных пользователей.

В личном приложении элемент управления ищет имя или идентификатор электронной почты по всей организации в Teams. Если приложение добавляется в чат или канал, контекст поиска настраивается в зависимости от сценария. Поиск ограничен участниками чата или канала.

API `selectPeople` поставляется со следующими конфигурациями ввода:

|Параметр конфигурации|Тип|Описание| Значение по умолчанию|
|-----|------|--------------|------|
|`title`|String| Это необязательный параметр, который задает заголовок для элемента управления "Выбор людей".|`selectPeople`|
|`setSelected`|String| Это необязательный параметр. Необходимо передать идентификаторы пользователей Microsoft Azure Active Directory (Azure AD), которые будут выбраны предварительно. Этот параметр предварительно выбирает людей при запуске элемента управления вводом средства "Выбор людей". В единичном выборе предварительно заполняется только первый действительный пользователь, остальные игнорируются.|**Null**|
|`openOrgWideSearchInChatOrChannel`|Логическое| Это необязательный параметр, и если задано значение true, он запускает "Выбор людей" в масштабах всей организации, даже если приложение добавлено в чат или канал.|**False**|
|`singleSelect`|Логическое|Это необязательный параметр, и если задано значение true, он запускает "Выбор людей" и ограничивает выбор только одним пользователем.|**False**|

На следующем изображении показан интерфейс средства "Выбор людей" на мобильных и настольных компьютерах.

# <a name="mobile"></a>[Мобильные устройства](#tab/Samplemobileapp)

С помощью элемента управления вводом средства "Выбор людей" пользователь может искать и добавлять пользователей, следуя следующим инструкциям.

1. Введите имя пользователя. Появится список с предложениями имен.
1. Выберите имя нужного пользователя из списка.

   :::image type="content" source="../../assets/images/tabs/people-picker-control-capability-mobile-updated.png" alt-text="Мобильная версия средства &quot;Выбор людей&quot;" border="true":::

# <a name="desktop"></a>[Компьютер](#tab/Sampledesktop)

Элемент управления "Выбор людей" в Интернете или в настольной версии запускается в модальном окне поверх веб-приложения. Чтобы добавить пользователей, выполните следующие действия.

1. Введите имя пользователя. Появится список с предложениями имен.
1. Выберите имя нужного пользователя из списка.

   :::image type="content" source="../../assets/images/tabs/select-people-picker-byname.png" alt-text="Средство &quot;Выбор людей&quot; с поиском по имени в настольной версии" border="true":::

---

## <a name="code-snippet"></a>Фрагмент кода

В следующем фрагменте кода показано использование пользователей API `selectPeople` из списка:

```javascript
microsoftTeams.people.selectPeople((error: microsoftTeams.SdkError, people: microsoftTeams.people.PeoplePickerResult[]) => 
 {
    if (error) 
    {
        if (error.message) 
           {
             alert(" ErrorCode: " + error.errorCode + error.message);
           }
            else 
            {
              alert(" ErrorCode: " + error.errorCode);
            }
      }
    if (people)
     {
            output(" People length: " + people.length + " " + JSON.stringify(people));
      }
  },{ setSelected: ["aad id"], openOrgWideSearchInChatOrChannel: true, singleSelect: false});
```

## <a name="error-handling"></a>Обработка ошибок

В следующей таблице перечислены коды ошибок и их описания.

|Код ошибки |  Название ошибки     | Описание|
| --------- | --------------- | --------- |
| **100** | NOT_SUPPORTED_ON_PLATFORM | API не поддерживается на текущей платформе.|
| **500** | INTERNAL_ERROR | Внутренняя ошибка при запуске средства "Выбор людей".|
| **4000** | INVALID_ARGUMENTS | API вызывается с неправильными или недостаточными обязательными аргументами.|
| **8000** | USER_ABORT |Пользователь отменил операцию.|
| **9000** | OLD_PLATFORM | Пользователь использует старую сборку платформы, где реализация API недоступна. Чтобы устранить проблему, обновите сборку до последней версии.|

## <a name="see-also"></a>См. также

* [Интеграция возможностей мультимедиа](~/concepts/device-capabilities/media-capabilities.md)
* [Интеграция функции сканирования QR- или штрихкода в Teams](qr-barcode-scanner-capability.md)
* [Интеграция функций местонахождения](location-capability.md)
