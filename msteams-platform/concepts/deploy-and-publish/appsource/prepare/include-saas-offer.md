---
title: Включение предложения SaaS в приложение
description: Узнайте, как монетизировать ваше Microsoft Teams с помощью планов подписки.
author: heath-hamilton
ms.author: surbhigupta
ms.topic: how-to
localization_priority: Normal
ms.openlocfilehash: 711f40ad24a0d714f4555ceb134009d6810b947f
ms.sourcegitcommit: a01d22a29e13e19331936e332ab7fbe6ffb1d718
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2021
ms.locfileid: "61348358"
---
# <a name="include-a-saas-offer-with-your-microsoft-teams-app"></a>Включите предложение SaaS в Microsoft Teams приложение

:::row:::
   :::column span="3":::

С помощью предложения transactable Software-as-a-Service (SaaS) можно монетизировать приложение Teams, продавая планы подписки непосредственно из списка Teams магазина. Например, допустим, у вас есть бесплатное приложение, которое любой желающий может получить в магазине. Теперь вы можете предложить премиум и корпоративные планы для пользователей, которые хотят больше возможностей.

Вот общее представление о том, как монетизировать приложение:

1.  [Планирование предложения SaaS](#plan-your-saas-offer).

1.  [Интеграция с API выполнения SaaS](#integrate-with-the-saas-fulfillment-apis).

1.  [Создание посадочной страницы для управления подпиской.](#build-a-landing-page-for-subscription-management)

1.  [Создайте предложение SaaS](#create-your-saas-offer).

1.  [Настройка приложения для предложения SaaS.](#configure-your-app-for-the-saas-offer)

1.  [Публикация приложения в Teams магазине.](#publish-your-app)

   :::column-end:::
   :::column span="1":::
   
:::image type="content" source="~/assets/images/saas-offer/saas-offer-diagram.png" alt-text="Схема, показывающая процесс, как включить предложение SaaS в Teams приложение." border="false":::

   :::column-end:::
:::row-end:::

## <a name="plan-your-saas-offer"></a>Планирование предложения SaaS

Всесторонние рекомендации см. в инструкции по планированию [предложения SaaS для коммерческого рынка Майкрософт.](/azure/marketplace/plan-saas-offer)

При планировании монетизации Teams приложения необходимо учитывать некоторые моменты.

* Определите модель подписки. Предложение SaaS с возможностью трансактабельного использования может включать несколько планов подписки. Общедоступные планы подписки, доступные для всех, являются наиболее распространенными, но вы также можете нацелить конкретных клиентов с предложениями только для них. Дополнительные сведения см. в [частных предложениях на коммерческом рынке Майкрософт.](/azure/marketplace/private-offers)
* Ознакомьтесь с вариантом продажи через [ *Microsoft*](/azure/marketplace/plan-saas-offer#listing-options) для предложения SaaS, который необходим, если вы хотите, чтобы пользователи приобретали планы подписки на ваше приложение непосредственно в Teams магазине.
* Узнайте, Azure Active Directory (Azure AD) один вход [(SSO)](/azure/marketplace/azure-ad-saas) помогает клиентам приобретать и управлять подписками. (SSO Azure AD требуется для Teams приложений с предложениями SaaS.)
* Поймите, что вы несете ответственность за управление инфраструктурой, необходимой для поддержки использования вашими клиентами предложения SaaS.
* Планирование мобильной связи. Чтобы не нарушать политики сторонних магазинов приложений, приложение не может включать ссылки, позволяющие пользователям приобретать планы подписки на мобильный телефон. Однако вы все равно можете указать, есть ли в вашем приложении функции, которые требуют подписки. Дополнительные сведения см. в соответствующих [политиках сертификации](/legal/marketplace/certification-policies#114048-mobile-experience)коммерческих рынков.

## <a name="integrate-with-the-saas-fulfillment-apis"></a>Интеграция с API выполнения SaaS

Интеграция с API выполнения SaaS необходима для монетизации Teams приложения. Эти API помогают управлять жизненным циклом плана подписки после его приобретения пользователем.

Полные инструкции и ссылки на API см. в документации API выполнения [SaaS.](/azure/marketplace/partner-center-portal/pc-saas-fulfillment-apis) Как правило, после приобретения подписки вы будете выполнять следующие действия с помощью API:

1. Получение [*маркера идентификации покупки*](/azure/marketplace/partner-center-portal/pc-saas-fulfillment-life-cycle#purchased-but-not-yet-activated-pendingfulfillmentstart) с помощью URL-адреса на посадочную страницу.

1. Используйте маркер для получения сведений о подписке.

1. Уведомить коммерческий рынок о активации подписки.

### <a name="best-practices-for-implementing-subscription-management"></a>Лучшие практики для реализации управления подписками

* С помощью трансактируемых SaaS-предложений для Teams приложений планы подписки (лицензии) должны быть назначены отдельным пользователям, а не группам или всей организации.
* Когда пользователям назначена подписка, сообщите об этом с помощью Teams или электронной почты. В сообщении включайте сведения о том, как добавить приложение в Teams и начать работу.
* Поддержка идеи нескольких администраторов. Другими словами, несколько пользователей в одной и той же организации могут приобретать и управлять своими подписками.

## <a name="build-a-landing-page-for-subscription-management"></a>Создание страницы для управления подпиской 

Когда кто-то закончит покупку плана подписки для вашего приложения в магазине Teams, коммерческий рынок направят его на вашу посадочную страницу, где они смогут управлять подпиской (например, назначить лицензию конкретному пользователю в своей организации).

Полные инструкции см. [в странице сборки посадочной страницы для предложения SaaS.](/azure/marketplace/azure-ad-transactable-saas-landing-page)

### <a name="best-practices-for-landing-pages"></a>Лучшие практики для посадочных страниц

При создании посадочной страницы для приложения Teams которое вы монетизируете, рассмотрите следующие подходы. См. пример посадочной страницы в [интерфейсе покупки конечных пользователей.](#end-user-purchasing-experience)

* Пользователи должны иметь возможность войти на вашу посадочную страницу с помощью тех же учетных данных Azure AD, которые использовались для покупки подписки. Дополнительные сведения см. в [видеоролике Azure AD и трансактируемых предложениях SaaS на коммерческом рынке.](/azure/marketplace/azure-ad-saas)
* Разрешить пользователям принимать следующие действия на вашей странице. Не забывайте учитывать, что подходит для роли и разрешений пользователя (например, может потребоваться разрешить поиск пользователей только администраторам подписки):
  * Поиск пользователей в их организации с помощью электронной почты или другой формы удостоверения.
  * Просмотр пользователей, на которые они могут назначать лицензии в списке.
  * Назначить лицензии одному или нескольким пользователям одновременно.
  * Назначение и управление различными типами лицензий (при наличии).
  * Проверка, если лицензия уже назначена другому пользователю.
  * Отмена подписки.
* Предодайте представление о том, как использовать приложение.
* Добавьте способы получения поддержки, такие как faQ, база знаний или контактный адрес электронной почты.
* Предобережете ссылку, которая упрощает доступ абонента к посадочной странице. Например, включите эту ссылку в вкладку "О вашем **приложении".**

## <a name="create-your-saas-offer"></a>Создание предложения SaaS

После интеграции API выполнения SaaS и создания своей посадочной страницы, на которой пользователи могут управлять подписками, пришло время официально создать, протестировать и опубликовать свое предложение SaaS для выполнения выполнения.

> [!IMPORTANT]
> Teams в настоящее время  поддерживает только модель ценообразования для каждого пользователя (пользователя/месяца и пользователя/года) для предложений SaaS. Дополнительные сведения см. в [моделях ценообразования SaaS.](/azure/marketplace/plan-saas-offer#saas-pricing-models)

### <a name="create-the-offer"></a>Создание предложения

Дополнительные инструкции по созданию [предложения SaaS](/azure/marketplace/create-new-saas-offer) см. в центре партнеров. Ниже описаны действия на высоком уровне.

1.  Создайте [учетную запись Центра](https://partner.microsoft.com/) партнеров, если ее нет.

1.  Настройте планы подписки, сведения о ценах и другие сведения для вашего трансактного предложения SaaS. В частности, убедитесь, что вы выполните следующие действия:

    * В **настройках** выберите параметр **Да,** чтобы указать, что вы продаете предложение через Корпорацию Майкрософт.
     
    * В **Microsoft 365 интеграции** добавьте ссылку AppSource в список приложений. Этот шаг гарантирует, что люди могут покупать ваши планы подписки в AppSource в дополнение к Teams.

1. Храните издателя и предлагайте ID. (Они вам нужны позже, чтобы связать предложение с приложением на портале разработчиков.)

1. Опубликуйте свое предложение на коммерческом рынке.

### <a name="test-the-offer"></a>Проверка предложения

Перед публикацией предложения SaaS настоятельно рекомендуется проверить возможность приобретения. Это можно сделать, создав отдельное предложение только для тестирования. Дополнительные сведения см. [в обзоре тестового предложения,](/azure/marketplace/plan-saas-offer#test-offer) [создании тестового предложения](/azure/marketplace/create-saas-dev-test-offer)и [предварительном просмотре предложения.](/azure/marketplace/test-publish-saas-offer)

> [!IMPORTANT]
> Необходимо протестировать предложение SaaS в AppSource. В настоящее время вы не можете протестировать end-to-end транзакцию в Teams, пока ваше приложение не завершит проверку магазина.

С Teams точки зрения эти тесты должны убедиться, что количество лицензий и назначений совпадает с тем, что находится в центре администрирования Teams, когда пользователи:

* Активация и настройка плана подписки на вашей странице.
* Назначьте, удалите или переназначите лицензии себе или другим лицам.
* Отмена или продление подписки.

### <a name="publish-the-offer"></a>Публикация предложения

После завершения тестирования [опубликуйте предложение в прямом эфире.](/azure/marketplace/test-publish-saas-offer#publish-your-offer-live)

## <a name="configure-your-app-for-the-saas-offer"></a>Настройка приложения для предложения SaaS

Вы опубликовали предложение SaaS, но все равно необходимо связать его с приложением Teams для пользователей, чтобы увидеть ваши планы подписки в Teams магазине.

1. Перейдите на [портал разработчика и](https://dev.teams.microsoft.com/) выберите **Приложения.**
1. На странице **Приложения** выберите приложение, с которое вы связываете предложение SaaS.
1. Перейдите на **страницу Планы и цены** и укажите издателя и предложите ID. (Эти ID можно найти в Центре партнеров, если они недоступны.)
1. Выберите **Просмотр,** чтобы просмотреть планы подписки на предложение SaaS.
1. Если все выглядит хорошо, выберите **Сохранить**.

   Свойство `subscriptionOffer` добавляется в манифест [приложения.](~/resources/schema/manifest-schema-dev-preview.md#subscriptionoffer)

   ```json
      "subscriptionOffer": {
        "offerId": "publisherId.offerId"  
        }
   ```

## <a name="publish-your-app"></a>Публикация приложения

Вы создали свое предложение SaaS и связали его с приложением Teams- пришло время опубликовать приложение в Teams магазине. Полные инструкции [см. в публикации](~/concepts/deploy-and-publish/appsource/publish.md)приложения в Teams магазине.

> [!IMPORTANT]
> Даже если ваше приложение уже перечислены в Teams магазине, вам все равно необходимо снова пройти проверку магазина, чтобы включить ваше предложение SaaS.

После публикации пользователи увидят параметр **Купить** подписку в диалоговом октаге сведений о приложении при попытке добавить приложение в Teams.

## <a name="end-user-purchasing-experience"></a>Опыт покупки конечных пользователей

В следующем примере показано, как пользователи могут приобретать планы подписки для вымышленного приложения Teams *recloud.*

1. В Teams магазине найдите и выберите приложение *Recloud.*

1. В диалоговом окте "Сведения о приложении" выберите **Купить подписку.**

    :::image type="content" source="~/assets/images/saas-offer/buysubscriptionplan.png" alt-text="Покупка подписки для выбранного приложения.":::

1. Выберите страну, чтобы увидеть планы подписки на ваше расположение.

1. В **диалоговом окте "Выбор плана подписки"** выберите нужный план и выберите **checkout.** (Примечание. Частные планы видны только пользователям в оргиях, на которые вы предоставляете предложение. Эти планы указаны значком **специального** :::image type="icon" source="~/assets/icons/special-icon.png"::: предложения.)

    :::image type="content" source="~/assets/images/saas-offer/choosingsubscriptionplan.png" alt-text="Выбор соответствующего плана подписки.":::

1. В **диалоговом октаге Checkout** предосмотрите все необходимые сведения и выберите **порядок Place.**

    :::image type="content" source="~/assets/images/saas-offer/placesubscriptionorder.png" alt-text="Размещение заказа подписки.":::

1. При запросе выберите **Настройка сейчас,** чтобы настроить подписку.

    :::image type="content" source="~/assets/images/saas-offer/saas-offer-set-up.png" alt-text="Настройка подписки.":::

1. Управление планом подписки с помощью *веб-сайта Recloud* (также известного как [посадочная страница).](#build-a-landing-page-for-subscription-management)

    :::image type="content" source="~/assets/images/saas-offer/subscriptionlicenses.png" alt-text="Настройка лицензий пользователей.":::

## <a name="admin-purchasing-experience"></a>Опыт покупки администратора

Администраторы могут приобретать планы подписки на [приложения в Teams центре администрирования.](/MicrosoftTeams/purchase-third-party-apps)

## <a name="remove-a-saas-offer-from-your-app"></a>Удаление предложения SaaS из приложения

Если вы отключите предложение SaaS, включенное в список Teams магазина, необходимо переиздать приложение, чтобы увидеть изменения в магазине.

1. Перейдите на [портал разработчика и](https://dev.teams.microsoft.com/) выберите **Приложения.**
1. На странице **Приложения** выберите приложение, из которое удаляется предложение.
1. Перейдите на **страницу Планы и цены** и выберите **Revert**.
1. После незамысвеченного предложения сделайте следующее, чтобы обновить список магазина:
   1. Выберите **Распределить > опубликовать в Teams магазине**.
   1. Выберите **Центр открытых партнеров,** чтобы начать процесс переопубликовки приложения без предложения.

## <a name="see-also"></a>См. также

[Ведение и поддержка опубликованного приложения](../post-publish/overview.md)
