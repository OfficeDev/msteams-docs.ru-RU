---
title: Начало работы — создайте Teams приложение с помощью Blazor
author: adrianhall
description: Вы сможете быстро разработать приложение Microsoft Teams, которое выводит строку "Hello, World!",  сообщение с Microsoft Teams набор средств и .NET Blazor.
ms.author: adhal
ms.date: 04/27/2021
ms.topic: quickstart
ms.openlocfilehash: f40331ed06a401d60092e884add2cfa747c3ebdc
ms.sourcegitcommit: 85a52119df6c4cb4536572e6d2e7407f0e5e8a23
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2021
ms.locfileid: "53179953"
---
# <a name="build-and-run-your-first-microsoft-teams-app-with-blazor"></a>Создание и запуск первого Microsoft Teams приложения с помощью Blazor

В этом руководстве вы создайте новое приложение Microsoft Teams в .NET/Blazor, которое реализует простое личное приложение для получения информации из microsoft Graph. (Личное *приложение включает* набор вкладок для индивидуального использования.)  Во время руководства вы узнаете о структуре приложения Teams, локальном запуске приложения и развертывании приложения в Azure.

Приложение, которое мы построим, выводит основные сведения о текущем пользователе.  Когда разрешение будет предоставлено, приложение подключится к Microsoft Graph в качестве текущего пользователя, чтобы получить его полный профиль.

## <a name="before-you-begin"></a>Перед началом работы

Настройте среду разработки, установив [необходимые компоненты](prerequisites.md).

> [!div class="nextstepaction"]
> [Необходимые условия для установки](prerequisites.md)

## <a name="create-your-project"></a>Создание проекта

Используйте набор средств Teams для создания своего первого проекта.

# <a name="visual-studio-2019"></a>[Visual Studio 2019](#tab/vs)

1. Open Visual Studio 2019.

1. Выберите **Создание нового проекта.**

1. Выберите **Microsoft Teams app,** а затем нажмите **кнопку Далее**.  Чтобы помочь найти шаблон, используйте тип **проекта Microsoft Teams.**

1. Дайте проекту и решению хорошее имя, а затем нажмите **кнопку Далее**.

1. Укайте имя приложения и имя компании, а затем нажмите **кнопку Создать**.  Имя приложения и имя компании отображаются конечным пользователям.

1. Создание приложения Teams займет несколько секунд.  После создания проекта установите единую регистрацию с помощью M365:

   - Выберите **Project**  >  **TeamsFx**  >  **Configure для SSO...**.
   - При запросе впишитесь в свою учетную запись администратора M365.

# <a name="command-line"></a>[Командная строка](#tab/cli)

1. Откройте терминал и выберите каталог, в котором вы хотите создать проект.

1. Выполнить `dotnet new -i` установку шаблона из NuGet:

   ``` bash
   dotnet new --install Microsoft.TeamsFx.VisualStudio.ProjectTemplates::0.1.43-beta
   ```

   Это необходимо сделать только в первый раз или при обновлении шаблона. Проверьте [NuGet](https://www.nuget.org/packages/Microsoft.TeamsFx.VisualStudio.ProjectTemplates/) последнюю версию этого пакета.

1. Создание каталога:

   ``` bash
   mkdir helloworld
   ```

1. Запуск `dotnet new` для создания нового проекта:

   ``` bash
   dotnet new teamsapp --shortName my-teams-app --companyName "My Company"
   ```

1. После развертывания на эшафоте настройте проект для Teams развертывания:

   ``` bash
   teamsfx init
   ```

Теперь можно открыть решение в Visual Studio для отладки.

---

## <a name="take-a-tour-of-the-source-code"></a>Знакомство с исходным кодом

Если вы хотите пропустить этот раздел, вы можете [запустить приложение локально](#run-your-app-locally).

После того как набор средств Teams настроит ваш проект, у вас появятся компоненты для создания простого личного приложения Teams. Каталоги и файлы проекта отображаются в области Обозреватель решений в Visual Studio 2019 г.

:::image type="content" source="../assets/images/teams-toolkit-v2/blazor-file-layout.png" alt-text="Снимок экрана, показывающий файлы проектов приложений для личного приложения в Visual Studio 2019 г.":::

- Значки приложений, хранимые как PNG-файлы в `color.png` и `outline.png`.
- Манифест приложения для публикации на портале разработчиков для Teams хранится в `Properties/manifest.json` .
- Контроллер backend предоставляется для `Controllers/BackendController.cs` оказания помощи в проверке подлинности.

Так как вы создали приложение вкладки во время установки, Teams набор средств наберет весь необходимый код для базовой вкладки в качестве [сервера Blazor.](/aspnet/core/blazor)

- `Pages/Tab.razor` является точкой входа переднего приложения.
- `TeamsFx.cs`и `JS/src/index.js` используется для инициализации коммуникаций с Teams хостом.

Можно добавить функции backend, добавив в приложение дополнительные ASP.NET Core контроллеры.

## <a name="run-your-app-locally"></a>Запустите приложение локально

Набор средств Teams позволяет запускать приложение локально.  Нужно выполнить несколько действий для обеспечения правильной инфраструктуры. Teams ожидает, что:

- Приложение зарегистрировано в Azure Active Directory.  Оно имеет разрешения, связанные с расположением, из которого загружается, и с любыми ресурсами серверной сторонй, которые использует.
- Веб-API находится (IIS Express) для оказания помощи в задачах проверки подлинности, выступая в качестве прокси-сервера между приложением и Azure Active Directory.  
- Манифест приложения создается и существует на портале разработчика для Teams.  Teams использует манифест приложения, чтобы сообщить подключенным клиентам, откуда загружать приложение.

После этого приложение можно загрузить в клиенте Teams.  Мы используем веб-клиент Teams, чтобы иметь возможность видеть код HTML, CSS и JavaScript в стандартной среде веб-разработки.

Чтобы создать и запустить приложение локально, выполните следующие действия.

1. С Visual Studio нажмите **кнопку F5** для запуска приложения в режиме отлаживания.

1. При запросе установите самозаверяющийся сертификат SSL для локальной отладки.

   :::image type="content" source="../assets/images/teams-toolkit-v2/ssl-prompt.png" alt-text="Снимок экрана: запрос на установку SSL-сертификата, чтобы разрешить Teams загрузку вашего приложения из localhost.":::

1. В браузере будет выполнена загрузка Teams, и вам будет предложено войти. При появлении запроса на открытие Microsoft Teams выберите "Отменить", чтобы остаться в браузере. Войдите с помощью своей учетной записи M365.
1. При появлении запроса на установку приложения в Teams нажмите кнопку **Добавить**.

Откроется окно приложения:

:::image type="content" source="../assets/images/teams-toolkit-v2/blazor-completed-app.png" alt-text="Снимок экрана: готовое приложение":::

Вы можете проводить обычные действия отладки так же, как если бы это было любое другое веб-приложение (например, установка точек останова). Приложение поддерживает горячую перезагрузку.  Если вы измените какой-либо файл в составе проекта, страница будет перезагружена.

<!-- markdownlint-disable MD033 -->
<details>
<summary>Узнайте, что происходит при локальном запуске приложения в отладчике.</summary>

При нажатии клавиши F5 набор средств Teams:

1. Зарегистрировал приложение в Azure Active Directory.
1. Зарегистрировал приложение для установки неопубликованных приложений в Microsoft Teams.
1. Начался локальный запуск backend приложения.
1. Запускает локальную часть приложения, размещенную на клиентской стороне.
1. Начало Microsoft Teams в веб-браузере с командой Teams для боковой загрузки приложения (URL-адрес зарегистрирован в манифесте приложения).

</details>

<!-- markdownlint-disable MD033 -->
<details>
<summary>Узнайте, как устранить распространенные проблемы при локальном запуске приложения.</summary>

Чтобы успешно запустить приложение в Teams, необходимо иметь учетную запись Microsoft 365 разработки, которая позволяет загружать приложения в стороне. Дополнительные сведения о создании учетной записи см. в разделе [Необходимые компоненты](prerequisites.md#enable-sideloading).

</details>

## <a name="deploy-your-app-to-azure"></a>Развертывание приложения в Azure

Развертывание состоит из двух этапов.  Сначала создаются необходимые облачные ресурсы (также известные как подготовка), затем код, который составляет ваше приложение, копируется в созданные облачные ресурсы.

> **Предварительный просмотр**
>
> Поддержка приложений Blazor является новой в Teams набор средств.  Подготовка и развертывание делаются с Visual Studio 2019 г. и порталом разработчиков для Teams.

## <a name="provision-and-deploy-your-app-to-azure-app-service"></a>Подготовка и развертывание приложения в Службе приложений Azure

1. В Обозревателе решений щелкните правой кнопкой мыши узел проекта и выберите **Опубликовать** (или используйте элемент **меню Build**  >  **Publish).**

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish1.png" alt-text="Выберите операцию Публикация в проекте":::

1. В **окне Публикация** выберите **Azure**.  Нажмите **кнопку Далее**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish2.png" alt-text="Выберите Azure в качестве цели публикации":::

1. Выберите **службу приложений Azure (Windows).**  Нажмите **кнопку Далее**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish3.png" alt-text="Выберите службу приложений Azure в качестве цели публикации":::

1. Выберите **+** для создания нового экземпляра службы приложений.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish4.png" alt-text="Создание нового экземпляра.":::

1. В **диалоговом октаге Create App Service (Windows)** заполняются  поля "Имя", "Имя подписки", "Группа ресурсов" и "Планирование размещения".  Если у вас уже запущена служба приложений, будут выбраны существующие параметры.  Вы можете выбрать создание новой группы ресурсов и плана размещения (Рекомендуется).  Когда вы готовы, выберите **Создать**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish5.png" alt-text="Выбор плана размещения и подписки":::

1. В **диалоговом** окте "Публикация" вновь созданный экземпляр выбран автоматически.  Когда вы готовы, выберите **Finish**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish6.png" alt-text="Выберите новый экземпляр.":::

1. Нажмите **значок Изменить** (карандаш) рядом с **режимом развертывания,** а затем выберите **автономный**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish8.png" alt-text="Выберите автономный режим развертывания.":::

1. Нажмите **Опубликовать**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/blazor-vs2019-publish7.png" alt-text="Публикация приложения в службу приложений":::

Visual Studio развертывает приложение в службе приложений Azure, а веб-приложение загружается в браузере.  Добавьте `/tab` в конец URL-адреса, чтобы увидеть свою страницу.

В области свойства проекта **Publish** показаны URL-адрес сайта и другие сведения. Заметьте URL-адрес сайта.

## <a name="create-an-environment-for-your-app"></a>Создание среды для приложения

Портал разработчиков для Teams управляет загрузкой вкладок для приложения с помощью **среды.**  Чтобы создать среду:

1. Откройте портал [разработчиков для Teams](https://dev.teams.microsoft.com).  Во входе с помощью административной учетной записи M365.

1. На боковой панели выберите **Приложения.**

1. Если у вас есть только одно приложение, оно будет выбрано автоматически.  Если нет, выберите приложение из списка.

1. Выбор **сред**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments1.png" alt-text="Выбор сред":::

1. Выберите **Создать первую среду.**

1. Введите имя для среды и нажмите кнопку **Добавить;** например _Production_.

1. После выбора новой среды нажмите кнопку **Создать свою первую переменную** среды.

1. `azure_app_url`Введите **имя**.  Введите URL-адрес сайта Azure (без `https://` ) в качестве **значения**.

    :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments2.png" alt-text="Создание переменной среды":::

   Нажмите **кнопку Добавить**.

## <a name="update-the-app-manifest"></a>Обновление манифеста приложения

Манифест приложения загружает вкладку с `localhost` URL-адреса.  В этом разделе вы отрегулируете манифест приложения для загрузки вкладки из URL-адреса, перечисленного в только что созданной среде.

1. На боковой панели выберите **основные сведения.**

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments3.png" alt-text="Выбор базовых сведений":::

1. В манифесте есть несколько мест, которые перечисляют `localhost:XXXXX` как часть URL-адреса.  Замените все случаи (включая фигурные `{{azure_app_url}}` скобки).

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments4.png" alt-text="Настройка базовых сведений для среды":::

1. После завершения нажмите кнопку **Сохранить**.

1. На боковой панели выберите **Возможности**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments5.png" alt-text="Выбор возможностей":::

1. Выберите **личную вкладку**.
1. Рядом с личной **вкладке** выберите тройные точки, а затем выберите **Изменить**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments6.png" alt-text="Изменение личных параметров вкладок":::

1. Замените URL-адрес переменной среды в **полях URL-адрес контента** и **веб-сайта.**

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments7.png" alt-text="Изменение URL-адресов личных вкладок":::

1. Обновление **прессы**.

1. Нажмите кнопку **Сохранить**.

1. На боковой панели выберите **один вход.**

1. Замените `localhost` внутри **URI ID приложения** на `{{azure_app_url}}` .

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments8.png" alt-text="Изменение единого входного URI приложения":::

1. Нажмите кнопку **Сохранить**.

1. С боковой панели нажмите **домены**.

1. Нажмите **кнопку Добавить домен**.

1. Если он не указан как допустимый домен, добавьте его как `{{azure_app_url}}` допустимый домен, нажмите **кнопку Добавить**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/devcenter-environments9.png" alt-text="Добавление домена":::

Теперь вы можете использовать кнопку **Preview Teams** в верхней части страницы для запуска приложения в Teams.

## <a name="see-also"></a>См. также

- [Создание приложения Teams с помощью React](first-app-react.md)
- [Создание приложения Teams в качестве SharePoint веб-части](first-app-spfx.md)
- [Создание бота беседы](first-app-bot.md)
- [Создание расширения для обмена сообщениями](first-message-extension.md)

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Создание приложения Teams в качестве SharePoint веб-части](first-app-spfx.md)
