---
title: 'Начало работы : создайте свое первое приложение Teams на основе React'
author: adrianhall
description: Вы сможете быстро разработать приложение Microsoft Teams, которое выводит строку "Hello, World!",  на базе набора средств Microsoft Teams и библиотеки React.
ms.author: adhal
ms.date: 05/27/2021
ms.topic: quickstart
ms.openlocfilehash: edd7cf8048dd89156b4b91afecb329d91baf3f53
ms.sourcegitcommit: 14409950307b135265c8582408be5277b35131dd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "52994116"
---
# <a name="build-and-run-your-first-microsoft-teams-app-with-react"></a>Создайте и запустите свое первое приложение Microsoft Teams, пользуясь библиотекой React

В этом руководстве вы создадите приложение Microsoft Teams в React — реализацию простого личного приложения, получающего информацию из Microsoft Graph. Например, личное *приложение включает* набор вкладок для индивидуального использования. Во время руководства вы узнаете о структуре приложения Teams, локальном запуске приложения и развертывании приложения в Azure.

Приложение, которое мы построим, выводит основные сведения о текущем пользователе. Когда разрешение будет предоставлено, приложение подключится к Microsoft Graph в качестве текущего пользователя, чтобы получить его полный профиль.

## <a name="before-you-begin"></a>Перед началом работы

Убедитесь, что среда разработки настроена путем установки [необходимых условий.](prerequisites.md)

> [!div class="nextstepaction"]
> [Необходимые условия для установки](prerequisites.md)

## <a name="create-your-project"></a>Создание проекта

Используйте набор средств Teams для создания своего первого проекта.

# <a name="visual-studio-code"></a>[Visual Studio Code](#tab/vscode)

1. Откройте Visual Studio Code.
1. Откройте набор средств Teams, выбрав значок Teams на боковой панели:

    :::image type="content" source="../assets/images/teams-toolkit-v2/sidebar-icon.png" alt-text="Значок Teams на боковой панели Visual Studio Code":::.

1. Выберите **Создать проект**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/create-project.png" alt-text="Расположение ссылки &quot;Создать проект&quot; на боковой панели набора средств Teams":::.

1. Выберите **Создать приложение Teams**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/create-new-project-intro.png" alt-text="Запуск мастера для создания проекта":::

1. На **шаге Выбор возможностей** уже выбрана возможность **Tab.** Нажмите кнопку **ОК**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/create-project-capabilities.png" alt-text="Снимок экрана: добавление возможностей в новое приложение.":::

1. На шаге **Тип размещения на клиенте** выберите **Azure**.

   :::image type="content" source="../assets/images/teams-toolkit-v2/create-project-hosting.png" alt-text="Снимок экрана: выбор размещения для нового приложения.":::

1. На этапе **Облачные ресурсы** нажмите **ОК**.  В этом руководстве вам не понадобятся дополнительные облачные ресурсы.

   :::image type="content" source="../assets/images/teams-toolkit-v2/create-project-cloud-resources.png" alt-text="Снимок экрана: добавление облачных ресурсов в новое приложение.":::

1. На этапе **Язык программирования** выберите **JavaScript**.

    :::image type="content" source="../assets/images/teams-toolkit-v2/create-project-programming-languages.png" alt-text="Снимок экрана: выбор языка.":::

1. Выберите папку рабочей области. Папка создается в папке рабочего пространства для созданного вами проекта.

1. Введите подходящее имя для приложения, например `helloworld`. Имя приложения должно состоять только из букв и цифр.  Чтобы продолжить, нажмите клавишу **ВВОД**.

Приложение Teams создается в течение нескольких секунд.

# <a name="command-line"></a>[Командная строка](#tab/cli)

Используйте для создания первого проекта интерфейс командной строки `teamsfx`.  Начните с папки, в которой будет создана папка проекта.

``` bash
teamsfx new
```

Интерфейс командной строки выдаст несколько вопросов, ответы на которые используются для создания проекта. На каждом вопросе будет посвеяно, как ответить на него, например, использовать клавиши со стрелками для выбора варианта. Ответив на вопрос, подтвердите свой выбор, нажав клавишу **ВВОД**.

1. Выберите **Создать приложение Teams**.
1. Выберите возможность **Вкладка**.
1. В качестве размещения на клиенте выберите **Azure**.
1. Не добавляйте облачные ресурсы.
1. Выберите **JavaScript** в качестве языка программирования.
1. Нажмите клавишу **ВВОД**, чтобы выбрать папку рабочей области по умолчанию.
1. Введите подходящее имя для приложения, например `helloworld`.  Имя приложения должно состоять только из букв и цифр.

После ответа на все вопросы создается проект.

---

## <a name="take-a-tour-of-the-source-code"></a>Знакомство с исходным кодом

Если вы хотите пропустить этот раздел, вы можете [запустить приложение локально](#run-your-app-locally).

После того как набор средств Teams настроит ваш проект, у вас появятся компоненты для создания простого личного приложения Teams. Каталоги и файлы проекта отображаются в области проводника Visual Studio Code.

:::image type="content" source="../assets/images/teams-toolkit-v2/react-app-project.png" alt-text="Снимок экрана: файлы проектов приложения для личного приложения в Visual Studio Code.":::

Набор средств автоматически формирует шаблоны в каталоге проекта на основе возможностей, добавленных во время установки. Набор средств Teams сохраняет свое состояние для вашего приложения в каталоге `.fx`.  Среди других элементов в этом каталоге находятся:

- Значки приложений, хранимые как PNG-файлы в `color.png` и `outline.png`.
- Манифест приложения для публикации на портале разработчика для Teams, хранимый в `manifest.source.json`.
- Параметры, выбранные при создании проекта, хранятся в `settings.json`.

Так как вы выбрали вкладку во время настройки, набор средств Teams создает шаблоны всего необходимого кода для программирования базовой вкладки в каталоге `tabs`. В этом каталоге есть несколько важных файлов:

- `tabs/src/index.jsx` — точка входа приложения на клиентской стороне, где проводится отрисовка основного компонента `App` с помощью `ReactDOM.render()`.
- `tabs/src/components/App.jsx` несет ответственность за маршрутизацию URL-адресов в приложении. Он вызывает [SDK JavaScript для Microsoft Teams](../tabs/how-to/using-teams-client-sdk.md), чтобы реализовать обмен сообщениями между вашим приложением и Teams.
- `tabs/src/components/Tab.jsx` содержит код для реализации пользовательского интерфейса вашего приложения.
- `tabs/src/components/TabConfig.jsx` содержит код для реализации пользовательского интерфейса настройки вашего приложения.

Среде выполнения Teams требуется несколько вкладок, в том числе для уведомления о конфиденциальности, для условий использования и для настроек.  Код уведомления о конфиденциальности и условия использования находятся в том же каталоге.

При добавлении функций облака в проект добавляются дополнительные каталоги.  В первую очередь, каталог `api` содержит код для всех разработанных вами функций Azure.

## <a name="run-your-app-locally"></a>Запустите приложение локально

Набор средств Teams позволяет запускать приложение локально.  Нужно выполнить несколько действий для обеспечения правильной инфраструктуры. Teams ожидает, что:

- Приложение зарегистрировано в Azure Active Directory.  Оно имеет разрешения, связанные с расположением, из которого загружается, и с любыми ресурсами серверной сторонй, которые использует.
- Веб-API позволяет выполнять задачи проверки подлинности, действуя в качестве прокси-сервера между приложением и Azure Active Directory.  Этим занимается набор инструментов Azure Functions Core Tools.  Доступ к нему можно получить по URL `https://localhost:5000`.
- Ресурсы HTML, CSS и JavaScript, которые составляют клиентскую часть приложения, размещены в локальной службе. Доступ к ней можно получить по URL `https://localhost:3000`.
- Манифест приложения создается и существует на портале разработчика для Teams.  Teams использует манифест приложения, чтобы сообщить подключенным клиентам, откуда загружать приложение.

После этого приложение можно загрузить в клиенте Teams.  Мы используем веб-клиент Teams, чтобы иметь возможность видеть код HTML, CSS и JavaScript в стандартной среде веб-разработки.

### <a name="build-and-run-your-app-locally-in-visual-studio-code"></a>Создайте и запустите приложение локально в Visual Studio Code

Чтобы создать и запустить приложение локально, выполните следующие действия.

1. В Visual Studio Code нажмите клавишу **F5**, чтобы запустить приложение в режиме отладки.

   > При первом запуске приложения произойдет загрузка всех зависимостей и сборка приложения.  По завершении сборки автоматически откроется окно браузера.  Для завершения может потребоваться от 3 до 5 минут.

   В набор средств необходимо установить локальный сертификат. Этот сертификат позволяет Teams загружать приложение из `https://localhost`. Выберите "Да", когда появится следующее диалоговое окно:

   :::image type="content" source="../assets/images/teams-toolkit-v2/ssl-prompt.png" alt-text="Снимок экрана: запрос на установку SSL-сертификата, чтобы разрешить Teams загрузку вашего приложения из localhost.":::

1. Веб-браузер начинает запускать приложение. Если вам будет предложено открыть Teams рабочий стол, выберите **Отмена,** чтобы оставаться в браузере. Вам также может быть предложено перейти на рабочий Teams в другое время; выберите Teams веб-приложение, когда это произойдет.

   :::image type="content" source="../assets/images/teams-toolkit-v2/launch-web-browser-and-pick-webapp.png" alt-text="Снимок экрана: выбор веб-версии Teams при запуске":::

1. Вам может быть предложено выполнить вход.  В этом случае войдите с учетной записью M365.
1. При появлении запроса на установку приложения в Teams нажмите кнопку **Добавить**.

Теперь ваше приложение отображается:

:::image type="content" source="../assets/images/teams-toolkit-v2/react-finished-app.png" alt-text="Снимок экрана: готовое приложение":::

Вы можете делать обычные действия отладки, как если бы это было любое другое веб-приложение, например настройка точек остановок. Приложение поддерживает горячую перезагрузку. Если вы измените какой-либо файл в составе проекта, страница будет перезагружена.

<!-- markdownlint-disable MD033 -->
<details>
<summary>Узнайте, что происходит при локальном запуске приложения в отладчике.</summary>

При нажатии клавиши F5 набор средств Teams:

1. Регистрирует приложение в Azure Active Directory.
1. *Загружает неопубликованное* приложение в Teams
1. Запускает серверную часть приложения локально с помощью [Azure Functions Core Tools](/azure/azure-functions/functions-run-local?#start).
1. Запускает локальную часть приложения, размещенную на клиентской стороне.
1. Начало Microsoft Teams в веб-браузере с командой Teams, чтобы загрузить приложение из `https://localhost:3000/tab` . Это URL-адрес, зарегистрированный в манифесте приложения.

</details>

<!-- markdownlint-disable MD033 -->
<details>
<summary>Научитесь искать и устранять распространенные проблемы при локальном запуске приложения.</summary>

Чтобы запустить приложение в Teams, у вас должна быть учетная запись разработчика Teams, позволяющая устанавливать неопубликованные приложения. Дополнительные сведения о создании учетной записи см. в разделе [Обязательные требования](prerequisites.md#enable-sideloading).

</details>

[!INCLUDE [Provision and Deploy your app on Azure](~/includes/get-started/azure-provisioning-instructions.md)]

<!-- markdownlint-disable MD033 -->
<details>
<summary>Узнайте, что происходит в ходе развертывания приложения в Azure</summary>

До развертывания приложение работает локально:

1. Серверная часть работает с использованием **Azure Functions Core Tools**.
1. Конечная точка HTTP приложения, в которую Microsoft Teams загружает приложение, работает локально.

Развертывание включает в себя подготовка ресурсов по активной подписке Azure и развертывание или отправка кода backend и frontend для приложения в Azure.

1. При настройке в приложении используется множество служб Azure, включая Службу приложений Azure и служба хранилища Azure.
1. Клиентское приложение будет развернуто под учетной записью хранилища Azure, настроенной для статического размещения веб-сайтов.

</details>

## <a name="see-also"></a>См. также

- [Создание приложения Teams с помощью Blazor](first-app-blazor.md)
- [Создание приложения Teams в формате веб-части SharePoint](first-app-spfx.md) (Azure не требуется)
- [Создание бота беседы](first-app-bot.md)
- [Создание расширения для обмена сообщениями](first-message-extension.md)

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Создание приложения Teams с помощью Blazor](first-app-blazor.md)
