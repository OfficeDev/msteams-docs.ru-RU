### YamlMime:Tutorial
title: Создание бота беседы Teams
metadata:
  title: Создание бота беседы Teams
  description: В этом руководстве описано, как настроить бот для общения в Teams.
  audience: Developer
  level: Beginner
  ms.date: 04/01/2022
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/how-to/conversations/channel-and-group-conversations.md
  nextTutorialTitle: Беседы с бото в канале и групповом чате
  ms.custom: mvc
  ms.localizationpriority: none
  ms.openlocfilehash: 8507ab1039568224f5b863b6fa7bb00a72fe4608
  ms.sourcegitcommit: e16b51a49756e0fe4eaf239898e28d3021f552da
  ms.translationtype: MT
  ms.contentlocale: ru-RU
  ms.lasthandoff: 06/04/2022
  ms.locfileid: "65887564"
items:
- durationInMinutes: 1
  content: >
    Боты бесед Teams позволяют пользователям взаимодействовать с веб-службой с помощью текстовых, интерактивных карточек и модулей задач. Основные беседы обрабатываются через соединитель Bot Framework, один REST API. Этот API позволяет боту взаимодействовать с Teams и другими каналами. Пакет SDK Bot Builder предоставляет следующие функции:


    * Простой доступ к соединителю Bot Framework.

    * Дополнительные функции для управления потоком беседы и состоянием.

    * Простые способы внедрения когнитивных служб, таких как обработка естественного языка (NLP).


    При первом добавлении бота в группу или команду отправляется вводное сообщение. В сообщении содержится краткое описание функций бота и способы их использования.


    Это пошаговое руководство поможет вам создать базовый бот беседы в приложении Teams. Вы увидите следующие выходные данные:


    :::image type="content" source="./assets/images/conversation-bot/final-output.png" alt-text="Окончательные выходные данные." border="true"lightbox="assets/images/conversation-bot/final-output.png":::
- title: Предварительные условия
  durationInMinutes: 1
  content: >
    Чтобы настроить среду разработки, установите следующие средства:


    * [Клиент Office 365](https://developer.microsoft.com/en-us/microsoft-365/dev-program)

    * [Ngrok](https://ngrok.com/) или эквивалентное решение для туннелирования

    * Последняя версия [Visual Studio](https://visualstudio.microsoft.com/downloads/)

    * [Пакет SDK для .NET Core версии 3.1](https://dotnet.microsoft.com/en-us/download)

    * Microsoft Teams и учетная запись Teams
- title: Настройка бота беседы
  durationInMinutes: 5
  content: "Зарегистрируйте бота в службе azure bot при разработке и размещении в Azure. Выполните следующие действия:\n\n1. Используйте ngrok для создания туннеля к конечным точкам веб-сервера.\n1. Создайте регистрацию канала бота в учетной записи Azure.\n1. Создайте секрет клиента, который включает проверку подлинности единого входа бота.\n1. Добавьте разрешения API для подчиненных вызовов.\n1. Добавьте конечную точку обмена сообщениями в созданный туннель ngrok.\n1. Добавьте канал Microsoft Teams для развертывания бота в канале Teams.\n\n**Создание туннеля ngrok**\n\nИспользуйте ngrok для создания туннеля к общедоступным конечным точкам HTTPS локального веб-сервера. Выполните следующую команду в ngrok:\n\n```bash\nngrok http -host-header=rewrite 3978\n```\n\n**Создание регистрации канала бота в учетной записи Azure**\n\n1. Доступ к [порталу Azure](https://portal.azure.com/).\n1. Выберите **Создать ресурс**.\n1. Найдите **Azure Bot** в поле поиска.\n1. Выберите **Azure Bot**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/azure-bot.png\" alt-text=\"Azure Bot.\":::\n\n1. Нажмите **Создать**.\n1. Введите имя дескриптора бота в поле **Дескриптор бота**.\n1. Выберите свою **подписку** в раскрывающемся списке.\n1. Выберите свою **группу ресурсов** в раскрывающемся списке.\n\n    Чтобы создать группу ресурсов, выберите \"Создать **\", введите** имя ресурса, нажмите кнопку **\"** ОК\" и выберите  необходимое расположение в раскрывающемся списке \"Новое расположение группы ресурсов\".\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/create-azure-bot.png\" alt-text=\"Создайте бот Azure.\":::\n\n1. Для параметра **Тип приложения** выберите **Мультитенантное** в разделе **Идентификатор приложения Майкрософт**.\n\n    > [!NOTE]\n    > В **разделе \"** Тип создания приложения Microsoft App ID\" уже выбран параметр \"Создать новый идентификатор приложения **Майкрософт** \", чтобы создать бот. Вы также можете выбрать **\"Использовать существующую регистрацию приложения**\", если вы уже зарегистрировали бот. Введите идентификатор приложения Майкрософт в поле **\"Существующий** идентификатор приложения\" и введите значение в поле **\"Существующий пароль приложения** \".\n\n1. Выберите **Проверить и создать**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/review-create.png\" alt-text=\"Просмотрите и создайте.\":::\n\n1. Выберите **\"Создать**\", если проверка пройдена. Подготовка службы бота займет несколько секунд.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/validation-passed.png\" alt-text=\"Проверка бота.\":::\n\n1. Выберите пункт **Перейти к ресурсу**. Бот и связанные ресурсы указаны в группе ресурсов.\n\n    Теперь бот Azure создан.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/go-to-resource.png\" alt-text=\"Перейдите к карточке ресурса.\":::\n\n**Создание секрета клиента**\n\n1. В разделе **Параметры** выберите **Конфигурация**. Сохраните **Идентификатор приложения Майкрософт** (идентификатор клиента) для дальнейшего использования.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/microsoft-app-id.png\" alt-text=\"Идентификатор приложения Майкрософт.\":::\n\n1. Выберите **\"Управление рядом** с **идентификатором приложения Майкрософт\"**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/manage-bot-label.png\" alt-text=\"Управление меткой.\":::\n\n1. В разделе **\"Секреты клиента** \" выберите \" **Новый секрет клиента\"**. **Появится окно \"Добавление секрета** клиента\".  \n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/new-client-secret.png\" alt-text=\"Новый секрет клиента.\":::\n\n1. Введите **описание** и нажмите **Добавить**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/add-client-secret.png\" alt-text=\"Добавьте секрет клиента.\":::\n\n1. Выберите **\"Копировать в буфер обмена** \" в столбце **\"Значение** \" и сохраните идентификатор секрета клиента для дальнейшей ссылки.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/value.png\" alt-text=\"Карточка значения.\":::\n\n**Добавление разрешений API для подчиненных вызовов**\n\n1. В **области** \"Управление ботом\" выберите **разрешения API**.\n1. Выберите **Добавить разрешение**. **Появится окно разрешений API** запроса.\n1. Выберите **API Майкрософт** и **Microsoft Graph**.\n1. Выберите **разрешения приложения** , а затем — разрешения.\n1. Добавьте любые разрешения пользователя, необходимые приложению для подчиненных API, например `User.Read`.\n1. Выберите **Добавить разрешения**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/api-permissions.png\" alt-text=\"Добавление разрешений API.\" border=\"true\"lightbox=\"assets/images/conversation-bot/api-permissions.png\":::\n\n**Добавление конечной точки обмена сообщениями**\n\n1. Перейдите **на домашнюю** страницу бота **и выберите \"** Конфигурация **\" в разделе \"Параметры** \" на левой панели.\n1. Перейдите в ngrok.\n1. Скопируйте URL-адрес HTTPS (https to io), как показано на следующем рисунке:\n    \n    :::image type=\"content\" source=\"./assets/images/conversation-bot/ngrok.png\" alt-text=\"Ngrok.\":::\n\n1. В **конечной точке обмена** сообщениями добавьте URL-адрес HTTPS, доступный в ngrok, и в конце URL-адреса добавьте **/api/messages**.\n    \n    :::image type=\"content\" source=\"./assets/images/conversation-bot/messaging-endpoint.png\" alt-text=\"Конечная точка обмена сообщениями.\":::\n\n1. Нажмите **Применить**.\n\n**Добавление канала Microsoft Teams**\n\n1. Перейдите на **домашнюю страницу**.\n1. В разделе **\"Последние ресурсы** \" откройте бот.\n1. Выберите **\"Каналы\"** в левой области и выберите **Microsoft Teams** <img src=\"~/assets/images/conversation-bot/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/> из списка доступных каналов.    \n    \n    :::image type=\"content\" source=\"./assets/images/conversation-bot/channels-teams.png\" alt-text=\"Выберите Teams.\":::\n\n1. Установите флажок, чтобы принять условия обслуживания, и выберите **Принять**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/terms-of-service.png\" alt-text=\"Условия обслуживания.\":::\n\n1. Нажмите **Сохранить**.\n\n    Вы успешно настроили бот в службе Azure Bot, и теперь необходимо настроить подключение к службе ботов.\n"
- title: Настройка подключения службы бота
  durationInMinutes: 1
  content: "Настройте пример бота, чтобы понять, как проверить подлинность бота беседы в Microsoft Teams, создать пакет приложения Teams и отправить его в организацию.\n\n1. Обновите файл appsettings.json в Visual Studio.\n1. Обновите файл manifest.json в Visual Studio и сжимайте его в ZIP-файл в проводнике.\n1. Запустите решение в Visual Studio.\n1. Отправьте бота в Teams.\n\n**Обновление appsettings для бота беседы**\n\n1. Перейдите в репозиторий https://github.com/Microsoft/botbuilder-samples.git.\n1. Выберите **\"Код** \" и выберите раскрывающийся список.\n1. Выберите \" **Скачать ZIP-файл\"**.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/repo.png\" alt-text=\"Клонирование репозитория.\":::\n\n1. Запишите путь к скачанном репозиторию.\n1. В **проводнике перейдите** к **примерам botbuilder-samples** >  >  >  csharp_dotnetcore **57.teams-conversation-bot**.\n1. Откройте файл **appsettings.json** в Visual Studio и обновите конфигурацию для бота.\n\n    * Добавьте имя бота для `MicrosoftAppType`.\n    * Вы можете получить страницу `MicrosoftAppId` конфигурации бота. Значение `MicrosoftAppPassword` для идентификатора секрета клиента, сохраненного ранее.\n    * Вы можете получить ссылку `MicrosoftAppTenantId` или `UserId` по ссылке учетной записи, используемой для входа в Teams. Следуйте пути на изображении, чтобы получить ссылку для:`tenant id`\n    \n        :::image type=\"content\" source=\"./assets/images/conversation-bot/teams-link-new.png\" alt-text=\"Путь к идентификатору клиента в Teams.\":::\n\n        :::image type=\"content\" source=\"./assets/images/conversation-bot/tenant-id.png\" alt-text=\"Копировать ссылку Teams.\":::\n\n        Скопируйте идентификатор клиента из URL-адреса.\n\n        :::image type=\"content\" source=\"./assets/images/conversation-bot/url-tenantid.png\" alt-text=\"TenantID.\":::\n\n1. Нажмите **Сохранить**.    \n    \n    :::image type=\"content\" source=\"./assets/images/conversation-bot/appsettings.png\" alt-text=\"Appsettings Json.\":::\n\n**Обновление манифеста**\n\n1. В **проводнике перейдите** к примерам **botbuilder-samples** >  >  >  csharp_dotnetcore **57.teams-conversation-bot** > **TeamsAppManifest**.\n1. Откройте файл **manifest.json** в Visual Studio.\n1. В **файле manifest.json** найдите **{id}, {botId}** и добавьте идентификатор приложения Майкрософт.\n1. Добавьте URL-адрес ngrok в **validDomains, за исключением** и `https://` сохраните его.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/manifest.png\" alt-text=\"Манифеста.\":::\n\n1. Запакуйте содержимое **папки TeamsAppManifest** , чтобы **создатьmanifest.zip**.\n\n    > [!NOTE]\n    > В `manifest.zip` нем не должно быть дополнительных папок. Он должен содержать исходный `manifest json` файл, `color` значок и `outline` значок в ZIP-папке.\n    > Запустите решение в Visual Studio и отправьте манифест в демонстрационный клиент для организации или учетной записи Teams.\n\n**Запуск решения в Visual Studio**\n\n1. Откройте Visual Studio.\n1. Выберите **\"Файл** \" и нажмите кнопку **\"Открыть\"**.\n1. Выберите **проект или решение,** чтобы открыть файл `.csproj` из проводника.\n1. Перейдите **к примерам botbuilder-samples** >  > **csharp_dotnetcore** > **57.teams-conversation-bot**.\n1. Выберите `TeamsConversationBot.csproj` файл и выберите бот в списке **запускаемых** проектов.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/visual-studio.png\" alt-text=\"Отладка Visual Studio.\":::\n\n1. Нажмите клавишу F5 для отладки. Когда бот будет готов, появится экран подтверждения.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/bot.png\" alt-text=\"Экран готовности бота.\":::\n\n**Отправка приложения в Teams**\n\n1. Перейдите в Teams.\n1. Чтобы отправить **manifest.zip**, выберите Store **> Manage your apps > Upload a custom app** and open **manifest.zip** from the repo in File Explorer.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/upload-manifest.png\" alt-text=\"Отправка манифеста в Teams.\":::\n\n1. Нажмите **кнопку \"Добавить** \", чтобы установить бот беседы в Teams.\n\n    :::image type=\"content\" source=\"./assets/images/conversation-bot/add-app-teams.png\" alt-text=\"Добавление приложения в Teams.\":::\n\n    Теперь вы можете взаимодействовать с этим ботом.\n"
- title: Взаимодействие с ботом беседы
  durationInMinutes: 2
  content: >
    Вы можете взаимодействовать с ботом в Teams, отправляя сообщение или выбрав команду из списка команд. Бот отвечает на следующие строки:


    В левой области Teams нажмите кнопку с многоточием (...), а затем выберите свое приложение в списке. Бот **отображает предложения** следующим образом:


    :::image type="content" source="./assets/images/conversation-bot/suggestions.png" alt-text="Карточка предложений.":::


    | MentionMe    | Показать приветствие   | MessageAllMembers |

    | --- | --- | --- |

    | :::image type="content" source="./assets/images/conversation-bot/mentionme-new.png" alt-text="Карточка mentionme" border="true"lightbox="assets/images/conversation-bot/mentionme-new.png"::: | :::image type="content" source="./assets/images/conversation-bot/show-welcome-new.png" alt-text="Показать приветственное карточку" border="true"lightbox="assets/images/conversation-bot/show-welcome-new.png"::: | :::image type="content" source="./assets/images/conversation-bot/message-all-members-new.png" alt-text="Карточка MessageAllMembers" border="true"lightbox="assets/images/conversation-bot/message-all-members-new.png"::: |

    | **Результат:** Бот отвечает на сообщение и упоминает пользователя. | **Результат:** Бот отправляет приветственное сообщение для взаимодействия. |  **Результат:** Бот отправляет сообщение "один к одному" каждому участнику текущего диалога. |

    | **Допустимые области: личный** , групповой чат, чат группы. | **Допустимые области: личный** , групповой чат, чат группы. |  **Допустимые области: личный** , групповой чат, чат группы. |


    Вы можете выбрать параметр из списка команд, **введя** @TeamsConversationBot в область сообщения создания и что можно сделать **?** Текст над областью создания.
- title: Полный запрос
  durationInMinutes: 1
  content: >
    У вас возникла такая проблема?


    :::image type="content" source="./assets/images/conversation-bot/final-output.png" alt-text="Окончательные выходные данные." border="true"lightbox="assets/images/conversation-bot/final-output.png":::
- content: Вы завершили работу с руководством по началу работы с ботом беседы для Microsoft Teams.
