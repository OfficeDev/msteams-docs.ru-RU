---
title: Объединение боты с вкладками
description: Описание использования вкладок и боты вместе
keywords: Разработка команд боты для вкладок Teams
ms.date: 03/15/2018
ms.openlocfilehash: 59ae8bc01f82c70dd7ea6869cb870e26acae1293
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675462"
---
# <a name="combine-bots-with-tabs"></a>Объединение боты с вкладками

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

Боты и вкладки хорошо работают вместе, и часто объединяются в одну фоновую службу. В этом разделе приводятся рекомендации и общие шаблоны для совместного использования вкладок и боты.

## <a name="associating-user-identities-across-bot-and-tab"></a>Сопоставление удостоверений пользователей на Bot и на вкладке

Например: Предположим, что приложение, использующее вкладку, использует систему ИДЕНТИФИКАТОРов для защиты своего содержимого. Предположим, у вас также есть Bot, которые могут взаимодействовать с пользователем. Как правило, необходимо отображать контент на вкладке, относящейся к пользователю просмотра. Проблема состоит в том, что идентификатор пользователя в вашей системе, скорее всего, отличается от идентификатора пользователя Microsoft Teams. Как связать эти два удостоверения?
Как правило, рекомендуемый способ подписать пользователя с помощью Bot с помощью той же системы идентификации, которая использовалась для проверки подлинности для содержимого вкладки. Это можно реализовать с помощью действия при входе, которое обычно заносится в журнал пользователя с помощью процесса OAuth.

Этот процесс лучше всего подходит, если поставщик удостоверений реализует протокол OAuth 2,0. Затем вы можете связать идентификатор пользователя Teams с учетными данными пользователя из собственной службы удостоверений.

   ![Сопоставление удостоверений](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>Создание глубоких ссылок на вкладки в сообщениях из ленты

Вы можете использовать вкладки для отображения большего количества контента, чем может уместиться в карточке, или предоставить способ выполнения сложных задач заполнения форм с помощью холста вкладок. Например, рассмотрите возможность переходить на вкладку, когда он щелкает карточку из ленты. Для этого необходимо закодировать сообщение Bot, чтобы включить URL-адрес с [глубокими ссылками](~/concepts/build-and-test/deep-links.md) , либо с помощью разметки, либо в качестве целевого значения действия openUrl.

Глубокие ссылки основываются на Ентитид, который представляет собой непрозрачное значение, которое сопоставляется с уникальной сущностью в системе. При создании вкладки в идеале необходимо хранить некоторое простое состояние (например, флаг) на внутреннем стороне, указывая, что вкладка была создана в канале. Когда ваш робот создает сообщение, он может ориентироваться в Ентитид, связанном с этой вкладкой.

**Примечание:** в разделе личные беседы, так как вкладки статичны и устанавливаются вместе с приложением, всегда можно придумать их существование и, таким образом, создавать детальные ссылки.

## <a name="sending-notifications-for-tab-updates"></a>Отправка уведомлений об обновлениях вкладок

Часто вы хотите уведомить конечного пользователя о том, что на вкладке возникает обновление или действие пользователя. В качестве примера сценария можно назначить задачу или билет участнику группы, а затем уведомить этого участника группы.

Существует два способа достижения этого сценария:

1. Если вы хотите уведомить весь канал, с которого Bot может асинхронно отправлять сообщение в канал. Невозможно создать беседу вкладки с помощью Bot, если она не была создана с помощью вкладки.

2. Если вы хотите уведомить получателя или заинтересованных лиц, участвующих в действии, пользователь с помощью программы Bot может отправить пользователю личное сообщение разговора. Сначала необходимо проверить, существует ли личный беседа между Bot и пользователем. В противном случае вы можете `CreateConversation` позвонить для запуска личного чата.

В обоих случаях рекомендуется использовать уведомления о событиях и никогда не спама пользователя с ненужными обновлениями.
