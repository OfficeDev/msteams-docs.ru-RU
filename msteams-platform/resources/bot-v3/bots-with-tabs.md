---
title: Объединение ботов с вкладками
description: В этой статье вы узнаете, как совместно использовать вкладки и боты, создавая глубокие ссылки на вкладки в сообщениях бота и разработку вкладок ботов teams
ms.topic: conceptual
ms.localizationpriority: medium
ms.date: 03/15/2018
ms.openlocfilehash: f993f3d8deb8b8a781c96627bf63c2eed350e6c8
ms.sourcegitcommit: c3601696cced9aadc764f1e734646ee7711f154c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2022
ms.locfileid: "68833025"
---
# <a name="combine-bots-with-tabs"></a>Объединение ботов с вкладками

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

Боты и вкладки работают вместе и часто объединяются в одну серверную службу. В этом разделе описаны рекомендации и общие шаблоны совместного использования вкладок и ботов.

## <a name="associating-user-identities-across-bot-and-tab"></a>Связывание удостоверений пользователей между ботом и вкладкой

Например, предположим, что приложение вкладки использует собственную систему идентификаторов для защиты содержимого. Предположим, у вас также есть бот, который может взаимодействовать с пользователем. Как правило, вы хотите отобразить содержимое на вкладке, относящееся к просмотру пользователя. Проблема заключается в том, что идентификатор пользователя в вашей системе, скорее всего, отличается от идентификатора пользователя Microsoft Teams. Итак, как связать эти два удостоверения?
Как правило, рекомендуется выполнить вход пользователя с помощью бота с помощью той же системы удостоверений, которая используется для проверки подлинности содержимого вкладки. Реализовать можно с помощью действия входа, которое обычно выполняет вход пользователя с помощью потока OAuth.

Этот поток работает лучше всего, если поставщик удостоверений реализует протокол OAuth 2.0. Затем можно связать идентификатор пользователя Teams с учетными данными пользователя из собственной службы удостоверений.

   :::image type="content" source="../../assets/images/bots/associating_contexts.png" alt-text="Снимок экрана: связывание удостоверений.":::

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>Создание глубоких ссылок на вкладки в сообщениях от бота

Вы хотите использовать вкладки, чтобы отобразить больше содержимого, которое может поместиться внутри карточки, или предоставить способ выполнения сложных задач заполнения форм с помощью холста вкладки. Например, рассмотрите возможность перехода пользователя на вкладку, когда пользователь выбирает карточку из бота. Для этого необходимо закодировать сообщение бота, включив URL-адрес [глубокой ссылки](~/concepts/build-and-test/deep-links.md) с помощью разметки или в качестве целевого объекта действия openUrl.

Глубокие ссылки основаны на entityId, который представляет собой непрозрачное значение, которое сопоставляется с уникальной сущностью в вашей системе. При создании вкладки сохраняется простое состояние. Например, флаг на серверной части, указывающий, что вкладка создана в канале. Когда бот создает сообщение, он может ориентироваться на entityId, связанный с этой вкладкой.

> [!NOTE]
> В личных чатах, так как вкладки *являются статическими* и устанавливаются вместе с приложением, вы всегда можете предположить, что они существуют и, таким образом, создавать глубокие ссылки соответствующим образом.

## <a name="sending-notifications-for-tab-updates"></a>Отправка уведомлений об обновлениях вкладки

Часто требуется уведомлять конечного пользователя при каждом обновлении или выполнении действия пользователя на вкладке. Примером сценария является назначение задачи или билета участнику команды, а затем уведомление этого участника команды.

Существует два способа реализации этого сценария:

1. Если вы хотите уведомить весь канал, бот может асинхронно отправить сообщение в канал. Бот не может заранее создать беседу на вкладке, если она не была создана с помощью вкладки.

2. Если вы хотите уведомить только получателя или заинтересованных лиц, участвующих в действии, бот может отправить пользователю личное сообщение чата. Сначала следует проверить, существует ли личная беседа между ботом и пользователем. Если нет, вы можете позвонить `CreateConversation` , чтобы инициировать личный чат.

В обоих случаях используйте уведомления о событиях с умом и никогда не рассылайте пользователям ненужные обновления.
