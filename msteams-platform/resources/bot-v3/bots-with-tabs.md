---
title: Объедините ботов с вкладками
description: Описывает, как использовать вкладки и боты вместе
keywords: разработка вкладок команд ботов
ms.topic: conceptual
localization_priority: Normal
ms.date: 03/15/2018
ms.openlocfilehash: 3273369ad1122355b792dc3d429c3a4eff7e1d47
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566455"
---
# <a name="combine-bots-with-tabs"></a><span data-ttu-id="e542f-104">Объедините ботов с вкладками</span><span class="sxs-lookup"><span data-stu-id="e542f-104">Combine bots with tabs</span></span>

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

<span data-ttu-id="e542f-105">Боты и вкладки хорошо работают вместе и часто объединяются в единый бэк-энд сервис.</span><span class="sxs-lookup"><span data-stu-id="e542f-105">Bots and tabs work well together, and are often combined into a single back-end service.</span></span> <span data-ttu-id="e542f-106">В этом разделе описаны лучшие практики и общие шаблоны совместного использования вкладок и ботов.</span><span class="sxs-lookup"><span data-stu-id="e542f-106">This section describes best practices and common patterns for using tabs and bots together.</span></span>

## <a name="associating-user-identities-across-bot-and-tab"></a><span data-ttu-id="e542f-107">Связывание идентификационных данных пользователей между ботом и вкладкой</span><span class="sxs-lookup"><span data-stu-id="e542f-107">Associating user identities across bot and tab</span></span>

<span data-ttu-id="e542f-108">Например: Предположим, что приложение для вкладок использует несвободную систему идентификационных данных для защиты содержимого.</span><span class="sxs-lookup"><span data-stu-id="e542f-108">For example: Suppose your tab application uses a proprietary ID system to secure its content.</span></span> <span data-ttu-id="e542f-109">Предположим, у вас также есть бот, который может взаимодействовать с пользователем.</span><span class="sxs-lookup"><span data-stu-id="e542f-109">Suppose you also have a bot that can interact with the user.</span></span> <span data-ttu-id="e542f-110">Как правило, вы хотите, чтобы показать содержимое во вкладке, которая является специфичной для просмотра пользователя.</span><span class="sxs-lookup"><span data-stu-id="e542f-110">Typically, you’ll want to show content in the tab that is specific to the viewing user.</span></span> <span data-ttu-id="e542f-111">Проблема заключается в том, что идентификатор пользователя в вашей системе, скорее всего, отличается от Microsoft Teams идентификатора пользователя.</span><span class="sxs-lookup"><span data-stu-id="e542f-111">The challenge is that the user ID in your system is likely different from the Microsoft Teams user ID.</span></span> <span data-ttu-id="e542f-112">Так как же связать эти две идентичности?</span><span class="sxs-lookup"><span data-stu-id="e542f-112">So how do you associate these two identities?</span></span>
<span data-ttu-id="e542f-113">Как правило, рекомендуемый подход заключается в том, чтобы войти в систему поддержки пользователя с помощью той же системы идентификации, используемой для проверки подлинности содержимого вкладки.</span><span class="sxs-lookup"><span data-stu-id="e542f-113">In general, the recommended approach is to sign the user in with the bot using the same identity system used to provide authentication for the tab content.</span></span> <span data-ttu-id="e542f-114">Реализовать это можно с помощью действия «войти в систему», которое обычно регистрируется пользователем через поток OAuth.</span><span class="sxs-lookup"><span data-stu-id="e542f-114">You can implement this via the sign-in action, which typically logs in the user via an OAuth flow.</span></span>

<span data-ttu-id="e542f-115">Этот поток работает лучше всего, если ваш поставщик идентификационных данных реализует протокол OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="e542f-115">This flow works best if your identity provider implements the OAuth 2.0 protocol.</span></span> <span data-ttu-id="e542f-116">Затем вы можете связать Teams идентификатор пользователя с учетными данными пользователя из вашей собственной службы идентификации.</span><span class="sxs-lookup"><span data-stu-id="e542f-116">You can then associate the Teams user ID with the user’s credentials from your own identity service.</span></span>

   ![Связывание идентичностей](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a><span data-ttu-id="e542f-118">Построение глубоких ссылок на вкладки в сообщениях от вашего бота</span><span class="sxs-lookup"><span data-stu-id="e542f-118">Constructing deep links to tabs in messages from your bot</span></span>

<span data-ttu-id="e542f-119">Вы можете использовать вкладки, чтобы показать больше контента, чем может поместиться внутри карты, или предоставить способ для выполнения сложных задач заполнения формы с помощью вкладки холст.</span><span class="sxs-lookup"><span data-stu-id="e542f-119">You may want to use tabs to show more content than can fit inside of a card, or provide a way to complete complex form-filling tasks using the tab canvas.</span></span> <span data-ttu-id="e542f-120">Например, рассмотрите возможность навигации пользователя по вкладке, когда он или она нажимает на карту от вашего бота.</span><span class="sxs-lookup"><span data-stu-id="e542f-120">For example, consider navigating the user to the tab when he or she clicks on the card from your bot.</span></span> <span data-ttu-id="e542f-121">Для этого вам нужно будет закодировать сообщение вашего бота, чтобы включить URL-адрес [глубокой](~/concepts/build-and-test/deep-links.md) ссылки, либо через разметку, либо в качестве мишени действия openUrl.</span><span class="sxs-lookup"><span data-stu-id="e542f-121">For this to happen, you’ll need to encode your bot’s message to include a [deep link](~/concepts/build-and-test/deep-links.md) URL, either through markup or as the target of the openUrl action.</span></span>

<span data-ttu-id="e542f-122">Глубокие ссылки полагаются на entityId, которое является непрозрачным значением, которое отображает уникальную сущность в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="e542f-122">Deep links rely on an entityId, which is an opaque value that maps to a unique entity in your system.</span></span> <span data-ttu-id="e542f-123">При создании вкладки идеально хранится некоторое простое состояние, например, флаг на бэкэнде, указывающий на то, что вкладка была создана в канале.</span><span class="sxs-lookup"><span data-stu-id="e542f-123">When the tab is created, you ideally store some simple state, For example, flag on your backend indicating the tab has been created in the channel.</span></span> <span data-ttu-id="e542f-124">Когда ваш бот строит сообщение, он может нацелиться на сущностьId, связанную с этой вкладкой.</span><span class="sxs-lookup"><span data-stu-id="e542f-124">When your bot constructs a message, it can target the entityId associated with that tab.</span></span>

> [!NOTE]
> <span data-ttu-id="e542f-125">в личных чатах, потому что вкладки являются "статическими" и установлены с приложением, вы всегда можете предположить их существование и, таким образом, построить глубокие ссылки соответственно.</span><span class="sxs-lookup"><span data-stu-id="e542f-125">in personal chats, because tabs are “static” and installed with the app, you can always assume their existence and thus construct deep links accordingly.</span></span>

## <a name="sending-notifications-for-tab-updates"></a><span data-ttu-id="e542f-126">Отправка уведомлений для обновления вкладок</span><span class="sxs-lookup"><span data-stu-id="e542f-126">Sending notifications for tab updates</span></span>

<span data-ttu-id="e542f-127">Часто вы хотите уведомить конечный пользователь всякий раз, когда обновление или действия пользователя происходит во вкладке. Примером сценария является назначение задачи или билета коллеге по команде, а затем уведомление этого члена команды.</span><span class="sxs-lookup"><span data-stu-id="e542f-127">Often you’ll want to notify the end user whenever an update or a user action occurs in a tab. An example scenario is assigning a task or ticket to a fellow team member and then notifying that team member.</span></span>

<span data-ttu-id="e542f-128">Существует два способа достижения этого сценария:</span><span class="sxs-lookup"><span data-stu-id="e542f-128">There are two ways of achieving this scenario:</span></span>

1. <span data-ttu-id="e542f-129">Если вы хотите уведомить весь канал ваш бот может асинхронно разместить сообщение на канал.</span><span class="sxs-lookup"><span data-stu-id="e542f-129">If you wish to notify an entire channel your bot can asynchronously post a message to the channel.</span></span> <span data-ttu-id="e542f-130">Бот не может активно создавать разговор на вкладке, если он не был создан с помощью вкладки.</span><span class="sxs-lookup"><span data-stu-id="e542f-130">There is no way for a bot to proactively create the tab conversation if it wasn't created with the tab.</span></span>

2. <span data-ttu-id="e542f-131">Если вы хотите уведомить об этом только получателя или заинтересованные стороны, ваш бот может отправить пользователю личное сообщение в чате.</span><span class="sxs-lookup"><span data-stu-id="e542f-131">If you wish to only notify the recipient or interested parties involved with the action, your bot can send a personal chat message to the user.</span></span> <span data-ttu-id="e542f-132">Сначала вы должны проверить, существует ли личный разговор между вашим ботом и пользователем.</span><span class="sxs-lookup"><span data-stu-id="e542f-132">You should first check to see if a personal conversation between your bot and the user exists.</span></span> <span data-ttu-id="e542f-133">Если нет, вы можете позвонить, `CreateConversation` чтобы инициировать личный чат.</span><span class="sxs-lookup"><span data-stu-id="e542f-133">If not, you can call `CreateConversation` to initiate the personal chat.</span></span>

<span data-ttu-id="e542f-134">В обоих случаях используйте уведомления о событиях мудро и никогда не спам пользователя с ненужными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="e542f-134">In both cases, use event notifications wisely and never spam the user with unnecessary updates.</span></span>
