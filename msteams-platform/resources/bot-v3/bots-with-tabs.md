---
title: Объединение ботов с вкладками
description: Описывает совместное использование вкладок и ботов
keywords: teams bots tabs development
ms.topic: conceptual
ms.date: 03/15/2018
ms.openlocfilehash: d8ef669f55d5edbb9795fa2d34277bd2e2dccc7c
ms.sourcegitcommit: 79e6bccfb513d4c16a58ffc03521edcf134fa518
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2021
ms.locfileid: "51696600"
---
# <a name="combine-bots-with-tabs"></a><span data-ttu-id="c8b94-104">Объединение ботов с вкладками</span><span class="sxs-lookup"><span data-stu-id="c8b94-104">Combine bots with tabs</span></span>

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

<span data-ttu-id="c8b94-105">Боты и вкладки хорошо работают вместе и часто объединяются в единую службу.</span><span class="sxs-lookup"><span data-stu-id="c8b94-105">Bots and tabs work well together, and are often combined into a single back-end service.</span></span> <span data-ttu-id="c8b94-106">В этом разделе описываются лучшие практики и общие шаблоны для совместного использования вкладок и ботов.</span><span class="sxs-lookup"><span data-stu-id="c8b94-106">This section describes best practices and common patterns for using tabs and bots together.</span></span>

## <a name="associating-user-identities-across-bot-and-tab"></a><span data-ttu-id="c8b94-107">Associating user identities across bot and tab</span><span class="sxs-lookup"><span data-stu-id="c8b94-107">Associating user identities across bot and tab</span></span>

<span data-ttu-id="c8b94-108">Например: Предположим, что приложение вкладки использует собственную систему ID для защиты контента.</span><span class="sxs-lookup"><span data-stu-id="c8b94-108">For example: Suppose your tab application uses a proprietary ID system to secure its content.</span></span> <span data-ttu-id="c8b94-109">Предположим, у вас также есть бот, который может взаимодействовать с пользователем.</span><span class="sxs-lookup"><span data-stu-id="c8b94-109">Suppose you also have a bot that can interact with the user.</span></span> <span data-ttu-id="c8b94-110">Как правило, необходимо показывать содержимое на вкладке, определенной пользователю просмотра.</span><span class="sxs-lookup"><span data-stu-id="c8b94-110">Typically, you’ll want to show content in the tab that is specific to the viewing user.</span></span> <span data-ttu-id="c8b94-111">Проблема заключается в том, что пользовательский ИД в вашей системе, скорее всего, отличается от пользовательского ID Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="c8b94-111">The challenge is that the user ID in your system is likely different from the Microsoft Teams user ID.</span></span> <span data-ttu-id="c8b94-112">Итак, как связать эти две идентичности?</span><span class="sxs-lookup"><span data-stu-id="c8b94-112">So how do you associate these two identities?</span></span>
<span data-ttu-id="c8b94-113">В общем, рекомендуется подписать пользователя с ботом с помощью той же системы удостоверений, которая используется для проверки подлинности контента вкладок.</span><span class="sxs-lookup"><span data-stu-id="c8b94-113">In general, the recommended approach is to sign the user in with the bot using the same identity system used to provide authentication for the tab content.</span></span> <span data-ttu-id="c8b94-114">Это можно реализовать с помощью действия входа, которое, как правило, входит в систему пользователя с помощью потока OAuth.</span><span class="sxs-lookup"><span data-stu-id="c8b94-114">You can implement this via the sign-in action, which typically logs in the user via an OAuth flow.</span></span>

<span data-ttu-id="c8b94-115">Этот поток лучше всего работает, если поставщик удостоверений реализует протокол OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="c8b94-115">This flow works best if your identity provider implements the OAuth 2.0 protocol.</span></span> <span data-ttu-id="c8b94-116">Затем можно связать идентификатор пользователя Teams с учетными данными пользователя из собственной службы удостоверений.</span><span class="sxs-lookup"><span data-stu-id="c8b94-116">You can then associate the Teams user ID with the user’s credentials from your own identity service.</span></span>

   ![Связывание удостоверений](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a><span data-ttu-id="c8b94-118">Создание глубоких ссылок на вкладки в сообщениях от бота</span><span class="sxs-lookup"><span data-stu-id="c8b94-118">Constructing deep links to tabs in messages from your bot</span></span>

<span data-ttu-id="c8b94-119">Вы можете использовать вкладки, чтобы показать больше контента, чем может поместиться внутри карты, или предоставить способ выполнения сложных задач заполнения форм с помощью холста вкладки.</span><span class="sxs-lookup"><span data-stu-id="c8b94-119">You may want to use tabs to show more content than can fit inside of a card, or provide a way to complete complex form-filling tasks using the tab canvas.</span></span> <span data-ttu-id="c8b94-120">Например, рассмотрите возможность навигации пользователя на вкладку, когда он щелкнет карточку от бота.</span><span class="sxs-lookup"><span data-stu-id="c8b94-120">For example, consider navigating the user to the tab when he or she clicks on the card from your bot.</span></span> <span data-ttu-id="c8b94-121">Для этого необходимо кодировать сообщение бота, чтобы включить URL-адрес глубокой ссылки либо с помощью разметки, либо в качестве цели действия openUrl. [](~/concepts/build-and-test/deep-links.md)</span><span class="sxs-lookup"><span data-stu-id="c8b94-121">For this to happen, you’ll need to encode your bot’s message to include a [deep link](~/concepts/build-and-test/deep-links.md) URL, either via markup or as the target of the openUrl action.</span></span>

<span data-ttu-id="c8b94-122">Глубокие ссылки полагаются на объектId, который является непрозрачной величиной, которая связывается с уникальной сущностью в вашей системе.</span><span class="sxs-lookup"><span data-stu-id="c8b94-122">Deep links rely on an entityId, which is an opaque value that maps to a unique entity in your system.</span></span> <span data-ttu-id="c8b94-123">Когда вкладка создана, вы в идеале сохраняете некоторое простое состояние (например, флаг) на задней части, указывающее, что вкладка была создана в канале.</span><span class="sxs-lookup"><span data-stu-id="c8b94-123">When the tab is created, you ideally store some simple state (e.g. flag) on your backend indicating the tab has been created in the channel.</span></span> <span data-ttu-id="c8b94-124">При построении сообщения бот может нацелить объектId, связанный с этой вкладке.</span><span class="sxs-lookup"><span data-stu-id="c8b94-124">When your bot constructs a message, it can target the entityId associated with that tab.</span></span>

<span data-ttu-id="c8b94-125">**Примечание.** В личных чатах, так как вкладки являются "статичными" и установлены с приложением, всегда можно предположить их существование и таким образом построить глубокие ссылки соответственно.</span><span class="sxs-lookup"><span data-stu-id="c8b94-125">**Note:** in personal chats, because tabs are “static” and installed with the app, you can always assume their existence and thus construct deep links accordingly.</span></span>

## <a name="sending-notifications-for-tab-updates"></a><span data-ttu-id="c8b94-126">Отправка уведомлений для обновлений вкладок</span><span class="sxs-lookup"><span data-stu-id="c8b94-126">Sending notifications for tab updates</span></span>

<span data-ttu-id="c8b94-127">Часто необходимо уведомлять конечный пользователь всякий раз, когда на вкладке происходит обновление или действие пользователя. Пример сценария — назначение задачи или билета члену команды, а затем уведомление об этом члене группы.</span><span class="sxs-lookup"><span data-stu-id="c8b94-127">Often you’ll want to notify the end user whenever an update or a user action occurs in a tab. An example scenario is assigning a task or ticket to a fellow team member and then notifying that team member.</span></span>

<span data-ttu-id="c8b94-128">Существует два способа достижения этого сценария:</span><span class="sxs-lookup"><span data-stu-id="c8b94-128">There are two ways of achieving this scenario:</span></span>

1. <span data-ttu-id="c8b94-129">Если вы хотите уведомить весь канал, ваш бот может асинхронно отправлять сообщение на канал.</span><span class="sxs-lookup"><span data-stu-id="c8b94-129">If you wish to notify an entire channel your bot can asynchronously post a message to the channel.</span></span> <span data-ttu-id="c8b94-130">Бот не может активно создавать беседу вкладки, если она не была создана с помощью вкладки.</span><span class="sxs-lookup"><span data-stu-id="c8b94-130">There is no way for a bot to proactively create the tab conversation if it wasn't created with the tab.</span></span>

2. <span data-ttu-id="c8b94-131">Если вы хотите уведомить только получателя или заинтересованные стороны, связанные с действием, ваш бот может отправить пользователю личное сообщение чата.</span><span class="sxs-lookup"><span data-stu-id="c8b94-131">If you wish to only notify the recipient or interested parties involved with the action, your bot can send a personal chat message to the user.</span></span> <span data-ttu-id="c8b94-132">Сначала необходимо проверить, существует ли личный разговор между ботом и пользователем.</span><span class="sxs-lookup"><span data-stu-id="c8b94-132">You should first check to see if a personal conversation between your bot and the user exists.</span></span> <span data-ttu-id="c8b94-133">Если нет, вы можете `CreateConversation` позвонить, чтобы инициировать личный чат.</span><span class="sxs-lookup"><span data-stu-id="c8b94-133">If not, you can call `CreateConversation` to initiate the personal chat.</span></span>

<span data-ttu-id="c8b94-134">В обоих случаях используйте уведомления о событиях с умом и никогда не спамить пользователя ненужными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="c8b94-134">In both cases, use event notifications wisely and never spam the user with unnecessary updates.</span></span>
