---
title: Объедините ботов с вкладками
description: Описывает, как использовать вкладки и боты вместе
keywords: разработка вкладок команд ботов
ms.topic: conceptual
localization_priority: Normal
ms.date: 03/15/2018
ms.openlocfilehash: 3273369ad1122355b792dc3d429c3a4eff7e1d47
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566455"
---
# <a name="combine-bots-with-tabs"></a>Объедините ботов с вкладками

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

Боты и вкладки хорошо работают вместе и часто объединяются в единый бэк-энд сервис. В этом разделе описаны лучшие практики и общие шаблоны совместного использования вкладок и ботов.

## <a name="associating-user-identities-across-bot-and-tab"></a>Связывание идентификационных данных пользователей между ботом и вкладкой

Например: Предположим, что приложение для вкладок использует несвободную систему идентификационных данных для защиты содержимого. Предположим, у вас также есть бот, который может взаимодействовать с пользователем. Как правило, вы хотите, чтобы показать содержимое во вкладке, которая является специфичной для просмотра пользователя. Проблема заключается в том, что идентификатор пользователя в вашей системе, скорее всего, отличается от Microsoft Teams идентификатора пользователя. Так как же связать эти две идентичности?
Как правило, рекомендуемый подход заключается в том, чтобы войти в систему поддержки пользователя с помощью той же системы идентификации, используемой для проверки подлинности содержимого вкладки. Реализовать это можно с помощью действия «войти в систему», которое обычно регистрируется пользователем через поток OAuth.

Этот поток работает лучше всего, если ваш поставщик идентификационных данных реализует протокол OAuth 2.0. Затем вы можете связать Teams идентификатор пользователя с учетными данными пользователя из вашей собственной службы идентификации.

   ![Связывание идентичностей](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>Построение глубоких ссылок на вкладки в сообщениях от вашего бота

Вы можете использовать вкладки, чтобы показать больше контента, чем может поместиться внутри карты, или предоставить способ для выполнения сложных задач заполнения формы с помощью вкладки холст. Например, рассмотрите возможность навигации пользователя по вкладке, когда он или она нажимает на карту от вашего бота. Для этого вам нужно будет закодировать сообщение вашего бота, чтобы включить URL-адрес [глубокой](~/concepts/build-and-test/deep-links.md) ссылки, либо через разметку, либо в качестве мишени действия openUrl.

Глубокие ссылки полагаются на entityId, которое является непрозрачным значением, которое отображает уникальную сущность в вашей системе. При создании вкладки идеально хранится некоторое простое состояние, например, флаг на бэкэнде, указывающий на то, что вкладка была создана в канале. Когда ваш бот строит сообщение, он может нацелиться на сущностьId, связанную с этой вкладкой.

> [!NOTE]
> в личных чатах, потому что вкладки являются "статическими" и установлены с приложением, вы всегда можете предположить их существование и, таким образом, построить глубокие ссылки соответственно.

## <a name="sending-notifications-for-tab-updates"></a>Отправка уведомлений для обновления вкладок

Часто вы хотите уведомить конечный пользователь всякий раз, когда обновление или действия пользователя происходит во вкладке. Примером сценария является назначение задачи или билета коллеге по команде, а затем уведомление этого члена команды.

Существует два способа достижения этого сценария:

1. Если вы хотите уведомить весь канал ваш бот может асинхронно разместить сообщение на канал. Бот не может активно создавать разговор на вкладке, если он не был создан с помощью вкладки.

2. Если вы хотите уведомить об этом только получателя или заинтересованные стороны, ваш бот может отправить пользователю личное сообщение в чате. Сначала вы должны проверить, существует ли личный разговор между вашим ботом и пользователем. Если нет, вы можете позвонить, `CreateConversation` чтобы инициировать личный чат.

В обоих случаях используйте уведомления о событиях мудро и никогда не спам пользователя с ненужными обновлениями.
