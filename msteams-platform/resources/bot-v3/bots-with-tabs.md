---
title: Объединение боты с вкладками
description: Описание использования вкладок и боты вместе
keywords: Разработка команд боты для вкладок Teams
ms.date: 03/15/2018
ms.openlocfilehash: 59ae8bc01f82c70dd7ea6869cb870e26acae1293
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675462"
---
# <a name="combine-bots-with-tabs"></a><span data-ttu-id="908a9-104">Объединение боты с вкладками</span><span class="sxs-lookup"><span data-stu-id="908a9-104">Combine bots with tabs</span></span>

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

<span data-ttu-id="908a9-105">Боты и вкладки хорошо работают вместе, и часто объединяются в одну фоновую службу.</span><span class="sxs-lookup"><span data-stu-id="908a9-105">Bots and tabs work well together, and are often combined into a single back-end service.</span></span> <span data-ttu-id="908a9-106">В этом разделе приводятся рекомендации и общие шаблоны для совместного использования вкладок и боты.</span><span class="sxs-lookup"><span data-stu-id="908a9-106">This section describes best practices and common patterns for using tabs and bots together.</span></span>

## <a name="associating-user-identities-across-bot-and-tab"></a><span data-ttu-id="908a9-107">Сопоставление удостоверений пользователей на Bot и на вкладке</span><span class="sxs-lookup"><span data-stu-id="908a9-107">Associating user identities across bot and tab</span></span>

<span data-ttu-id="908a9-108">Например: Предположим, что приложение, использующее вкладку, использует систему ИДЕНТИФИКАТОРов для защиты своего содержимого.</span><span class="sxs-lookup"><span data-stu-id="908a9-108">For example: Suppose your tab application uses a proprietary ID system to secure its content.</span></span> <span data-ttu-id="908a9-109">Предположим, у вас также есть Bot, которые могут взаимодействовать с пользователем.</span><span class="sxs-lookup"><span data-stu-id="908a9-109">Suppose you also have a bot that can interact with the user.</span></span> <span data-ttu-id="908a9-110">Как правило, необходимо отображать контент на вкладке, относящейся к пользователю просмотра.</span><span class="sxs-lookup"><span data-stu-id="908a9-110">Typically, you’ll want to show content in the tab that is specific to the viewing user.</span></span> <span data-ttu-id="908a9-111">Проблема состоит в том, что идентификатор пользователя в вашей системе, скорее всего, отличается от идентификатора пользователя Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="908a9-111">The challenge is that the user ID in your system is likely different from the Microsoft Teams user ID.</span></span> <span data-ttu-id="908a9-112">Как связать эти два удостоверения?</span><span class="sxs-lookup"><span data-stu-id="908a9-112">So how do you associate these two identities?</span></span>
<span data-ttu-id="908a9-113">Как правило, рекомендуемый способ подписать пользователя с помощью Bot с помощью той же системы идентификации, которая использовалась для проверки подлинности для содержимого вкладки.</span><span class="sxs-lookup"><span data-stu-id="908a9-113">In general, the recommended approach is to sign the user in with the bot using the same identity system used to provide authentication for the tab content.</span></span> <span data-ttu-id="908a9-114">Это можно реализовать с помощью действия при входе, которое обычно заносится в журнал пользователя с помощью процесса OAuth.</span><span class="sxs-lookup"><span data-stu-id="908a9-114">You can implement this via the sign-in action, which typically logs in the user via an OAuth flow.</span></span>

<span data-ttu-id="908a9-115">Этот процесс лучше всего подходит, если поставщик удостоверений реализует протокол OAuth 2,0.</span><span class="sxs-lookup"><span data-stu-id="908a9-115">This flow works best if your identity provider implements the OAuth 2.0 protocol.</span></span> <span data-ttu-id="908a9-116">Затем вы можете связать идентификатор пользователя Teams с учетными данными пользователя из собственной службы удостоверений.</span><span class="sxs-lookup"><span data-stu-id="908a9-116">You can then associate the Teams user ID with the user’s credentials from your own identity service.</span></span>

   ![Сопоставление удостоверений](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a><span data-ttu-id="908a9-118">Создание глубоких ссылок на вкладки в сообщениях из ленты</span><span class="sxs-lookup"><span data-stu-id="908a9-118">Constructing deep links to tabs in messages from your bot</span></span>

<span data-ttu-id="908a9-119">Вы можете использовать вкладки для отображения большего количества контента, чем может уместиться в карточке, или предоставить способ выполнения сложных задач заполнения форм с помощью холста вкладок.</span><span class="sxs-lookup"><span data-stu-id="908a9-119">You may want to use tabs to show more content than can fit inside of a card, or provide a way to complete complex form-filling tasks using the tab canvas.</span></span> <span data-ttu-id="908a9-120">Например, рассмотрите возможность переходить на вкладку, когда он щелкает карточку из ленты.</span><span class="sxs-lookup"><span data-stu-id="908a9-120">For example, consider navigating the user to the tab when he or she clicks on the card from your bot.</span></span> <span data-ttu-id="908a9-121">Для этого необходимо закодировать сообщение Bot, чтобы включить URL-адрес с [глубокими ссылками](~/concepts/build-and-test/deep-links.md) , либо с помощью разметки, либо в качестве целевого значения действия openUrl.</span><span class="sxs-lookup"><span data-stu-id="908a9-121">For this to happen, you’ll need to encode your bot’s message to include a [deep link](~/concepts/build-and-test/deep-links.md) URL, either via markup or as the target of the openUrl action.</span></span>

<span data-ttu-id="908a9-122">Глубокие ссылки основываются на Ентитид, который представляет собой непрозрачное значение, которое сопоставляется с уникальной сущностью в системе.</span><span class="sxs-lookup"><span data-stu-id="908a9-122">Deep links rely on an entityId, which is an opaque value that maps to a unique entity in your system.</span></span> <span data-ttu-id="908a9-123">При создании вкладки в идеале необходимо хранить некоторое простое состояние (например, флаг) на внутреннем стороне, указывая, что вкладка была создана в канале.</span><span class="sxs-lookup"><span data-stu-id="908a9-123">When the tab is created, you ideally store some simple state (e.g. flag) on your backend indicating the tab has been created in the channel.</span></span> <span data-ttu-id="908a9-124">Когда ваш робот создает сообщение, он может ориентироваться в Ентитид, связанном с этой вкладкой.</span><span class="sxs-lookup"><span data-stu-id="908a9-124">When your bot constructs a message, it can target the entityId associated with that tab.</span></span>

<span data-ttu-id="908a9-125">**Примечание:** в разделе личные беседы, так как вкладки статичны и устанавливаются вместе с приложением, всегда можно придумать их существование и, таким образом, создавать детальные ссылки.</span><span class="sxs-lookup"><span data-stu-id="908a9-125">**Note:** in personal chats, because tabs are “static” and installed with the app, you can always assume their existence and thus construct deep links accordingly.</span></span>

## <a name="sending-notifications-for-tab-updates"></a><span data-ttu-id="908a9-126">Отправка уведомлений об обновлениях вкладок</span><span class="sxs-lookup"><span data-stu-id="908a9-126">Sending notifications for tab updates</span></span>

<span data-ttu-id="908a9-127">Часто вы хотите уведомить конечного пользователя о том, что на вкладке возникает обновление или действие пользователя. В качестве примера сценария можно назначить задачу или билет участнику группы, а затем уведомить этого участника группы.</span><span class="sxs-lookup"><span data-stu-id="908a9-127">Often you’ll want to notify the end user whenever an update or a user action occurs in a tab. An example scenario is assigning a task or ticket to a fellow team member and then notifying that team member.</span></span>

<span data-ttu-id="908a9-128">Существует два способа достижения этого сценария:</span><span class="sxs-lookup"><span data-stu-id="908a9-128">There are two ways of achieving this scenario:</span></span>

1. <span data-ttu-id="908a9-129">Если вы хотите уведомить весь канал, с которого Bot может асинхронно отправлять сообщение в канал.</span><span class="sxs-lookup"><span data-stu-id="908a9-129">If you wish to notify an entire channel your bot can asynchronously post a message to the channel.</span></span> <span data-ttu-id="908a9-130">Невозможно создать беседу вкладки с помощью Bot, если она не была создана с помощью вкладки.</span><span class="sxs-lookup"><span data-stu-id="908a9-130">There is no way for a bot to proactively create the tab conversation if it wasn't created with the tab.</span></span>

2. <span data-ttu-id="908a9-131">Если вы хотите уведомить получателя или заинтересованных лиц, участвующих в действии, пользователь с помощью программы Bot может отправить пользователю личное сообщение разговора.</span><span class="sxs-lookup"><span data-stu-id="908a9-131">If you wish to only notify the recipient or interested parties involved with the action, your bot can send a personal chat message to the user.</span></span> <span data-ttu-id="908a9-132">Сначала необходимо проверить, существует ли личный беседа между Bot и пользователем.</span><span class="sxs-lookup"><span data-stu-id="908a9-132">You should first check to see if a personal conversation between your bot and the user exists.</span></span> <span data-ttu-id="908a9-133">В противном случае вы можете `CreateConversation` позвонить для запуска личного чата.</span><span class="sxs-lookup"><span data-stu-id="908a9-133">If not, you can call `CreateConversation` to initiate the personal chat.</span></span>

<span data-ttu-id="908a9-134">В обоих случаях рекомендуется использовать уведомления о событиях и никогда не спама пользователя с ненужными обновлениями.</span><span class="sxs-lookup"><span data-stu-id="908a9-134">In both cases, use event notifications wisely and never spam the user with unnecessary updates.</span></span>
