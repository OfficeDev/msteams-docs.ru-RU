---
title: Протестируйте и отладьте бот
description: В этой статье вы узнаете, как тестировать и отлаживать боты в Microsoft Teams и тестировать бот без отправки в Teams
ms.topic: how-to
ms.localizationpriority: medium
ms.date: 03/20/2019
ms.openlocfilehash: 3cfb76443566a0ca5c279547f7b3db490c6095d3
ms.sourcegitcommit: ca84b5fe5d3b97f377ce5cca41c48afa95496e28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2022
ms.locfileid: "66143699"
---
# <a name="test-and-debug-your-microsoft-teams-bot"></a>Тестирование и отладка бота Microsoft Teams

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

При тестировании бота необходимо учитывать как предполагаемые контексты работы бота, так и любые возможные функции, которые вы захотите добавить в бот, и для которых требуются данные, специфичные для Microsoft Teams. Убедитесь, что метод, выбранный для тестирования бота, соответствует его функциональным возможностям.

## <a name="test-by-uploading-to-teams"></a>Тестирование путем отправки в Teams

Самый полный способ тестирования бота — создание пакета приложения и отправка его в Teams. Это единственный способ тестирования всех функциональных возможностей, доступных вашему боту, во всех областях.

Существует два способа отправки приложения: Вы можете использовать [App Studio](~/concepts/build-and-test/app-studio-overview.md), либо вручную [создать пакет приложения](~/concepts/build-and-test/apps-package.md) и [загрузить приложение](~/concepts/deploy-and-publish/apps-upload.md). Если вам нужно изменить манифест и повторно загрузить приложение, вам следует [удалить бот](#deleting-a-bot-from-teams) перед загрузкой измененного пакета приложения.

## <a name="debug-your-bot-locally"></a>Локальная отладка бота

Если вы размещаете бот локально во время разработки, для тестирования бота необходимо использовать службу туннелирования, например [ngrok](https://ngrok.com/) . Скачав и установив ngrok, выполните приведенную ниже команду, чтобы запустить службу туннелирования. Возможно, потребуется добавить ngrok к пути.

```bash
ngrok http <port> -host-header=localhost:<port>
```

Используйте конечную точку HTTPS, предоставленную ngrok, в манифесте приложения. Если вы закроете командное окно и перезапустите его, вы получите новый URL-адрес, и вам потребуется обновить адрес конечной точки бота, чтобы использовать его.

## <a name="testing-your-bot-without-uploading-to-teams"></a>Тестирование бота без отправки в Teams

Иногда необходимо протестировать бот, не устанавливая его как приложение в Teams. Мы предлагаем два метода тестирования. Тестирование бота без его установки в качестве приложения может быть полезно, чтобы убедиться, что бот доступен и отвечает, однако это не позволит вам протестировать весь спектр функций Microsoft Teams, которые вы, возможно, добавили в бот. Если вам нужно полностью протестировать бот, следуйте инструкциям по [тестированию с помощью загрузки](#test-by-uploading-to-teams).

### <a name="use-the-bot-emulator"></a>Использование эмулятора бота

Эмулятор Bot Framework — это настольное приложение, которое позволяет разработчикам ботов тестировать и отлаживать боты локально или удаленно. Используя эмулятор, вы можете общаться со своим ботом и проверять сообщения, которые ваш бот отправляет и получает. Это может быть полезно для проверки доступности бота и реагирования на него, однако эмулятор не позволит протестировать функции, относящиеся к Teams, которые вы добавили в бот, и не будет точно визуализировать то, как они отображаются в Teams. Если вам нужно протестировать любую из этих вещей, лучше не [загружать бот](#test-by-uploading-to-teams).

Полные инструкции по эмулятору Bot Framework можно найти [здесь](/azure/bot-service/bot-service-debug-emulator?view=azure-bot-service-4.0&preserve-view=true).

### <a name="talk-to-your-bot-directly-by-id"></a>Общение с ботом напрямую по идентификатору

>[!Important]
>Общение с ботом по идентификатору предназначено только для тестирования.

Вы также можете инициировать беседу с ботом, используя его идентификатор. Ниже приведены два способа это сделать. Если бот был добавлен с помощью одного из этих методов, к нему нельзя будет обратиться в беседах по каналам, и вы не сможете воспользоваться другими возможностями приложения Microsoft Teams, такими как вкладки или расширения сообщений.

1. На странице [Панель мониторинга бота](https://dev.botframework.com/bots) для вашего бота в разделе **Каналы** выберите **Добавить в Microsoft Teams**. Microsoft Teams запустится с личным чатом с ботом.
2. Ссылайтесь непосредственно на идентификатор приложения бота из Microsoft Teams:
   * На странице [панели мониторинга бота](https://dev.botframework.com/bots) в разделе **Сведения** скопируйте **идентификатор приложения бота Майкрософт**.
  
      :::image type="content" source="../../assets/images/bots_appid_botframework.png" alt-text="Панель мониторинга бота":::
  
   * В Microsoft Teams на панели **Чат** выберите значок **Добавить чат**. В поле **Кому** вставьте идентификатор приложения бота Майкрософт.
  
      :::image type="content" source="../../assets/images/bots_uploading.png" alt-text="Загрузка идентификатора приложения для бота"border="true":::

     Идентификатор приложения должен соответствовать имени бота.

   * Выберите бот и отправьте сообщение, чтобы начать разговор.
   * Кроме того, вы можете вставить идентификатор приложения бота в поле поиска в левом верхнем углу Microsoft Teams. На странице результатов поиска перейдите на вкладку ''Люди'', чтобы увидеть бот и начать с ним чат.

Бот получит событие `conversationUpdate` так же, как боты, добавленные в команду, но без сведений о команде в объекте `channelData`.

## <a name="blocking-a-bot-in-personal-chat"></a>Блокировка бота в личном чате

Пользователи могут запретить боту отправлять сообщения в личных чатах. Для этого запрета нужно щелкнуть бота правой кнопкой мыши в канале чата и выбрать **Блокировать беседу бота**. Это означает, что боты будут продолжать отправлять сообщения, но пользователь их не получит.

  :::image type="content" source="../../assets/images/bots/botdisable.png" alt-text="Блокировка бота"border="true":::

## <a name="removing-a-bot-from-a-team"></a>Удаление бота из команды

Пользователи могут удалить бот, выбрав значок корзины в списке ботов в представлении своей группы. Обратите внимание, что это только удаляет бот из использования этой командой, отдельные пользователи могут взаимодействовать в личном контексте.

Боты в личном контексте не могут быть отключены или удалены пользователем, за счет полного удаления бота из Teams.

## <a name="disabling-a-bot-in-teams"></a>Отключение бота в Teams

Чтобы запретить боту получать сообщения, перейдите на панель управления ботом и отредактируйте канал Microsoft Teams. Снимите флажок **Включить в Microsoft Teams**. Это не позволяет пользователям взаимодействовать с ботом, но его все равно можно будет обнаружить, и пользователи смогут добавлять его в команды.

## <a name="deleting-a-bot-from-teams"></a>Удаление бота из Teams

Чтобы полностью удалить бот из Teams, перейдите на панель управления ботами и отредактируйте канал Microsoft Teams. В нижней части страницы нажмите **Удалить**. Теперь пользователи не смогут обнаруживать бот, добавлять его и взаимодействовать с ним. Это не приводит к удалению бота из экземпляров Teams других пользователей, хотя он также перестанет работать для них.

## <a name="removing-your-bot-from-appsource"></a>Удаление бота из AppSource

Если вы хотите удалить бот из приложения Teams в AppSource (ранее Магазин Office), вы должны удалить бот из манифеста приложения и повторно отправить приложение на проверку. Подробнее см. [Публикация приложения Microsoft Teams в AppSource](~/concepts/deploy-and-publish/apps-publish.md).
