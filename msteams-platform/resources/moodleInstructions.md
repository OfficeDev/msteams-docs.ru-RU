---
title: Установка Moodle LMS
description: Установка и настройка приложения интеграции Moodle для Microsoft Teams
keywords: Плагин интеграции приложений Moodle Teams
ms.topic: how-to
localization_priority: Normal
ms.author: lajanuar
author: laujan
ms.openlocfilehash: 2a99acbe9bc618ea940af3bbe898b30d342ad0cf
ms.sourcegitcommit: a732789190f59ec1f3699e8ad2f06387e8fe1458
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2021
ms.locfileid: "52058357"
---
# <a name="install-moodle-lms"></a>Установка Moodle LMS

Moodle — популярная система управления обучением с открытым исходным кодом (LMS). Теперь она интегрирована с Microsoft Teams. Эта интеграция помогает преподавателям и преподавателям совместно работать на курсах Moodle, задавать вопросы о классах и назначениях и получать уведомления непосредственно в Teams.

Чтобы помочь ИТ-администраторам легко настроить эту интеграцию, с открытым исходным кодом Microsoft 365 Moodle Plugin обновляется с помощью следующих возможностей:

* Автоматическая регистрация сервера Moodle в [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) (Azure AD).
* Одним щелчком мыши развертывание бота помощника Moodle в Azure.
* Автозапранение команд и автохронизация регистраций команд для всех или выбор курсов Moodle.
* Автоматическая установка вкладки Moodle и бота помощника Moodle в каждую синхронизированную команду.

Дополнительные данные о возможностях, которые предоставляет эта интеграция, см. в [статьях Microsoft Teams и Moodle.](https://education.microsoft.com/resource/3dffb3a8)

## <a name="prerequisites"></a>Необходимые условия

Ниже следующую предпосылку для установки и настройки приложения Moodle: 

1. Учетные данные администратора Moodle.

1. Учетные данные администратора Azure AD.

1. Подписка Azure, в которой можно создавать новые ресурсы.

**Установка и настройка приложения Moodle** 

Выполните следующие действия по установке и настройке приложения Moodle: 

## <a name="1-install-the-microsoft-365-moodle-plugins"></a>1. Установка плагинов Microsoft 365 Moodle

Интеграция Moodle в Microsoft Teams за счет набора плагинов [Microsoft 365 Moodle](https://github.com/Microsoft/o365-moodle)с открытым исходным кодом. Чтобы установить плагин на сервере Moodle, необходимо установить следующие приложения:

1. Текущая [стабильная версия Moodle](https://download.moodle.org/releases/latest/).

1. Плагины Moodle [OpenID Connect](https://moodle.org/plugins/auth_oidc) и [плагины интеграции Microsoft 365,](https://moodle.org/plugins/local_o365) загруженные и сохраненные на локальном компьютере.

   > [!NOTE]
   > Для интеграции Teams необходимо установить плагины OpenID Connect и Microsoft 365 Integration. Кроме того, рекомендуется подключать к теме [Microsoft 365 Teams.](https://moodle.org/plugins/theme_boost_o365teams)

1. Вопишитесь на сервер Moodle в  качестве администратора и выберите администрирование сайта из блока [Параметры,](https://docs.moodle.org/22/en/Settings_block) расположенного в левой панели навигации.

1. Выберите **вкладку Plugins,** а затем установите **плагины Install.**

1. В разделе **Установка плагина из файла ZIP** выберите **кнопку Выберите кнопку файла.**

1. Выберите **Параметр Upload a file** из левой навигации, просмотрите скачаный файл и **загрузите этот файл.**

1. Выберите **администрирование сайта** из левой панели навигации, чтобы вернуться на панель мониторинга администрирования. Прокрутите вниз **к локальным плагинам** и выберите **ссылку Интеграция Microsoft 365.** 

> [!IMPORTANT]
>
> * Откройте страницу конфигурации Microsoft 365 Moodle Plugin на отдельной вкладке браузера, так как вам необходимо вернуться к этому набору страниц на протяжении всего процесса.  <br/><br/>
> * Если у вас нет существующего сайта Moodle, вы можете проверить Moodle в Azure [репо,](https://github.com/azure/moodle) где можно быстро развернуть экземпляр Moodle и настроить его под свои нужды.

## <a name="2-configure-the-connection-between-the-microsoft-365-plugin-and-azure-active-directory-azure-ad"></a>2. Настройка подключения между плагином Microsoft 365 и Azure Active Directory (Azure AD)

В Azure AD необходимо зарегистрировать Moodle в качестве приложения. Чтобы завершить этот процесс, используйте скрипт PowerShell. Сценарий PowerShell содержит новое приложение Azure AD для клиента Microsoft 365, которое используется плагином Moodle Microsoft 365. Сценарий содержит приложение для клиента Microsoft 365, настройка URL-адресов и разрешений на необходимый ответ для предварительного приложения, а также `AppID` возврат и `Key` . Для настройки сайта сервера Moodle с помощью Azure AD можно использовать созданную и созданную на странице установки плагина `AppID` `Key` Moodle 365.

> [!IMPORTANT]
> * Скрипт PowerShell не обновляется с помощью последних элементов конфигурации, поэтому необходимо выполнить конфигурацию вручную, следуя шагам, описанным на страницах выпуска Moodle [3.8.0.4 и 3.9.1](https://docs.moodle.org/39/en/Office365#3.8.0.4_and_3.9.1_release) и [3.8.0.5 и 3.9.2.](https://docs.moodle.org/39/en/Office365#3.8.0.5_and_3.9.2_release) </br></br>
> * Чтобы подробно просмотреть инструкции, которые автоматизирует скрипт PowerShell, см. в примере [Register your Moodle в качестве приложения.](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application)

### <a name="the-moodle-tab-for-microsoft-teams-information-flow"></a>Вкладка Moodle для информационного потока Microsoft Teams

<img width="530px" src="../assets/images/MoodleTabInformationFlow.png" alt="Moodle tab for Microsoft Teams information flow" />

1. На странице Интеграция Microsoft 365 выберите вкладку **Установки.**

1. Выберите **кнопку Download PowerShell Script** и сохраните ее на локальном компьютере.

1. Необходимо подготовить сценарий PowerShell из файла ZIP. Выполните следующие действия для подготовки сценария PowerShell из файла ZIP:

    1. Скачайте и извлекайте `Moodle-AzureAD-Powershell.zip` файл.
    1. Откройте извлеченную папку.
    1. Щелкните правой кнопкой мыши `Moodle-AzureAD-Script.ps1` по файлу и выберите **Свойства**.
    1. На **вкладке Общие** свойства окна проверьте поле рядом с атрибутом Безопасности, расположенным `Unblock` в нижней части окна. 
    1. Нажмите **ОК**.
    1. Скопируйте путь каталога в извлеченную папку.

1. Запустите PowerShell в качестве администратора:

    1. Выберите «Начать».
    1. Тип PowerShell.
    1. Щелкните правой кнопкой мыши Windows PowerShell.
    1. Выберите **Выполнить в качестве администратора.**

1. Перейдите к unzipped каталогу, введя в текст `cd .../.../Moodle-AzureAD-Powershell` `.../...` путь к каталогу.

1. Выполните сценарий PowerShell:

    1. Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser` .
    1. Введите `./Moodle-AzureAD-Script.ps1` .
    1. Во входе в учетную запись администратора Microsoft 365 в всплывающее окно.
    1. Введите имя приложения Azure AD (например, плагин Moodle/Moodle).
    1. Введите URL-адрес сервера Moodle.
    1. **Скопируйте ID приложения** и **ключ приложения,** созданные сценарием, и сохраните их.

1. Далее необходимо добавить `AppID` и добавить в плагин `Key` Moodle Microsoft 365. Возвращайся на страницу администрирования плагина. Поток: администрирование сайтов ➡ плагинов ➡ Microsoft 365 Integration.

1. На **вкладке Установка** добавьте ранее  скопированные **ID** приложения и ключ приложения, а затем выберите **сохранить изменения.**

1. После обновления страницы можно увидеть новый раздел **Выбор метода подключения.** Выберите почтовый ящик с **меткой По умолчанию,** а затем снова **выберите Сохранить изменения.**

1. После обновления страницы вы можете увидеть еще один новый раздел **Согласие администратора & дополнительные сведения**.
    1. Выберите **ссылку Предоставление согласия администратора,** введите учетные  данные глобального администратора Microsoft 365, а затем примите решение о предоставлении разрешений.
    1. Рядом с **полем Клиент Azure AD выберите** кнопку **Обнаружение.**
    1. Рядом с **URL-адресом OneDrive для бизнеса** выберите кнопку **Обнаружение.**
    1. После заполнения полей снова выберите кнопку **Сохранить изменения.**

1. Выберите **кнопку Обновление** для проверки установки, а затем **сохраните изменения.**

1. Синхронизация пользователей между сервером Moodle и Azure AD. В зависимости от среды можно выбрать различные параметры на этом этапе. Для начала сделайте следующее:
    1. Переключиться на **вкладку Параметры синхронизации**
    1. В разделе **Синхронизация пользователей с azure AD** выберите почтовые ящики, применимые к вашей среде. Необходимо выбрать следующее:  

        ✔ Создание учетных записей в Moodle для пользователей Azure AD . 
        ✔ обновления всех учетных записей в Moodle для пользователей Azure AD.  

    1. В разделе **Ограничение создания** пользователей можно настроить фильтр, чтобы ограничить пользователей Azure AD, синхронизированных с Moodle.
    1. Раздел **Сопоставление полей** пользователя позволяет настроить отображение поля Azure AD для сопоставления профилей пользователей Moodle.
    1. В разделе **Синхронизация** команд можно выбрать для автоматического создания групп, например групп для некоторых или всех существующих курсов Moodle.

> [!NOTE]
> Cron [](https://docs.moodle.org/310/en/Cron) Moodle выполняется в соответствии с расписанием задач. Расписание по умолчанию — один раз в день. Тем не менее, крона должна работать чаще, чтобы сохранить все в синхронизации.

13. Чтобы проверить [задания cron](https://docs.moodle.org/310/en/Cron) и выполнить их вручную  для первого запуска, выберите ссылку на страницу управления запланированными задачами в разделе Синхронизация пользователей **с azure AD.** В этом случае вы **перенабирались на страницу Запланированные** задачи.

    1. Прокрутите вниз и найдите пользователей **Sync с заданием Azure AD** и выберите **Выполнить сейчас.**
    1. Если вы выберете для создания групп на основе существующих курсов, вы также можете выполнить задание **Create user groups в Microsoft 365.**

1. Возвращайся на страницу администрирования плагина. Поток навигации: администрирование ➡ плагинов ➡ Microsoft 365 Integratio. Затем выберите **страницу Параметры команд.** Необходимо настроить некоторые параметры, чтобы включить интеграцию приложений Teams.

    1. Чтобы включить **OpenID Connect,** выберите ссылку **Управление** проверкой подлинности и выберите значок глаза на линии **OpenId Connect,** если он серый.
    1. Включить встраивку кадров. Выберите **ссылку HTTP Security,** а затем выберите почтовый ящик рядом с **разрешить встраивку кадров.**
    1. Включить веб-службы, которые позволяют функции API Moodle. Выберите **ссылку Расширенные функции,** а затем убедитесь, что контрольный ящик рядом с **включить веб-службы** проверяется.
    1. Включить внешние службы для Microsoft 365. Выберите **ссылку Внешние службы** далее:  

        ✔ Изменить **в** строке **Веб-службы Moodle Microsoft 365.**  
        ✔ пометите почтовый ящик рядом с **включенной,** а затем выберите **Сохранить изменения**

    1. Отредактировать разрешения пользователя, проверку подлинности, чтобы разрешить им создавать маркеры веб-службы. Выберите **ссылку "Проверка** подлинности пользователя" роли редактирования. Прокрутите вниз и найдите **возможность создания маркера веб-службы** и пометите почтовый ящик **Разрешить.**

## <a name="3-deploy-the-moodle-assistant-bot-to-azure"></a>3. Развертывание бота помощника Moodle в Azure

Бесплатный бот помощника Moodle для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о своих курсах, назначениях, оценках и других сведениях в Moodle. Бот также отправляет уведомления Moodle учащимся и преподавателям в Teams. Бот — это проект с открытым исходным кодом, поддерживаемый Корпорацией Майкрософт, и доступен в [GitHub.](https://github.com/microsoft/Moodle-Teams-Bot)

> [!NOTE]
> * В этом разделе необходимо развернуть ресурсы в подписке Azure. Все ресурсы, настроенные с помощью **бесплатного уровня.** В зависимости от использования бота необходимо масштабировать эти ресурсы.
> * Чтобы использовать вкладку Moodle без бота, пропустите [4](#4-deploy-your-microsoft-teams-app).

### <a name="moodle-bot-information-flow"></a>Поток информации о боте Moodle

<img width="530px" src="../assets/images/MoodleBotInformationFlow.png" alt="Moodle bot for Microsoft Teams information flow" />

Чтобы установить бот, необходимо зарегистрировать его на [платформе удостоверений Майкрософт.](https://identity.microsoft.com/Landing) Это позволяет боту проверить подлинность в конечных точках Майкрософт. 

**Чтобы зарегистрировать бот:**

1. Перейдите на страницу администрирования плагина. Перейдите к **плагинам**. В **рамках интеграции Microsoft 365** выберите вкладку **Teams Settings.**

1. Выберите **ссылку портала регистрации приложений** Майкрософт и вопишитесь в свой Microsoft ID.

1. Введите имя приложения, например MoodleBot, и выберите кнопку **Создать.**

1. **Скопируйте ID приложения и** вклеите его в поле **Бот-приложения на** странице **Параметры** команды.

1. Выберите **кнопку Создание нового пароля.** Скопируйте созданный пароль и вклейте его в поле **пароль** для бот-приложений на странице **Параметры** команды.

1. Прокрутите в нижней части формы и выберите **Сохранить изменения.**

При сгенерировании ID приложения и пароля следующий шаг — развертывание бота в Azure:

> [!div class="checklist"]
> * Выберите **кнопку Развертывание** в Azure и заполняйте форму с необходимой информацией, например, кодом приложения-бота, паролем для бот-приложений и секретом Moodle на странице **Параметры** команды. Сведения Azure на странице **Настройка).** 
> * После завершения формы выберите контрольный ящик, чтобы согласовать условия и условия.
> * Выберите **кнопку Покупка.** Все ресурсы Azure развернуты на бесплатном уровне.

После завершения развертывания ресурсов в Azure необходимо настроить плагин Moodle Microsoft 365 с конечной точкой обмена сообщениями. Вы должны получить конечную точку от бота в Azure:

**Настройка плагина Moodle Microsoft 365 с конечной точкой обмена сообщениями**  
1. Войдите на [портал Azure](https://portal.azure.com).

1. В левой области выберите группы **ресурсов** и выберите группу ресурсов, используемую или созданную при развертывании бота.

1. Выберите ресурс **WebApp Bot** из списка ресурсов в группе.

1. Скопируйте **конечную точку обмена** сообщениями из **раздела Обзор.**

1. В Moodle откройте **страницу Параметры** команды вашего плагина Moodle Microsoft 365.

1. В поле **Bot Endpoint** вклеить URL-адрес, который вы только что скопировали, и изменить слово *сообщения* на *веб-ок.* URL-адрес теперь должен отображаться следующим образом: `https://botname.azurewebsites.net/api/webhook`

1. Выберите **Сохранить изменения.**

1. После сохранения изменений перейдите на вкладку **Параметры** команды, выберите кнопку Файл манифеста загрузки и сохраните пакет манифеста приложения на компьютере для дальнейшего использования. 

## <a name="4-deploy-your-microsoft-teams-app"></a>4. Развертывание приложения Microsoft Teams

После развертывания бота в Azure и настройки для беседы с сервером Moodle необходимо развернуть приложение Microsoft Teams. Для этого необходимо загрузить файл манифеста приложения, скачаемый со страницы параметров команды Moodle Plugin Microsoft 365 на предыдущем шаге.

Перед установкой приложения необходимо убедиться, что необходимо включить внешние приложения и загрузить приложения. Для этого можно следовать шагам в командной подготовке [документации клиента Microsoft 365.](../concepts/build-and-test/prepare-your-o365-tenant.md) Для развертывания приложения можно выполнить следующие действия: 

**Развертывание приложения**

1. Откройте **Microsoft Teams.** 

1. Выберите **значок App** в нижней левой области панели навигации.

1. Выберите **ссылку Upload a custom app** из списка параметров.

   > [!NOTE]
   > Если вы вошли в систему в качестве глобального администратора, вы должны иметь возможность загрузить приложение в каталог приложений организации, в противном случае вы можете загрузить приложение только для команды, в которой вы член.

4. Выберите `manifest.zip` пакет, который вы скачали ранее, и выберите **Сохранить**. Если вы не скачали пакет манифеста приложения, вы можете скачать со вкладки **Параметры** команды страницы конфигурации плагина в Moodle.

Теперь, когда у вас установлено приложение, вы можете добавить вкладку в любой канал, к который у вас есть доступ. Для этого перейдите по каналу, выберите символ плюс **(➕)** и выберите приложение из списка. Следуйте подсказкам, чтобы завершить добавление вкладки Курс Moodle в канал.

## <a name="5-allow-automatic-creation-of-moodle-tabs-in-microsoft-teams"></a>5. Разрешить автоматическое создание вкладок Moodle в Microsoft Teams

Несмотря на то, что вкладки Moodle создаются вручную в Microsoft Teams, вы можете принять решение о том, чтобы они автоматически создавались при синхронизации курсов. Для этого необходимо настроить ID загруженного приложения Microsoft Teams в Moodle:

1. Откройте Microsoft Teams.

1. Выберите значок Apps из нижней левой области панели навигации.

1. Найдите загруженное приложение **Moodle➡** выберите значок **параметров** ➡ **ссылку копирования.**

1. В текстовом редакторе вклеить скопированные материалы. Он должен содержать URL-адрес, например ht&#8203;tps://teams.microsoft.com/l/app/00112233-4455-6677-8899-aabbccddeeff. Скопируйте последнюю часть URL-адреса, например , который является  `00112233-4455-6677-8899-aabbccddeeff` ID приложения Microsoft Teams.

1. В Moodle откройте вкладку **Приложения Teams Moodle** со страницы конфигурации 365-го мудл-плагина Microsoft 365.

1. Встроите ID приложения Microsoft Teams в поле ID приложения Moodle и сохраните изменения.

При синхронизации курса Moodle Microsoft Teams автоматически устанавливает приложение Moodle в команде, создает вкладку Moodle в общем канале Teams и настраивает ее, чтобы содержать страницу курса для курса Moodle, с которого оно синхронизировано. Теперь вы можете начать работать с курсами Moodle непосредственно из Microsoft Teams.

Чтобы поделиться с нами любыми запросами или отзывами о функциях, посетите страницу [голосовой связи пользователя.](https://microsoftteams.uservoice.com/forums/916759-moodle)

## <a name="see-also"></a>См. также

- [Интеграция веб-приложений](~/samples/integrate-web-apps-overview.md)

- [Moodle](https://moodle.org/)

- [Документация Moodle](https://docs.moodle.org/34/en/Installing_plugins).
