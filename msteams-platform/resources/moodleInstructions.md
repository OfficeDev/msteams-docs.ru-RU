---
title: Установка Moodle LMS
description: Установка и настройка приложения интеграции Moodle для Microsoft Teams
keywords: Teams Плагины интеграции приложений Moodle
ms.topic: how-to
localization_priority: Normal
ms.author: lajanuar
author: surbhigupta
ms.openlocfilehash: e5f33fa9146d0abb735e9f76aeaecea2dbdd230efe81251f9b7dcaf5700a907a
ms.sourcegitcommit: 3ab1cbec41b9783a7abba1e0870a67831282c3b5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2021
ms.locfileid: "57706008"
---
# <a name="install-moodle-lms"></a>Установка Moodle LMS

В этой статье вы узнаете, как установить Moodle LMS.

> [!NOTE]
> Чтобы помочь ИТ-администраторам легко настроить интеграцию Moodle и Teams, Microsoft 365 плагины Moodle обновляются для следующих версий:
>
> * Авторегистрация сервера Moodle с [помощью Azure Active Directory (Azure AD).](https://azure.microsoft.com/services/active-directory/)
>
> * Одним щелчком мыши развертывание бота помощника Moodle в Azure.
>
> * Автозапранение команд и автохронизация регистраций команд для всех или выбор курсов Moodle.
>
> * Автоматическая установка вкладки Moodle и бота помощника Moodle в каждую синхронизированную команду.
>
> Дополнительные данные о возможностях, которые предоставляет эта интеграция, см. в [Microsoft Teams и Moodle.](https://education.microsoft.com/resource/3dffb3a8)

## <a name="prerequisites"></a>Необходимые компоненты

Ниже следующую предпосылку для установки Moodle:

* Учетные данные администратора Moodle.

* Учетные данные администратора Azure AD.

* Подписка Azure, в которой можно создавать новые ресурсы.

## <a name="1-install-the-microsoft-365-moodle-plugins"></a>1. Установка Microsoft 365 плагинов Moodle

Интеграция Moodle Microsoft Teams в Microsoft Teams питания с открытым исходным кодом Microsoft 365 [плагинов Moodle](https://github.com/Microsoft/o365-moodle).

### <a name="requisite-applications-and-plugins"></a>Необходимые приложения и плагины

Убедитесь, что перед началом работы с установкой Microsoft 365 плагинов Moodle необходимо установить и скачать следующее:

1. Убедитесь, что [установить текущую стабильную версию Moodle](https://download.moodle.org/releases/latest/).

1. Скачайте и сохраните плагины Moodle [OpenID Подключение](https://moodle.org/plugins/auth_oidc) и [Microsoft 365 интеграции](https://moodle.org/plugins/local_o365) на локальном компьютере.

    > [!NOTE]
    > Установка плагинов OpenID Подключение и Microsoft 365 интеграции требуется для Teams интеграции.
    >
    > Кроме того, [рекомендуется использовать Microsoft 365 Teams темы.](https://moodle.org/plugins/theme_boost_o365teams)

### <a name="microsoft-365-moodle-plugins"></a>Microsoft 365 Плагины Moodle

1. Вопишитесь на сервер Moodle в  качестве администратора и выберите администрирование сайта из Параметры, расположенного в левой панели навигации. [](https://docs.moodle.org/22/en/Settings_block)

1. Выберите **вкладку Plugins,** а затем установите **плагины Install.**

1. В разделе **Установка плагинов из файла ZIP** выберите выберите **файл.**

1. Выберите **Upload** файл из левой панели навигации, просмотрите скачаный файл и **Upload файл**.

1. Выберите **администрирование сайта** из левой панели навигации, чтобы вернуться на панель мониторинга администрирования. Прокрутите вниз **к локальным плагинам** и **выберите ссылку Microsoft 365 интеграции.**

    > [!IMPORTANT]
    >
    > * Откройте страницу конфигурации Microsoft 365 Moodle Plugins на отдельной вкладке браузера, так как вам необходимо вернуться к этому набору страниц на протяжении всего процесса.  
    >
    > * Если у вас нет существующего сайта Moodle, перейдите в [Moodle на репо Azure](https://github.com/azure/moodle) и быстро разверните экземпляр Moodle и настройте его под ваши нужды.

## <a name="2-configure-the-connection-between-the-microsoft-365-plugins-and-azure-active-directory-azure-ad"></a>2. Настройка подключения между плагинами Microsoft 365 и Azure Active Directory (Azure AD)

Необходимо настроить подключение между плагинами Microsoft 365 Azure AD.

### <a name="requisites"></a>Реквизиты

Зарегистрируйте Moodle в качестве приложения в Azure AD с помощью сценария PowerShell. Сценарий Powershell содержит следующее:

* Новое приложение Azure AD для Microsoft 365 клиента, которое используется Microsoft 365 Плагины Moodle.
* Приложение для клиента Microsoft 365, настройка URL-адресов и разрешений на необходимый ответ для предварительного приложения, а также `AppID` возвращает и `Key` .

Используйте созданную и на Microsoft 365 страницу настройки плагинов Moodle для настройки сайта сервера `AppID` `Key` Moodle с помощью Azure AD.

> [!IMPORTANT]
>
> * Сценарий PowerShell не обновляется с последними элементами конфигурации, поэтому необходимо выполнить конфигурацию вручную после действий, описанных на страницах выпуска Moodle [3.8.0.4 и 3.9.1](https://docs.moodle.org/39/en/Office365#3.8.0.4_and_3.9.1_release) и [3.8.0.5 и 3.9.2.](https://docs.moodle.org/39/en/Office365#3.8.0.5_and_3.9.2_release)
>
> * Дополнительные сведения о регистрации экземпляра Moodle вручную см. в статью Регистрация экземпляра [Moodle в качестве приложения.](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application)

### <a name="the-moodle-tab-for-microsoft-teams-information-flow"></a>Вкладка Moodle для Microsoft Teams потока информации

<img width="530px" src="../assets/images/MoodleTabInformationFlow.png" alt="Moodle tab for Microsoft Teams information flow" />

1. На странице Microsoft 365 интеграции выберите вкладку **Setup.**

1. Выберите **кнопку Download PowerShell Script** и сохраните ее в качестве папки ZIP на локальном компьютере.

1. Подготовка сценария PowerShell из файла ZIP следующим образом: 

    1. Скачайте и извлекайте `Moodle-AzureAD-Powershell.zip` файл.
    1. Откройте извлеченную папку.
    1. Щелкните правой кнопкой мыши `Moodle-AzureAD-Script.ps1` по файлу и выберите **Свойства**.
    1. На **вкладке General** в окне Свойства выберите почтовый ящик рядом с атрибутом Security, расположенным в `Unblock` нижней части окна. 
    1. Нажмите **ОК**.
    1. Скопируйте путь каталога в извлеченную папку.

1. Запустите PowerShell в качестве администратора:

    1. Выберите «Начать».
    1. Тип PowerShell.
    1. Щелкните правой **кнопкой мыши Windows PowerShell**.
    1. Выберите **Выполнить в качестве администратора.**

1. Перейдите к unzipped каталогу, введя в текст `cd .../.../Moodle-AzureAD-Powershell` `.../...` путь к каталогу.

1. Выполните сценарий PowerShell:

    1. Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser` .
    1. Введите `./Moodle-AzureAD-Script.ps1` .
    1. Вопишитесь в Microsoft 365 учетную запись администратора в всплывающее окно.
    1. Введите имя приложения Azure AD, например, плагинов Moodle или Moodle.
    1. Введите URL-адрес сервера Moodle.
    1. **Скопируйте ID приложения `AppID` ()** и **ключ `Key` приложения(),** созданный скриптом, и сохраните их.

1. Далее необходимо добавить и добавить в Microsoft 365 `AppID` `Key` плагины Moodle. Возвращайся на страницу администрирования плагинов, администрирование > плагинов > Microsoft 365 интеграции.

1. На **вкладке Установка** добавьте скопированную ранее и выберите `AppID` сохранить `Key` **изменения.** После обновления страницы можно увидеть новый раздел **Выбор метода подключения.**

1. В **методе Выбор подключения** выберите почтовый ящик с меткой **По** умолчанию, а затем снова выберите **Сохранить изменения.**

1. После обновления страницы вы можете увидеть еще один новый раздел **Согласие администратора & дополнительные сведения**.
    1. Выберите **ссылку Предоставление** согласия администратора, введите Microsoft 365  учетные данные глобального администратора, а затем примите решение о предоставлении разрешений.
    1. Рядом с **полем Клиент Azure AD выберите** кнопку **Обнаружение.**
    1. Рядом с **URL-адресом OneDrive для бизнеса** выберите кнопку **Обнаружение.**
    1. После заполнения полей снова выберите кнопку **Сохранить изменения.**

1. Выберите **кнопку Обновление** для проверки установки, а затем выберите **сохранить изменения.**

1. Синхронизация пользователей между сервером Moodle и Azure AD. Для начала сделайте следующее:

    > [!NOTE]
    > В зависимости от среды можно выбрать различные параметры на этом этапе.

1. Синхронизация пользователей между сервером Moodle и Azure AD. В зависимости от среды можно выбрать различные параметры на этом этапе. Для начала сделайте следующее:
    1. Переключиться на **вкладку Sync Параметры .**

    1. В разделе **Синхронизация пользователей с azure AD** выберите почтовые ящики, применимые к вашей среде. Необходимо выбрать следующее:  

        ✔ создать учетные записи в Moodle для пользователей Azure AD.

        ✔ обновления всех учетных записей в Moodle для пользователей Azure AD.

    1. В разделе **Ограничение создания** пользователей можно настроить фильтр, чтобы ограничить пользователей Azure AD, синхронизированных с Moodle.
    1. Раздел **Сопоставление полей** пользователя позволяет настроить отображение поля Azure AD для сопоставления профилей пользователей Moodle.
    1. В разделе **Teams Синхронизация** можно выбрать для автоматического создания групп, например групп для некоторых или всех существующих курсов Moodle.

13. Чтобы проверить [задания cron](https://docs.moodle.org/310/en/Cron) и выполнить их вручную  для первого запуска, выберите ссылку на страницу управления запланированными задачами в разделе Синхронизация пользователей **с azure AD.** В этом случае вы **перенабирались на страницу Запланированные** задачи.

    1. Прокрутите вниз и найдите пользователей **Sync с заданием Azure AD** и выберите **Выполнить сейчас.**
    1. Если вы выберете для создания групп на основе существующих курсов, вы также можете запустить группы пользователей **в Microsoft 365** задания.

    > [!NOTE]
    >
    > Cron [](https://docs.moodle.org/310/en/Cron) Moodle выполняется в соответствии с расписанием задач. Расписание по умолчанию — один раз в день. Тем не менее, крона должна работать чаще, чтобы сохранить все в синхронизации.

1. Вернись на страницу администрирования плагинов, администрирование **> плагинов**> Microsoft 365 интеграции и выберите **Teams Параметры** страницу.

1. На **Teams Параметры** настроить необходимые параметры, чтобы включить интеграцию Teams приложения.

    1. Чтобы включить **openID Подключение,** выберите ссылку **Управление** проверкой подлинности и выберите значок глаза в строке **OpenId Подключение,** если она серым цветом.
    1. Чтобы включить встраив кадр, выберите **ссылку HTTP Security,** а затем выберите почтовый ящик рядом с разрешить встраивку **кадров.**
    1. Чтобы включить веб-службы, которые позволяют функции API Moodle, выберите ссылку **Расширенные** функции, а затем убедитесь, что рядом с почтовым ящиком Включить веб-службы выбраны. 
    1. Чтобы включить внешние службы для Microsoft 365, выберите ссылку **Внешние** службы, а затем:  

        ✔ **Выберите изменение** в строке **Moodle Microsoft 365 Webservices.**

        ✔ выберите контрольный ящик рядом с **включенной,** а затем выберите **Сохранить изменения**

    1. Отредактировать разрешения пользователя, проверку подлинности, чтобы разрешить им создавать маркеры веб-службы.

        ✔ выберите ссылку пользователя **на роль** редактирования.

        ✔ прокрутите вниз и найдите возможность **создания** маркера веб-службы и выберите контрольный ящик **Разрешить.**

## <a name="3-deploy-the-moodle-assistant-bot-to-azure"></a>3. Развертывание бота помощника Moodle в Azure

Бесплатный бот помощника Moodle для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о своих курсах, заданиях, оценках и других сведениях в Moodle. Бот также отправляет уведомления Moodle учащимся и преподавателям в Teams. Бот — это проект с открытым исходным кодом, поддерживаемый Корпорацией Майкрософт, и доступен в [GitHub.](https://github.com/microsoft/Moodle-Teams-Bot)

> [!NOTE]
>
> * Развертывание ресурсов в подписке Azure. Все ресурсы были настроены с помощью **бесплатного уровня.** В зависимости от использования бота может потребоваться масштабировать эти ресурсы.
>
> * Чтобы использовать вкладку Moodle без бота, пропустите [4](#4-deploy-your-microsoft-teams-app).

### <a name="moodle-bot-information-flow"></a>Поток информации о боте Moodle

<img width="530px" src="../assets/images/MoodleBotInformationFlow.png" alt="Moodle bot for Microsoft Teams information flow" />

Чтобы установить бот, необходимо зарегистрировать его на [платформе удостоверений Майкрософт.](https://identity.microsoft.com/Landing) Это позволяет боту проверить подлинность в конечных точках Майкрософт. 

**Регистрация бота**

1. Перейдите на страницу администрирования плагинов и выберите **плагины.** В **Microsoft 365 интеграции** выберите **вкладку Teams Параметры.**

1. Выберите **ссылку портала регистрации приложений** Майкрософт и вопишитесь в свой Microsoft ID.

1. Введите имя приложения, например MoodleBot, и выберите кнопку **Создать.**

1. **Скопируйте ID приложения и** вклеите его в поле **Бот-приложение на** странице **Параметры.**

1. Выберите **кнопку Создание нового пароля.** Скопируйте созданный пароль и вклейте его в поле **Пароль** для бота на странице **Параметры.**

1. Прокрутите в нижней части формы и выберите **Сохранить изменения.**

После создания имени приложения и пароля разверните бот в Azure:

> [!div class="checklist"]
> * Выберите **Развертывание в Azure** и заполняйте форму необходимой информацией, например кодом приложения-бота, паролем для бот-приложений и секретом Moodle **на** Teams Параметры странице. Сведения Azure на странице **Настройка.** 
> * После завершения формы выберите почтовый ящик, чтобы согласовать условия и условия.
> * Выберите **покупку**. Все ресурсы Azure развернуты на бесплатном уровне.

После завершения развертывания ресурсов в Azure необходимо настроить плагины Microsoft 365 Moodle с конечной точкой обмена сообщениями. Вы должны получить конечную точку от бота в Azure:

1. Войдите на [портал Azure](https://portal.azure.com).

1. В левой области выберите группы **ресурсов** и выберите группу ресурсов, используемую или созданную при развертывании бота.

1. Выберите ресурс **WebApp Bot** из списка ресурсов в группе.

1. Скопируйте **конечную точку обмена** сообщениями из **раздела Обзор.**

1. В Moodle откройте страницу **командной Параметры** вашего Microsoft 365 Плагины Moodle.

1. В поле **Bot Endpoint** вклеить URL-адрес, который вы только что скопировали, и изменить слово *сообщения* на *веб-ок.* URL-адрес должен отображаться следующим образом: `https://botname.azurewebsites.net/api/webhook`

1. Нажмите кнопку **Сохранить изменения**.

1. После сохранения изменений  **перейдите на вкладку Team Параметры,** выберите кнопку Файл манифеста загрузки и сохраните пакет манифеста приложения на компьютере для дальнейшего использования.

## <a name="4-deploy-your-microsoft-teams-app"></a>4. Развертывание Microsoft Teams приложения

После развертывания бота в Azure и настройки для беседы с сервером Moodle необходимо развернуть Microsoft Teams приложение. Для этого необходимо загрузить файл манифеста приложения, скачаемый с Microsoft 365 команды плагинов Moodle Параметры на предыдущем шаге.

Перед установкой приложения необходимо убедиться, что необходимо включить внешние приложения и загрузить приложения. Дополнительные сведения см. в [Microsoft 365 клиента.](../concepts/build-and-test/prepare-your-o365-tenant.md) 

**Развертывание приложения** 

1. Откройте **Microsoft Teams**. 

1. Выберите **значок App** в нижней левой области панели навигации.

1. Выберите **ссылку Upload приложения** из списка параметров.

   > [!NOTE]
   > Если вы вошли в систему в качестве глобального администратора, вы должны иметь возможность загрузить приложение в каталог приложений организации, в противном случае вы можете загрузить приложение только для команды, в которой вы член.

4. Выберите `manifest.zip` пакет, который вы скачали ранее, и выберите **Сохранить**. Если вы не скачали пакет манифеста приложения, вы можете скачать с вкладки **Team Параметры** страницы конфигурации плагинов в Moodle.

Теперь, когда у вас установлено приложение, вы можете добавить вкладку в любой канал, к который у вас есть доступ. Для этого перейдите по каналу, выберите символ плюс **(➕)** и выберите приложение из списка. Следуйте подсказкам, чтобы завершить добавление вкладки Курс Moodle в канал.

## <a name="5-allow-automatic-creation-of-moodle-tabs-in-microsoft-teams"></a>5. Разрешить автоматическое создание вкладок Moodle в Microsoft Teams

Несмотря на то, что вкладки Moodle создаются вручную в Microsoft Teams, их можно создать автоматически при создании команд из синхронизации курсов. Для этого необходимо настроить ID загруженного Microsoft Teams в Moodle.

**Автоматическое создание вкладок Moodle**

1. Откройте Microsoft Teams.

1. Выберите значок Apps из нижней левой области панели навигации.

1. Найдите загруженное приложение **Moodle>** выберите значок **параметров** > **ссылку копирования.**

1. В текстовом редакторе вклеить скопированные материалы. Он должен содержать URL-адрес, например ht&#8203;tps://teams.microsoft.com/l/app/00112233-4455-6677-8899-aabbccddeeff. Скопируйте последнюю часть URL-адреса, например , который является `00112233-4455-6677-8899-aabbccddeeff` ID Microsoft Teams приложения.

1. В Moodle откройте **вкладку Teams Moodle** на странице конфигурации Microsoft 365 Moodle Plugins.

1. Встроите ID приложения Microsoft Teams в поле ID приложения Moodle и сохраните изменения.

При синхронизации курса Moodle Microsoft Teams автоматически устанавливает приложение Moodle в команде, создает вкладку Moodle в общем канале Teams и настраивает ее, чтобы содержать страницу курса для курса Moodle, с которого оно синхронизировано. Теперь вы можете начать работать с курсами Moodle непосредственно с Microsoft Teams.

> [!NOTE]
> Чтобы поделиться с нами любыми запросами или отзывами о функциях, посетите страницу [голосовой связи пользователя.](https://microsoftteams.uservoice.com/forums/916759-moodle)

## <a name="see-also"></a>См. также

- [Интеграция веб-приложений](~/samples/integrate-web-apps-overview.md)
- [Moodle](https://moodle.org/)
- [Документация Moodle](https://docs.moodle.org/34/en/Installing_plugins).

