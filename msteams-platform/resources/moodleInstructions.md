---
title: Установка Moodle LMS
description: Из этой статьи вы узнаете, как установить и настроить приложение интеграции Moodle для Microsoft Teams.
ms.topic: how-to
ms.localizationpriority: medium
ms.author: lajanuar
author: surbhigupta
ms.openlocfilehash: 83a4b4d40ebca418b62dcac5f94f77ac30ee85d7
ms.sourcegitcommit: 904cca011c3f27d1d90ddd80c3d0300a8918e412
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2022
ms.locfileid: "66895505"
---
# <a name="install-moodle-lms"></a>Установка Moodle LMS

Из этой статьи вы узнаете, как установить Moodle LMS.

> [!NOTE]
> Чтобы помочь ИТ-администраторам легко настроить интеграцию Moodle и Teams, подключаемые модули Microsoft 365 Moodle с открытым кодом обновляются для следующих компонентов:
>
> * Автоматическая регистрация сервера Moodle с помощью Microsoft Azure Active Directory [(Azure AD)](https://azure.microsoft.com/services/active-directory/).
>
> * Развертывание бота Помощника по Moodle одним щелчком в Azure.
>
> * Автоматическая подготовка команд и автоматическая синхронизация регистраций для всех или выбранных курсов Moodle.
>
> * Автоматическая установка вкладки Moodle и бота помощника Moodle в каждой синхронизированной команде.
>
> Дополнительные сведения о функциях, которые предоставляет эта интеграция, см. в [Microsoft Teams и Moodle](https://education.microsoft.com/resource/3dffb3a8).

## <a name="prerequisites"></a>Предварительные требования

Ниже приведены предварительные требования для установки Moodle:

* Учетные данные администратора Moodle.

* Azure AD учетные данные администратора.

* Подписка Azure, в которой можно создавать новые ресурсы.

## <a name="1-install-the-microsoft-365-moodle-plugins"></a>1. Установка подключаемых модулей Microsoft 365 Moodle

Интеграция Moodle в Microsoft Teams выполняется на основе Open Source [подключаемых модулей Microsoft 365 Moodle](https://moodle.org/plugins/browse.php?list=set&id=72).

### <a name="requisite-applications-and-plugins"></a>Необходимые приложения и подключаемые модули

Прежде чем продолжить установку подключаемых модулей Moodle для Microsoft 365, установите и скачайте следующую команду:

1. Убедитесь, что [установлена текущая стабильная версия Moodle](https://download.moodle.org/releases/latest/).

1. Скачайте и сохраните подключаемые модули Moodle [OpenID Connect](https://moodle.org/plugins/auth_oidc) и [Microsoft 365 Integration](https://moodle.org/plugins/local_o365) на локальном компьютере.

    > [!NOTE]
    > Установка подключаемых модулей OpenID Connect и Интеграция Microsoft 365 необходима для интеграции Teams.
    >
    > Кроме того, настоятельно рекомендуется использовать подключаемый модуль [темы Microsoft 365 Teams](https://moodle.org/plugins/theme_boost_o365teams) .

### <a name="microsoft-365-moodle-plugins"></a>Подключаемые модули Moodle для Microsoft 365

1. Скачайте подключаемые модули, извлеките их и отправьте в соответствующие папки. Например, извлеките подключаемый модуль OpenID Connect (auth_oidc) в папку с именем **oidc** и отправьте его в папку проверки  подлинности корневого каталога документа Moodle. 

1. Войдите на сервер Moodle с правами администратора и выберите " **Администрирование сайта"**.

1. После обнаружения новых подключаемых модулей, которые необходимо установить, Moodle должен перенаправить вас на страницу установки новых подключаемых модулей. Если этого не происходит, на странице администрирования сайта выберите "Уведомления"  на вкладке "Общие", что должно активировать установку подключаемых модулей.

1. После установки подключаемых модулей перейдите на вкладку **"** Подключаемые модули" на странице администратора  сайта, выберите ссылку на раздел проверки подлинности и **включите OpenID Connect**. Конфигурацию подключаемого модуля можно оставить пустой — они будут заполнены позже.

1. На странице **администратора сайта** прокрутите вниз до раздела **"** Локальные подключаемые модули" и выберите ссылку **"Интеграция Microsoft 365** ".

    > [!IMPORTANT]
    >
    > * Не закрывайте страницу конфигурации подключаемых модулей Microsoft 365 Moodle на отдельной вкладке браузера, так как вам нужно вернуться к этому набору страниц на протяжении всего процесса.  
    >
    > * Если у вас нет сайта Moodle, перейдите в репозиторий [Moodle в Azure](https://github.com/azure/moodle) и быстро разверните экземпляр Moodle и настройте его в зависимости от ваших потребностей.

## <a name="2-configure-the-connection-between-the-microsoft-365-plugins-and-azure-ad"></a>2. Настройте подключение между подключаемыми модулями Microsoft 365 и Azure AD

Необходимо настроить подключение между подключаемыми модулями Microsoft 365 и Azure AD.

### <a name="requisites"></a>Реквизиты

Зарегистрируйте Moodle в качестве приложения в Azure AD с помощью скрипта PowerShell. Сценарий подготавливает следующие параметров:

* Новое Azure AD приложения для клиента Microsoft 365, которое используется подключаемыми модулями Microsoft 365 Moodle.
* Приложение для клиента Microsoft 365, настройка требуемых URL-адресов ответа и разрешений для подготовленного приложения, `AppID` а также возвращает и `Key`.

Используйте созданный и `AppID` `Key` на странице настройки подключаемых модулей Moodle для Microsoft 365, чтобы настроить сайт сервера Moodle с Azure AD.

> [!IMPORTANT]
>
> * Дополнительные сведения о регистрации экземпляра Moodle вручную см. в разделе "Регистрация экземпляра [Moodle в качестве приложения"](https://docs.moodle.org/400/en/Microsoft_365#Azure_App_Creation_and_Configuration).

### <a name="the-moodle-tab-for-microsoft-teams-information-flow"></a>Поток сведений на вкладке Moodle для Microsoft Teams

<img width="530px" src="../assets/images/MoodleTabInformationFlow.png" alt="Moodle tab for Microsoft Teams information flow" />

1. На странице подключаемых модулей интеграции Microsoft 365 выберите вкладку **"Настройка** ".

1. Нажмите **кнопку "Скачать сценарий PowerShell** " и сохраните его как ZIP-папку на локальном компьютере.

1. Подготовьте скрипт PowerShell из ZIP-файла следующим образом:

    1. Скачайте и извлеките `Moodle-AzureAD-Powershell.zip` файл.
    1. Откройте извлеченную папку.
    1. Щелкните файл правой кнопкой `Moodle-AzureAD-Script.ps1` мыши и выберите **пункт "Свойства"**.
    1. На **вкладке "** Общие" `Unblock` okno Vlastnosti установите флажок рядом с атрибутом **Security**, расположенным в нижней части окна.
    1. Нажмите кнопку **ОК**.
    1. Скопируйте путь к каталогу в извлеченную папку.

1. Запустите PowerShell от имени администратора:

    1. Выберите «Начать».
    1. Введите PowerShell.
    1. Щелкните правой кнопкой мыши **Windows PowerShell**.
    1. Выберите **"Запуск от имени администратора"**.

1. Перейдите в распакованный каталог `cd .../.../Moodle-AzureAD-Powershell` `.../...` , введя путь к каталогу.

1. Выполните скрипт PowerShell:

    1. Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.
    1. Введите `./Moodle-AzureAD-Script.ps1`.
    1. Во всплывающем окне войдите в учетную запись администратора Microsoft 365.
    1. Введите имя приложения Azure AD, например подключаемые модули Moodle или Moodle.
    1. Введите URL-адрес сервера Moodle.
    1. **Скопируйте идентификатор приложения (`AppID`)** и **ключ приложения(`Key`),** созданные скриптом, и сохраните их.

1. Далее необходимо добавить подключаемые `AppID` модули `Key` Moodle для Microsoft 365 и в них. Вернитесь на страницу администрирования подключаемых модулей, > подключаемых модулей > Интеграция Microsoft 365.

1. На **вкладке "** Настройка" добавьте скопированный `AppID` `Key` ранее файл и нажмите кнопку " **Сохранить изменения"**. После обновления страницы вы увидите новый раздел **"Выбор метода подключения"**.

1. В **методе "Выбор подключения" установите** флажок "По **умолчанию",** а затем снова нажмите кнопку **"Сохранить изменения** ".

1. После обновления страницы вы увидите другой новый раздел, Администратор **предоставить & дополнительные сведения**.
    1. Выберите **ссылку "Администратор согласия**", введите учетные данные глобального администратора Microsoft 365, а затем примите условия предоставления разрешений.
    1. Рядом с **полем Azure AD клиента** нажмите кнопку **"Обнаружить**".
    1. Рядом с **URL-адресом OneDrive для бизнеса** нажмите кнопку **"Обнаружить**".
    1. После заполнения полей снова нажмите кнопку **"Сохранить изменения** ".

1. Нажмите **кнопку "** Обновить", чтобы проверить установку, а затем нажмите кнопку **"Сохранить изменения"**.

1. Синхронизация пользователей между сервером Moodle и Azure AD. Для начала сделайте следующее:

    > [!NOTE]
    > В зависимости от среды на этом этапе можно выбрать различные параметры.

    1. Перейдите на **вкладку "Параметры синхронизации"**.

    1. В разделе **"** Синхронизация пользователей Azure AD" установите флажки, которые применяются к вашей среде. Необходимо выбрать следующее:  

        ✔ Создание учетных записей в Moodle для пользователей в Azure AD.

        ✔ Обновите все учетные записи в Moodle для пользователей в Azure AD.

    1. В разделе **"Ограничения на** создание пользователей" можно настроить фильтр, чтобы ограничить количество Azure AD пользователей, синхронизированных с Moodle.

1. Чтобы проверить [задания cron](https://docs.moodle.org/400/en/Cron) и запустить их вручную для первого запуска, выберите ссылку  на страницу управления запланированными задачами в разделе "Синхронизация пользователей **Azure AD**". Откроется страница **"Запланированные задачи** ".

    1. Прокрутите вниз и найдите пользователей **синхронизации с Azure AD** и нажмите кнопку **"Запустить сейчас"**.
    1. Если вы выберете создание групп на основе существующих курсов, можно также запустить задание "Создание групп пользователей **" в задании Microsoft 365** .

    > [!NOTE]
    >
    > Moodle [Cron](https://docs.moodle.org/310/en/Cron) выполняется в соответствии с расписанием задач. Расписание по умолчанию — один раз в день. Однако cron должен выполняться чаще, чтобы синхронизировать все данные.

1. Вернитесь на страницу администрирования подключаемых модулей, > подключаемых модулей > **Microsoft 365 Integration** и выберите страницу **параметров Teams** .

1. На странице параметров **Teams** настройте необходимые параметры, чтобы включить интеграцию приложений Teams, щелкнув ссылку "Параметры **Check Moodle** ", чтобы обновить все необходимые конфигурации для работы интеграции Teams. 

## <a name="3-deploy-the-moodle-assistant-bot-to-azure"></a>3. Развертывание бота Помощника по Moodle в Azure

Бесплатный бот помощника Moodle для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о курсах, заданиях, оценках и других сведениях в Moodle. Бот также отправляет уведомления Moodle учащимся и преподавателям в Teams. Бот — это проект с открытым кодом, поддерживаемый корпорацией Майкрософт и доступный на [сайте GitHub](https://github.com/microsoft/Moodle-Teams-Bot).

> [!NOTE]
>
> * Развертывание ресурсов в подписке Azure. Все ресурсы были настроены на уровне **"Бесплатный** ". В зависимости от использования бота может потребоваться масштабировать эти ресурсы.
>
> * Чтобы использовать вкладку Moodle без бота, перейдите к [значению 4](#4-deploy-your-microsoft-teams-app).

### <a name="moodle-bot-information-flow"></a>Поток сведений о боте Moodle

<img width="530px" src="../assets/images/MoodleBotInformationFlow.png" alt="Moodle bot for Microsoft Teams information flow" />

Чтобы установить бот, необходимо зарегистрировать его на платформе [удостоверений Майкрософт](https://identity.microsoft.com/Landing). Это позволяет боту выполнять проверку подлинности в конечных точках Майкрософт.

Чтобы зарегистрировать бота:

1. Перейдите на страницу администрирования подключаемых модулей и выберите **"Подключаемые модули"**. В **разделе "Интеграция с Microsoft 365**" выберите вкладку **"Параметры Teams** ".

1. Щелкните **ссылку на портал регистрации приложений Майкрософт** и выполните вход с помощью идентификатора Майкрософт.

1. Введите имя приложения, например MoodleBot, и нажмите кнопку **"Создать** ".

1. **Скопируйте идентификатор приложения** и вставьте его в поле "Идентификатор приложения **бота**" на странице **"Параметры команды**".

1. Нажмите **кнопку "Создать пароль** ". Скопируйте созданный пароль и вставьте его  в поле "Пароль приложения бота" на странице **"Параметры команды**".

1. Прокрутите страницу до нижней части формы и выберите **команду "Сохранить изменения"**.

После создания идентификатора приложения и пароля разверните бот в Azure:

> [!div class="checklist"]
>
> * Выберите **"Развернуть в Azure"** и заполните форму необходимыми сведениями, такими как идентификатор приложения бота, пароль приложения бота и секрет Moodle на странице параметров **Teams** . Сведения об Azure см. на **странице "Настройка** ".
> * После заполнения формы установите флажок, чтобы принять условия.
> * Выберите **"Приобрести"**. Все ресурсы Azure развертываются на бесплатном уровне.

После завершения развертывания ресурсов в Azure необходимо настроить подключаемые модули Microsoft 365 Moodle с конечной точкой обмена сообщениями. Вы должны получить конечную точку из бота в Azure:

1. Войдите на [портал Microsoft Azure](https://portal.azure.com).

1. В области слева выберите группы ресурсов и  группу ресурсов, которую вы использовали или создали, при развертывании бота.

1. Выберите ресурс **WebApp Bot** из списка ресурсов в группе.

1. **Скопируйте конечную точку обмена** сообщениями из **раздела "Обзор**".

1. В Moodle **откройте страницу** параметров команды подключаемых модулей Microsoft 365 Moodle.

1. В поле **"Конечная точка** бота" вставьте скопированный URL-адрес  и измените текст сообщения на *веб-перехватчик*. URL-адрес должен выглядеть следующим образом: `https://botname.azurewebsites.net/api/webhook`

1. Нажмите кнопку **Сохранить изменения**.

1. После сохранения изменений вернитесь на вкладку **"** Параметры команды", нажмите  кнопку "Скачать файл манифеста" и сохраните пакет манифеста приложения на компьютере для дальнейшего использования.

## <a name="4-deploy-your-microsoft-teams-app"></a>4. Развертывание приложения Microsoft Teams

После развертывания бота в Azure и настройки взаимодействия с сервером Moodle необходимо развернуть приложение Microsoft Teams. Для этого необходимо загрузить файл манифеста приложения, скачанный со страницы параметров группы подключаемых модулей Moodle для Microsoft 365 на предыдущем шаге.

Перед установкой приложения необходимо обеспечить включение внешних приложений и их отправку. Дополнительные сведения см. [в разделе "Подготовка клиента Microsoft 365"](../concepts/build-and-test/prepare-your-o365-tenant.md).

Чтобы развернуть приложение, выполните следующее.

1. Откройте **Microsoft Teams**.

1. Щелкните **значок** "Приложения" в нижней левой области панели навигации.

1. Выберите **ссылку "Управление приложениями** " в меню навигации.

1. Нажмите **кнопку "Опубликовать приложение** " и выберите "Отправить приложение **в каталог приложений вашей организации"**.

   > [!NOTE]
   > Если вы вошли в систему от имени глобального администратора, у вас должен быть возможность отправить приложение в каталог приложений вашей организации. В противном случае вы можете загрузить приложение только для команды, в которой вы входите.

4. Выберите пакет `manifest.zip` , скачанный ранее, и нажмите кнопку **"Сохранить"**. Если вы не скачали пакет манифеста приложения, его можно скачать на вкладке **"** Параметры команды" на странице конфигурации подключаемых модулей в Moodle.

Теперь, когда приложение установлено, вы можете добавить вкладку в любой канал, к котором у вас есть доступ. Для этого перейдите к каналу, выберите символ **плюса** (➕) и выберите приложение из списка. Следуйте инструкциям, чтобы завершить добавление вкладки курса Moodle в канал.

## <a name="5-allow-automatic-creation-of-moodle-tabs-in-microsoft-teams"></a>5. Разрешить автоматическое создание вкладок Moodle в Microsoft Teams

Хотя вкладки Moodle создаются вручную в Microsoft Teams, их можно создать автоматически при создании команд на основе синхронизации курсов. Для этого необходимо настроить идентификатор отправленного приложения Microsoft Teams в Moodle.

Чтобы разрешить автоматическое создание вкладок Moodle:

1. В Moodle откройте вкладку **приложения Teams Moodle** на странице конфигурации подключаемых модулей Moodle для Microsoft 365.

1. Если приложение Azure имеет рекомендуемое разрешение, для параметра **идентификатора приложения Moodle** оно должно отобразить автоматически обнаруженное **значение,** скопируйте это значение в параметр.

1. Если автоматически обнаруженное значение отсутствует, следуйте инструкциям на странице, чтобы найти идентификатор приложения Moodle и указать параметр.

При синхронизации курса Moodle Teams автоматически устанавливает приложение Moodle в команде, создает вкладку Moodle в канале "Общие" Teams и настраивает его для хранения страницы курса Moodle, из которого оно синхронизируется. Теперь вы можете приступить к работе с курсами Moodle непосредственно из Teams.

> [!NOTE]
> Чтобы поделиться с нами любыми запросами функций или отзывами, посетите нашу страницу [user Voice](https://support.microsoft.com/en-us/office/uservoice-pages-430e1a78-e016-472a-a10f-dc2a3df3450a).

## <a name="see-also"></a>Дополнительные ресурсы

* [Интеграция веб-приложений](~/samples/integrate-web-apps-overview.md)
* [Moodle](https://moodle.org/)
* [Документация по Moodle](https://docs.moodle.org/400/en/Installing_plugins)
* [Страница интеграции Microsoft 365 и Moodle в документации по Moodle](https://docs.moodle.org/400/en/Microsoft_365)
