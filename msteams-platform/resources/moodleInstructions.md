---
title: Установка Moodle LMS
description: Установка и настройка приложения интеграции Moodle для Microsoft Teams
keywords: Teams подключаемых модулей интеграции приложений Moodle
ms.topic: how-to
ms.localizationpriority: medium
ms.author: lajanuar
author: surbhigupta
ms.openlocfilehash: b5e023041ad732c7580b8b01cd62bc7159a52887
ms.sourcegitcommit: 12510f34b00bfdd0b0e92d35c8dbe6ea1f6f0be2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2022
ms.locfileid: "66033059"
---
# <a name="install-moodle-lms"></a>Установка Moodle LMS

Из этой статьи вы узнаете, как установить Moodle LMS.

> [!NOTE]
> Чтобы помочь ИТ-администраторам легко настроить интеграцию Moodle и Teams, подключаемые модули Moodle Microsoft 365 с открытым кодом обновляются для следующих компонентов:
>
> * Автоматическая регистрация сервера Moodle с помощью Microsoft Azure Active Directory [(Azure AD)](https://azure.microsoft.com/services/active-directory/).
>
> * Развертывание бота Помощника по Moodle одним щелчком в Azure.
>
> * Автоматическая подготовка команд и автоматическая синхронизация регистраций для всех или выбранных курсов Moodle.
>
> * Автоматическая установка вкладки Moodle и бота помощника Moodle в каждой синхронизированной команде.
>
> Дополнительные сведения о функциях, которые предоставляет эта интеграция, см. в Microsoft Teams [Moodle](https://education.microsoft.com/resource/3dffb3a8).

## <a name="prerequisites"></a>Предварительные требования

Ниже приведены предварительные требования для установки Moodle:

* Учетные данные администратора Moodle.

* Azure AD учетные данные администратора.

* Подписка Azure, в которой можно создавать новые ресурсы.

## <a name="1-install-the-microsoft-365-moodle-plugins"></a>1. Установка подключаемых модулей Microsoft 365 Moodle

Интеграция Moodle в Microsoft Teams на основе набора подключаемых модулей открытый код [Microsoft 365 Moodle](https://github.com/Microsoft/o365-moodle).

### <a name="requisite-applications-and-plugins"></a>Необходимые приложения и подключаемые модули

Прежде чем продолжить установку подключаемых модулей Microsoft 365 Moodle, установите и скачайте следующую команду:

1. Убедитесь, что [установлена текущая стабильная версия Moodle](https://download.moodle.org/releases/latest/).

1. Скачайте и сохраните файлы Moodle [OpenID Подключение](https://moodle.org/plugins/auth_oidc) и [подключаемые модули Microsoft 365 Integration](https://moodle.org/plugins/local_o365) на локальном компьютере.

    > [!NOTE]
    > Для интеграции Подключение и Microsoft 365 интеграции необходимо установить Teams OpenID.
    >
    > Кроме того, [настоятельно Microsoft 365 Teams подключаемые](https://moodle.org/plugins/theme_boost_o365teams) модули темы.

### <a name="microsoft-365-moodle-plugins"></a>Microsoft 365 Подключаемые модули Moodle

1. Войдите на сервер Moodle с правами администратора и  выберите "Администрирование сайта["](https://docs.moodle.org/22/en/Settings_block) Параметры, расположенном на панели навигации слева.

1. Перейдите на **вкладку "Подключаемые** модули", а затем **выберите "Установить подключаемые модули"**.

1. В разделе **"Установка подключаемых модулей из ZIP-файла** " выберите **"Выбрать файл"**.

1. Выберите **параметр "Отправить файл** " на панели навигации слева, найдите скачанный файл и выберите **"Отправить этот файл"**.

1. Выберите **"Администрирование сайта** " на панели навигации слева, чтобы вернуться на панель мониторинга администратора. Прокрутите вниз до **локальных подключаемых** модулей и выберите **ссылку Microsoft 365 интеграции**.

    > [!IMPORTANT]
    >
    > * Не закрывайте Microsoft 365 настройки подключаемых модулей Moodle на отдельной вкладке браузера, так как вам нужно вернуться к этому набору страниц на протяжении всего процесса.  
    >
    > * Если у вас нет сайта Moodle, перейдите в репозиторий [Moodle в Azure](https://github.com/azure/moodle) и быстро разверните экземпляр Moodle и настройте его в зависимости от ваших потребностей.

## <a name="2-configure-the-connection-between-the-microsoft-365-plugins-and-azure-ad"></a>2. Настройте подключение между подключаемыми модулями Microsoft 365 и Azure AD

Необходимо настроить подключение между подключаемыми модулями Microsoft 365 и Azure AD.

### <a name="requisites"></a>Реквизиты

Зарегистрируйте Moodle в качестве приложения в Azure AD с помощью скрипта PowerShell. Сценарий подготавливает следующие параметров:

* Новое Azure AD для вашего Microsoft 365, которое используется подключаемыми модулями Microsoft 365 Moodle.
* Приложение для вашего Microsoft 365, настроит необходимые URL-адреса ответа и разрешения для подготовленного приложения, `AppID` а затем возвращает и `Key`.

Используйте созданную и `AppID` на `Key` странице настройки Microsoft 365 Moodle Plugins для настройки сайта сервера Moodle с помощью Azure AD.

> [!IMPORTANT]
>
> * Скрипт PowerShell не обновляется последними элементами конфигурации, поэтому необходимо выполнить настройку вручную, следуя инструкциям на страницах выпуска Moodle [3.8.0.4 и 3.9.1](https://docs.moodle.org/39/en/Office365#3.8.0.4_and_3.9.1_release) и [3.8.0.5 и 3.9.2](https://docs.moodle.org/39/en/Office365#3.8.0.5_and_3.9.2_release) .
>
> * Дополнительные сведения о регистрации экземпляра Moodle вручную см. в разделе "Регистрация экземпляра [Moodle в качестве приложения"](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).

### <a name="the-moodle-tab-for-microsoft-teams-information-flow"></a>Вкладка Moodle для Microsoft Teams данных

<img width="530px" src="../assets/images/MoodleTabInformationFlow.png" alt="Moodle tab for Microsoft Teams information flow" />

1. На странице Microsoft 365 интеграции выберите вкладку **"Настройка**".

1. Нажмите **кнопку "Скачать сценарий PowerShell** " и сохраните его как ZIP-папку на локальном компьютере.

1. Подготовьте скрипт PowerShell из ZIP-файла следующим образом:

    1. Скачайте и извлеките `Moodle-AzureAD-Powershell.zip` файл.
    1. Откройте извлеченную папку.
    1. Щелкните файл правой кнопкой `Moodle-AzureAD-Script.ps1` мыши и выберите **пункт "Свойства"**.
    1. На **вкладке "** Общие" `Unblock` окно свойств установите флажок рядом с атрибутом **Security**, расположенным в нижней части окна.
    1. Нажмите кнопку **ОК**.
    1. Скопируйте путь к каталогу в извлеченную папку.

1. Запустите PowerShell от имени администратора:

    1. Выберите «Начать».
    1. Введите PowerShell.
    1. Щелкните правой кнопкой мыши **Windows PowerShell**.
    1. Выберите **"Запуск от имени администратора"**.

1. Перейдите в распакованный каталог `cd .../.../Moodle-AzureAD-Powershell` `.../...` , введя путь к каталогу.

1. Выполните скрипт PowerShell:

    1. Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.
    1. Введите `./Moodle-AzureAD-Script.ps1`.
    1. Войдите в учетную запись Microsoft 365 администратора во всплывающем окне.
    1. Введите имя приложения Azure AD, например подключаемые модули Moodle или Moodle.
    1. Введите URL-адрес сервера Moodle.
    1. **Скопируйте идентификатор приложения (`AppID`)** и **ключ приложения(`Key`),** созданные скриптом, и сохраните их.

1. Далее необходимо добавить подключаемые `AppID` модули Microsoft 365 `Key` Moodle. Вернитесь на страницу администрирования подключаемых модулей, > подключаемых модулей > Microsoft 365 интеграции.

1. На **вкладке "** Настройка" добавьте ранее `AppID` `Key` скопированную копию и нажмите кнопку **"Сохранить изменения"**. После обновления страницы вы увидите новый раздел **"Выбор метода подключения"**.

1. В **методе "Выбор подключения" установите** флажок "По **умолчанию",** а затем снова нажмите кнопку **"Сохранить изменения** ".

1. После обновления страницы вы увидите другой новый раздел согласия администратора, & **дополнительные сведения**.
    1. **Щелкните ссылку "** Предоставить согласие администратора", Microsoft 365 учетные данные глобального администратора, а затем примите условия предоставления разрешений.
    1. Рядом с **полем Azure AD клиента** нажмите кнопку **"Обнаружить**".
    1. Рядом с **URL-адресом OneDrive для бизнеса** нажмите кнопку **"Обнаружить**".
    1. После заполнения полей снова нажмите кнопку **"Сохранить изменения** ".

1. Нажмите **кнопку "** Обновить", чтобы проверить установку, а затем нажмите кнопку **"Сохранить изменения"**.

1. Синхронизация пользователей между сервером Moodle и Azure AD. Для начала сделайте следующее:

    > [!NOTE]
    > В зависимости от среды на этом этапе можно выбрать различные параметры.

1. Синхронизация пользователей между сервером Moodle и Azure AD. В зависимости от среды на этом этапе можно выбрать различные параметры. Для начала сделайте следующее:
    1. Перейдите на **вкладку Параметры синхронизации**.

    1. В разделе **"** Синхронизация пользователей Azure AD" установите флажки, которые применяются к вашей среде. Необходимо выбрать следующее:  

        ✔ Создание учетных записей в Moodle для пользователей в Azure AD.

        ✔ Обновите все учетные записи в Moodle для пользователей в Azure AD.

    1. В разделе **"Ограничения на** создание пользователей" можно настроить фильтр, чтобы ограничить количество Azure AD пользователей, синхронизированных с Moodle.
    1. В **разделе "Сопоставление** полей пользователей" можно настроить Azure AD для сопоставления полей профиля пользователя Moodle.
    1. В разделе **Teams "** Синхронизация" можно выбрать автоматическое создание групп, таких как команды для некоторых или всех существующих курсов Moodle.

13. Чтобы проверить [задания cron](https://docs.moodle.org/310/en/Cron) и запустить их вручную для первого запуска, выберите ссылку  на страницу управления запланированными задачами в разделе "Синхронизация пользователей **Azure AD**". Откроется страница **"Запланированные задачи** ".

    1. Прокрутите вниз и найдите пользователей **синхронизации с Azure AD** и нажмите кнопку **"Запустить сейчас"**.
    1. Если вы выбрали создание групп на основе существующих курсов, можно также запустить группу "Создать пользователей **" Microsoft 365** задании.

    > [!NOTE]
    >
    > Moodle [Cron](https://docs.moodle.org/310/en/Cron) выполняется в соответствии с расписанием задач. Расписание по умолчанию — один раз в день. Однако cron должен выполняться чаще, чтобы синхронизировать все данные.

1. Вернитесь на страницу администрирования подключаемых модулей, > подключаемых модулей > Microsoft 365 **интеграции**, и выберите **страницу** Teams Параметры.

1. На **Teams Параметры** настройте необходимые параметры, чтобы включить интеграцию Teams приложения.

    1. Чтобы включить **openID Подключение**, щелкните ссылку "Управление проверкой подлинности" и щелкните значок глаза на строке **openId Подключение**, если она недоступна.
    1. Чтобы включить внедрение кадров, щелкните ссылку **"Безопасность HTTP** ", а затем установите флажок рядом с пунктом "Разрешить внедрение **кадров"**.
    1. Чтобы включить веб-службы, включив функции API Moodle,  выберите ссылку "Дополнительные компоненты", а затем установите флажок рядом с пунктом "Включить веб-службы".
    1. Чтобы включить внешние службы для Microsoft 365, выберите ссылку **"Внешние** службы", а затем:  

        ✔ Выберите **"Изменить**" в **строке Microsoft 365 Веб-служб Moodle**.

        ✔ Установите флажок рядом с параметром **"Включено**", а затем нажмите кнопку **"Сохранить изменения"**.

    1. Измените разрешения пользователей, прошедших проверку подлинности, чтобы разрешить им создавать маркеры веб-службы.

        ✔ Выберите **ссылку пользователя, прошедшего проверку подлинности для роли редактирования** .

        ✔ Прокрутите вниз и найдите **возможность создания маркера веб-службы** и установите флажок **"Разрешить** ".

## <a name="3-deploy-the-moodle-assistant-bot-to-azure"></a>3. Развертывание бота Помощника по Moodle в Azure

Бесплатный бот помощника по Moodle для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о курсах, заданиях, оценках и других сведениях в Moodle. Бот также отправляет уведомления Moodle учащимся и преподавателям в Teams. Бот — это проект с открытым кодом, поддерживаемый корпорацией Майкрософт и доступный [в GitHub.](https://github.com/microsoft/Moodle-Teams-Bot)

> [!NOTE]
>
> * Развертывание ресурсов в подписке Azure. Все ресурсы были настроены на уровне **"Бесплатный** ". В зависимости от использования бота может потребоваться масштабировать эти ресурсы.
>
> * Чтобы использовать вкладку Moodle без бота, перейдите к [значению 4](#4-deploy-your-microsoft-teams-app).

### <a name="moodle-bot-information-flow"></a>Поток сведений о боте Moodle

<img width="530px" src="../assets/images/MoodleBotInformationFlow.png" alt="Moodle bot for Microsoft Teams information flow" />

Чтобы установить бот, необходимо зарегистрировать его на платформе [удостоверений Майкрософт](https://identity.microsoft.com/Landing). Это позволяет боту выполнять проверку подлинности в конечных точках Майкрософт.

Чтобы зарегистрировать бота:

1. Перейдите на страницу администрирования подключаемых модулей и выберите **"Подключаемые модули"**. В **Microsoft 365 интеграции** выберите вкладку **Teams Параметры**.

1. Щелкните **ссылку на портал регистрации приложений Майкрософт** и выполните вход с помощью идентификатора Майкрософт.

1. Введите имя приложения, например MoodleBot, и нажмите кнопку **"Создать** ".

1. **Скопируйте идентификатор приложения** и **вставьте** его в поле **"** Идентификатор приложения бота" на Параметры team.

1. Нажмите **кнопку "Создать пароль** ". Скопируйте созданный пароль и вставьте его в поле **"** Пароль приложения бота" **на Параметры team**.

1. Прокрутите страницу до нижней части формы и выберите **команду "Сохранить изменения"**.

После создания идентификатора приложения и пароля разверните бот в Azure:

> [!div class="checklist"]
>
> * Выберите "Развернуть в **Azure"** и заполните форму необходимыми сведениями, такими как идентификатор приложения бота, пароль приложения бота и секрет Moodle на **Teams Параметры странице.** Сведения об Azure см. на **странице "Настройка** ".
> * После заполнения формы установите флажок, чтобы принять условия.
> * Выберите **"Приобрести"**. Все ресурсы Azure развертываются на бесплатном уровне.

После завершения развертывания ресурсов в Azure необходимо настроить подключаемые модули Microsoft 365 Moodle с конечной точкой обмена сообщениями. Вы должны получить конечную точку из бота в Azure:

1. Войдите на [портал Microsoft Azure](https://portal.azure.com).

1. В области слева выберите группы ресурсов и  группу ресурсов, которую вы использовали или создали, при развертывании бота.

1. Выберите ресурс **WebApp Bot** из списка ресурсов в группе.

1. **Скопируйте конечную точку обмена** сообщениями из **раздела "Обзор**".

1. В Moodle откройте страницу **командной Параметры** подключаемых модулей Microsoft 365 Moodle.

1. В поле **"Конечная точка** бота" вставьте только что скопированный URL-адрес и измените текст сообщения на *веб-перехватчик*. URL-адрес должен выглядеть следующим образом: `https://botname.azurewebsites.net/api/webhook`

1. Нажмите кнопку **Сохранить изменения**.

1. После сохранения изменений вернитесь на вкладку **Team Параметры**, нажмите кнопку "Скачать файл  манифеста" и сохраните пакет манифеста приложения на компьютере для дальнейшего использования.

## <a name="4-deploy-your-microsoft-teams-app"></a>4. Развертывание Microsoft Teams приложения

После развертывания бота в Azure и настройки для взаимодействия с сервером Moodle необходимо развернуть Microsoft Teams приложения. Для этого необходимо загрузить файл манифеста приложения, скачанный со страницы Microsoft 365 Moodle Plugins Team Параметры на предыдущем шаге.

Перед установкой приложения необходимо обеспечить включение внешних приложений и их отправку. Дополнительные сведения см. в [разделе "Подготовка Microsoft 365 клиента"](../concepts/build-and-test/prepare-your-o365-tenant.md).

Чтобы развернуть приложение, выполните следующее.

1. Откройте **Microsoft Teams**.

1. Щелкните **значок** приложения в нижней левой области панели навигации.

1. Выберите **ссылку "Отправить пользовательское приложение** " в списке параметров.

   > [!NOTE]
   > Если вы вошли в систему от имени глобального администратора, у вас должен быть возможность отправить приложение в каталог приложений вашей организации. В противном случае вы можете загрузить приложение только для команды, в которой вы входите.

4. Выберите пакет `manifest.zip` , скачанный ранее, и нажмите кнопку **"Сохранить"**. Если вы еще не скачали пакет манифеста приложения, его можно скачать на вкладке **Team Параметры** на странице конфигурации подключаемых модулей в Moodle.

Теперь, когда приложение установлено, вы можете добавить вкладку в любой канал, к котором у вас есть доступ. Для этого перейдите к каналу, выберите символ **плюса** (➕) и выберите приложение из списка. Следуйте инструкциям, чтобы завершить добавление вкладки курса Moodle в канал.

## <a name="5-allow-automatic-creation-of-moodle-tabs-in-microsoft-teams"></a>5. Разрешить автоматическое создание вкладок Moodle в Microsoft Teams

Хотя вкладки Moodle создаются вручную в Microsoft Teams, вы можете создать их автоматически при создании команд на основе синхронизации курсов. Для этого необходимо настроить идентификатор отправленного Microsoft Teams в Moodle.

Чтобы разрешить автоматическое создание вкладок Moodle:

1. Откройте Microsoft Teams.

1. Щелкните значок "Приложения" в нижней левой области панели навигации.

1. Найдите отправленное приложение **Moodle, >** значок **параметров** , > **ссылку для копирования**.

1. В текстовом редакторе вставьте скопированное содержимое. Он должен содержать URL-адрес, например `https://teams.microsoft.com/l/app/00112233-4455-6677-8899-aabbccddeeff`. Скопируйте последнюю часть URL-адреса, `00112233-4455-6677-8899-aabbccddeeff`например идентификатор Microsoft Teams приложения.

1. В Moodle откройте вкладку **Teams Moodle** на странице конфигурации Microsoft 365 Moodle Plugins.

1. Вставьте идентификатор приложения Microsoft Teams в поле "Идентификатор приложения Moodle" и сохраните изменения.

Когда курс Moodle синхронизируется, Microsoft Teams автоматически устанавливает приложение Moodle в команде, создает вкладку Moodle в канале "Общие" Teams и настраивает его для хранения страницы курса для курса Moodle, из которого оно синхронизируется. Теперь вы можете начать работу с курсами Moodle непосредственно из Microsoft Teams.

> [!NOTE]
> Чтобы поделиться с нами любыми запросами функций или отзывами, посетите нашу страницу [user Voice](https://microsoftteams.uservoice.com/forums/916759-moodle).

## <a name="see-also"></a>Дополнительные ресурсы

* [Интеграция веб-приложений](~/samples/integrate-web-apps-overview.md)
* [Moodle](https://moodle.org/)
* [Документация по Moodle](https://docs.moodle.org/34/en/Installing_plugins).
