---
title: Что такое модули задач?
author: clearab
description: Добавление модальных всплывающих экранов для сбора или отображения сведений о приложениях Microsoft Teams для пользователей.
ms.topic: overview
ms.author: anclear
ms.openlocfilehash: d92da7e6def6d66efd2f94600b7b8f8847553701
ms.sourcegitcommit: e3b6bc31059ec77de5fbef9b15c17d358abbca0f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2021
ms.locfileid: "50231661"
---
# <a name="what-are-task-modules"></a><span data-ttu-id="f1d18-103">Что такое модули задач?</span><span class="sxs-lookup"><span data-stu-id="f1d18-103">What are task modules?</span></span>

<span data-ttu-id="f1d18-104">Модули задач позволяют создавать модальные всплывающие блоки в приложении Teams.</span><span class="sxs-lookup"><span data-stu-id="f1d18-104">Task modules allow you to create modal popup experiences in your Teams application.</span></span> <span data-ttu-id="f1d18-105">Во всплывающее представление можно запустить собственный код HTML или JavaScript, отобразить мини-приложения на основе youTube или Microsoft Stream или показать адаптивную `<iframe>` [карточку.](/adaptive-cards/)</span><span class="sxs-lookup"><span data-stu-id="f1d18-105">Inside the popup you can run your own custom HTML/JavaScript code, show an `<iframe>`-based widget such as a YouTube or Microsoft Stream video or display an [Adaptive card](/adaptive-cards/).</span></span> <span data-ttu-id="f1d18-106">Они особенно полезны для инициирования и выполнения задач или отображения подробной информации, например видео или панелей мониторинга Power BI.</span><span class="sxs-lookup"><span data-stu-id="f1d18-106">They are especially useful for initiating and completing tasks or displaying rich information like videos or Power BI dashboards.</span></span> <span data-ttu-id="f1d18-107">Всплывающие чаты часто более естественны для пользователей, которые инициируются и завершают задачи, по сравнению с вкладками или ботами на основе бесед.</span><span class="sxs-lookup"><span data-stu-id="f1d18-107">A popup experience is often more natural for users initiating and completing tasks compared to a tab or a conversation-based bot experience.</span></span>

<span data-ttu-id="f1d18-108">Модули задач на основе вкладок Microsoft Teams; По сути, они являются вкладками во всплывающее окно.</span><span class="sxs-lookup"><span data-stu-id="f1d18-108">Task modules build on the foundation of Microsoft Teams tabs; they are essentially a tab inside a popup window.</span></span> <span data-ttu-id="f1d18-109">Они используют тот же SDK, поэтому если вы создали вкладку, вы уже на 90 % можете создать модуль задач.</span><span class="sxs-lookup"><span data-stu-id="f1d18-109">They use the same SDK, so if you've built a tab you are already 90% of the way to being able to create a task module.</span></span>

<span data-ttu-id="f1d18-110">Модули задач могут вызываться тремя способами:</span><span class="sxs-lookup"><span data-stu-id="f1d18-110">Task modules can be invoked in three ways:</span></span>

* <span data-ttu-id="f1d18-111">**Канал или личные вкладки.**</span><span class="sxs-lookup"><span data-stu-id="f1d18-111">**Channel or personal tabs.**</span></span> <span data-ttu-id="f1d18-112">С помощью SDK вкладок Microsoft Teams можно вызывать модули задач из кнопок, ссылок или меню на вкладке. Это подробно [освещается здесь.](~/task-modules-and-cards/task-modules/task-modules-tabs.md)</span><span class="sxs-lookup"><span data-stu-id="f1d18-112">Using the Microsoft Teams Tabs SDK you can invoke task modules from buttons, links or menus on your tab. [This is covered in detail here.](~/task-modules-and-cards/task-modules/task-modules-tabs.md)</span></span>
* <span data-ttu-id="f1d18-113">**Боты.**</span><span class="sxs-lookup"><span data-stu-id="f1d18-113">**Bots.**</span></span> <span data-ttu-id="f1d18-114">Кнопки на [карточках, отправленных](~/task-modules-and-cards/cards/cards-reference.md) ботом.</span><span class="sxs-lookup"><span data-stu-id="f1d18-114">Buttons on [cards](~/task-modules-and-cards/cards/cards-reference.md) sent from your bot.</span></span> <span data-ttu-id="f1d18-115">Это особенно полезно, если вам не нужны все в канале, чтобы увидеть, что вы делаете с ботом.</span><span class="sxs-lookup"><span data-stu-id="f1d18-115">This is particularly useful when you don't need everyone in a channel to see what you are doing with a bot.</span></span> <span data-ttu-id="f1d18-116">Например, когда пользователи отвечают на опрос в канале, не очень полезно видеть запись о том, что опрос создается.</span><span class="sxs-lookup"><span data-stu-id="f1d18-116">For example, when having users respond to a poll in a channel it's not terribly useful to see a record of that poll being created.</span></span> [<span data-ttu-id="f1d18-117">Это подробно освещается здесь.</span><span class="sxs-lookup"><span data-stu-id="f1d18-117">This is covered in detail here.</span></span>](~/task-modules-and-cards/task-modules/task-modules-bots.md)
* <span data-ttu-id="f1d18-118">**За пределами Teams по прямой ссылке.**</span><span class="sxs-lookup"><span data-stu-id="f1d18-118">**Outside of Teams from a deep link.**</span></span> <span data-ttu-id="f1d18-119">Вы также можете создавать URL-адреса для вызова модуля задачи из любого места.</span><span class="sxs-lookup"><span data-stu-id="f1d18-119">You can also create URLs to invoke a task module from anywhere.</span></span> [<span data-ttu-id="f1d18-120">Это подробно освещается здесь.</span><span class="sxs-lookup"><span data-stu-id="f1d18-120">This is covered in detail here.</span></span>](#task-module-deep-link-syntax)

## <a name="what-a-task-module-looks-like"></a><span data-ttu-id="f1d18-121">Как выглядит модуль задачи</span><span class="sxs-lookup"><span data-stu-id="f1d18-121">What a task module looks like</span></span>

<span data-ttu-id="f1d18-122">Вот как выглядит модуль задачи при вызове из бота (без цветных прямоугольников и нумитных кругов, конечно):</span><span class="sxs-lookup"><span data-stu-id="f1d18-122">Here's what a task module looks like when invoked from a bot (without the colored rectangles and numbered circles, of course):</span></span>

![Пример модуля задач](~/assets/images/task-module/task-module-example.png)

<span data-ttu-id="f1d18-124">Рассмотрим его.</span><span class="sxs-lookup"><span data-stu-id="f1d18-124">Let's walk through it:</span></span>

1. <span data-ttu-id="f1d18-125">Значок вашего [ `color` приложения.](~/resources/schema/manifest-schema.md#icons)</span><span class="sxs-lookup"><span data-stu-id="f1d18-125">Your app's [`color` icon](~/resources/schema/manifest-schema.md#icons).</span></span>
2. <span data-ttu-id="f1d18-126">Имя вашего [ `short` приложения.](~/resources/schema/manifest-schema.md#name)</span><span class="sxs-lookup"><span data-stu-id="f1d18-126">Your app's [`short` name](~/resources/schema/manifest-schema.md#name).</span></span>
3. <span data-ttu-id="f1d18-127">Заголовок модуля задачи, указанный в свойстве объекта `title` [TaskInfo.](#the-taskinfo-object)</span><span class="sxs-lookup"><span data-stu-id="f1d18-127">The task module's title specified in the `title` property of the [TaskInfo object](#the-taskinfo-object).</span></span>
4. <span data-ttu-id="f1d18-128">Кнопка закрытия или отмены модуля задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-128">The task module's close/cancel button.</span></span> <span data-ttu-id="f1d18-129">Если пользователь нажал эту кнопку, ваше приложение получит `err` событие, как [описано здесь.](~/task-modules-and-cards/task-modules/task-modules-tabs.md#example-submitting-the-result-of-a-task-module)</span><span class="sxs-lookup"><span data-stu-id="f1d18-129">If the user presses this, your app will receive an `err` event as described [here](~/task-modules-and-cards/task-modules/task-modules-tabs.md#example-submitting-the-result-of-a-task-module).</span></span> <span data-ttu-id="f1d18-130">(**Примечание.** В настоящее время невозможно обнаружить это событие, когда модуль задачи вызывается ботом.)</span><span class="sxs-lookup"><span data-stu-id="f1d18-130">(**Note:** It is currently not possible to detect this event when a task module is invoked from a bot.)</span></span>
5. <span data-ttu-id="f1d18-131">Синий прямоугольник — это то место, где отображается веб-страница при загрузке собственной веб-страницы с помощью свойства `url` [объекта TaskInfo.](#the-taskinfo-object)</span><span class="sxs-lookup"><span data-stu-id="f1d18-131">The blue rectangle is the where your web page appears if you are loading your own web page using the `url` property of the [TaskInfo object](#the-taskinfo-object).</span></span> <span data-ttu-id="f1d18-132">Дополнительные подробности см. в [разделе "Размер модуля задачи"](#task-module-sizing) ниже.</span><span class="sxs-lookup"><span data-stu-id="f1d18-132">More detail is in the [task module sizing](#task-module-sizing) section below.</span></span>
6. <span data-ttu-id="f1d18-133">Если вы отображаете адаптивную карточку с помощью свойства объекта `card` [TaskInfo,](#the-taskinfo-object) заполнение будет добавлено для вас, в противном случае вам придется обработать [это самостоятельно.](#task-module-css-for-htmljavascript-task-modules)</span><span class="sxs-lookup"><span data-stu-id="f1d18-133">If you are displaying an Adaptive card via the `card` property of the [TaskInfo object](#the-taskinfo-object) the padding is added for you, otherwise you'll need to [handle this yourself](#task-module-css-for-htmljavascript-task-modules).</span></span>
7. <span data-ttu-id="f1d18-134">Здесь будут отрисовываться кнопки адаптивной карточки.</span><span class="sxs-lookup"><span data-stu-id="f1d18-134">Adaptive card buttons will render here.</span></span> <span data-ttu-id="f1d18-135">Если вы используете собственную страницу, необходимо создать собственные кнопки.</span><span class="sxs-lookup"><span data-stu-id="f1d18-135">If you're using your own page you must create your own buttons.</span></span>

## <a name="overview-of-invoking-and-dismissing-task-modules"></a><span data-ttu-id="f1d18-136">Общие сведения о том, как сдуть и отклонять модули задач</span><span class="sxs-lookup"><span data-stu-id="f1d18-136">Overview of invoking and dismissing task modules</span></span>

<span data-ttu-id="f1d18-137">Модули задач могут вызываться из вкладок, ботов или глубоких ссылок, и в одном из них могут быть HTML-коды или адаптивные карточки, поэтому существует много гибкости с точки зрения того, как они вызываются и как работать с результатом взаимодействия пользователя.</span><span class="sxs-lookup"><span data-stu-id="f1d18-137">Task modules can be invoked from tabs, bots or deep links and what appears in one can be either HTML or an Adaptive card, so there's a lot of flexibility in terms of how they are invoked and how to deal with the result of a user's interaction.</span></span> <span data-ttu-id="f1d18-138">В приведенной ниже таблице приведена итоговая по этим процессу работа.</span><span class="sxs-lookup"><span data-stu-id="f1d18-138">The table below summarizes how this works:</span></span>

| <span data-ttu-id="f1d18-139">**Вызывается через...**</span><span class="sxs-lookup"><span data-stu-id="f1d18-139">**Invoked via...**</span></span> | <span data-ttu-id="f1d18-140">**Модуль задачи — HTML/JavaScript**</span><span class="sxs-lookup"><span data-stu-id="f1d18-140">**Task module is HTML/JavaScript**</span></span> | <span data-ttu-id="f1d18-141">**Модуль задачи — это адаптивная карточка**</span><span class="sxs-lookup"><span data-stu-id="f1d18-141">**Task module is Adaptive card**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f1d18-142">**JavaScript на вкладке**</span><span class="sxs-lookup"><span data-stu-id="f1d18-142">**JavaScript in a tab**</span></span> | <span data-ttu-id="f1d18-143">1. Использование функции SDK клиента Teams `tasks.startTask()` с необязательной функцией `submitHandler(err, result)` вызова</span><span class="sxs-lookup"><span data-stu-id="f1d18-143">1. Use the Teams client SDK function `tasks.startTask()` with an optional `submitHandler(err, result)` callback function</span></span> <br/><br/> <span data-ttu-id="f1d18-144">2. После завершения работы пользователя в коде модуля задачи вызовите функцию Teams SDK с объектом в `tasks.submitTask()` `result` качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="f1d18-144">2. In the task module code, when the user is finished, call the Teams SDK function `tasks.submitTask()` with a `result` object as a parameter.</span></span> <span data-ttu-id="f1d18-145">Если в `submitHandler` параметре указан параметр callback, Teams вызывает его `tasks.startTask()` в качестве `result` параметра.</span><span class="sxs-lookup"><span data-stu-id="f1d18-145">If a `submitHandler` callback was specified in `tasks.startTask()`, Teams calls it with `result` as a parameter.</span></span><br/><br/> <span data-ttu-id="f1d18-146">3. Если при подавке произошла ошибка, функция будет вызвана `tasks.startTask()` `submitHandler` со `err` строкой.</span><span class="sxs-lookup"><span data-stu-id="f1d18-146">3. If there was an error when invoking `tasks.startTask()`, the `submitHandler` function is called with an `err` string instead.</span></span> <br/><br/> <span data-ttu-id="f1d18-147">4. Вы также можете указать a при вызове — в этом `completionBotId` `teams.startTask()` случае `result` отправляется боту.</span><span class="sxs-lookup"><span data-stu-id="f1d18-147">4. You can also specify a `completionBotId` when calling `teams.startTask()` - in that case `result` is sent to the bot instead.</span></span> | <span data-ttu-id="f1d18-148">1. Вызовите функцию SDK клиента Teams с объектом TaskInfo и содержащей JSON для адаптивной карточки, которая будет отражаться во всплывающее представление `tasks.startTask()` модуля [](#the-taskinfo-object) `TaskInfo.card` задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-148">1. Call the Teams client SDK function `tasks.startTask()` with a [TaskInfo object](#the-taskinfo-object) and `TaskInfo.card` containing the JSON for the Adaptive card to show in the task module popup.</span></span> <br/><br/> <span data-ttu-id="f1d18-149">2. Если в методе callback указан метод, Teams вызывает его со строкой, если при вызове произошла ошибка или пользователь закрывает всплывающее сообщение модуля задачи с помощью `submitHandler` `tasks.startTask()` `err` `tasks.startTask()` X в правом верхнем.</span><span class="sxs-lookup"><span data-stu-id="f1d18-149">2. If a `submitHandler` callback was specified in `tasks.startTask()`, Teams calls it with an `err` string if there was an error when invoking `tasks.startTask()` or if the user closes the task module popup using the X at the upper right.</span></span> <br/><br/> <span data-ttu-id="f1d18-150">3. Если пользователь нажал кнопку Action.Submit, его объект возвращается `data` в качестве значения `result` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-150">3. If the user presses an Action.Submit button then its `data` object is returned as the value of `result`.</span></span> |
| <span data-ttu-id="f1d18-151">**Кнопка карточки бота**</span><span class="sxs-lookup"><span data-stu-id="f1d18-151">**Bot card button**</span></span> | <span data-ttu-id="f1d18-152">1. Кнопки карточки бота в зависимости от типа кнопки могут вызывать модули задач двумя способами: URL-адресом глубокой ссылки или отправкой `task/fetch` сообщения.</span><span class="sxs-lookup"><span data-stu-id="f1d18-152">1. Bot card buttons, depending on the type of button, can invoke task modules in two ways: a deep link URL or by sending a `task/fetch` message.</span></span> <span data-ttu-id="f1d18-153">См. ниже, как работают URL-адреса глубоких ссылок.</span><span class="sxs-lookup"><span data-stu-id="f1d18-153">See below for how deep link URLs work.</span></span> <br/><br/> <span data-ttu-id="f1d18-154">2. Если действие кнопки ( тип кнопки для адаптивных карточек), боту отправляется событие (HTTP POST под обложками), и бот отвечает на ЗАПРОС POST с http 200 и тело ответа, содержащее оболочку вокруг объекта `type` `task/fetch` `Action.Submit` `task/fetch invoke` [TaskInfo.](#the-taskinfo-object)</span><span class="sxs-lookup"><span data-stu-id="f1d18-154">2. If the button's action `type` is `task/fetch` (`Action.Submit` button type for Adaptive cards), a `task/fetch invoke` event (an HTTP POST under the covers) is sent to the bot, and the bot responds to the POST with HTTP 200 and the response body containing a wrapper around the [TaskInfo object](#the-taskinfo-object).</span></span> <span data-ttu-id="f1d18-155">Это подробно объясняется при извлечении модуля задачи [через задачу/извлечение.](~/task-modules-and-cards/task-modules/task-modules-bots.md#invoking-a-task-module-via-taskfetch)</span><span class="sxs-lookup"><span data-stu-id="f1d18-155">This is explained in detail in [invoking a task module via task/fetch](~/task-modules-and-cards/task-modules/task-modules-bots.md#invoking-a-task-module-via-taskfetch).</span></span><br/><br/> <span data-ttu-id="f1d18-156">3. Teams отображает модуль задачи; Когда пользователь завершит работу, вызовите функцию Teams SDK с `tasks.submitTask()` `result` объектом в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="f1d18-156">3. Teams displays the task module; when the user is finished, call the Teams SDK function `tasks.submitTask()` with a `result` object as a parameter.</span></span> <br/><br/> <span data-ttu-id="f1d18-157">4. Бот получает сообщение `task/submit invoke` с `result` объектом.</span><span class="sxs-lookup"><span data-stu-id="f1d18-157">4. The bot receives a `task/submit invoke` message that contains the `result` object.</span></span> <span data-ttu-id="f1d18-158">У вас есть три различных способа ответа на сообщение: ничего не делать (задача успешно завершена), отображая сообщение пользователю во всплывающее окно или путем запроса другого окна модуля задачи (то есть создания мастера, как `task/submit` интерфейс).</span><span class="sxs-lookup"><span data-stu-id="f1d18-158">You have three different ways to respond to the `task/submit` message: by doing nothing (the task completed successfully), by displaying a message to the user in a popup window, or by invoking another task module window (i.e. creating a wizard-like experience).</span></span> <span data-ttu-id="f1d18-159">Эти три варианта более подробно обсуждаются в подробном обсуждении [задачи/отправки.](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit)</span><span class="sxs-lookup"><span data-stu-id="f1d18-159">These three options are discussed more [in the detailed discussion on task/submit](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit).</span></span> | <span data-ttu-id="f1d18-160">1. Как и кнопки на карточках Bot Framework, кнопки на адаптивных карточках поддерживают два способа вызова модулей задач: URL-адреса с прямой связью с кнопками и с помощью `Action.openUrl` `task/fetch` `Action.Submit` кнопок.</span><span class="sxs-lookup"><span data-stu-id="f1d18-160">1. Like buttons on Bot Framework cards, buttons on Adaptive cards support two ways of invoking task modules: deep link URLs with `Action.openUrl` buttons, and via `task/fetch` using `Action.Submit` buttons.</span></span> <br/><br/> <span data-ttu-id="f1d18-161">2. Модули задач с адаптивными карточками работают очень аналогично примеру HTML или JavaScript (см. слева).</span><span class="sxs-lookup"><span data-stu-id="f1d18-161">2. Task modules with Adaptive cards work very similarly to the HTML/JavaScript case (see left).</span></span> <span data-ttu-id="f1d18-162">Главное отличие заключается в том, что так как при использовании адаптивных карт нет кода JavaScript, нельзя вызывать `tasks.submitTask()` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-162">The major difference is that since there's no JavaScript when you're using Adaptive cards, there's no way to call `tasks.submitTask()`.</span></span> <span data-ttu-id="f1d18-163">Вместо этого Teams берет объект и возвращает его в качестве полезной нагрузки события, как `data` `Action.Submit` `task/submit` [описано здесь.](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit)</span><span class="sxs-lookup"><span data-stu-id="f1d18-163">Instead, Teams takes the `data` object from `Action.Submit` and returns it as the payload of in the `task/submit` event, as described [here](~/task-modules-and-cards/task-modules/task-modules-bots.md#the-flexibility-of-tasksubmit).</span></span> |
| <span data-ttu-id="f1d18-164">**URL-адрес глубокой ссылки**</span><span class="sxs-lookup"><span data-stu-id="f1d18-164">**Deep link URL**</span></span> <br/>[<span data-ttu-id="f1d18-165">синтаксис URL-адреса</span><span class="sxs-lookup"><span data-stu-id="f1d18-165">URL syntax</span></span>](#task-module-deep-link-syntax) | <span data-ttu-id="f1d18-166">1. Teams вызывает модуль задачи; URL-адрес, который отображается внутри `<iframe>` указанного в `url` параметре глубокой ссылки.</span><span class="sxs-lookup"><span data-stu-id="f1d18-166">1. Teams invokes the task module; the URL that appears inside the `<iframe>` specified in the `url` parameter of the deep link.</span></span> <span data-ttu-id="f1d18-167">Не существует никакого `submitHandler` вызова.</span><span class="sxs-lookup"><span data-stu-id="f1d18-167">There is no `submitHandler` callback.</span></span> <br/><br/> <span data-ttu-id="f1d18-168">2. В JavaScript страницы в модуле задачи вызовите, чтобы закрыть его с помощью объекта в качестве параметра, так же, как при вызове с вкладки или кнопки карточки `tasks.submitTask()` `result` бота.</span><span class="sxs-lookup"><span data-stu-id="f1d18-168">2. Within the JavaScript of the page in the task module, call `tasks.submitTask()` to close it with a `result` object as a parameter, the same as when invoking it from a tab or a bot card button.</span></span> <span data-ttu-id="f1d18-169">Логика завершения немного отличается.</span><span class="sxs-lookup"><span data-stu-id="f1d18-169">Completion logic is slightly different, however.</span></span> <span data-ttu-id="f1d18-170">Если логика завершения находится на клиенте (то есть если бота нет), то не будет никакого вызова, поэтому любая логика завершения должна находиться в коде перед `submitHandler` `tasks.submitTask()` вызовом.</span><span class="sxs-lookup"><span data-stu-id="f1d18-170">If your completion logic resides on the client (i.e. if there is no bot) there is no `submitHandler` callback, so any completion logic must be in the code preceding the call to `tasks.submitTask()`.</span></span> <span data-ttu-id="f1d18-171">Об ошибках вызовов сообщается только через консоль.</span><span class="sxs-lookup"><span data-stu-id="f1d18-171">Invocation errors are only reported via the console.</span></span> <span data-ttu-id="f1d18-172">Если у вас есть бот, вы можете указать параметр в глубокой ссылке, чтобы `completionBotId` отправить `result` объект через `task/submit` событие.</span><span class="sxs-lookup"><span data-stu-id="f1d18-172">If you have a bot, then you can specify a `completionBotId` parameter in the deep link to send the `result` object via a `task/submit` event.</span></span> | <span data-ttu-id="f1d18-173">1. Teams вызывает модуль задачи; Тело карточки JSON адаптивной карточки указывается в качестве значения параметра глубокой ссылки в кодированном `card` URL-адресе.</span><span class="sxs-lookup"><span data-stu-id="f1d18-173">1. Teams invokes the task module; the JSON card body of the Adaptive card is specified as a URL-encoded value of the `card` parameter of the deep link.</span></span> <br/><br/> <span data-ttu-id="f1d18-174">2. Пользователь закрывает модуль задачи, щелкнув X в верхней правой части модуля задачи или нажав кнопку `Action.Submit` на карточке.</span><span class="sxs-lookup"><span data-stu-id="f1d18-174">2. The user closes the task module by clicking on the X at the upper right of the task module or by pressing an `Action.Submit` button on the card.</span></span> <span data-ttu-id="f1d18-175">Так как вызовов нет, необходимо иметь бота для отправки значения полей `submitHandler` адаптивной карточки.</span><span class="sxs-lookup"><span data-stu-id="f1d18-175">Since there is no `submitHandler` to call, you must have a bot to send the value of the Adaptive card fields to.</span></span> <span data-ttu-id="f1d18-176">Параметр в глубокой ссылке используется для указания бота для отправки данных `completionBotId` через `task/submit invoke` событие.</span><span class="sxs-lookup"><span data-stu-id="f1d18-176">You use the `completionBotId` parameter in the deep link to specify the bot to send the data to via a `task/submit invoke` event.</span></span> |

> [!NOTE]
> <span data-ttu-id="f1d18-177">На мобильных устройствах не поддерживается искомый модуль задачи из JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f1d18-177">Invoking a task module from JavaScript is not supported on mobile.</span></span>

## <a name="the-taskinfo-object"></a><span data-ttu-id="f1d18-178">Объект TaskInfo</span><span class="sxs-lookup"><span data-stu-id="f1d18-178">The TaskInfo object</span></span>

<span data-ttu-id="f1d18-179">Объект `TaskInfo` содержит метаданные для модуля задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-179">The `TaskInfo` object contains the metadata for a task module.</span></span> <span data-ttu-id="f1d18-180">Определение объекта приведено ниже.</span><span class="sxs-lookup"><span data-stu-id="f1d18-180">The object definition is below.</span></span> <span data-ttu-id="f1d18-181">Необходимо **определить** либо `url` (для внедренного iFrame), либо `card` (для адаптивной карточки).</span><span class="sxs-lookup"><span data-stu-id="f1d18-181">You **must** define either `url` (for an embedded iFrame) or `card` (for an Adaptive Card).</span></span>

| <span data-ttu-id="f1d18-182">Атрибут</span><span class="sxs-lookup"><span data-stu-id="f1d18-182">Attribute</span></span> | <span data-ttu-id="f1d18-183">Тип</span><span class="sxs-lookup"><span data-stu-id="f1d18-183">Type</span></span> | <span data-ttu-id="f1d18-184">Описание</span><span class="sxs-lookup"><span data-stu-id="f1d18-184">Description</span></span> |
| --- | --- | --- |
| `title` | <span data-ttu-id="f1d18-185">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-185">string</span></span> | <span data-ttu-id="f1d18-186">Отображается под именем приложения и справа от значка приложения</span><span class="sxs-lookup"><span data-stu-id="f1d18-186">Appears below the app name and to the right of the app icon</span></span> |
| `height` | <span data-ttu-id="f1d18-187">number или string</span><span class="sxs-lookup"><span data-stu-id="f1d18-187">number or string</span></span> | <span data-ttu-id="f1d18-188">Это может быть число, представляющее высоту модуля задачи в пикселях, или `small` `medium` , или `large` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-188">This can be a number representing the task module's height in pixels, or `small`, `medium`, or `large`.</span></span> <span data-ttu-id="f1d18-189">[Подробнее об обработке высоты и ширины см. ниже.](#task-module-sizing)</span><span class="sxs-lookup"><span data-stu-id="f1d18-189">[See below for how height and width are handled](#task-module-sizing).</span></span> |
| `width` | <span data-ttu-id="f1d18-190">number или string</span><span class="sxs-lookup"><span data-stu-id="f1d18-190">number or string</span></span> | <span data-ttu-id="f1d18-191">Это может быть число, представляющее ширину модуля задачи в пикселях, или `small` `medium` , или `large` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-191">This can be a number representing the task module's width in pixels, or `small`, `medium`, or `large`.</span></span> <span data-ttu-id="f1d18-192">[Подробнее об обработке высоты и ширины см. ниже.](#task-module-sizing)</span><span class="sxs-lookup"><span data-stu-id="f1d18-192">[See below for how height and width are handled](#task-module-sizing).</span></span> |
| `url` | <span data-ttu-id="f1d18-193">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-193">string</span></span> | <span data-ttu-id="f1d18-194">URL-адрес страницы, загруженной в модуле `<iframe>` задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-194">The URL of the page loaded as an `<iframe>` inside the task module.</span></span> <span data-ttu-id="f1d18-195">Домен URL-адреса должен быть в массиве допустимого домена приложения [в](~/resources/schema/manifest-schema.md#validdomains) манифесте приложения.</span><span class="sxs-lookup"><span data-stu-id="f1d18-195">The URL's domain must be in the app's [validDomains array](~/resources/schema/manifest-schema.md#validdomains) in your app's manifest.</span></span> |
| `card` | <span data-ttu-id="f1d18-196">Адаптивная карточка или вложение бота адаптивной карточки</span><span class="sxs-lookup"><span data-stu-id="f1d18-196">Adaptive card or an Adaptive card bot card attachment</span></span> | <span data-ttu-id="f1d18-197">JSON для адаптивной карточки, которая будет отображаться в модуле задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-197">The JSON for the Adaptive card to appear in the task module.</span></span> <span data-ttu-id="f1d18-198">Если вы используете бота, необходимо использовать JSON адаптивной карточки в объекте Bot `attachment` Framework.</span><span class="sxs-lookup"><span data-stu-id="f1d18-198">If you're invoking from a bot, you'll need to use the Adaptive card JSON in a Bot Framework `attachment` object.</span></span> <span data-ttu-id="f1d18-199">На вкладке вы будете использовать только адаптивную карточку.</span><span class="sxs-lookup"><span data-stu-id="f1d18-199">From a tab you'll use just an Adaptive Card.</span></span> [<span data-ttu-id="f1d18-200">Вот пример.</span><span class="sxs-lookup"><span data-stu-id="f1d18-200">Here's an example.</span></span>](#adaptive-card-or-adaptive-card-bot-card-attachment) |
| `fallbackUrl` | <span data-ttu-id="f1d18-201">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-201">string</span></span> | <span data-ttu-id="f1d18-202">Если клиент не поддерживает функцию модуля задачи, этот URL-адрес открывается на вкладке браузера.</span><span class="sxs-lookup"><span data-stu-id="f1d18-202">If a client does not support the task module feature, this URL is opened in a browser tab.</span></span> |
| `completionBotId` | <span data-ttu-id="f1d18-203">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-203">string</span></span> | <span data-ttu-id="f1d18-204">Указывает ИД приложения-бота, в который отправляется результат взаимодействия пользователя с модулем задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-204">Specifies a bot App ID to send the result of the user's interaction with the task module to.</span></span> <span data-ttu-id="f1d18-205">Если этот объект задан, бот получит событие с объектом JSON в полезной нагрузке `task/submit invoke` события.</span><span class="sxs-lookup"><span data-stu-id="f1d18-205">If specified, the bot will receive a `task/submit invoke` event with a JSON object in the event payload.</span></span> |

> [!NOTE]
> <span data-ttu-id="f1d18-206">Для функции модуля задачи необходимо, чтобы домены всех URL-адресов, которые вы хотите загрузить, были включены в массив `validDomains` манифеста приложения.</span><span class="sxs-lookup"><span data-stu-id="f1d18-206">The task module feature requires that the domains of any URLs you want to load are included in the `validDomains` array in your app's manifest.</span></span>

## <a name="task-module-sizing"></a><span data-ttu-id="f1d18-207">Размер модуля задачи</span><span class="sxs-lookup"><span data-stu-id="f1d18-207">Task module sizing</span></span>

<span data-ttu-id="f1d18-208">Использование в пикселях высоты и ширины с помощью `TaskInfo.width` integers. `TaskInfo.height`</span><span class="sxs-lookup"><span data-stu-id="f1d18-208">Using integers for `TaskInfo.width` and `TaskInfo.height` will set the height and width in pixels.</span></span> <span data-ttu-id="f1d18-209">Однако в зависимости от размера окна команды и разрешения экрана они будут уменьшаться пропорционально при сохранении пропорций (ширина и высота).</span><span class="sxs-lookup"><span data-stu-id="f1d18-209">However, depending on the size of the Team's window and screen resolution they will be reduced proportionally while maintaining the aspect ratio (width/height).</span></span>

<span data-ttu-id="f1d18-210">Если и есть, либо размер красного прямоугольника на рисунке выше является пропорцией доступного `TaskInfo.width` `TaskInfo.height` `"small"` `"medium"` `"large"` пространства: 20%, 50 %, 60 % для и `width` 20%, 50 %, 66% для `height` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-210">If `TaskInfo.width` and `TaskInfo.height` are `"small"`, `"medium"` or `"large"` the size of the red rectangle in the picture above is a proportion of the available space: 20%, 50%, 60% for `width` and 20%, 50%, 66% for `height`.</span></span>

<span data-ttu-id="f1d18-211">Модули задач, вызываемые с вкладки, можно динамически реаклизовать.</span><span class="sxs-lookup"><span data-stu-id="f1d18-211">Task modules invoked from a tab can be dynamically resized.</span></span> <span data-ttu-id="f1d18-212">После вызова можно вызвать, где свойства высоты и ширины объекта newSize соответствуют спецификации `tasks.startTask()` `tasks.updateTask(newSize)` TaskInfo (например.</span><span class="sxs-lookup"><span data-stu-id="f1d18-212">After calling `tasks.startTask()` you can call `tasks.updateTask(newSize)` where height and width properties on the newSize object conform to the TaskInfo spec (ex.</span></span> <span data-ttu-id="f1d18-213">`{ height: 'medium', width: 'medium' }`).</span><span class="sxs-lookup"><span data-stu-id="f1d18-213">`{ height: 'medium', width: 'medium' }`).</span></span>

## <a name="task-module-css-for-htmljavascript-task-modules"></a><span data-ttu-id="f1d18-214">CSS модуля задач для модулей задач HTML и JavaScript</span><span class="sxs-lookup"><span data-stu-id="f1d18-214">Task module CSS for HTML/JavaScript task modules</span></span>

<span data-ttu-id="f1d18-215">Модули задач на основе HTML и JavaScript имеют доступ ко всей области модуля задачи под заголовщиком.</span><span class="sxs-lookup"><span data-stu-id="f1d18-215">HTML/JavaScript-based task modules have access to the entire area of the task module below the header.</span></span> <span data-ttu-id="f1d18-216">Хотя это обеспечивает большую гибкость, если вы хотите, чтобы заполнение по краям было согласовано с элементами header и избегало лишних прокруток, необходимо предоставить правильный CSS.</span><span class="sxs-lookup"><span data-stu-id="f1d18-216">While that offers a great deal of flexibility, if you want padding around the edges to align with the header elements and avoid unnecessary scrollbars you'll need to provide the right CSS.</span></span> <span data-ttu-id="f1d18-217">Вот несколько примеров использования.</span><span class="sxs-lookup"><span data-stu-id="f1d18-217">Here are some examples for a few use cases.</span></span>

### <a name="example-1---youtube-video"></a><span data-ttu-id="f1d18-218">Пример 1. Видео youTube</span><span class="sxs-lookup"><span data-stu-id="f1d18-218">Example 1 - YouTube video</span></span>

<span data-ttu-id="f1d18-219">YouTube предлагает возможность встраить видео на веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="f1d18-219">YouTube offers the ability to embed videos on web pages.</span></span> <span data-ttu-id="f1d18-220">С помощью простой веб-страницы загона ее легко отдемонстрировать в модуле задачи:</span><span class="sxs-lookup"><span data-stu-id="f1d18-220">Using a simple stub web page it's easy to show this in a task module:</span></span>

![Видео с YouTube](~/assets/images/task-module/youtube-example.png)

<span data-ttu-id="f1d18-222">Вот HTML-код для этой страницы без CSS:</span><span class="sxs-lookup"><span data-stu-id="f1d18-222">Here's the HTML for this page, without the CSS:</span></span>

```html
<!DOCTYPE html>
<html lang="en">
<head>
  ⋮
</head>
<body>
  <div id="embed-container">
    <iframe width="1000" height="700" src="https://www.youtube.com/embed/rd0Rd8w3FZ0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe>
  </div>
</body>
</html>
```

<span data-ttu-id="f1d18-223">CSS выглядит так:</span><span class="sxs-lookup"><span data-stu-id="f1d18-223">The CSS looks like this:</span></span>

```css
#embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 95%;
    height: 95%;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-style: none;
}
```

### <a name="example-2---powerapp"></a><span data-ttu-id="f1d18-224">Пример 2. PowerApp</span><span class="sxs-lookup"><span data-stu-id="f1d18-224">Example 2 - PowerApp</span></span>

<span data-ttu-id="f1d18-225">Такой же подход можно использовать и для встраивки PowerApp.</span><span class="sxs-lookup"><span data-stu-id="f1d18-225">You can use the same approach to embed a PowerApp as well.</span></span> <span data-ttu-id="f1d18-226">Так как высота и ширина любого отдельного powerApp можно настраивать, вам может потребоваться изменить высоту и ширину для достижения нужного представления.</span><span class="sxs-lookup"><span data-stu-id="f1d18-226">As the height/width of any individual PowerApp is customizable, you may need to adjust the height and width to achieve your desired presentation.</span></span>

![PowerApp для управления активами](~/assets/images/task-module/powerapp-example.png)

```html
<iframe width="720" height="520" src="https://web.powerapps.com/webplayer/iframeapp?source=iframe&screenColor=rgba(104,101,171,1)&appId=/providers/Microsoft.PowerApps/apps/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"></iframe>
```

<span data-ttu-id="f1d18-228">CSS::</span><span class="sxs-lookup"><span data-stu-id="f1d18-228">And the CSS is:</span></span>

```css
#embed-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 94%;
    height: 95%;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    border-style: none;
}
```

## <a name="adaptive-card-or-adaptive-card-bot-card-attachment"></a><span data-ttu-id="f1d18-229">Адаптивная карточка или вложение карточки бота адаптивной карточки</span><span class="sxs-lookup"><span data-stu-id="f1d18-229">Adaptive card or Adaptive card bot card attachment</span></span>

<span data-ttu-id="f1d18-230">Как мы уже отмечалось выше, в зависимости от того, как вы используете вашу, вам потребуется использовать либо адаптивную карту, либо вложение карточки бота адаптивной карточки (которая является просто адаптивной картой, упакованной в объект `card` вложения).</span><span class="sxs-lookup"><span data-stu-id="f1d18-230">As we noted above, depending on how you're invoking your `card` you'll need to use either an Adaptive card, or an Adaptive card bot card attachment (which is just an Adaptive card wrapped in an attachment object).</span></span>

<span data-ttu-id="f1d18-231">Когда вы используете вкладку, вам потребуется использовать адаптивную карточку.</span><span class="sxs-lookup"><span data-stu-id="f1d18-231">When you're invoking from a tab, you'll need to use an adaptive card.</span></span> <span data-ttu-id="f1d18-232">Вот очень простой пример:</span><span class="sxs-lookup"><span data-stu-id="f1d18-232">Here's a very simple example:</span></span>

```json
{
    "type": "AdaptiveCard",
    "body": [
        {
            "type": "TextBlock",
            "text": "Here is a ninja cat:"
        },
        {
            "type": "Image",
            "url": "http://adaptivecards.io/content/cats/1.png",
            "size": "Medium"
        }
    ],
    "version": "1.0"
}
```

<span data-ttu-id="f1d18-233">При вложении бота вам потребуется использовать вложение карточки бота адаптивной карточки, как в примере ниже:</span><span class="sxs-lookup"><span data-stu-id="f1d18-233">When you're invoking from a bot you'll need to use an Adaptive card bot card attachment as in the example below:</span></span>

```json
{
    "contentType": "application/vnd.microsoft.card.adaptive",
    "content": {
        "type": "AdaptiveCard",
        "body": [
            {
                "type": "TextBlock",
                "text": "Here is a ninja cat:"
            },
            {
                "type": "Image",
                "url": "http://adaptivecards.io/content/cats/1.png",
                "size": "Medium"
            }
        ],
        "version": "1.0"
    }
}
```

<span data-ttu-id="f1d18-234">Необходимо помнить, что вы искомый модуль задачи, содержащий адаптивную карточку из бота или вкладки.</span><span class="sxs-lookup"><span data-stu-id="f1d18-234">You'll need to remember whether you are invoking a task module containing an Adaptive card from a bot or a tab.</span></span>

## <a name="task-module-deep-link-syntax"></a><span data-ttu-id="f1d18-235">Синтаксис глубокой ссылки модуля задачи</span><span class="sxs-lookup"><span data-stu-id="f1d18-235">Task module deep link syntax</span></span>

<span data-ttu-id="f1d18-236">Глубокая ссылка модуля задачи — это просто сериализация объекта [TaskInfo](#the-taskinfo-object) с двумя другими частями информации и, при желании, `APP_ID` `BOT_APP_ID` :</span><span class="sxs-lookup"><span data-stu-id="f1d18-236">A task module deep link is just a serialization of the [TaskInfo object](#the-taskinfo-object) with two other pieces of information, `APP_ID` and optionally the `BOT_APP_ID`:</span></span>

`https://teams.microsoft.com/l/task/APP_ID?url=<TaskInfo.url>&height=<TaskInfo.height>&width=<TaskInfo.width>&title=<TaskInfo.title>&completionBotId=BOT_APP_ID`

`https://teams.microsoft.com/l/task/APP_ID?card=<TaskInfo.card>&height=<TaskInfo.height>&width=<TaskInfo.width>&title=<TaskInfo.title>&completionBotId=BOT_APP_ID`

<span data-ttu-id="f1d18-237">См. [объект TaskInfo](#the-taskinfo-object) для типов данных и допустимых значений для `<TaskInfo.url>` , , , и `<TaskInfo.card>` `<TaskInfo.height>` `<TaskInfo.width>` `<TaskInfo.title>` .</span><span class="sxs-lookup"><span data-stu-id="f1d18-237">See [TaskInfo object](#the-taskinfo-object) for the data types and allowable values for `<TaskInfo.url>`, `<TaskInfo.card>`, `<TaskInfo.height>`, `<TaskInfo.width>`, and `<TaskInfo.title>`.</span></span>

> [!TIP]
> <span data-ttu-id="f1d18-238">Убедитесь, что URL-адрес кодирует глубокую ссылку, особенно при использовании параметра `card` (например, [ `encodeURI()` ](https://www.w3schools.com/jsref/jsref_encodeURI.asp)функции JavaScript).</span><span class="sxs-lookup"><span data-stu-id="f1d18-238">Be sure to URL encode the deep link, especially when using the `card` parameter (for example, JavaScript's [`encodeURI()` function](https://www.w3schools.com/jsref/jsref_encodeURI.asp)).</span></span>

<span data-ttu-id="f1d18-239">Ниже данная информация и: `APP_ID` `BOT_APP_ID`</span><span class="sxs-lookup"><span data-stu-id="f1d18-239">Here's the information on `APP_ID` and `BOT_APP_ID`:</span></span>

| <span data-ttu-id="f1d18-240">Значение</span><span class="sxs-lookup"><span data-stu-id="f1d18-240">Value</span></span> | <span data-ttu-id="f1d18-241">Тип</span><span class="sxs-lookup"><span data-stu-id="f1d18-241">Type</span></span> | <span data-ttu-id="f1d18-242">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="f1d18-242">Required?</span></span> | <span data-ttu-id="f1d18-243">Описание</span><span class="sxs-lookup"><span data-stu-id="f1d18-243">Description</span></span> |
| --- | --- | --- | --- |
| `APP_ID` | <span data-ttu-id="f1d18-244">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-244">string</span></span> | <span data-ttu-id="f1d18-245">Да</span><span class="sxs-lookup"><span data-stu-id="f1d18-245">Yes</span></span> | <span data-ttu-id="f1d18-246">ИД [приложения,](~/resources/schema/manifest-schema.md#id) которое выдает модуль задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-246">The [id](~/resources/schema/manifest-schema.md#id) of the app invoking the task module.</span></span> <span data-ttu-id="f1d18-247">Массив [validDomains в](~/resources/schema/manifest-schema.md#validdomains) манифесте должен содержать `APP_ID` домен, для которых указан `url` `url` URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="f1d18-247">The [validDomains array](~/resources/schema/manifest-schema.md#validdomains) in the manifest for `APP_ID` must contain the domain for `url` if `url` is in the URL.</span></span> <span data-ttu-id="f1d18-248">(ИД приложения уже известен, когда модуль задачи вызывается с помощью вкладки или бота, поэтому он не включен в `TaskInfo` .)</span><span class="sxs-lookup"><span data-stu-id="f1d18-248">(The app ID is already known when a task module is invoked from a tab or a bot, which is why it's not included in `TaskInfo`.)</span></span> |
| `BOT_APP_ID` | <span data-ttu-id="f1d18-249">string</span><span class="sxs-lookup"><span data-stu-id="f1d18-249">string</span></span> | <span data-ttu-id="f1d18-250">Нет</span><span class="sxs-lookup"><span data-stu-id="f1d18-250">No</span></span> | <span data-ttu-id="f1d18-251">Если задано значение, объект отправляется через `completionBotId` `result` сообщение `task/submit invoke` указанному боту.</span><span class="sxs-lookup"><span data-stu-id="f1d18-251">If a value for `completionBotId` is specified, the `result` object is sent via a a `task/submit invoke` message to the specified bot.</span></span> <span data-ttu-id="f1d18-252">`BOT_APP_ID` должен быть указан как бот в манифесте приложения, т. е. вы не можете просто отправить его любому боту.</span><span class="sxs-lookup"><span data-stu-id="f1d18-252">`BOT_APP_ID` must be specified as a bot in the app's manifest, i.e. you can't just send it to any bot.</span></span> |

<span data-ttu-id="f1d18-253">Обратите внимание, что это допустимо и должно быть одинаковым, и во многих случаях это будет, если приложение имеет бота, так как рекомендуется использовать его в качестве ИД приложения, если он `APP_ID` `BOT_APP_ID` существует.</span><span class="sxs-lookup"><span data-stu-id="f1d18-253">Note that it's valid for `APP_ID` and `BOT_APP_ID` to be the same, and in many cases will be if an app has a bot since it's recommended to use that as an app's ID if there is one.</span></span>

## <a name="keyboard-and-accessibility-guidelines"></a><span data-ttu-id="f1d18-254">Рекомендации по клавиатуре и специальным возможности</span><span class="sxs-lookup"><span data-stu-id="f1d18-254">Keyboard and accessibility guidelines</span></span>

<span data-ttu-id="f1d18-255">С помощью модулей задач на основе HTML и JavaScript вы несете ответственность за то, чтобы модуль задач вашего приложения можно было использовать с клавиатурой.</span><span class="sxs-lookup"><span data-stu-id="f1d18-255">With HTML/JavaScript-based task modules it is your responsibility to ensure your app's task module can be used with a keyboard.</span></span> <span data-ttu-id="f1d18-256">Программы чтения с экрана также зависят от возможности навигации с помощью клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="f1d18-256">Screen reader programs also depend on the ability to navigate using the keyboard.</span></span> <span data-ttu-id="f1d18-257">На практике это означает две вещи:</span><span class="sxs-lookup"><span data-stu-id="f1d18-257">As a practical matter this means two things:</span></span>

1. <span data-ttu-id="f1d18-258">Использование атрибута [tabindex](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) в HTML-тегах для управления тем, какие элементы могут быть сфокусированы и если/где он участвует в последовательной навигации с помощью клавиатуры (обычно с клавишами <kbd>TAB</kbd> и <kbd>SHIFT-TAB).</kbd></span><span class="sxs-lookup"><span data-stu-id="f1d18-258">Using the [tabindex attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex) in your HTML tags to control which elements can be focused and if/where it participates in sequential keyboard navigation (usually with the <kbd>Tab</kbd> and <kbd>Shift-Tab</kbd> keys).</span></span>
2. <span data-ttu-id="f1d18-259">Обработка <kbd>клавиши ESC</kbd> в JavaScript для модуля задачи.</span><span class="sxs-lookup"><span data-stu-id="f1d18-259">Handling the <kbd>Esc</kbd> key in the JavaScript for your task module.</span></span> <span data-ttu-id="f1d18-260">Вот пример кода, показывающий, как это сделать:</span><span class="sxs-lookup"><span data-stu-id="f1d18-260">Here's a code sample showing how to do this:</span></span>

  ```javascript
  // Handle the Esc key
  document.onkeyup = function(event) {
  if ((event.key === 27) || (event.key === "Escape")) {
    microsoftTeams.submitTask(null); // this will return an err object to the completionHandler()
    }
  }
  ```

<span data-ttu-id="f1d18-261">Microsoft Teams обеспечит правильную работу навигации с помощью клавиатуры из заголовка модуля задачи в HTML и наоборот.</span><span class="sxs-lookup"><span data-stu-id="f1d18-261">Microsoft Teams will ensure that keyboard navigation works properly from the task module header into your HTML and vice-versa.</span></span>

## <a name="task-module-samples"></a><span data-ttu-id="f1d18-262">Примеры модулей задач</span><span class="sxs-lookup"><span data-stu-id="f1d18-262">Task module samples</span></span>

* [<span data-ttu-id="f1d18-263">Node.js/TypeScript</span><span class="sxs-lookup"><span data-stu-id="f1d18-263">Node.js/TypeScript sample</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-task-module-nodejs)
* [<span data-ttu-id="f1d18-264">Пример C#/.NET</span><span class="sxs-lookup"><span data-stu-id="f1d18-264">C#/.NET sample</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-task-module-csharp)

> [!div class="nextstepaction"]
> [<span data-ttu-id="f1d18-265">Подробнее: запрос разрешений устройства</span><span class="sxs-lookup"><span data-stu-id="f1d18-265">Learn  more: Request device permissions</span></span>](../concepts/device-capabilities/native-device-permissions.md)

> [!div class="nextstepaction"]
> [<span data-ttu-id="f1d18-266">Подробнее: интеграция возможностей мультимедиа</span><span class="sxs-lookup"><span data-stu-id="f1d18-266">Learn more: Integrate media capabilities</span></span>](../concepts/device-capabilities/mobile-camera-image-permissions.md)
