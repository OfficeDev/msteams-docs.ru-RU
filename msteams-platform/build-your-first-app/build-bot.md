---
title: Начало работы — сборка бота
author: girliemac
description: Быстро создайте бот Microsoft Teams с помощью microsoft Teams набор средств.
ms.author: timura
ms.date: 04/14/2020
ms.topic: tutorial
ms.openlocfilehash: dbb6f0a2497a0914d8e14473f1dbd6b2b225fc96
ms.sourcegitcommit: 303fc214aa04757779a171337f31a6539f47fd03
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2021
ms.locfileid: "52068632"
---
# <a name="create-your-first-bot-for-teams"></a>Создание первого бота для Teams

В этом руководстве вы можете создать базовое бот-приложение. Бот выступает в качестве посредника между пользователями Teams и вашим веб-приложением или службой с беседным интерфейсом. Люди могут общаться с ботом, чтобы быстро получить информацию или инициировать рабочий процесс и задачи, выполняемые вашей службой.

## <a name="what-youll-learn"></a>Что вы узнаете

* Создание проекта приложения и бота с помощью microsoft Teams набор средств для Visual Studio кода.
* Понимание конфигураций приложений Teams, соответствующих ботам.
* Хост и запуск приложения локально с помощью решения локальной туннельной туннели.
* Боковой загрузки и тестирования бота в Teams.

## <a name="prerequisites"></a>Необходимые условия

Убедитесь, что вы понимаете, как настроить и создать простое приложение Teams. Дополнительные сведения см. в [вашем первом приложении Microsoft Teams "Hello, World!".](../build-your-first-app/build-and-run.md) 

## <a name="1-create-your-app-project"></a>1. Создание проекта приложения

Программа Microsoft Teams набор средств позволяет настроить следующие компоненты для приложения: 

* **Конфигурации приложений и леса, соответствующие** ботам
* **Бот,** автоматически зарегистрированный в службе Microsoft Azure Bot

**Создание проекта приложения**

1. В Visual Studio коде выберите **Microsoft Teams** в левой панели действий и создайте новое приложение :::image type="icon" source="../assets/icons/vsc-toolkit.png"::: **Teams.**

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-01.png" alt-text="Снимок экрана, показывающий создание приложения в командной набор средств.":::

1. При запросе впишитесь в учетную запись разработки Microsoft 365. 
1. На экране Select project выберите боты conversation: 

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-02.png" alt-text="Снимок экрана, показывающий создание нового бота в командной набор средств.":::

1. На экране **Настройка проекта** введите имя бота. Это имя по умолчанию для вашего приложения, а также имя каталога проектов приложений на локальной машине.
1. Выберите **Создание нового bot** Create Bot  >  **Registration,** как показано на следующем изображении:

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-03.png" alt-text="Снимок экрана, показывающий имя нового бота в командной набор средств.":::

    В случае успешной работы новый бот будет иметь **зарегистрированный** статус. Теперь бот автоматически регистрируется в службе Microsoft Azure Bot Service. 

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-04.png" alt-text="Снимок экрана, показывающий регистрацию нового бота в командной набор средств.":::

1. Выберите **Готово** в нижней части экрана и сохраните проект на компьютере.  

## <a name="2-understand-your-app-project-components"></a>2. Понимание компонентов проекта приложения

Большая часть конфигураций приложений и строительных лесов создается автоматически при создании проекта с командной набор средств. Рассмотрим основные компоненты для создания бота:

:::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-05.png" alt-text="Снимок экрана, показывающий леса проекта в командной набор средств.":::

Если вы создали вкладку в другом учебнике, строительные леса приложений для бота отличаются. В отличие от вкладок, для разработки ботов не требуется создавать какие-либо веб-компоненты переднего конца или использовать SDK клиента Teams JavaScript.  Вместо этого в строительных лесах используется [Microsoft Bot Framework](https://dev.botframework.com/), которая является SDK с открытым исходным кодом для создания интеллектуальных корпоративных ботов, которые могут работать в Интернете, мобильных устройствах и, конечно же, Teams! 

Файл, расположенный в корневом каталоге проекта, является обработщиком, который обрабатывает действия ботов, например, как бот реагирует на определенные `botActivityHandler.js` сообщения. Строительные леса приложений предоставляют файл, расположенный в корневом каталоге проекта, это специальный обработщик Teams, который обрабатывает действия бота, например, как бот реагирует на определенные `botActivityHandler.js` сообщения.

## <a name="3-securely-expose-your-localhost-to-the-internet"></a>3. Надежно обналичите локальное подключение к Интернету

Взгляните на файл, который создает http-сервер и обрабатывает маршрутику для прослушивания входящих `index.js` запросов к боту. Url-адрес конечной точки приложения `/api/messages` для ответа на запросы клиентов: 

```JavaScript
server.post('/api/messages', (req, res) => { 
  adapter.processActivity(req, res, async (context) => { 
    await botActivityHandler.run(context); 
  }); 
}); 
```

Чтобы переададировать запросы в логику бота, необходимо настроить общедоступный URL-адрес, например , вместо `https://example.com/api/messages` `https://localhost` . Так как в настоящее время приложение работает из локального приложения, необходимо *туннелить* сеть.

Tunneling — это протокол, который позволяет транспортировать данные по сети. И локальное туннельное подключение обеспечивает подключение между локальной машиной и удаленным подключением. Чтобы безопасно выставить локализованную сеть в Интернете, рекомендуется использовать средство 3-й стороны под названием **ngrok**. Это даст вам безопасный URL-адрес. 

1. Перейдите на [ngrok.com](https://ngrok.com/download) и следуйте инструкции по установке и установке ngrok в среде. 
    
    Добавьте полный путь в файл ngrok.exe, установленный в переменную среды PATH системы. Точные действия специфичная для оболочки, которую вы используете.

1.  После завершения настройки откройте терминал и запустите `ngrok http -host-header=rewrite 3978` . 

    Теперь ngrok предоставляет общедоступный защищенный URL-адрес, который передается в локальный адрес в порту 3978, поэтому скопируйте URL-адрес HTTPS, например, как показано на скриншоте ниже, так как Teams требует `https://287a4f4223bc.ngrok.io` подключения HTTPS: 

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-ngrok-06.png" alt-text="Снимок экрана, показывающий туннельирование localhost с помощью ngrok.":::

1. Зарегистрируйте URL-адрес в манифесте приложения. 

## <a name="4-register-your-bot-endpoint"></a>4. Регистрация конечной точки бота

Чтобы использовать бот в Teams, необходимо зарегистрировать его в службе Azure Bot. Это делается автоматически при настройках приложения с помощью teams набор средств.

Для получения и обработки сообщений пользователей или запросов, отправленных боту, необходимо указать адрес конечной точки. Как правило, URL-адрес выглядит `https://HOST_URL/api/messages` как . Это можно быстро настроить в наборе инструментов.

1. В Visual Studio коде откройте **Microsoft Teams набор средств.**
1. Выберите **Боты**  >  **Существующие регистрации ботов** и выберите бот, созданный во время установки. 
1. В поле **адресов конечной точки** Бота введите URL-адрес ngrok, например, где размещен бот и `https://287a4f4223bc.ngrok.io` приложение к `/api/messages` ней:

    :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-bots-07.png" alt-text="Снимок экрана, показывающий, как туннель localhost с помощью ngrok.":::

    После правильного настройка конечной точки бот сможет отвечать на сообщения в Teams. 

## <a name="5-build-and-run-your-app"></a>5. Сборка и запуск приложения

Вы настроили URL-адрес для хост-бота и настроили его для обработки сообщений. Пришло время, чтобы ваше приложение было запущено.

1. В терминале перейдите в корневой каталог проекта приложения и запустите `npm install` .
1. Запуск `npm start` .

   В случае успеха вы увидите следующее сообщение, указывающее на то, что ваш бот прослушивает действия в `localhost` вашем :

   `Bot/ME service listening at http://localhost:3978`

## <a name="6-sideload-your-bot-in-teams"></a>6. Боковой загрузки бота в Teams

При запуске бота его можно установить в Teams.

> [!TIP]
> Если вы еще не перегружали приложение Teams до и не могли решить проблемы, следуйте [этим инструкциям.](../build-your-first-app/build-and-run.md#4-sideload-your-app-in-teams)

1. В Visual Studio коде выберите **клавишу F5** для запуска веб-клиента Teams.
1. В диалоговом окте установке приложения выберите **Добавить для меня**. 

   > [!Note]
   > По умолчанию приложение добавляется в ваше прямое сообщение чата 1:1, однако вы можете установить его в команду или чат, щелкнув стрелку рядом **Добавить для меня**. В этом руководстве давайте просто нажмите кнопку Добавить.

   :::image type="content" source="../assets/images/build-your-first-app/vscode-teams-toolkit-install-08.png" alt-text="Снимок экрана, показывающий туннельный локальный канал с помощью ngrok.":::

## <a name="7-test-your-bot"></a>7. Проверка бота

Давайте скажем "Привет" вашему боту.

* В окне составить отправьте `Hello` сообщение.
    Бот отвечает следующим сообщением:

    :::image type="content" source="../assets/images/build-your-first-app/teams-client-bot.png" alt-text="Снимок экрана, на котором пользователь скажет &quot;Привет&quot; боту Teams и будет получать ответ.":::

    Теперь создан базовый бот Teams, который может общаться с пользователями один на один или в групповых настройках (каналы и чаты) 🎉

## <a name="troubleshoot-your-bot"></a>Устранение неполадок в боте

Следующие сведения могут помочь, если у вас были проблемы с завершением этого руководства.

### <a name="bot-isnt-connected-to-teams"></a>Бот не подключен к Teams


Если вы установили приложение, но бот не работает, убедитесь, что бот подключен к каналу [Teams службы ](https://docs.microsoft.com/azure/bot-service/channel-connect-teams?view=azure-bot-service-4.0&preserve-view=true)Azure Bot.

Важно понимать, что это не то же самое, что канал в Teams. В этом случае канал — это способ подключения службы Azure Bot к Teams или другому поддерживаемом приложению майкрософт или сторонних [коммуникаций.](https://docs.microsoft.com/azure/bot-service/bot-service-channels-reference?view=azure-bot-service-4.0&preserve-view=true)

## <a name="see-also"></a>См. также

* [Основы бота](../bots/bot-basics.md)
* [Создание личной вкладки для Microsoft Teams](../build-your-first-app/build-personal-tab.md)
* [Узнайте, что еще могут сделать боты Teams с одним из наших образцов](https://github.com/microsoft/BotBuilder-Samples#teams-samples)
* [Основы беседы для ботов](../bots/how-to/conversations/conversation-basics.md)
* [Рекомендации по дизайну](../bots/design/bots.md) 
* [Шаблоны пользовательского интерфейса, готовые к производству](../concepts/design/design-teams-app-ui-templates.md)
* [Проверка подлинности ботов в Teams](../bots/how-to/authentication/auth-flow-bot.md)
* [Microsoft Bot Framework](https://dev.botframework.com/)
* [Создание бота без инструментария](../resources/bot-v3/bots-create.md)

## <a name="next-step"></a>Следующий шаг

> [!div class="nextstepaction"]
> [Создание расширения для сообщений](../build-your-first-app/build-messaging-extension.md)
