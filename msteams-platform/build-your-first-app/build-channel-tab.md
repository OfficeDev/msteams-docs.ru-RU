---
title: Начало работы — Создание вкладки "канал" и "Группа"
author: heath-hamilton
description: Быстро создайте вкладку "канал и группа Microsoft Teams" с помощью набора инструментов Microsoft Teams.
ms.author: lajanuar
ms.date: 10/09/2020
ms.topic: tutorial
ms.openlocfilehash: f890754cdf4ca43f39c25e3ba24fcf47b08c5a9f
ms.sourcegitcommit: d61f14053fc695bc1956bf50e83956613c19ccca
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "48452857"
---
# <a name="build-a-channel-and-group-tab-for-microsoft-teams"></a>Создание вкладки "канал" и "Группа" для Microsoft Teams

В этом руководстве описывается создание простой *вкладки канала* (также известной как *вкладка группы*), которая является полноэкранной страницей для канала команды или чата. В отличие от вкладки личных сведений, пользователи могут настроить некоторые аспекты вкладки такого типа (например, переименовать вкладку, чтобы она была осмысленной для канала).

## <a name="your-assignment"></a>Ваше назначение

Не давно, ваша организация создала вкладку команды со сведениями о том, как обращаться к важным функциям (служба технической поддержки, HR и т. д.). Тем не менее, так как вкладка была создана только для личного использования, каждый пользователь должен установить эту вкладку, чтобы ее увидеть, а уровень внедрения меньше ожидаемого. Другими словами, слишком много сотрудников по-прежнему не знают, как связаться со службой поддержки.

Вы можете упростить поиск этих сведений путем создания вкладки канала, которая будет изменять нагрузку, требующую от всех пользователей устанавливать приложение. Вместо этого один пользователь может установить вкладку в канале или чат, чтобы воспользоваться преимуществами всей группы.

## <a name="what-youll-learn"></a>Что вы узнаете

> [!div class="checklist"]
>
> * Создание проекта приложения с помощью набора инструментов Microsoft Teams для Visual Studio Code
> * Определение некоторых свойств манифеста приложения и формирование шаблонов, относящихся к вкладкам каналов и групп
> * Локальное размещение приложения
> * Создание содержимого вкладки
> * Создание контента для страницы конфигурации вкладки
> * Настройка и установка вкладки
> * Ввод предлагаемого имени вкладки

## <a name="1-create-your-app-project"></a>1. Создайте проект приложения.

Набор средств Microsoft Teams помогает настроить манифест приложения и формирование шаблонов, относящихся к вкладкам каналов и групп, включая основную страницу конфигурации и страницу содержимого, в которой отображается "Hello, World!". Сообщение.

> [!TIP]
> Если вы еще не создали проект приложения Teams, возможно, вам будет полезно выполнить приведенные [выше инструкции по](../build-your-first-app/build-and-run.md) более подробному объяснению проектов.

1. В Visual Studio Code выберите **Microsoft Teams** :::image type="icon" source="../assets/icons/vsc-toolkit.png"::: на левой панели активности и выберите **создать приложение Teams**.
1. Введите имя приложения Teams. (Это имя приложения по умолчанию, а также имя каталога проекта приложения на локальном компьютере.)
1. На экране **добавить возможности** выберите **вкладки** , а затем **группу или канал Teams**.
1. В нижней части экрана нажмите кнопку **Готово** , чтобы настроить проект.  

## <a name="2-identify-relevant-app-project-components"></a>2. определение соответствующих компонентов проекта приложения

Большинство манифестов и шаблонов приложений настраиваются автоматически при создании проекта с помощью набора инструментов Teams. Рассмотрим основные компоненты для создания вкладки "канал" и "Группа".

### <a name="app-manifest"></a>Манифест приложения

В следующем фрагменте манифеста приложения показаны [`configurableTabs`](../resources/schema/manifest-schema.md#configurabletabs) Свойства и значения по умолчанию, которые относятся к вкладкам каналов и групп.

```JSON
"configurableTabs": [
    {
        "configurationUrl": "{baseUrl0}/config",
        "canUpdateConfiguration": true,
        "scopes": [
            "team",
            "groupchat"
        ]
    }
],
```

* `configurationUrl`: URL-адрес узла для страницы настройки вкладки (должен быть HTTPS).
* `canUpdateConfiguration`: Если задано значение `true` , пользователи могут изменять параметры вкладок, переименовывать вкладку или удалять ее из канала или чата.
* `scopes`: Указывает, могут ли пользователи устанавливать приложение в каналах ( `team` ) и чата ( `groupchat` ). Необходимо указать по крайней мере одно значение.

### <a name="app-scaffolding"></a>Формирование шаблонов приложений

Формирование шаблонов приложений предоставляет `TabConfig.js` файл, расположенный в `src/components` каталоге проекта, для отображения страницы конфигурации вкладки (больше в скором времени).

## <a name="3-run-your-app"></a>3. Запустите приложение.

В течение этого времени вы создадите и запустите свое приложение локально.

1. В терминале перейдите к корневому каталогу проекта приложения и запустите его `npm install` .
1. Выполните команду `npm start` .

По завершении **компиляции успешно выполняется.** сообщение в терминале.

## <a name="4-set-up-a-secure-tunnel-to-your-app"></a>4. Настройка безопасного туннеля для приложения

В целях тестирования давайте разместите вкладку на локальном веб-сервере (порт 3000).

1. В терминале запустите `ngrok http 3000` .
1. Скопируйте предоставленный URL-адрес HTTPS.
1. В `.publish` каталоге откройте `Development.env` .
1. Замените `baseUrl0` значение скопированным URL-адресом. (Например, замените `baseUrl0=http://localhost:3000` на `baseUrl0=https://85528b2b3ca5.ngrok.io` .)

Манифест приложения указывает на место размещения вкладки.

## <a name="5-customize-your-tab-content-page"></a>5. Настройка страницы контента вкладки

Откройте манифест приложения ( `manifest.json` ) в `.publish` каталоге и задайте следующие свойства в разделе [`staticTabs`](../resources/schema/manifest-schema.md#statictabs) , определяющем страницу содержимого вкладки.

```JSON
"staticTabs": [
    {
        "entityId": "index",
        "name": "My Contacts",
        "contentUrl": "{baseUrl0}/tab",
        "scopes": [ "personal" ]
    }
],
```

Скопируйте и обновите следующий фрагмент кода, используя сведения, которые относятся к вашей организации, или, в целях простоты, используйте код как есть.

```JSX
<div>
  <h1>Important Contacts</h1>
    <ul>
      <li>Help Desk: <a href="mailto:support@company.com">support@company.com</a></li>
      <li>Human Resources: <a href="mailto:hr@company.com">hr@company.com</a></li>
      <li>Facilities: <a href="mailto:facilities@company.com">facilities@company.com</a></li>
    </ul>
</div>
```

Перейдите в `src/components` каталог и откройте его `Tab.js` . Нахождение `render()` функции и вставка содержимого внутри `return()` (как показано на рисунке).

```JavaScript
render() {

    let userName = Object.keys(this.state.context).length > 0 ? this.state.context['upn'] : "";

    return (
    <div>
      <h1>Important Contacts</h1>
        <ul>
          <li>Help Desk: <a href="mailto:support@company.com">support@company.com</a></li>
          <li>Human Resources: <a href="mailto:hr@company.com">hr@company.com</a></li>
          <li>Facilities: <a href="mailto:facilities@company.com">facilities@company.com</a></li>
        </ul>
    </div>
    );
}
```

Добавьте следующее правило, чтобы `App.css` ссылки электронной почты легче читались независимо от того, какая тема используется.

```CSS
a {
  color: inherit;
}
```

## <a name="6-create-your-tab-configuration-page"></a>6. Создание страницы конфигурации вкладки

У каждой вкладки в канале или в чате есть страница конфигурации, которая является модальной по крайней мере с одним параметром установки, который отображается при установке приложения пользователями. По умолчанию на странице конфигурации запрашиваются пользователи, хотят ли они уведомлять канал или чат при установке вкладки.

Добавьте содержимое на страницу конфигурации. Перейдите в `src/components` каталог проекта, откройте `TabConfig.js` и вставьте содержимое внутри `return()` (как показано на рисунке).

```JavaScript
return (
    <div>
      <h1>Add My Contoso Contacts</h1>
      <div>
        Select <b>Save</b> to add our organization's important contacts to this workspace.
      </div>
    </div>
);
```
 
> [!TIP]
> Как минимум, укажите некоторые краткие сведения о приложении на этой странице, так как это может быть первый раз, когда пользователи узнают об этом. Кроме того, можно включить настраиваемые параметры конфигурации или [Рабочий процесс проверки подлинности](../tabs/how-to/authentication/auth-aad-sso.md), который распространен на страницах настройки вкладок.

## <a name="7-allow-the-tab-to-be-configured-and-installed"></a>7. разрешить настройку и установку вкладки

Чтобы пользователи успешно настроили и установили вкладку, необходимо добавить [URL-адрес безопасного узла, настроенный](#4-set-up-a-secure-tunnel-to-your-app) на компонент страницы конфигурации.

Перейдите к разделу `TabConfig.js` и выберите `microsoftTeams.settings.setSettings` . Для `"contentUrl"` замените `localhost:3000` часть URL-адреса на домен, в котором размещается содержимое вкладки (как показано на рисунке).

```JavaScript
microsoftTeams.settings.setSettings({
  "contentUrl": "https://<MY_HOST_DOMAIN>/tab"
});
```

Кроме того, убедитесь, что `microsoftTeams.settings.setValidityState(true);` . По умолчанию он имеет значение, но если для этого параметра задано значение `false` , то кнопка **сохранить** на странице Конфигурация отключена.

## <a name="8-provide-a-suggested-tab-name"></a>8. Введите предлагаемое имя вкладки.

При установке вкладки для личного использования отображаемым именем является `name` свойство в `staticTabs` части манифеста приложения (например, " **Мои контакты**"). При установке вкладки канал по умолчанию отображается имя приложения (например, **First-App**).

Это может быть разумно в зависимости от того, что вы назначите для вашего приложения, но вы можете указать имя, которое лучше в контексте совместной работы группы (например, " **Контакты группы**").

В `TabConfig.js` , вернитесь к `microsoftTeams.settings.setSettings` . Добавьте `suggestedDisplayName` свойство с именем вкладки, которое будет отображаться по умолчанию (как показано). Используйте предоставленное имя или создайте собственное. Помните, что в манифесте вы можете разрешить пользователям изменять имя, если это необходимо.

```JavaScript
microsoftTeams.settings.setSettings({
  "contentUrl": "https://<MY_HOST_DOMAIN>/tab",
  "suggestedDisplayName": "Team Contacts"
});
```

## <a name="9-view-the-tab"></a>9. Просмотр вкладки

Чтобы просмотреть страницы конфигурации и контента вкладки, необходимо установить их в канале или чате.

1. В клиенте Teams выберите **приложения**.
1. Выберите **Отправить настраиваемое приложение** и выберите приложение `Development.zip` .
1. Выберите команду **Добавить в группу** или **Добавить в чат** , а затем выберите канал или чат, который вы можете использовать для тестирования.
1. Выберите **Настройка вкладки**. Отобразится страница Конфигурация.<br/>
   :::image type="content" source="../assets/images/tabs/channel-tab-tutorial-content.png" alt-text="Снимок экрана: страница настройки вкладки каналов.":::
1. Нажмите кнопку **сохранить** , чтобы настроить вкладку. Содержимое отображается.<br/>
   :::image type="content" source="../assets/images/tabs/channel-tab-tutorial-content-installed.png" alt-text="Снимок экрана: страница настройки вкладки каналов.":::

## <a name="well-done"></a>Прекрасно

Поздравляем! У вас есть приложение Teams с вкладкой для отображения содержимого в каналах и беседах.

## <a name="learn-more"></a>Подробнее

* [Проверка подлинности пользователей вкладки с единым входом](../tabs/how-to/authentication/auth-aad-sso.md): Если вы хотите, чтобы авторизованные пользователи просматривали вкладку, настройте единый вход (SSO) через Azure Active Directory (AD).
* [Внедрение контента из существующего веб-приложения или веб-страницы](../tabs/how-to/add-tab.md#tab-requirements): мы показали, как создать новое содержимое для вкладки личных данных, но вы также можете загрузить контент с внешнего URL-адреса.
* [Создайте простой интерфейс для вкладки](../tabs/design/tabs.md): Ознакомьтесь с рекомендациями по проектированию вкладок Teams.
* [Создание вкладок для мобильных устройств](../tabs/design/tabs-mobile.md): Узнайте, как создавать вкладки для телефонов и планшетов.
* [Создание вкладки без набора инструментов](../tabs/how-to/add-tab.md)

## <a name="next-lesson"></a>Следующий урок

Вы знаете, как создать вкладку для совместной работы. Хотите попробовать создать другой тип приложения Teams?

> [!div class="nextstepaction"]
> [Создание бота](../build-your-first-app/build-bot.md)
