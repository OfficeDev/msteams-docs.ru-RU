---
title: Определение команд поиска расширений сообщений
author: surbhigupta
description: Узнайте о командах поиска расширений сообщений для приложений Teams, чтобы создать команду поиска с помощью манифеста приложения и вручную.
ms.topic: conceptual
ms.author: anclear
ms.localizationpriority: medium
ms.openlocfilehash: c126d6436c5fb091804c92caeb2876c09392bd9b
ms.sourcegitcommit: 84747a9e3c561c2ca046eda0b52ada18da04521d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2022
ms.locfileid: "68791834"
---
# <a name="define-message-extension-search-commands"></a>Определение команд поиска расширений сообщений

[!include[v4-to-v3-SDK-pointer](~/includes/v4-to-v3-pointer-me.md)]

Команды поиска расширений сообщений позволяют пользователям выполнять поиск во внешних системах и вставлять результаты этого поиска в сообщение в виде карточки. В этом документе описано, как выбрать команду поиска для вызова расположений и добавить команду поиска в манифест приложения.

> [!NOTE]
> Максимальный размер карточки результата составляет 28 КБ. Карточка не отправляется, если ее размер превышает 28 КБ.

См. следующее видео, чтобы узнать, как определить команды поиска расширений сообщений:
<br>

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE4OIvK]
<br>

## <a name="select-search-command-invoke-locations"></a>Выбор расположений вызова команды поиска

Команда поиска вызывается из любого или обоих следующих расположений:

* Область создания сообщения: кнопки в нижней части области создания сообщения.
* Командное поле: @mentioning в командном окне.

При вызове команды поиска из области создания сообщений пользователь отправляет результаты в беседу. При вызове из командного поля пользователь взаимодействует с полученной карточкой или копирует ее для использования в другом месте.

На следующем рисунке показаны расположения вызова команды поиска:

:::image type="content" source="~/assets/images/messaging-extension/search-command-invoke-locations.png" alt-text="Снимок экрана: расположения вызова команды поиска в канале Teams.":::

## <a name="add-the-search-command-to-your-app-manifest"></a>Добавление команды поиска в манифест приложения

Чтобы добавить команду поиска в манифест приложения, необходимо добавить новый `composeExtension` объект на верхний уровень JSON манифеста приложения. Команду поиска можно добавить с помощью портала разработчика или вручную.

### <a name="create-a-search-command-using-developer-portal"></a>Создание команды поиска с помощью портала разработчика

Предварительным условием для создания команды поиска является то, что вы уже должны создать расширение сообщений. Сведения о том, как создать расширение для сообщений, см. в разделе [Создание расширения для сообщений](~/messaging-extensions/how-to/create-messaging-extension.md).

**Создание команды действия**

1. Откройте **портал разработчика** в клиенте Microsoft Teams и выберите вкладку **Приложения** . Если пакет приложения уже создан на **портале разработчика**, выберите из списка. Если вы еще не создали пакет приложения, импортируйте существующий.
1. После импорта пакета приложения выберите **Расширения сообщений** в разделе **Функции приложения**.
1. Чтобы создать расширение для сообщений, вам потребуется зарегистрированный бот Майкрософт. Можно использовать существующий бот или создать новый. Выберите **параметр Создать бот** , присвойте имя новому боту, а затем нажмите **кнопку Создать**.

   :::image type="content" source="../../../assets/images/tdp/bot-page.png" alt-text="Снимок экрана: параметры настройки бота для приложения на портале разработчика Teams.":::

1. Чтобы использовать существующего бота, выберите **Выбрать существующего бота** и выберите существующих ботов в раскрывающемся списке или **введите идентификатор бота** , если у вас уже создан идентификатор бота.

1. Выберите область расширения для обмена сообщениями и нажмите кнопку **Сохранить**.

1. Выберите **Добавить команду** в разделе **Команда** , чтобы включить команды, которые определяют поведение расширения сообщений.
На следующем рисунке показано добавление команды расширения для сообщений:

   :::image type="content" source="../../../assets/images/tdp/add-a-command.PNG" alt-text="Снимок экрана: добавление команды на портале разработчика Teams для определения поведения расширения сообщений.":::

1. Выберите **Поиск** и введите **Идентификатор команды**, **Заголовок команды** и **Описание команды**.

1. Введите все параметры и выберите тип входных данных в раскрывающемся списке.

   :::image type="content" source="../../../assets/images/tdp/add-a-command-parameter.PNG" alt-text="Снимок экрана: добавление параметра для определения команды на портале разработчика Teams для расширения сообщений.":::

1. Выберите **Добавить домен** в разделе **Ссылки предварительного просмотра**.

1. Введите допустимый домен и нажмите кнопку **Добавить**.

   :::image type="content" source="../../../assets/images/tdp/add-domain.PNG" alt-text="Снимок экрана: добавление допустимого домена в расширение обмена сообщениями для распаковки ссылок.":::

1. Нажмите кнопку **Сохранить**.

   :::image type="content" source="../../../assets/images/tdp/add-a-command-save.PNG" alt-text="Снимок экрана: сохранение всех параметров и параметров для расширения сообщений.":::

**Добавление дополнительных параметров**

1. Выберите многоточие в разделе команды, а затем выберите **Изменить параметр**.

   :::image type="content" source="../../../assets/images/tdp/edit-parameters.PNG" alt-text="На снимках экрана показано, как изменить параметры для расширения сообщений.":::

1. Выберите **Добавить параметры** и введите все параметры.

   :::image type="content" source="../../../assets/images/tdp/add-parameter.PNG" alt-text="Снимок экрана: добавление дополнительных параметров для расширения сообщений."lightbox="../../../assets/images/tdp/add-a-parameters.PNG":::

### <a name="create-a-search-command-manually"></a>Создание команды поиска вручную

Чтобы вручную добавить команду поиска расширения сообщений в манифест приложения, необходимо добавить следующие параметры в `composeExtension.commands` массив объектов:

| Имя свойства | Назначение | Обязательный? | Минимальная версия манифеста |
|---|---|---|---|
| `id` | Это свойство является уникальным идентификатором, который назначается команде поиска. Запрос пользователя включает этот идентификатор. | Да | 1.0 |
| `title` | Это свойство является именем команды. Это значение отображается в пользовательском интерфейсе. | Да | 1.0 |
| `description` | Это свойство представляет собой текст справки, указывающий, что делает эта команда. Это значение выводится в пользовательском интерфейсе. | Да | 1.0 |
| `type` | Это свойство должно быть .`query` | Нет | 1.4 |
|`initialRun` | Если для этого свойства задано **значение true**, это означает, что эта команда должна быть выполнена, как только пользователь выберет эту команду в пользовательском интерфейсе. | Нет | 1.0 |
| `context` | Это свойство является необязательным массивом значений, определяющим контекст, в который доступно действие поиска. Возможные значения — `message`, `compose` и `commandBox`. Значение по умолчанию: `["compose", "commandBox"]`. | Нет | 1.5 |

Необходимо добавить сведения о параметре поиска, который определяет текст, видимый пользователю в клиенте Teams.

| Имя свойства | Назначение | Обязательно? | Минимальная версия манифеста |
|---|---|---|---|
| `parameters` | Это свойство определяет статический список параметров для команды . | Нет | 1.0 |
| `parameter.name` | Это свойство описывает имя параметра. Отправляется `parameter.name` в службу в пользовательском запросе. | Да | 1.0 |
| `parameter.description` | Это свойство описывает цели параметра или пример значения, которое необходимо указать. Это значение выводится в пользовательском интерфейсе. | Да | 1.0 |
| `parameter.title` | Это свойство представляет собой краткое понятное название или метку параметра. | Да | 1.0 |
| `parameter.inputType` | Для этого свойства задается тип требуемых входных данных. Возможные значения: `text`, `textarea`, `number`, `date`, `time`, . `toggle` По умолчанию задано значение `text`. | Нет | 1.4 |
| `parameters.value` | Начальное значение параметра. В настоящее время значение не поддерживается. | Нет | 1.5 |

#### <a name="example"></a>Пример

Ниже приведен пример простого манифеста приложения объекта, определяющего `composeExtensions` команду поиска:

```json
{
...
  "composeExtensions": [
    {
      "botId": "57a3c29f-1fc5-4d97-a142-35bb662b7b23",
      "canUpdateConfiguration": true,
      "commands": [{
          "id": "searchCmd",
          "description": "Search Bing for information on the web",
          "title": "Search",
          "initialRun": true,
          "parameters": [{
            "name": "searchKeyword",
            "description": "Enter your search keywords",
            "title": "Keywords"
          }]
        }
      ]
    }
  ],
...
}

```

Полный манифест приложения см. в разделе [Схема манифеста приложения](~/resources/schema/manifest-schema.md).

## <a name="code-sample"></a>Пример кода

| Название примера           | Описание | .NET    | Node.js   |
|:---------------------|:--------------|:---------|:--------|
|Поиск в расширении для сообщений Teams   |  Описывает, как определить команды поиска и отвечать на поисковые запросы.        |[Просмотр](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/50.teams-messaging-extensions-search)|[View](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/50.teams-messaging-extensions-search)|

## <a name="step-by-step-guide"></a>Пошаговые инструкции

Выполните [пошаговые инструкции](../../../sbs-messagingextension-searchcommand.yml) по созданию расширения для сообщений на основе поиска.

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Отвечайте на команды поиска](~/messaging-extensions/how-to/search-commands/respond-to-search.md).
