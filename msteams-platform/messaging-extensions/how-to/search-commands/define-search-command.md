---
title: Определение команд поиска расширения сообщений
author: surbhigupta
description: В этом модуле вы узнаете о командах поиска расширений сообщений для Teams приложений, чтобы создать команду поиска с помощью манифеста приложения и вручную.
ms.topic: conceptual
ms.author: anclear
ms.localizationpriority: medium
ms.openlocfilehash: e71e83f8fbd6b0d44257a2d38fd13486b087bc5e
ms.sourcegitcommit: ca84b5fe5d3b97f377ce5cca41c48afa95496e28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2022
ms.locfileid: "66142810"
---
# <a name="define-message-extension-search-commands"></a>Определение команд поиска расширения сообщений

[!include[v4-to-v3-SDK-pointer](~/includes/v4-to-v3-pointer-me.md)]

Команды поиска расширений сообщений позволяют пользователям выполнять поиск во внешних системах и вставлять результаты этого поиска в сообщение в виде карточки. В этом документе описывается, как выбрать расположения для вызова команды поиска и добавить команду поиска в манифест приложения.

> [!NOTE]
> Максимальный размер карточки результата — 28 КБ. Карточка не отправляется, если ее размер превышает 28 КБ.

## <a name="select-search-command-invoke-locations"></a>Выбор расположений вызова команды поиска

Команда поиска вызывается из любого из следующих расположений или из обоих следующих расположений:

* Область создания сообщения: кнопки в нижней части области создания сообщения.
* Командная строка: @mentioning в командной строке.

  При вызове команды поиска из области создания сообщения пользователь отправляет результаты в беседу. При вызове из командного поля пользователь взаимодействует с полученной карточкой или копирует ее для использования в другом месте.

На следующем рисунке отображаются расположения вызова команды поиска:

:::image type="content" source="~/assets/images/messaging-extension/search-command-invoke-locations.png" alt-text="Расположения вызова команды поиска":::

## <a name="add-the-search-command-to-your-app-manifest"></a>Добавление команды поиска в манифест приложения

Чтобы добавить команду поиска в манифест приложения, `composeExtension` необходимо добавить новый объект на верхний уровень JSON манифеста приложения. Вы можете добавить команду поиска с помощью App Studio или вручную.

### <a name="create-a-search-command-using-app-studio"></a>Создание команды поиска с помощью App Studio

Предварительным требованием для создания команды поиска является то, что вы уже должны создать расширение сообщения. Сведения о том, как создать расширение для сообщений, см. в разделе [Создание расширения для сообщений](~/messaging-extensions/how-to/create-messaging-extension.md).

Чтобы создать команду поиска, выполните следующие действия.

1. Откройте **App Studio** в клиенте Microsoft Teams и выберите вкладку **редактора манифеста**.
1. Если вы уже создали пакет приложения в **App Studio**, выберите его из списка. Если вы еще не создали пакет приложения, импортируйте существующий.
1. После импорта пакета приложения выберите расширения **сообщений в** разделе **"Возможности"**. Вы получите всплывающее окно настройки расширения для сообщений.
1. Выберите в окне **Настроить**, чтобы включить расширение для сообщений в интерфейс приложения. На следующем рисунке показана страница настройки расширения сообщения:

    :::image type="content" source="~/assets/images/messaging-extension/messaging-extension-set-up.png" alt-text="Настройка расширения для сообщений":::

1. Чтобы создать расширение сообщения, вам потребуется зарегистрированный бот Майкрософт. Можно использовать существующий бот или создать новый. Выберите **Создать бот**, присвойте имя новому боту и щелкните **Создать**. На следующем рисунке показано создание бота расширения для сообщений:

    :::image type="content" source="~/assets/images/messaging-extension/create-bot-for-messaging-extension.png" alt-text="Создание бота расширения для сообщений":::

1. Чтобы использовать существующий бот, выберите **Использовать существующий бот** и щелкните **Выбрать один из существующих ботов**, чтобы выбрать существующие боты из раскрывающегося списка; укажите **Имя бота** и выберите **Сохранить**. Или выберите **Подключение к другому идентификатору бота**, если идентификатор бота уже создан, укажите **Имя бота** и выберите **Сохранить**. 

    :::image type="content" source="~/assets/images/messaging-extension/use-existing-bot.png" alt-text="Использование существующего бота в расширении для сообщений":::

1. Выберите **"** Добавить" **в разделе "Команда** " на странице расширений сообщений, чтобы включить команды, которые определяют поведение расширения сообщения.
На следующем рисунке показано добавление команды расширения для сообщений:

    :::image type="content" source="~/assets/images/messaging-extension/include-command.png" alt-text="Добавление команды":::

1. Выберите **"Разрешить пользователям запрашивать сведения в службе" и вставлять их в сообщение**. На следующем рисунке показан выбор параметра команды поиска:

    :::image type="content" source="~/assets/images/messaging-extension/search-command-parameter-selection.png" alt-text="Выбор параметра команды поиска":::

1. Добавьте **Идентификатор команды** и **Заголовок**.
1. Выберите расположение, из которого должна быть вызвана команда поиска. На следующем рисунке показано расположение вызова команды поиска:

    :::image type="content" source="~/assets/images/messaging-extension/search-command-invoke-location-selection.png" alt-text="Выбор расположения вызова команды поиска":::

1. Добавьте параметр поиска и нажмите кнопку **"Сохранить"**.

### <a name="create-a-search-command-manually"></a>Создание команды поиска вручную

Чтобы вручную добавить команду поиска расширения сообщения в манифест приложения, `composeExtension.commands` необходимо добавить в массив объектов следующие параметры:

| Имя свойства | Назначение | Обязательный? | Минимальная версия манифеста |
|---|---|---|---|
| `id` | Это свойство является уникальным идентификатором, который назначается команде поиска. Запрос пользователя включает этот идентификатор. | Да | 1.0 |
| `title` | Это свойство является именем команды. Это значение отображается в пользовательском интерфейсе. | Да | 1.0 |
| `description` | Это свойство представляет собой текст справки, указывающий, что делает эта команда. Это значение выводится в пользовательском интерфейсе. | Да | 1.0 |
| `type` | Это свойство должно иметь значение `query`. | Нет | 1.4 |
|`initialRun` | Если этому свойству присвоено значение **true**, это означает, что эта команда должна выполняться, как только пользователь выберет эту команду в пользовательском интерфейсе. | Нет | 1.0 |
| `context` | Это свойство является необязательным массивом значений, который определяет контекст, в котором доступно действие поиска. Возможные значения — `message`, `compose` и `commandBox`. Значение по умолчанию: `["compose", "commandBox"]`. | Нет | 1.5 |

Необходимо добавить сведения о параметре поиска, который определяет текст, видимый пользователю в Teams клиенте.

| Имя свойства | Назначение | Обязательно? | Минимальная версия манифеста |
|---|---|---|---|
| `parameters` | Это свойство определяет статический список параметров для команды. | Нет | 1.0 |
| `parameter.name` | Это свойство описывает имя параметра. Оно отправляется в службу в составе запроса пользователя. | Да | 1.0 |
| `parameter.description` | Это свойство описывает цели параметра или пример значения, которое необходимо указать. Это значение выводится в пользовательском интерфейсе. | Да | 1.0 |
| `parameter.title` | Это свойство представляет собой краткое понятное название или метку параметра. | Да | 1.0 |
| `parameter.inputType` | Этому свойству задается тип входных данных. Возможные значения: `text`, `textarea`, `number`, , `date`, `toggle``time`. По умолчанию задано значение `text`. | Нет | 1.4 |

#### <a name="example"></a>Пример

В следующем разделе приведен пример простого манифеста приложения для объекта `composeExtensions` , определяющего команду поиска:

```json
{
...
  "composeExtensions": [
    {
      "botId": "57a3c29f-1fc5-4d97-a142-35bb662b7b23",
      "canUpdateConfiguration": true,
      "commands": [{
          "id": "searchCmd",
          "description": "Search Bing for information on the web",
          "title": "Search",
          "initialRun": true,
          "parameters": [{
            "name": "searchKeyword",
            "description": "Enter your search keywords",
            "title": "Keywords"
          }]
        }
      ]
    }
  ],
...
}
```

Полный манифест приложения см. в [схеме манифеста приложения](~/resources/schema/manifest-schema.md).

## <a name="code-sample"></a>Пример кода

| Название примера           | Описание | .NET    | Node.js   |
|:---------------------|:--------------|:---------|:--------|
|Поиск в расширении для сообщений Teams   |  Описывает, как определить команды поиска и отвечать на поисковые запросы.        |[Просмотр](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/50.teams-messaging-extensions-search)|[View](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/50.teams-messaging-extensions-search)|

## <a name="step-by-step-guide"></a>Пошаговые инструкции

Выполните [пошаговое руководство,](../../../sbs-messagingextension-searchcommand.yml) чтобы создать расширение сообщений на основе поиска.

## <a name="next-step"></a>Следующее действие

> [!div class="nextstepaction"]
> [Ответ на команды поиска](~/messaging-extensions/how-to/search-commands/respond-to-search.md).
