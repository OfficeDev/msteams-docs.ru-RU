---
title: Создание расширения для сообщений с помощью App Studio
author: clearab
description: Узнайте, как создать расширение системы обмена сообщениями Microsoft Teams с помощью App Studio.
ms.topic: conceptual
ms.author: anclear
ms.openlocfilehash: 24d5736fcc7c88d903d30c6f1103a95154143058
ms.sourcegitcommit: aca9990e1f84b07b9e77c08bfeca4440eb4e64f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "49409059"
---
# <a name="create-a-messaging-extension-using-app-studio"></a><span data-ttu-id="d8b55-103">Создание расширения для сообщений с помощью App Studio</span><span class="sxs-lookup"><span data-stu-id="d8b55-103">Create a messaging extension using App Studio</span></span>

> [!TIP]
> <span data-ttu-id="d8b55-104">Ищете быстрый способ приступить к работе?</span><span class="sxs-lookup"><span data-stu-id="d8b55-104">Looking for a faster way to get started?</span></span> <span data-ttu-id="d8b55-105">Создайте [расширение системы обмена сообщениями](../../build-your-first-app/build-messaging-extension.md) с помощью набора инструментов Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="d8b55-105">Create a [messaging extension](../../build-your-first-app/build-messaging-extension.md) using the Microsoft Teams Toolkit.</span></span>

<span data-ttu-id="d8b55-106">На высоком уровне необходимо выполнить следующие действия, чтобы создать расширение системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-106">At a high level, you'll need to complete the following steps to create a messaging extension.</span></span>

1. <span data-ttu-id="d8b55-107">Подготовка среды разработки</span><span class="sxs-lookup"><span data-stu-id="d8b55-107">Prepare your development environment</span></span>
2. <span data-ttu-id="d8b55-108">Создание и развертывание веб-службы (при разработке используйте службу туннелирования, например ngrok, чтобы запускать ее локально)</span><span class="sxs-lookup"><span data-stu-id="d8b55-108">Create and deploy your web service (while developing use a tunneling service like ngrok to run it locally)</span></span>
3. <span data-ttu-id="d8b55-109">Регистрация веб-службы в Bot Framework</span><span class="sxs-lookup"><span data-stu-id="d8b55-109">Register your web service with the Bot Framework</span></span>
4. <span data-ttu-id="d8b55-110">Создайте свой пакет приложений</span><span class="sxs-lookup"><span data-stu-id="d8b55-110">Create your app package</span></span>
5. <span data-ttu-id="d8b55-111">Отправка пакета в Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="d8b55-111">Upload your package to Microsoft Teams</span></span>

<span data-ttu-id="d8b55-112">Создание веб-службы, создание пакета приложения и регистрация веб-службы с помощью Bot Framework можно выполнять в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="d8b55-112">Creating your web service, creating your app package, and registering your web service with the Bot Framework can be done in any order.</span></span> <span data-ttu-id="d8b55-113">Так как эти три части так интертвинед, вам потребуется вернуться, чтобы обновить другие.</span><span class="sxs-lookup"><span data-stu-id="d8b55-113">Because those three pieces are so intertwined, no matter which order you do them in you'll need return to update the others.</span></span> <span data-ttu-id="d8b55-114">Для регистрации требуется конечная точка обмена сообщениями из развернутой веб-службы, а веб-службе требуется идентификатор и пароль, созданные при регистрации.</span><span class="sxs-lookup"><span data-stu-id="d8b55-114">Your registration needs the messaging endpoint from your deployed web service, and your web service needs the Id and password created from your registration.</span></span> <span data-ttu-id="d8b55-115">Манифест приложения также должен использовать этот идентификатор для подключения Teams к вашей веб-службе.</span><span class="sxs-lookup"><span data-stu-id="d8b55-115">Your app manifest also needs that Id to connect Teams to your web service.</span></span>

<span data-ttu-id="d8b55-116">Когда вы создаете расширение системы обмена сообщениями, регулярно перемещайтесь между изменением манифеста приложения и развертыванием кода в веб-службе.</span><span class="sxs-lookup"><span data-stu-id="d8b55-116">As you're building your messaging extension, you'll regularly be moving between changing your app manifest, and deploying code to your web service.</span></span> <span data-ttu-id="d8b55-117">При работе с манифестом приложения помните, что вы можете вручную управлять файлом JSON или вносить изменения через приложение App Studio.</span><span class="sxs-lookup"><span data-stu-id="d8b55-117">When working with the app manifest, keep in mind that you can either manually manipulate the JSON file, or make changes through App Studio.</span></span> <span data-ttu-id="d8b55-118">В любом случае вам потребуется повторно развернуть (отправить) ваше приложение в Teams, если вы вносите изменения в манифест, но это не нужно делать при развертывании изменений в веб-службе.</span><span class="sxs-lookup"><span data-stu-id="d8b55-118">Either way, you'll need to re-deploy (upload) your app in Teams when you make a change to the manifest, but there's no need to do so when you deploy changes to your web service.</span></span>

[!include[prepare environment](~/includes/prepare-environment.md)]

## <a name="create-your-web-service"></a><span data-ttu-id="d8b55-119">Создание веб-службы</span><span class="sxs-lookup"><span data-stu-id="d8b55-119">Create your web service</span></span>

<span data-ttu-id="d8b55-120">Сердце расширения системы обмена сообщениями — это веб-служба.</span><span class="sxs-lookup"><span data-stu-id="d8b55-120">The heart of your messaging extension is your web service.</span></span> <span data-ttu-id="d8b55-121">Он будет определять один маршрут, как правило, `/api/messages` для получения всех запросов.</span><span class="sxs-lookup"><span data-stu-id="d8b55-121">It will define a single route, typically `/api/messages`, to receive all requests on.</span></span> <span data-ttu-id="d8b55-122">Если вы приступите к работе с нуля, вы можете выбрать один из вариантов.</span><span class="sxs-lookup"><span data-stu-id="d8b55-122">If you're getting started from scratch, you have a few options to choose from.</span></span>

* <span data-ttu-id="d8b55-123">Воспользуйтесь одним из учебных [руководств,](#learn-more) посвященных созданию веб-службы.</span><span class="sxs-lookup"><span data-stu-id="d8b55-123">Use one of our [quickstarts](#learn-more) tutorials that will guide you through the creation of your web service.</span></span>
* <span data-ttu-id="d8b55-124">Выберите один из примеров расширения обмена сообщениями, доступных в [репозитории примера ленты Bot](https://github.com/Microsoft/BotBuilder-Samples) , чтобы начать с.</span><span class="sxs-lookup"><span data-stu-id="d8b55-124">Choose one of the messaging extension samples available in the [Bot Framework sample repository](https://github.com/Microsoft/BotBuilder-Samples) to start from.</span></span>
* <span data-ttu-id="d8b55-125">Если вы используете JavaScript, используйте [генератор Yeoman для Microsoft Teams](https://github.com/OfficeDev/generator-teams) , чтобы сформировать шаблон приложения Teams, в том числе веб-службу.</span><span class="sxs-lookup"><span data-stu-id="d8b55-125">If you're using JavaScript, use the [Yeoman generator for Microsoft Teams](https://github.com/OfficeDev/generator-teams) to scaffold your Teams app, including your web service.</span></span>
* <span data-ttu-id="d8b55-126">Создайте веб-службу с нуля.</span><span class="sxs-lookup"><span data-stu-id="d8b55-126">Create your web service from scratch.</span></span> <span data-ttu-id="d8b55-127">Вы можете добавить пакет SDK Bot Framework для своего языка или работать непосредственно с полезными данными JSON.</span><span class="sxs-lookup"><span data-stu-id="d8b55-127">You can choose to add the Bot Framework SDK for your language, or you can work directly with the JSON payloads.</span></span>

## <a name="register-your-web-service-with-the-bot-framework"></a><span data-ttu-id="d8b55-128">Регистрация веб-службы в Bot Framework</span><span class="sxs-lookup"><span data-stu-id="d8b55-128">Register your web service with the Bot Framework</span></span>

<span data-ttu-id="d8b55-129">Расширения обмена сообщениями используют схему обмена сообщениями и протокол безопасного обмена сообщениями в среде Bot. Если вы еще не сделали это, вам потребуется зарегистрировать веб-службу в Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="d8b55-129">Messaging extensions take advantage of the Bot Framework's messaging schema and secure communication protocol; if you don't already have one you'll need to register your web service on the Bot Framework.</span></span> <span data-ttu-id="d8b55-130">Идентификатор приложения Microsoft (мы будем называть его идентификатором ленты в Teams, чтобы определить его с помощью идентификатора другого приложения, с которым вы можете работать), а конечная точка обмена сообщениями будет использоваться в вашем расширении обмена сообщениями для получения и ответа на запросы.</span><span class="sxs-lookup"><span data-stu-id="d8b55-130">The Microsoft App Id (we'll refer to this as your Bot Id from inside of Teams, to identify it from other App Id's you might be working with) and the messaging endpoint your register with the Bot Framework will be used in your messaging extension to receive and respond to requests.</span></span> <span data-ttu-id="d8b55-131">Если вы используете существующую регистрацию, убедитесь, что вы [включили канал Microsoft Teams](/azure/bot-service/bot-service-manage-channels.md?view=azure-bot-service-4.0&preserve-view=true).</span><span class="sxs-lookup"><span data-stu-id="d8b55-131">If you're using an existing registration, make sure you [enable the Microsoft Teams channel](/azure/bot-service/bot-service-manage-channels.md?view=azure-bot-service-4.0&preserve-view=true).</span></span>

<span data-ttu-id="d8b55-132">Если вы выберете один из примеров или начните с одного из доступных примеров, вы будете участником регистрации веб-службы.</span><span class="sxs-lookup"><span data-stu-id="d8b55-132">If you follow one of the quickstarts or start from one of the available samples you'll be guided through registering your web service.</span></span> <span data-ttu-id="d8b55-133">Если вы хотите зарегистрировать службу вручную, у вас есть три варианта.</span><span class="sxs-lookup"><span data-stu-id="d8b55-133">If you want to manually register your service you have three options to do so.</span></span> <span data-ttu-id="d8b55-134">Если вы решите зарегистрировать, не используя подписку на Azure, вы не сможете использовать упрощенный процесс проверки подлинности OAuth, предоставленный в интерфейсе Bot.</span><span class="sxs-lookup"><span data-stu-id="d8b55-134">If you choose to register without using an Azure subscription you will not be able to take advantage of the simplified OAuth authentication flow provided by the Bot Framework.</span></span> <span data-ttu-id="d8b55-135">Вы сможете перенести регистрацию в Azure после создания.</span><span class="sxs-lookup"><span data-stu-id="d8b55-135">You will be able to migrate your registration to Azure after creation.</span></span>

* <span data-ttu-id="d8b55-136">Если у вас есть подписка на Azure (или вы хотите создать новую), вы можете зарегистрировать веб-службу вручную с помощью портала Azure.</span><span class="sxs-lookup"><span data-stu-id="d8b55-136">If you have an Azure subscription (or want to create a new one), you can register your web service manually using the Azure Portal.</span></span> <span data-ttu-id="d8b55-137">Создайте ресурс "регистрация каналов ленты".</span><span class="sxs-lookup"><span data-stu-id="d8b55-137">Create a "Bot Channels Registration" resource.</span></span> <span data-ttu-id="d8b55-138">Вы можете выбрать бесплатную ценовую категорию, поскольку сообщения от Microsoft Teams не будут подсчитывать общее количество разрешенных сообщений в месяц.</span><span class="sxs-lookup"><span data-stu-id="d8b55-138">You can choose the free pricing tier, as messages from Microsoft Teams do not count towards your total allowable messages per month.</span></span>
* <span data-ttu-id="d8b55-139">Если вы не хотите использовать подписку на Azure, вы можете использовать [устаревший портал регистрации](https://dev.botframework.com/bots/new).</span><span class="sxs-lookup"><span data-stu-id="d8b55-139">If you do not wish to use an Azure subscription, you can use the [legacy registration portal](https://dev.botframework.com/bots/new).</span></span>
* <span data-ttu-id="d8b55-140">Кроме того, с помощью App Studio можно зарегистрировать веб-службу (Bot).</span><span class="sxs-lookup"><span data-stu-id="d8b55-140">App Studio can also help you register your web service (bot).</span></span> <span data-ttu-id="d8b55-141">Веб-службы, зарегистрированные с помощью App Studio, не зарегистрированы в Azure.</span><span class="sxs-lookup"><span data-stu-id="d8b55-141">Web services registered through App Studio are not registered in Azure.</span></span> <span data-ttu-id="d8b55-142">[Портал прежних версий](https://dev.botframework.com/bots) можно использовать для просмотра и переноса регистраций, управления ими и их переноса.</span><span class="sxs-lookup"><span data-stu-id="d8b55-142">You can use the [legacy portal](https://dev.botframework.com/bots) to view, manage, and migrate your registrations.</span></span>

## <a name="create-your-app-manifest"></a><span data-ttu-id="d8b55-143">Создание манифеста приложения</span><span class="sxs-lookup"><span data-stu-id="d8b55-143">Create your app manifest</span></span>

<span data-ttu-id="d8b55-144">Вы можете использовать App Studio для создания манифеста приложения или создать его вручную.</span><span class="sxs-lookup"><span data-stu-id="d8b55-144">You can either use App Studio to help you create your app manifest, or create it manually.</span></span>

### <a name="create-your-app-manifest-using-app-studio"></a><span data-ttu-id="d8b55-145">Создание манифеста приложения с помощью App Studio</span><span class="sxs-lookup"><span data-stu-id="d8b55-145">Create your app manifest using App Studio</span></span>

<span data-ttu-id="d8b55-146">Вы можете использовать приложение App Studio в клиенте Microsoft Teams, чтобы помочь создать манифест приложения.</span><span class="sxs-lookup"><span data-stu-id="d8b55-146">You can use the App Studio app from within the Microsoft Teams client to help create your app manifest.</span></span>

1. <span data-ttu-id="d8b55-147">В клиенте Teams откройте App Studio из меню переполнения **...** на панели навигации слева.</span><span class="sxs-lookup"><span data-stu-id="d8b55-147">In the Teams client, open App Studio from the **...** overflow menu on the left navigation rail.</span></span> <span data-ttu-id="d8b55-148">Если он еще не установлен, можно сделать это, выполнив поиск.</span><span class="sxs-lookup"><span data-stu-id="d8b55-148">If it isn't already installed, you can do so by searching for it.</span></span>
2. <span data-ttu-id="d8b55-149">На вкладке **редактор манифеста** выберите **создать новое приложение** (или, если вы добавляете расширение для обмена сообщениями в существующее приложение, вы можете импортировать пакет приложения)</span><span class="sxs-lookup"><span data-stu-id="d8b55-149">On the **Manifest editor** tab select **Create a new app** (or if you're adding a messaging extension to an existing app, you can import your app package)</span></span>
3. <span data-ttu-id="d8b55-150">Добавьте сведения о приложении (см. [определение схемы манифеста](~/resources/schema/manifest-schema.md) с полным описанием каждого поля).</span><span class="sxs-lookup"><span data-stu-id="d8b55-150">Add your app details (see [manifest schema definition](~/resources/schema/manifest-schema.md) for full descriptions of each field).</span></span>
4. <span data-ttu-id="d8b55-151">На вкладке **расширения обмена сообщениями** нажмите кнопку **установить** .</span><span class="sxs-lookup"><span data-stu-id="d8b55-151">On the **Messaging extensions** tab click the **Setup** button.</span></span>
5. <span data-ttu-id="d8b55-152">Вы можете создать новую веб-службу (Bot) для используемого расширения обмена сообщениями, или если вы уже зарегистрировали одну из них, а затем добавить ее здесь.</span><span class="sxs-lookup"><span data-stu-id="d8b55-152">You can either create a new web service (bot) for your messaging extension to use, or if you've already registered one select/add it here.</span></span>
6. <span data-ttu-id="d8b55-153">При необходимости обновите адрес конечной точки бота, чтобы он указывал на вашего бота.</span><span class="sxs-lookup"><span data-stu-id="d8b55-153">If necessary, update your bot endpoint address to point to your bot.</span></span> <span data-ttu-id="d8b55-154">Он должен выглядеть примерно следующим образом: `https://someplace.com/api/messages`.</span><span class="sxs-lookup"><span data-stu-id="d8b55-154">It should look something like `https://someplace.com/api/messages`.</span></span>
7. <span data-ttu-id="d8b55-155">Кнопка **Добавить** в разделе **команда** поможет добавить команды к своему расширению обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-155">The **Add** button in the **Command** section will guide you through adding commands to your messaging extension.</span></span> <span data-ttu-id="d8b55-156">В разделе [Дополнительные сведения приведены](#learn-more) ссылки на дополнительные сведения о добавлении команд.</span><span class="sxs-lookup"><span data-stu-id="d8b55-156">See the [Learn more](#learn-more) section for links to more information on adding commands.</span></span> <span data-ttu-id="d8b55-157">Помните, что вы можете определить до 10 команд для своего расширения обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-157">Remember you can define up to 10 commands for your messaging extension.</span></span>
8. <span data-ttu-id="d8b55-158">Раздел **обработчики сообщений** позволяет добавить домен, на котором будет запускаться обмен сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-158">The **Message Handlers** section allows you to add a domain that your messaging will trigger on.</span></span> <span data-ttu-id="d8b55-159">Для получения дополнительных сведений обратитесь к разделу [Link унфурлинг](~/messaging-extensions/how-to/link-unfurling.md) .</span><span class="sxs-lookup"><span data-stu-id="d8b55-159">See [link unfurling](~/messaging-extensions/how-to/link-unfurling.md) for more information.</span></span>

<span data-ttu-id="d8b55-160">На вкладке **Готово => тест и распределить** можно **скачать** пакет приложения (включая манифест приложения, а также значки приложений) или **установить** пакет.</span><span class="sxs-lookup"><span data-stu-id="d8b55-160">From the **Finish => Test and distribute** tab you can **Download** your app package (which includes your app manifest as well as your app icons), or **Install** the package.</span></span>

### <a name="create-your-app-manifest-manually"></a><span data-ttu-id="d8b55-161">Создание манифеста приложения вручную</span><span class="sxs-lookup"><span data-stu-id="d8b55-161">Create your app manifest manually</span></span>

<span data-ttu-id="d8b55-162">Как и в случае с Боты и вкладками, вы обновляете [Манифест](~/resources/schema/manifest-schema.md#composeextensions) приложения, чтобы включить свойства расширения обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-162">As with bots and tabs, you update the [app manifest](~/resources/schema/manifest-schema.md#composeextensions) of your app to include the messaging extension properties.</span></span> <span data-ttu-id="d8b55-163">Эти свойства определяют, как ваше расширение обмена сообщениями отображается и работает в клиенте Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="d8b55-163">These properties govern how your messaging extension appears and behaves in the Microsoft Teams client.</span></span> <span data-ttu-id="d8b55-164">Расширения обмена сообщениями поддерживаются начиная с версии 1.0 манифеста.</span><span class="sxs-lookup"><span data-stu-id="d8b55-164">Messaging extensions are supported beginning with v1.0 of the manifest.</span></span>

#### <a name="declare-your-messaging-extension"></a><span data-ttu-id="d8b55-165">Объявление расширения обмена сообщениями</span><span class="sxs-lookup"><span data-stu-id="d8b55-165">Declare your messaging extension</span></span>

<span data-ttu-id="d8b55-166">Чтобы добавить расширение системы обмена сообщениями, включите новую структуру JSON верхнего уровня в манифест приложения со `composeExtensions` свойством.</span><span class="sxs-lookup"><span data-stu-id="d8b55-166">To add a messaging extension, include a new top-level JSON structure in your app manifest with the `composeExtensions` property.</span></span> <span data-ttu-id="d8b55-167">Вы можете создать одно расширение обмена сообщениями для своего приложения, используя до 10 команд.</span><span class="sxs-lookup"><span data-stu-id="d8b55-167">You create a single messaging extension for your app, with up to 10 commands.</span></span>

> [!NOTE]
> <span data-ttu-id="d8b55-168">Манифест содержит ссылки на расширения обмена сообщениями `composeExtensions` .</span><span class="sxs-lookup"><span data-stu-id="d8b55-168">The manifest refers to messaging extensions as `composeExtensions`.</span></span> <span data-ttu-id="d8b55-169">Это необходимо для обеспечения обратной совместимости.</span><span class="sxs-lookup"><span data-stu-id="d8b55-169">This is to maintain backward compatibility.</span></span>

<span data-ttu-id="d8b55-170">Определение расширения — это объект, имеющий следующую структуру:</span><span class="sxs-lookup"><span data-stu-id="d8b55-170">The extension definition is an object that has the following structure:</span></span>

| <span data-ttu-id="d8b55-171">Имя свойства</span><span class="sxs-lookup"><span data-stu-id="d8b55-171">Property name</span></span> | <span data-ttu-id="d8b55-172">Назначение</span><span class="sxs-lookup"><span data-stu-id="d8b55-172">Purpose</span></span> | <span data-ttu-id="d8b55-173">Обязательный?</span><span class="sxs-lookup"><span data-stu-id="d8b55-173">Required?</span></span> |
|---|---|---|
| `botId` | <span data-ttu-id="d8b55-174">Уникальный идентификатор приложения Майкрософт для бота, зарегистрированный в Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="d8b55-174">The unique Microsoft app ID for the bot as registered with the Bot Framework.</span></span> <span data-ttu-id="d8b55-175">Как правило, это должен быть тот же идентификатор, что и для всего приложения Teams.</span><span class="sxs-lookup"><span data-stu-id="d8b55-175">This should typically be the same as the ID for your overall Teams app.</span></span> | <span data-ttu-id="d8b55-176">Да</span><span class="sxs-lookup"><span data-stu-id="d8b55-176">Yes</span></span> |
| `canUpdateConfiguration` | <span data-ttu-id="d8b55-177">Включает пункт меню **параметров** .</span><span class="sxs-lookup"><span data-stu-id="d8b55-177">Enables **Settings** menu item.</span></span> | <span data-ttu-id="d8b55-178">Нет</span><span class="sxs-lookup"><span data-stu-id="d8b55-178">No</span></span> |
| `commands` | <span data-ttu-id="d8b55-179">Массив команд, поддерживаемых этим расширением обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-179">Array of commands that this messaging extension supports.</span></span> <span data-ttu-id="d8b55-180">Можно выполнить не более 10 команд.</span><span class="sxs-lookup"><span data-stu-id="d8b55-180">You are limited to 10 commands.</span></span> | <span data-ttu-id="d8b55-181">Да</span><span class="sxs-lookup"><span data-stu-id="d8b55-181">Yes</span></span> |

#### <a name="define-your-commands"></a><span data-ttu-id="d8b55-182">Определение команд</span><span class="sxs-lookup"><span data-stu-id="d8b55-182">Define your commands</span></span>

<span data-ttu-id="d8b55-183">Ваш модуль обмена сообщениями должен объявить одну или несколько команд, определяющих, где пользователи могут активировать ваш модуль обмена сообщениями, и тип взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="d8b55-183">Your messaging extension should declare one or more commands, which define where your users can trigger your messaging extension, and the type of interaction.</span></span> <span data-ttu-id="d8b55-184">Дополнительные сведения о командах расширения системы обмена сообщениями приведены в [статье](#learn-more) дополнительные сведения.</span><span class="sxs-lookup"><span data-stu-id="d8b55-184">See [learn more](#learn-more) for more information on messaging extension commands.</span></span>

#### <a name="simple-manifest-example"></a><span data-ttu-id="d8b55-185">Пример простого манифеста</span><span class="sxs-lookup"><span data-stu-id="d8b55-185">Simple manifest example</span></span>

<span data-ttu-id="d8b55-186">В приведенном ниже примере показан объект простого расширения обмена сообщениями в манифесте приложения с помощью команды поиска.</span><span class="sxs-lookup"><span data-stu-id="d8b55-186">The example below is a simple messaging extension object in the app manifest with a search command.</span></span> <span data-ttu-id="d8b55-187">Это не весь файл манифеста приложения, а только часть, относящаяся к расширениям для обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="d8b55-187">This is not the entire app manifest file, just the part specific to messaging extensions.</span></span> <span data-ttu-id="d8b55-188">Полный пример приведен в статье [схема манифеста приложения](~/resources/schema/manifest-schema.md) .</span><span class="sxs-lookup"><span data-stu-id="d8b55-188">See [app manifest schema](~/resources/schema/manifest-schema.md) for a complete example.</span></span>

```json
...
"composeExtensions": [
  {
    "botId": "abcd1234-1fc5-4d97-a142-35bb662b7b23",
    "canUpdateConfiguration": true,
    "commands": [
      {
        "id": "searchCmd",
        "description": "Search you ToDo's",
        "title": "Search",
        "initialRun": true,
        "parameters": [
          {
            "name": "searchKeyword",
            "description": "Enter your search keywords",
            "title": "Keywords"
          }
        ]
      }
    ]
  }
]
...
```

## <a name="add-your-invoke-message-handlers"></a><span data-ttu-id="d8b55-189">Добавление обработчиков сообщений о вызовах</span><span class="sxs-lookup"><span data-stu-id="d8b55-189">Add your invoke message handlers</span></span>

<span data-ttu-id="d8b55-190">Когда ваши пользователи запускают расширение системы обмена сообщениями, необходимо обработать исходное сообщение о вызове, собрать некоторую информацию от пользователя, затем обработать эту информацию и ответить соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="d8b55-190">When your users trigger your messaging extension you'll need to handle the initial invoke message, collect some information from the user, then process that information and respond appropriately.</span></span> <span data-ttu-id="d8b55-191">Для этого сначала необходимо решить, какие команды вы хотите добавить в расширение системы обмена сообщениями, и либо [добавить команды действий](~/messaging-extensions/how-to/action-commands/define-action-command.md) , либо [добавить команды поиска](~/messaging-extensions/how-to/search-commands/define-search-command.md).</span><span class="sxs-lookup"><span data-stu-id="d8b55-191">To do that, you'll first need to decide what kind of commands you want to add to your messaging extension and either [add an action commands](~/messaging-extensions/how-to/action-commands/define-action-command.md) or [add a search commands](~/messaging-extensions/how-to/search-commands/define-search-command.md).</span></span>

## <a name="messaging-extensions-in-teams-meetings"></a><span data-ttu-id="d8b55-192">Расширения обмена сообщениями в собраниях Teams</span><span class="sxs-lookup"><span data-stu-id="d8b55-192">Messaging extensions in Teams meetings</span></span>

> [!NOTE]
> <span data-ttu-id="d8b55-193">Если в списке собраний или группового чата есть Федеративные пользователи, Teams подавляет доступ к расширениям обмена сообщениями для всех пользователей, в том числе организатора.</span><span class="sxs-lookup"><span data-stu-id="d8b55-193">If a meeting or group chat has federated users in the roster, Teams suppresses access to messaging extensions for all users, including the organizer.</span></span>

<span data-ttu-id="d8b55-194">После начала собрания участники Teams могут напрямую взаимодействовать с расширением обмена сообщениями во время интерактивного звонка.</span><span class="sxs-lookup"><span data-stu-id="d8b55-194">Once a meeting begins, Teams participants can interact directly with your messaging extension during a live call.</span></span> <span data-ttu-id="d8b55-195">При создании расширения обмена сообщениями для собраний учитывайте следующее:</span><span class="sxs-lookup"><span data-stu-id="d8b55-195">Consider the following when building your in-meeting messaging extension:</span></span>

1. <span data-ttu-id="d8b55-196">**Location**.</span><span class="sxs-lookup"><span data-stu-id="d8b55-196">**Location**.</span></span> <span data-ttu-id="d8b55-197">Ваш модуль обмена сообщениями можно вызвать из области создание сообщения, команды или @mentioned в чате для собрания.</span><span class="sxs-lookup"><span data-stu-id="d8b55-197">Your messaging extension can be invoked from the compose message area, the command box, or @mentioned in the meeting chat.</span></span>

1. <span data-ttu-id="d8b55-198">**Metadata (метаданные**).</span><span class="sxs-lookup"><span data-stu-id="d8b55-198">**Metadata**.</span></span> <span data-ttu-id="d8b55-199">При вызове расширения обмена сообщениями он может идентифицировать пользователя и клиента из `userId` и `tenantId` .</span><span class="sxs-lookup"><span data-stu-id="d8b55-199">When your messaging extension is invoked it can identify the user and tenant from `userId` and `tenantId`.</span></span> <span data-ttu-id="d8b55-200">`meetingId` может быть частью объекта `channelData`.</span><span class="sxs-lookup"><span data-stu-id="d8b55-200">The `meetingId` can be found as part of the `channelData` object.</span></span> <span data-ttu-id="d8b55-201">Приложение может использовать `userId` `meetingId` `GetParticipant` запрос API и для получения ролей пользователей.</span><span class="sxs-lookup"><span data-stu-id="d8b55-201">Your app can use the `userId` and `meetingId`  for the `GetParticipant` API request to retrieve user roles.</span></span>

1. <span data-ttu-id="d8b55-202">**Тип команды**.</span><span class="sxs-lookup"><span data-stu-id="d8b55-202">**Command type**.</span></span> <span data-ttu-id="d8b55-203">Если расширение сообщения использует [команды на основе действий](../../messaging-extensions/what-are-messaging-extensions.md#action-commands), оно должно соответствовать вкладкам проверки подлинности [с единым входом](../../tabs/how-to/authentication/auth-aad-sso.md) .</span><span class="sxs-lookup"><span data-stu-id="d8b55-203">If your message extension uses [action-based commands](../../messaging-extensions/what-are-messaging-extensions.md#action-commands), it should follow tabs [single sign-on](../../tabs/how-to/authentication/auth-aad-sso.md) authentication.</span></span>

1. <span data-ttu-id="d8b55-204">**Взаимодействие с пользователем**.</span><span class="sxs-lookup"><span data-stu-id="d8b55-204">**User experience**.</span></span> <span data-ttu-id="d8b55-205">Расширение системы обмена сообщениями должно выглядеть и работать так же, как и за пресроком собрания.</span><span class="sxs-lookup"><span data-stu-id="d8b55-205">You messaging extension should look and behave the same as it would outside a meeting.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d8b55-206">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d8b55-206">Next steps</span></span>

* [<span data-ttu-id="d8b55-207">Создание команд действий</span><span class="sxs-lookup"><span data-stu-id="d8b55-207">Create action commands</span></span>](~/messaging-extensions/how-to/action-commands/define-action-command.md)
* [<span data-ttu-id="d8b55-208">Создание команд поиска</span><span class="sxs-lookup"><span data-stu-id="d8b55-208">Create search commands</span></span>](~/messaging-extensions/how-to/search-commands/define-search-command.md)
* [<span data-ttu-id="d8b55-209">Развернуть ссылку</span><span class="sxs-lookup"><span data-stu-id="d8b55-209">Link unfurling</span></span>](~/messaging-extensions/how-to/link-unfurling.md)

## <a name="learn-more"></a><span data-ttu-id="d8b55-210">Подробнее</span><span class="sxs-lookup"><span data-stu-id="d8b55-210">Learn more</span></span>

<span data-ttu-id="d8b55-211">Попробуйте это в кратком руководстве:</span><span class="sxs-lookup"><span data-stu-id="d8b55-211">Try it out in a quickstart:</span></span>

* <span data-ttu-id="d8b55-212">Примеры использования C #</span><span class="sxs-lookup"><span data-stu-id="d8b55-212">Quickstarts for C#</span></span>
  * [<span data-ttu-id="d8b55-213">Расширение системы обмена сообщениями с помощью команд на основе действий</span><span class="sxs-lookup"><span data-stu-id="d8b55-213">Messaging extension with action-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/51.teams-messaging-extensions-action)
  * [<span data-ttu-id="d8b55-214">Расширение системы обмена сообщениями с помощью команд на основе поиска</span><span class="sxs-lookup"><span data-stu-id="d8b55-214">Messaging extension with search-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/50.teams-messaging-extensions-search)
* <span data-ttu-id="d8b55-215">Примеры использования JavaScript</span><span class="sxs-lookup"><span data-stu-id="d8b55-215">Quickstarts for JavaScript</span></span>
  * [<span data-ttu-id="d8b55-216">Расширение системы обмена сообщениями с помощью команд на основе действий</span><span class="sxs-lookup"><span data-stu-id="d8b55-216">Messaging extension with action-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/51.teams-messaging-extensions-action)
  * [<span data-ttu-id="d8b55-217">Расширение системы обмена сообщениями с помощью команд на основе поиска</span><span class="sxs-lookup"><span data-stu-id="d8b55-217">Messaging extension with search-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/50.teams-messaging-extensions-search)

<span data-ttu-id="d8b55-218">Узнайте больше о концепциях разработки teams:</span><span class="sxs-lookup"><span data-stu-id="d8b55-218">Learn more about Teams development concepts:</span></span>

* [<span data-ttu-id="d8b55-219">Общие сведения о возможностях приложений Teams</span><span class="sxs-lookup"><span data-stu-id="d8b55-219">Understand Teams app capabilities</span></span>](../../concepts/capabilities-overview.md)
* [<span data-ttu-id="d8b55-220">Что такое расширения обмена сообщениями?</span><span class="sxs-lookup"><span data-stu-id="d8b55-220">What are messaging extensions?</span></span>](~/messaging-extensions/what-are-messaging-extensions.md)
