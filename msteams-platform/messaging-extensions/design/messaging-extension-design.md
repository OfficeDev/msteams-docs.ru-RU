---
title: Разработка расширения обмена сообщениями
description: Узнайте, как разработать расширение системы обмена сообщениями Teams и получить набор пользовательских интерфейсов Microsoft Teams.
keywords: рекомендации по проектированию Teams Справочник по расширениям обмена сообщениями советы
author: heath-hamilton
ms.author: qinch
ms.topic: conceptual
ms.openlocfilehash: ad628bdaa46058aed4acdcea1a224c7ebfe40f89
ms.sourcegitcommit: c102da958759c13aa9e0f81bde1cffb34a8bef34
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/09/2020
ms.locfileid: "49604855"
---
# <a name="designing-your-microsoft-teams-messaging-extension"></a>Разработка расширения обмена сообщениями Microsoft Teams

Расширения обмена сообщениями — это ярлыки для вставки контента приложения или работы с сообщением без перехода от беседы.

В следующей статье описываются способы добавления и использования расширений обмена сообщениями в Teams, а также управления ими.

## <a name="microsoft-teams-ui-kit"></a>Набор элементов пользовательского интерфейса Microsoft Teams

Вы можете найти подробные рекомендации по проектированию расширений сообщений, в том числе элементы, которые можно прихватить и изменить при необходимости, в наборе элементов Microsoft Teams.

> [!div class="nextstepaction"]
> [Получение набора элементов пользовательского интерфейса Microsoft Teams (фигма)](https://www.figma.com/community/file/916836509871353159)

## <a name="add-a-messaging-extension"></a>Добавление расширения обмена сообщениями

Вы можете добавить расширение системы обмена сообщениями в следующих контекстах команд:

* Из хранилища Teams (AppSource).
* В канале, чате или собрании (до, во время и после) в поле "создание". Стоит отметить, что если вы добавите расширение обмена сообщениями в одном из этих мест, то можете использовать его только в этом контексте.

В приведенном ниже примере показано, как добавить расширение обмена сообщениями в канале.

:::image type="content" source="../../assets/images/messaging-extension/add-in-channel.png" alt-text="Пример показывает, как добавить расширение обмена сообщениями рядом с полем &quot;создание&quot; в канале." border="false":::

## <a name="set-up-a-messaging-extension"></a>Настройка расширения обмена сообщениями

Проверка подлинности не обязательна, но если ваше приложение аналогично средству отслеживания билетов, для входа в систему можно использовать расширение обмена сообщениями.

Для согласованности в приложениях Teams невозможно настроить экран входа. При использовании проверки подлинности с использованием единого входа пользователи автоматически подписываются.

:::image type="content" source="../../assets/images/messaging-extension/set-up.png" alt-text="В примере отображается экран Настройка расширения обмена сообщениями с кнопкой входа." border="false":::

## <a name="types-of-messaging-extensions"></a>Типы расширений обмена сообщениями

Расширения для обмена сообщениями могут иметь команды поиска, команды действий или и то, и другое. Ваши команды зависят от компонентов приложения и от того, как они соответствуют вариантам использования в Teams.

### <a name="search-commands"></a>Команды поиска

С помощью команд поиска пользователи могут быстро находить внешний контент и вставлять их в сообщения с помощью расширения для обмена сообщениями. Команды поиска обычно становятся доступными в поле "создание". Например, вы можете начать или добавить обсуждение, выполнив общий доступ к содержимому, не покидая Teams.

:::image type="content" source="../../assets/images/messaging-extension/search-command-type.png" alt-text="В примере показано расширение обмена сообщениями на основе поиска, запущенное из поля создать." border="false":::

#### <a name="compose-box-layout-options"></a>Параметры макета поля создания

Существует несколько способов отображения результатов поиска для расширения системы обмена сообщениями, в том числе [представления списка и таблицы](../../messaging-Ask about extensions/how-to/search-commands/respond-to-search.md#respond-to-user-requests).

:::image type="content" source="../../assets/images/messaging-extension/search-result-layout.png" alt-text="Иллюстрация, на которой показаны параметры макета для результатов поиска расширения системы обмена сообщениями." border="false":::

### <a name="action-commands"></a>Команды действий

Команды действий позволяют пользователям запускать действия и обрабатывать запросы во внешних службах в Teams. Например, если ваше приложение отслеживает заказы, пользователь может создать новый заказ, используя содержимое сообщения коллеги непосредственно внутри разговора.

Расширения для обмена сообщениями на основе действий часто требуют, чтобы пользователи выполнили форму или другой тип конфигурации в модальном виде. Эти возможности можно создавать с помощью [модулей задач](../../task-modules-and-cards/task-modules/design-teams-task-modules.md).

## <a name="open-a-messaging-extension"></a>Открытие расширения обмена сообщениями

Поле создания и сообщения/записи — это основные контексты, в которых люди используют расширения для обмена сообщениями.

### <a name="from-the-compose-box"></a>Из поля "создание"

После добавления пользователи могут открыть свой модуль обмена сообщениями, выбрав значок приложения под полем "создание". В этом примере у расширения есть команды поиска и действий.

:::image type="content" source="../../assets/images/messaging-extension/open-from-compose-box.png" alt-text="В примере показано, как открыть расширение системы обмена сообщениями из поля &quot;создание&quot;." border="false":::

### <a name="from-a-chat-message-or-channel-post"></a>Из сообщения чата или записи в канале

После добавления пользователи могут выбрать значок **More (дополнительные** ) :::image type="icon" source="../../assets/icons/teams-client-more.png"::: в сообщении чата или канале POST, чтобы найти команды действий расширения. Ваш добавочный номер может отображаться в разделе **Дополнительные действия** в зависимости от использования.

#### <a name="chat-message"></a>Сообщение чата

:::image type="content" source="../../assets/images/messaging-extension/open-from-chat-message.png" alt-text="В примере показано, как открыть расширение обмена сообщениями из сообщения чата." border="false":::

#### <a name="channel-post"></a>POST канала

:::image type="content" source="../../assets/images/messaging-extension/open-from-channel-post.png" alt-text="В примере показано, как открыть расширение обмена сообщениями из канала POST." border="false":::

## <a name="use-a-messaging-extension"></a>Использование расширения обмена сообщениями

В следующих сценариях показаны основные способы использования расширений обмена сообщениями для пользователей.

### <a name="insert-content-into-a-message"></a>Вставка контента в сообщение

**1. Выберите расширение системы обмена сообщениями**. Пользователи могут искать контент, к которому они хотят предоставить доступ, из поля "создание".

:::image type="content" source="../../assets/images/messaging-extension/insert-content-search.png" alt-text="Пример показывает, как пользователь выполняет поиск контента для вставки из поля &quot;создание&quot;." border="false":::

**2. Вставьте контент**. После публикации другие пользователи могут ответить или выбрать контент, чтобы просмотреть дополнительные сведения в приложении.

:::image type="content" source="../../assets/images/messaging-extension/insert-content-posted.png" alt-text="Пример показывает, что пользователь разбивает контент в беседе канала." border="false":::

### <a name="take-action-on-a-message"></a>Выполнение действий с сообщением

**1. Выберите расширение системы обмена сообщениями**. Ваше приложение может включать одну или несколько команд действий.

:::image type="content" source="../../assets/images/messaging-extension/select-action-command.png" alt-text="Пример показывает, как пользователь выбирает команду действия расширения системы обмена сообщениями." border="false":::

**2. Выполните действие**. Ваше приложение может получать и обрабатывать любые контент или данные, отправленные действием Message. Это позволяет пользователям оставить беседу в беседе и, в следующем примере, не беспокоиться о вводе информации непосредственно в приложении.

:::image type="content" source="../../assets/images/messaging-extension/complete-action-command.png" alt-text="Пример показывает, как пользователь выполняет поиск контента для вставки из поля &quot;создание&quot;." border="false":::

### <a name="preview-links"></a>Ссылки для предварительного просмотра

Расширения обмена сообщениями также позволяют вставлять в сообщение ссылки на распознаваемые URL-адреса (Эта возможность называется [Link унфурлинг](../../messaging-extensions/how-to/link-unfurling.md).)

**1. Вставьте распознанную ссылку** в поле "создание".

:::image type="content" source="../../assets/images/messaging-extension/paste-preview-link.png" alt-text="В примере показано, как пользователь вставил ссылку в поле компост." border="false":::

**2. Вставьте контент**. Если ваше приложение распознает URL-адрес в поле "создание", он отображает ссылку в виде карточки, которая обеспечивает полный предварительный просмотр веб-контента. (См. [рекомендации по проектированию адаптивных карточек](../../task-modules-and-cards/cards/design-effective-cards.md) для получения дополнительной информации.)

:::image type="content" source="../../assets/images/messaging-extension/insert-preview-link.png" alt-text="В примере показано, как URL-адрес, так как он распознается вашим приложением, включает в себя некоторый обширный контент в поле &quot;создание&quot;." border="false":::

## <a name="manage-a-messaging-extension"></a>Управление расширением обмена сообщениями

Щелкнув значок правой кнопкой мыши, пользователи могут закреплять, удалять или настраивать расширение системы обмена сообщениями.

## <a name="anatomy"></a>Составляющие

### <a name="messaging-extension-in-the-compose-box"></a>Расширение обмена сообщениями в поле "создание"

Ниже приведен пример расширения обмена сообщениями, открытого из поля "создание".

:::image type="content" source="../../assets/images/messaging-extension/anatomy-compose.png" alt-text="Иллюстрация, демонстрирующая пользовательский интерфейс расширения для обмена сообщениями в поле &quot;создание&quot;." border="false":::

|Счетчик|Описание|
|----------|-----------|
|1|**Логотип приложения**: значок цвета эмблемы приложения.|
|2 |**Имя приложения**: полное имя приложения.|
|3 |**Значок меню команд действий (необязательно)**: открывает список команд действий для расширения системы обмена сообщениями (если вы указали его).
|4 |**Поле поиска**: позволяет пользователям находить контент приложений, которые они хотят вставить.|
|5 |**Меню вкладок (необязательно)**: предоставляет несколько категорий контента.|
|6 |**Меню команд действий (необязательно)**: отображает список команд действий (если вы указали их).|
|7 |**Контент приложения**: в первую очередь для отображения результатов поиска. В этом примере используется макет списка (макет сетки — другой вариант).|
|8 |**Логотип приложения**: значок структуры эмблемы приложения.|

### <a name="messaging-extension-management-menu"></a>Меню управления расширениями обмена сообщениями

:::image type="content" source="../../assets/images/messaging-extension/anatomy-management-menu.png" alt-text="Иллюстрация, на которой показана структура пользовательского интерфейса меню управления расширениями для обмена сообщениями." border="false":::

|Счетчик|Описание|
|----------|-----------|
|1|**Открепить**: доступно, если пользователь закрепляет ваше приложение.|
|2 |**Удалить**: удаляет расширение обмена сообщениями из канала, чата или собрания.|

## <a name="best-practices"></a>Рекомендации

### <a name="setup-and-general-usage"></a>Настройка и общие сведения об использовании

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-do.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="do-integrate-with-single-sign-on"></a>Do: интеграция с единым входом

ЕДИНЫЙ вход упрощает, ускоряет и обеспечивает безопасность процесса входа. Кроме того, если пользователь уже выполнил вход в личное приложение, ему не придется повторно выполнять вход для доступа к расширению системы обмена сообщениями.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-dont.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="dont-take-users-away-from-the-conversation"></a>Не отвлекайте пользователей от беседы.

Расширения обмена сообщениями — это те, которые предположительно уменьшают контекстное переключение. Ваш добавочный номер не должен, например, направлять пользователей на веб-страницу за пределами Teams.

   :::column-end:::
:::row-end:::

#### <a name="do-highlight-your-messaging-extension"></a>Do: выделите свой добавочный номер для обмена сообщениями

Расширения обмена сообщениями не всегда просты в поиске. Включите снимки экрана, которые можно использовать на странице сведений о приложении. Если ваше приложение также содержит Bot, вы можете включить справочную документацию по расширению системы обмена сообщениями в начальном начальном экране ленты.

### <a name="templating"></a>Создание

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-do.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="do-let-teams-handle-some-of-the-design-work-if-possible"></a>Do: разрешить командам по возможности обрабатывать некоторые задачи по проектированию

Если это имеет смысл для вариантов использования, рекомендуется создать расширение для обмена сообщениями на основе поиска. Teams отрисовывает эти типы расширений с помощью встроенных функций и специальных возможностей.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-dont.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="dont-embed-your-entire-app-in-a-task-module"></a>Не все: внедрите приложение в модуль задач

Если для расширения системы обмена сообщениями требуются команды действий, оставьте модуль задач простым и отобразите только компоненты, необходимые для выполнения действия.

   :::column-end:::
:::row-end:::

### <a name="theming"></a>Темы

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-do.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="do-take-advantage-of-teams-color-tokens"></a>Do: Воспользуйтесь преимуществами цветовых маркеров для Teams

У каждой темы Teams есть своя цветовая схема. Для автоматической обработки изменений темы используйте <a href="https://fluentsite.z22.web.core.windows.net/0.51.3/colors#color-scheme" target="_blank">маркеры цветов (пользовательский интерфейс Fluent)</a> .

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-dont.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="dont-hard-code-color-values"></a>Не: значения цвета жесткого кода

Если вы не используете цветовые маркеры для работы с группами, ваши макеты будут менее масштабируемыми и занимать больше времени на управление.

   :::column-end:::
:::row-end:::

### <a name="actions"></a>Действия

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-do.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="do-include-action-commands-that-make-sense-in-context"></a>Do: Включение команд действий, которые имеют смысл в контексте

Действия с сообщениями должны относиться к тем, что пользователь ищет. Например, предоставьте пользователям ярлык для создания вопроса или рабочего элемента с помощью текста в записи пользователя.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-dont.png" alt-text="Пример, в котором показана рекомендация расширения для обмена сообщениями." border="false":::

#### <a name="dont-include-actions-commands-that-arent-contextual"></a>Не: включить команды действий, не являющиеся контекстными

Действие с сообщением для **просмотра панели мониторинга** , скорее всего, не будет отсоединено от большинства бесед.

   :::column-end:::
:::row-end:::

### <a name="searches"></a>Выполняет

#### <a name="do-show-search-results-while-typing"></a>Do: отображение результатов поиска при вводе текста

Предоставление предлагаемых результатов поиска при вводе пользователями. Они могут находить нужные вам материалы быстрее с минимальным количеством символов.

#### <a name="dont-require-users-to-submit-a-query"></a>Не требовать от пользователей отправки запроса.

Вы можете сделать так, чтобы пользователи нажмет клавишу или выбрали кнопку для отправки запросов в свое приложение. Несмотря на то, что вы можете упростить работу со службой приложений, люди могут запутать, что они не видят результаты поиска в реальном времени по мере их ввода.

#### <a name="do-consider-zero-term-queries"></a>Do: рассмотрение нулевых терминов запросов

Например, прежде чем пользователь запишет что-либо в поле поиска, отобразите сведения о последнем просмотре в приложении. Возможно, они хотят вставить это содержимое в беседу.

## <a name="validate-your-design"></a>Проверка проекта

Если вы планируете опубликовать свое приложение в AppSource, следует изучить проблемы, которые обычно приводят к сбою приложений во время отправки.

> [!div class="nextstepaction"]
> [Проверка рекомендаций по проверке макета](../../concepts/deploy-and-publish/appsource/prepare/frequently-failed-cases.md#validation-guidelines--most-failed-test-cases)
