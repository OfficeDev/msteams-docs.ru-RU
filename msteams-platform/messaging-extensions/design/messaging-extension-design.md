---
title: Разработка расширения для сообщений
description: Узнайте, как создать расширение для сообщений Teams, и получите комплект разработчика для пользовательского интерфейса Microsoft Teams.
keywords: рекомендации по проектированию teams общие принципы рекомендации и советы для расширений по обмену сообщениями
author: heath-hamilton
ms.localizationpriority: high
ms.author: qinch
ms.topic: conceptual
ms.openlocfilehash: 3cc9ac28bd07d3d79894a59cb2ff436fa43dda0d
ms.sourcegitcommit: fc9f906ea1316028d85b41959980b81f2c23ef2f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/12/2021
ms.locfileid: "59156169"
---
# <a name="designing-your-microsoft-teams-messaging-extension"></a>Разработка расширения Microsoft Teams для сообщений

Расширения для сообщений помогают быстро вставить содержимое приложения или выполнить какие-либо операции с сообщением, не выходя из беседы.
Далее описано и показано, как добавлять расширения для сообщений, использовать их и управлять ими в Teams.

## <a name="microsoft-teams-ui-kit"></a>Комплект разработчика для пользовательского интерфейса Microsoft Teams

В комплекте разработчика для пользовательского интерфейса Microsoft Teams можно найти полные рекомендации по проектированию расширений для сообщений, в том числе элементы, которые можно взять и изменить нужным образом.

> [!div class="nextstepaction"]
> [Получить комплект разработчика для пользовательского интерфейса Microsoft Teams (Figma)](https://www.figma.com/community/file/916836509871353159)

## <a name="add-a-messaging-extension"></a>Добавить расширение для сообщений

Вы можете добавить расширение для сообщений в следующих контекстах Teams:

* В магазине Teams.
* В канале, чате или собрании (до, во время и после) рядом с полем создания сообщения. Стоит отметить, что если вы добавили расширение для сообщений в одном из этих мест, в этом контексте его сможете использовать только вы.

В следующих примерах показано, как добавить расширение для сообщений в канале:

### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-add-in-channel.png" alt-text="В примере показано, как добавить расширение для сообщений рядом с полем создания сообщения в канале на мобильном устройстве." border="false":::

### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/add-in-channel.png" alt-text="В примере показано, как добавить расширение для сообщений рядом с полем создания сообщения в канале." border="false":::

## <a name="set-up-a-messaging-extension"></a>Настройка расширения для сообщений

Проверка подлинности в принципе не обязательна, но если вы проектируете что-нибудь вроде системы отслеживания запросов, то, возможно, захотите, чтобы пользователи, прежде чем воспользоваться вашим ПО, выполняли вход в систему.

Чтобы обеспечить единый дизайн приложений Teams, экран входа менять нельзя. Если вы используете проверку подлинности с единым входом (SSO), пользователи будут автоматически выполнять вход.

### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-set-up.png" alt-text="В примере показан экран настройки расширения сообщений с кнопкой &quot;Вход&quot; на мобильном устройстве." border="false":::

### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/set-up.png" alt-text="В примере показан экран настройки расширения сообщений с кнопкой &quot;Вход&quot;." border="false":::

## <a name="types-of-messaging-extensions"></a>Типы расширений для сообщений

В расширениях для сообщений могут быть реализованы команды поиска, команды действий или и то, и другое. Какие именно нужны вам — зависит от функций вашего приложения и их соответствия сценариям использования Teams.

### <a name="search-commands"></a>Команды поиска

Расширение для сообщений с поиском может использоваться для быстрого поиска внешнего содержимого и вставки его в сообщение. Команды поиска обычно доступны в поле создания сообщения. Например, вы можете начать обсуждение или поучаствовать в нем, поделившись содержимым — и при этом не выходя из Teams.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-search-command-type.png" alt-text="В примере показано расширение для сообщений на основе поиска, запущенное из поля создания сообщения на мобильном устройстве." border="false":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/search-command-type.png" alt-text="В примере показано расширение для сообщений на основе поиска, запущенное из поля создания сообщения." border="false":::

#### <a name="compose-box-layout-options"></a>Параметры компоновки поля создания сообщения

Результаты поиска расширения сообщений можно выводить в разных конфигурациях, в том числе в виде [таблицы и списка](../../messaging-extensions/how-to/search-commands/respond-to-search.md#respond-to-user-requests).

:::image type="content" source="../../assets/images/messaging-extension/search-result-layout.png" alt-text="Иллюстрации, на которых показаны варианты компоновки при выводе результатов поиска из расширения сообщений." border="false":::

### <a name="action-commands"></a>Команды действий

Команды действий позволяют запускать действия и обрабатывать запросы во внешних службах в Teams. Например, если ваше приложение отслеживает заказы, пользователь может создать новый заказ, используя содержимое сообщения коллеги прямо в чате.

Расширения сообщений на основе действий часто требуют, чтобы пользователи заполняли форму или что-либо подобное в модальном окне. Такие виды интерфейса можно создавать с помощью [модулей задач](../../task-modules-and-cards/task-modules/design-teams-task-modules.md).

## <a name="open-a-messaging-extension"></a>Открыть расширение для сообщений

Поле создания сообщения и сами сообщения или записи являются основным контекстом, в котором используются расширения для сообщений.

### <a name="from-the-compose-box"></a>Из поля создания сообщения

После того как вы добавите свое расширение для сообщений, пользователи смогут открывать его, выбрав значок приложения, расположенный ниже поля создания сообщения. В этих примерах расширение содержит и команду поиска, и команду действий.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-open-from-compose-box.png" alt-text="В примере показано, как открыть расширение для обмена сообщениями из поля создания сообщения на мобильном устройстве." border="false":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/open-from-compose-box.png" alt-text="В примере показано, как открыть расширение для сообщений из поля создания сообщения." border="false":::

### <a name="from-a-chat-message-or-channel-post"></a>Из сообщения чата или публикации канала

После того как вы добавите свое расширение для сообщений, пользователи смогут открывать его, выбрав значок **Еще**:::image type="icon" source="../../assets/icons/teams-client-more.png"::: в сообщении чата или публикации канала, чтобы найти команды действий. В зависимости от того, как используется ваше расширение, оно может быть указано в списке **Дополнительные действия**.

#### <a name="chat-message"></a>Сообщение чата

:::image type="content" source="../../assets/images/messaging-extension/open-from-chat-message.png" alt-text="В примере показано, как открыть расширение для сообщений из сообщения чата." border="false":::

#### <a name="channel-post"></a>Публикация в канале

:::image type="content" source="../../assets/images/messaging-extension/open-from-channel-post.png" alt-text="В примере показано, как открыть расширение для сообщений из публикации в канале на мобильном устройстве." border="false":::

## <a name="use-a-messaging-extension"></a>Использование расширения для сообщений

В следующих сценариях показаны основные способы использования расширений для сообщений.

### <a name="insert-content-into-a-message"></a>Вставка контента в сообщение

**1. Выберите расширение для сообщений**. Пользователи могут искать контент, которым они хотят поделиться, прямо из поля создания сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-content-search.png" alt-text="В примере показано, как пользователь ищет контент для вставки прямо из поля создания сообщения на мобильном устройстве." border="false":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-content-search.png" alt-text="В примере показано, как пользователь ищет контент для вставки прямо из поля создания сообщения." border="false":::

**2. Вставьте контент**. После публикации пользователи люди могут ответить или выбрать содержимое, чтобы увидеть дополнительную информацию в вашем приложении.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-content-posted.png" alt-text="В примере показан пользователь, публикующий контент в беседе в канале на мобильном устройстве." border="false":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-content-posted.png" alt-text="В примере показан пользователь, публикующий контент в беседе в канале." border="false":::

### <a name="take-action-on-a-message"></a>Действия с сообщениями

**1. Выберите расширение для сообщений**. Ваше приложение может включать одну или несколько команд действий.

:::image type="content" source="../../assets/images/messaging-extension/select-action-command.png" alt-text="В примере показано, как пользователь выбирает команду действия расширения обмена сообщениями." border="false":::

**2. Закончите действие**. Ваше приложение может получать и обрабатывать любой контент или данные, отправленные действием сообщения. Пользователи заканчивают действие в вашем приложении, оставаясь в беседе.

:::image type="content" source="../../assets/images/messaging-extension/complete-action-command.png" alt-text="Пример действия с сообщением." border="false":::

### <a name="preview-links"></a>Предварительный просмотр ссылок

Расширения для сообщений также позволяют вставлять в сообщение форматированные ссылки с контентом с распознаваемых URL-адресов (эта возможность называется [развертыванием ссылки](../../messaging-extensions/how-to/link-unfurling.md)).

**1. Вставьте распознаваемую ссылку** в поле создания сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-paste-preview-link.png" alt-text="В примере показано, как пользователь вставляет ссылку в поле создания сообщения на мобильном устройстве" border="false":::.

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/paste-preview-link.png" alt-text="В примере показано, как пользователь вставляет ссылку в поле создания сообщения" border="false":::.

**2. Вставьте контент**. Если ваше приложение распознает URL-адрес в поле создания сообщения, оно сформирует ссылку в виде карточки, которая обеспечивает предварительный просмотр веб-контента в форматированном виде. (Подробности см. в разделе [Рекомендации по созданию адаптивных карточек](../../task-modules-and-cards/cards/design-effective-cards.md).)

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-preview-link.png" alt-text="В примере показано, как URL-адрес, распознанный приложением, включает в поле создания сообщения часть контента на мобильном устройстве" border="false":::.

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-preview-link.png" alt-text="В примере показано, как URL-адрес, распознанный приложением, включает в поле создания сообщения часть контента" border="false":::.

## <a name="manage-a-messaging-extension"></a>Управление расширением для сообщений

Щелкнув значок правой кнопкой мыши, пользователи смогут закрепить, удалить или настроить ваше расширение для сообщений.

## <a name="anatomy"></a>Структура

### <a name="messaging-extension-in-the-compose-box"></a>Расширение для сообщений в поле создания сообщения

Следующий пример показывает расширение для сообщений, открытое из поля создания сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-anatomy-compose.png" alt-text="Иллюстрация, показывающая структуру пользовательского интерфейса расширения для сообщений в поле создания сообщения на мобильном устройстве" border="false":::.

|Счетчик|Описание|
|----------|-----------|
|1|**Имя приложения**: полное имя приложения.|
|2.|**Значок меню команд действий (необязательно)**: открывает список команд действий данного расширения для сообщений (если вы их указали).
|3|**Поле поиска**: позволяет пользователям находить контент приложения для последующей вставки.|
|4|**Меню вкладок (необязательно)**: предоставляет несколько категорий контента.|
|5|**Меню команд действий (необязательно)**: выводит на экран список команд действий (если вы их указали).|
|6|**Контент приложения**: в основном для отображения результатов поиска.|

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/anatomy-compose.png" alt-text="Иллюстрация, показывающая структуру пользовательского интерфейса расширения для сообщений в поле создания сообщения" border="false":::.

|Счетчик|Описание|
|----------|-----------|
|1|**Логотип приложения**: цветной значок логотипа приложения.|
|2.|**Имя приложения**: полное имя приложения.|
|3|**Значок меню команд действий (необязательно)**: открывает список команд действий данного расширения для сообщений (если вы их указали).
|4|**Поле поиска**: позволяет пользователям находить контент приложения для последующей вставки.|
|5|**Меню вкладок (необязательно)**: предоставляет несколько категорий контента.|
|6|**Меню команд действий (необязательно)**: выводит на экран список команд действий (если вы их указали).|
|7|**Контент приложения**: в основном для отображения результатов поиска. В этом примере используется компоновка списка (другой вариант — табличная компоновка).|
|8|**Логотип приложения**: контурный значок логотипа приложения.|

### <a name="messaging-extension-management-menu"></a>Меню управления расширениями сообщений

:::image type="content" source="../../assets/images/messaging-extension/anatomy-management-menu.png" alt-text="Иллюстрация, показывающая структуру пользовательского интерфейса меню расширения для сообщений" border="false":::.

|Счетчик|Описание|
|----------|-----------|
|1|**Открепить**: доступно, если пользователь закрепил ваше приложение.|
|2.|**Удалить**: удаляет расширение для сообщений из канала, чата или собрания.|

## <a name="best-practices"></a>Рекомендованные методики

Используйте эти рекомендации для создания качественных приложений.

### <a name="setup-and-general-usage"></a>Настройка и общее использование

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-do.png" alt-text="Пример настройки и общего использования" border="false":::.

#### <a name="do-integrate-with-single-sign-on"></a>Нужно: интегрироваться с единым входом

SSO делает вход проще, быстрее и надежнее. Кроме того, если пользователь уже выполнил вход в ваше личное приложение, повторный вход для доступа к расширению для сообщений уже не нужен.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-dont.png" alt-text="Пример интеграции с единым входом" border="false":::.

#### <a name="dont-take-users-away-from-the-conversation"></a>Нельзя: заставлять пользователей выходить из беседы

Расширения для сообщений — это средства упрощения работы, позволяющие свести к минимуму переключение контекста. Например, расширение не должно направлять пользователей на веб-страницу за пределами Teams.

   :::column-end:::
:::row-end:::

#### <a name="do-highlight-your-messaging-extension"></a>Нужно: сделать расширение для сообщений броским

Расширение для сообщений не всегда легко заметить. Добавьте на страницу сведений о приложении снимки экрана, показывающие, как использовать ваше расширение для сообщений. Если приложение также содержит бот, вы можете добавить документацию по расширению для сообщений в приветственный обзор бота.

### <a name="templating"></a>Шаблоны

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-do.png" alt-text="Пример шаблона" border="false":::.

#### <a name="do-let-teams-handle-some-of-the-design-work-if-possible"></a>Нужно: по возможности перекладывать работу на Teams

Если это имеет смысл для ваших сценариев, рассмотрите возможность создания расширения для сообщений на основе поиска. Teams отрисовывает такие расширения, используя встроенную тему и с учетом специальных возможностей.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-dont.png" alt-text="Пример подхода к проектированию" border="false":::

#### <a name="dont-embed-your-entire-app-in-a-task-module"></a>Нельзя: встраивать все приложение целиком в модуль задач

Если вашему расширению обмена сообщениями требуются команды действий, сделайте очень простой модуль задач и выводите на экран только компоненты, необходимые для выполнения действия.

   :::column-end:::
:::row-end:::

### <a name="theming"></a>Визуальные темы

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-do.png" alt-text="Пример визуальной темы" border="false":::

#### <a name="do-take-advantage-of-teams-color-tokens"></a>Нужно: использовать преимущества цветовых маркеров Teams

Каждая тема Teams имеет собственную цветовую схему. Чтобы автоматически обрабатывать изменения темы, используйте в дизайне <a href="https://fluentsite.z22.web.core.windows.net/0.51.3/colors#color-scheme" target="_blank">цветовые маркеры (Fluent UI)</a>.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-dont.png" alt-text="Пример использования цветовых маркеров" border="false":::

#### <a name="dont-hard-code-color-values"></a>Нельзя: жестко задавать значения цветов прямо в коде

Если вы не используете цветовые маркеры Teams, ваши макеты будут менее масштабируемыми и управление ими будет отнимать больше времени.

   :::column-end:::
:::row-end:::

### <a name="actions"></a>Действия

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-do.png" alt-text="Пример работы с действиями" border="false":::

#### <a name="do-include-action-commands-that-make-sense-in-context"></a>Нужно: реализовать команды действий, имеющие смысл в данном контексте

Предлагаемые действия с сообщениями должны быть связаны с тем, что сейчас просматривает пользователь. Например, вы можете предоставить пользователям средство для быстрой регистрации проблемы или создания рабочего запроса на основе чужого сообщения.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-dont.png" alt-text="Пример работы с командами действий" border="false":::

#### <a name="dont-include-actions-commands-that-arent-contextual"></a>Нельзя: создавать команды действий, которые никак не связаны с контекстом.

Действие **Открыть панель управления** будет выглядеть неуместно в большинстве бесед.

   :::column-end:::
:::row-end:::

### <a name="searches"></a>Поиск

#### <a name="do-show-search-results-while-typing"></a>Нужно: показывать результаты поиска по мере того, как пользователь вводит поисковый запрос

Показывайте предлагаемые результаты поиска сразу, пока пользователь печатает. Это позволит быстрее находить нужное содержимое, введя при этом меньше символов.

#### <a name="dont-require-users-to-submit-a-query"></a>Нельзя: требовать от пользователей отправки запроса

Вы можете заставить пользователей нажимать клавишу или кнопку для отправки запросов в ваше приложение. Хотя так может быть проще для службы приложений, пользователя может запутать то, что результаты поиска не выводятся в режиме реального времени по мере ввода запроса.

#### <a name="do-consider-zero-term-queries"></a>Нужно: рассмотрите возможность реализации запросов при пустом вводе

Например, пока пользователь еще не успел ничего ввести в поле поиска, покажите то, что он недавно просматривал в приложении. Возможно, пользователь хочет вставить в беседу.именно это.
