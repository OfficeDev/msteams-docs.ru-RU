---
title: Разработка расширения для обмена сообщениями
description: Узнайте, как разработать расширение для обмена сообщениями Teams, и получить комплект пользовательского интерфейса Microsoft Teams. В руководствах по проектированию Teams содержатся справочные советы и рекомендации по расширению сообщений.
author: heath-hamilton
ms.localizationpriority: high
ms.author: surbhigupta
ms.topic: conceptual
ms.openlocfilehash: ab456458c5e7ec5b71ae02c4071d86365f4805cf
ms.sourcegitcommit: 2d2a08f671c3d19381403ba1af5dff1f06bb4dd6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2022
ms.locfileid: "67338902"
---
# <a name="designing-your-microsoft-teams-message-extension"></a>Разработка расширения Microsoft Teams для обмена сообщениями

Расширения для обмена сообщениями — это ярлыки для вставки содержимого приложения или действий с сообщением без выхода из беседы.
Дальнейшие описания и иллюстрации того, как добавлять, использовать и управлять расширениями для обмена сообщениями в Teams, помогут вам в разработке вашего приложения.

## <a name="microsoft-teams-ui-kit"></a>Комплект разработчика для пользовательского интерфейса Microsoft Teams

Вы можете найти исчерпывающие рекомендации по разработке расширений для обмена сообщениями, включая элементы, которые вы можете взять и изменить по мере необходимости, в комплекте пользовательского интерфейса Microsoft Teams.

> [!div class="nextstepaction"]
> [Получить комплект разработчика для пользовательского интерфейса Microsoft Teams (Figma)](https://www.figma.com/community/file/916836509871353159)

## <a name="add-a-message-extension"></a>Добавление расширения для обмена сообщениями

Вы можете добавить расширение для обмена сообщениями в следующих контекстах Teams:

* В магазине Teams.
* В канале, чате или собрании (до, во время и после) рядом с полем создания сообщения. Стоит отметить, что если вы добавите расширение для обмена сообщениями в одном из этих мест, только вы сможете использовать его в этом контексте.

В следующих примерах показано, как добавить расширение для обмена сообщениями в канале:

### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-add-in-channel.png" alt-text="В примере показано, как добавить расширение для обмена сообщениями рядом с полем создания сообщения в канале на мобильном устройстве.":::

### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/add-in-channel.png" alt-text="В примере показано, как добавить расширение для обмена сообщениями рядом с полем создания сообщения в канале.":::

## <a name="set-up-a-message-extension"></a>Настройка расширения для обмена сообщениями

Проверка подлинности не является обязательной, но если ваше приложение является чем-то вроде инструмента отслеживания запросов, вам может потребоваться, чтобы пользователи входили в систему, прежде чем использовать расширение для обмена сообщениями.

Чтобы обеспечить единый дизайн приложений Teams, экран входа менять нельзя. Если вы используете проверку подлинности с единым входом (SSO), пользователи будут автоматически выполнять вход.

### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-set-up.png" alt-text="В примере показан экран настройки расширения для обмена сообщениями с кнопкой входа на мобильном устройстве.":::

### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/set-up.png" alt-text="В примере показан экран настройки расширения для обмена сообщениями с кнопкой входа.":::

## <a name="types-of-message-extensions"></a>Типы расширений для обмена сообщениями

Расширения для обмена сообщениями могут содержать команды поиска, команды действия или и то, и другое. Ваши команды зависят от функций приложения и того, как они соответствуют вариантам использования Teams.

### <a name="search-commands"></a>Команды поиска

С помощью команд поиска пользователи могут использовать ваше расширение для обмена сообщениями для быстрого поиска внешнего контента и его вставки в сообщение. Команды поиска обычно доступны в поле создания сообщения. Например, вы можете начать обсуждение или поучаствовать в нем, поделившись содержимым — и при этом не выходя из Teams.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-search-command-type.png" alt-text="В примере показано расширение для обмена сообщениями с поиском, открытое из окна создания сообщения на мобильном устройстве.":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/search-command-type.png" alt-text="В примере показано расширение для обмена сообщениями с поиском, открытое из поля создания сообщения.":::

#### <a name="compose-box-layout-options"></a>Параметры компоновки поля создания сообщения

Существует несколько вариантов отображения результатов поиска в расширении для обмена сообщениями, включая [представление в виде списка и сетки](../../messaging-extensions/how-to/search-commands/respond-to-search.md#respond-to-user-requests).

:::image type="content" source="../../assets/images/messaging-extension/search-result-layout.png" alt-text="Иллюстрации вариантов макета для результатов поиска в расширении для обмена сообщениями":::

### <a name="action-commands"></a>Команды действий

Команды действий позволяют запускать действия и обрабатывать запросы во внешних службах в Teams. Например, если ваше приложение отслеживает заказы, пользователь может создать новый заказ, используя содержимое сообщения коллеги прямо в чате.

Расширения для обмена сообщениями с действиями, часто требуют от пользователей заполнения формы или какой-либо другой конфигурации в модальном окне. Такие виды интерфейса можно создавать с помощью [модулей задач](../../task-modules-and-cards/task-modules/design-teams-task-modules.md).

## <a name="open-a-message-extension"></a>Открытие расширения для обмена сообщениями

Поля ввода, сообщения или публикации являются основными контекстами, в которых пользователи используют расширения для обмена сообщениями.

### <a name="from-the-compose-box"></a>Из поля создания сообщения

После добавления пользователи могут открыть ваше расширение для обмена сообщениями, выбрав значок приложения под полем ввода. В этих примерах расширение содержит и команду поиска, и команду действий.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-open-from-compose-box.png" alt-text="В примере показано, как открыть расширение для обмена сообщениями из поля ввода на мобильном устройстве.":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/open-from-compose-box.png" alt-text="В примере показано, как открыть расширение для обмена сообщениями из поля ввода":::

### <a name="from-a-chat-message-or-channel-post"></a>Из сообщения чата или публикации канала

После того как вы добавите свое расширение для сообщений, пользователи смогут открывать его, выбрав значок **Еще**:::image type="icon" source="../../assets/icons/teams-client-more.png"::: в сообщении чата или публикации канала, чтобы найти команды действий. В зависимости от того, как используется ваше расширение, оно может быть указано в списке **Дополнительные действия**.

#### <a name="chat-message"></a>Сообщение чата

:::image type="content" source="../../assets/images/messaging-extension/open-from-chat-message.png" alt-text="В примере показано, как открыть расширение для обмена сообщениями из сообщения чата.":::

#### <a name="channel-post"></a>Публикация в канале

:::image type="content" source="../../assets/images/messaging-extension/open-from-channel-post.png" alt-text="В примере показано, как открыть расширение для обмена сообщениями из сообщения канала на мобильном устройстве.":::

## <a name="use-a-message-extension"></a>Использование расширения для обмена сообщениями

В следующих сценариях показаны основные способы использования расширений для обмена сообщениями.

### <a name="insert-content-into-a-message"></a>Вставка контента в сообщение

**1. Выберите расширение для обмена сообщениями**. Пользователи могут искать содержимое, которым они хотят поделиться, в поле ввода сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-content-search.png" alt-text="В примере показано, как пользователь ищет контент для вставки прямо из поля создания сообщения на мобильном устройстве.":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-content-search.png" alt-text="В примере показано, как пользователь ищет контент для вставки прямо из поля создания сообщения.":::

**2. Вставьте содержимое**. После публикации другие смогут ответить или выбрать контент, чтобы увидеть больше информации в вашем приложении.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-content-posted.png" alt-text="В примере показан пользователь, публикующий контент в беседе в канале на мобильном устройстве.":::

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-content-posted.png" alt-text="В примере показан пользователь, публикующий контент в беседе в канале.":::

### <a name="take-action-on-a-message"></a>Действия с сообщениями

**1. Выберите расширение для обмена сообщениями**. Ваше приложение может включать одну или несколько команд действий.

:::image type="content" source="../../assets/images/messaging-extension/select-action-command.png" alt-text="В примере показано, как пользователь выбирает команду действия расширения для обмена сообщениями.":::

**2. Закончите действие**. Ваше приложение может получать и обрабатывать любой контент или данные, отправленные действием сообщения. Пользователи заканчивают действие в вашем приложении, оставаясь в беседе.

:::image type="content" source="../../assets/images/messaging-extension/complete-action-command.png" alt-text="Пример действия с сообщением.":::

### <a name="preview-links"></a>Предварительный просмотр ссылок

Расширения для обмена сообщениями также позволяют вставлять в сообщение расширенные ссылки с распознанного URL-адреса (эта возможность называется [развертыванием ссылок](../../messaging-extensions/how-to/link-unfurling.md).)

**1. Вставьте распознаваемую ссылку** в поле создания сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-paste-preview-link.png" alt-text="В примере показано, как пользователь вставляет ссылку в поле создания сообщения на мобильном устройстве":::.

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/paste-preview-link.png" alt-text="В примере показано, как пользователь вставляет ссылку в поле создания сообщения":::.

**2. Вставьте содержимое**. Если ваше приложение распознает URL-адрес в поле ввода сообщения, оно отображает ссылку в виде карточки, которая обеспечивает предварительный просмотр веб-контента с объемным содержимым. (Подробнее см. в [руководстве по дизайну адаптивных карточек](../../task-modules-and-cards/cards/design-effective-cards.md).)

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-insert-preview-link.png" alt-text="В примере показано, как URL-адрес, распознанный приложением, включает в поле создания сообщения часть контента на мобильном устройстве":::.

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/insert-preview-link.png" alt-text="В примере показано, как URL-адрес, распознанный приложением, включает в поле создания сообщения часть контента":::.

## <a name="manage-a-message-extension"></a>Управление расширением для обмена сообщениями

Щелкнув значок правой кнопкой мыши, пользователи смогут закрепить, удалить или настроить ваше расширение для обмена сообщениями.

## <a name="anatomy"></a>Структура

### <a name="message-extension-in-the-compose-box"></a>Расширение для обмена сообщениями в поле ввода сообщения

В следующих примерах показано расширение для обмена сообщениями, открытое из поля ввода сообщения.

#### <a name="mobile"></a>Мобильная версия

:::image type="content" source="../../assets/images/messaging-extension/mobile-anatomy-compose.png" alt-text="Иллюстрация структуры пользовательского интерфейса расширения для обмена сообщениями в поле ввода сообщения на мобильном устройстве":::

|Счетчик|Описание|
|----------|-----------|
|1|**Имя приложения**: полное имя приложения.|
|2|**Значок меню команд действий (необязательно)**: открывает список команд действий для вашего расширения для обмена сообщениями (если вы его указали).
|3|**Поле поиска**: позволяет пользователям находить контент приложения для последующей вставки.|
|4|**Меню вкладок (необязательно)**: предоставляет несколько категорий контента.|
|5|**Меню команд действий (необязательно)**: выводит на экран список команд действий (если вы их указали).|
|6|**Контент приложения**: в основном для отображения результатов поиска.|

#### <a name="desktop"></a>Версия для настольного компьютера

:::image type="content" source="../../assets/images/messaging-extension/anatomy-compose.png" alt-text="Иллюстрация структуры пользовательского интерфейса расширения для обмена сообщениями в поле ввода сообщения.":::

|Счетчик|Описание|
|----------|-----------|
|1|**Логотип приложения**: цветной значок логотипа приложения.|
|2|**Имя приложения**: полное имя приложения.|
|3|**Значок меню команд действий (необязательно)**: открывает список команд действий для вашего расширения для обмена сообщениями (если вы его указали).
|4|**Поле поиска**: позволяет пользователям находить контент приложения для последующей вставки.|
|5|**Меню вкладок (необязательно)**: предоставляет несколько категорий контента.|
|6|**Меню команд действий (необязательно)**: выводит на экран список команд действий (если вы их указали).|
|7 |**Контент приложения**: в основном для отображения результатов поиска. В этом примере используется компоновка списка (другой вариант — табличная компоновка).|
|8 |**Логотип приложения**: контурный значок логотипа приложения.|

### <a name="message-extension-management-menu"></a>Меню управления расширениями для обмена сообщениями

:::image type="content" source="../../assets/images/messaging-extension/anatomy-management-menu.png" alt-text="Иллюстрация структуры пользовательского интерфейса меню расширения для обмена сообщениями":::

|Счетчик|Описание|
|----------|-----------|
|1|**Открепить**: доступно, если пользователь закрепил ваше приложение.|
|2|**Удалить** удаляет расширение для обмена сообщениями из канала, чата или собрания.|

## <a name="best-practices"></a>Рекомендации

Используйте эти рекомендации для создания качественных приложений.

### <a name="setup-and-general-usage"></a>Настройка и общее использование

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-do.png" alt-text="Пример установки и общего использования.":::

#### <a name="do-integrate-with-single-sign-on"></a>Нужно: интегрироваться с единым входом

Система единого входа делает процесс входа проще, быстрее и безопаснее. Кроме того, если пользователь уже вошел в ваше личное приложение, ему не нужно входить снова, чтобы получить доступ к расширению для обмена сообщениями.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/setup-dont.png" alt-text="Пример интеграции с единым входом.":::

#### <a name="dont-take-users-away-from-the-conversation"></a>Нельзя: заставлять пользователей выходить из беседы

Расширения для обмена сообщениями — это ярлыки, для ярлыки, позволяющие снизить необходимость переключения контекста. Например, расширение не должно направлять пользователей на веб-страницу за пределами Teams.

   :::column-end:::
:::row-end:::

#### <a name="do-highlight-your-message-extension"></a>Нужно: выделить ваше расширение для обмена сообщениями

Расширение для обмена сообщениями не всегда легко заметить. Добавьте на страницу сведений о приложении снимки экрана, показывающие, как использовать ваше расширение для сообщений. Если приложение также содержит бот, вы можете добавить документацию по расширению для обмена сообщениями в приветственный обзор бота.

### <a name="templating"></a>Шаблоны

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-do.png" alt-text="Пример шаблона.":::

#### <a name="do-let-teams-handle-some-of-the-design-work-if-possible"></a>Нужно: по возможности перекладывать работу на Teams

Если это подходит для ваших вариантов использования, рассмотрите возможность создания расширения для обмена сообщениями с поиском. Teams отрисовывает такие расширения, используя встроенную тему и с учетом специальных возможностей.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/templating-dont.png" alt-text="Пример обработки работ по проектированию.":::

#### <a name="dont-embed-your-entire-app-in-a-task-module"></a>Нельзя: встраивать все приложение целиком в модуль задач

Если вашему расширению для обмена сообщениями требуются команды действий, сделайте модуль задач простым и отобразите только компоненты, необходимые для выполнения действия.

   :::column-end:::
:::row-end:::

### <a name="theming"></a>Визуальные темы

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-do.png" alt-text="Пример визуальной темы":::

#### <a name="do-take-advantage-of-teams-color-tokens"></a>Нужно: использовать преимущества цветовых маркеров Teams

Каждая тема Teams имеет собственную цветовую схему. Чтобы автоматически обрабатывать изменения темы, используйте в дизайне <a href="https://fluentsite.z22.web.core.windows.net/0.51.3/colors#color-scheme" target="_blank">цветовые маркеры (Fluent UI)</a>.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/theming-dont.png" alt-text="Пример использования цветовых маркеров":::

#### <a name="dont-hard-code-color-values"></a>Нельзя: жестко задавать значения цветов прямо в коде

Если вы не используете цветовые маркеры Teams, ваши макеты будут менее масштабируемыми и управление ими будет отнимать больше времени.

   :::column-end:::
:::row-end:::

### <a name="actions"></a>Действия

:::row:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-do.png" alt-text="Пример работы с действиями":::

#### <a name="do-include-action-commands-that-make-sense-in-context"></a>Нужно: реализовать команды действий, имеющие смысл в данном контексте

Предлагаемые действия с сообщениями должны быть связаны с тем, что сейчас просматривает пользователь. Например, вы можете предоставить пользователям средство для быстрой регистрации проблемы или создания рабочего запроса на основе чужого сообщения.

   :::column-end:::
   :::column span="":::
:::image type="content" source="../../assets/images/messaging-extension/action-commands-dont.png" alt-text="Пример работы с командами действий":::

#### <a name="dont-include-actions-commands-that-arent-contextual"></a>Нельзя: создавать команды действий, которые никак не связаны с контекстом.

Действие **Открыть панель управления** будет выглядеть неуместно в большинстве бесед.

   :::column-end:::
:::row-end:::

### <a name="searches"></a>Поиск

#### <a name="do-show-search-results-while-typing"></a>Нужно: показывать результаты поиска по мере того, как пользователь вводит поисковый запрос

Показывайте предлагаемые результаты поиска сразу, пока пользователь печатает. Это позволит быстрее находить нужное содержимое, введя при этом меньше символов.

#### <a name="dont-require-users-to-submit-a-query"></a>Нельзя: требовать от пользователей отправки запроса

Вы можете заставить пользователей нажимать клавишу или кнопку для отправки запросов в ваше приложение. Хотя так может быть проще для службы приложений, пользователя может запутать то, что результаты поиска не выводятся в режиме реального времени по мере ввода запроса.

#### <a name="do-consider-zero-term-queries"></a>Нужно: рассмотрите возможность реализации запросов при пустом вводе

Например, пока пользователь еще не успел ничего ввести в поле поиска, покажите то, что он недавно просматривал в приложении. Возможно, пользователь хочет вставить в беседу.именно это.
