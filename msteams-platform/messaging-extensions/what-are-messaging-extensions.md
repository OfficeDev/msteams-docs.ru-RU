---
title: Что такое расширения обмена сообщениями?
author: clearab
description: Обзор расширений обмена сообщениями на платформе Microsoft Teams
ms.topic: overview
ms.author: anclear
ms.openlocfilehash: dd68f2005cbb3ed119a9aadfafd6066db221000b
ms.sourcegitcommit: a08f1c7eb9fca11f44842773ab669c69d4af40db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2020
ms.locfileid: "43225793"
---
# <a name="what-are-messaging-extensions"></a>Что такое расширения обмена сообщениями?

Расширения обмена сообщениями позволяют пользователям взаимодействовать с веб-службой с помощью кнопок и форм в клиенте Microsoft Teams. Они могут выполнять поиск или инициировать действия во внешней системе из области создание сообщения, команды или непосредственно из сообщения. Затем вы можете отправить результаты этого взаимодействия обратно в клиент Microsoft Teams, как правило, в виде карточки с расширенным форматированием.

На снимке экрана ниже показаны расположения, из которых могут вызываться расширения обмена сообщениями.

![места вызова расширения обмена сообщениями](~/assets/images/messaging-extension-invoke-locations.png)

## <a name="what-kinds-of-tasks-are-they-good-for"></a>Какие типы задач хорошо подходят?

**Сценарий:** Мне нужна внешняя система, чтобы сделать что-то, и я хочу отправить результат действия обратно в беседу. \
**Пример:** Зарезервируйте ресурс и сообщите каналу, для которого зарезервированы сведения о дне и времени.

**Сценарий:** Мне нужно найти что-то во внешней системе и хочу поделиться результатами с моим разговором. \
**Пример:**  Выполните поиск рабочего элемента в Azure DevOps и предоставьте ему доступ к группе в качестве адаптивной карточки.

**Сценарий:** Мне нужно выполнить сложную задачу, включающую несколько шагов (или множество сведений) во внешней системе, и получить доступ к результатам с помощью беседы. \
**Пример:** Создание ошибки в системе отслеживания на основе сообщения Teams, назначение ошибки Бобу, а затем отправка карты в поток бесед с подробными сведениями об ошибке.

## <a name="how-do-messaging-extensions-work"></a>Как работают расширения обмена сообщениями?

Расширение системы обмена сообщениями состоит из размещенной веб-службы и манифеста приложения, который определяет, где можно вызвать веб-службу в клиенте Microsoft Teams. Они используют преимущества схемы обмена сообщениями и протокола Secure Communication Framework, поэтому вам также потребуется зарегистрировать веб-службу в качестве Bot в Bot-среде. Несмотря на то, что вы можете самостоятельно создать свою веб-службу, мы рекомендуем использовать [пакет SDK для ленты](https://github.com/microsoft/botframework) , чтобы упростить работу с протоколом.

В манифесте приложения для приложения Microsoft Teams вы можете определить одно расширение обмена сообщениями, используя до десяти разных команд. Каждая команда определяет тип (действие или поиск) и расположения в клиенте, из которых он может вызываться (создание области сообщений, панели команд и/или сообщения). После вызова веб-служба получает HTTPS-сообщение с полезной нагрузкой JSON, в том числе всю необходимую информацию. Вы будете отвечать с помощью полезных данных JSON, позволяя клиенту Teams знать, какое взаимодействие следует включить следующим.

## <a name="types-of-messaging-extension-commands"></a>Типы команд расширения обмена сообщениями

Команда тип расширения обмена сообщениями определяет элементы пользовательского интерфейса и потоки взаимодействия, доступные для веб-службы. Некоторые взаимодействия, такие как проверка подлинности и конфигурация, доступны для обоих типов команд.

### <a name="action-commands"></a>Команды действий

Команды действий позволяют предоставить пользователям модальное всплывающее окно для сбора и отображения данных. При отправку формы веб-служба может ответить, вставив сообщение в беседу напрямую или вставив сообщение в область создание сообщения и разрешив пользователю отправить сообщение. Вы можете даже объединить несколько форм в цепочку для более сложных рабочих процессов.

Их можно запустить из области "Создание сообщения", команды или из сообщения. При вызове из сообщения первоначальные полезные данные JSON, отправленные на Bot, будут включать все сообщение, из которого оно было вызвано.

![модуль задачи для команды действия расширения обмена сообщениями](~/assets/images/task-module.png)

### <a name="search-commands"></a>Команды поиска

Команды поиска позволяют пользователям выполнять поиск информации в внешней системе (вручную с помощью поля поиска или путем вставки ссылки на отслеживаемый домен в область сообщений), а затем вставлять результаты поиска в сообщение. В самом основном окне команды поиска исходное сообщение вызова будет содержать строку поиска, отправленную пользователем. Вы получите ответ со списком карточек и предварительных просмотров карточек. Клиент Teams будет отображать предварительный просмотр карт в списке для выбора конечным пользователем. Когда пользователь выбирает карточку, в область сообщения "создать" будет вставлена карточка полного размера.

Их можно запустить из области создать сообщение или Командная поле. В отличие от команд действий, они не могут быть вызваны из сообщения.

![команда поиска для расширения системы обмена сообщениями](~/assets/images/search-extension.png)

### <a name="link-unfurling"></a>Ссылка унфурлинг

Кроме того, необходимо выполнить команду, чтобы вызвать службу при вставке URL-адреса в область "Создание сообщения". Эта функция, называемая **Link унфурлинг**, позволяет подписываться на получение вызова, когда URL-адреса, содержащие определенный домен, вставляются в область сообщения создание. Веб-служба может "унфурл" URL-адрес на детализированную карточку, предоставляя дополнительные сведения, чем стандартная карта предварительного просмотра веб-сайта. Вы можете даже добавить кнопки, чтобы пользователи могли сразу же предпринять действия, не выходя из клиента Microsoft Teams.

## <a name="get-started"></a>Начало работы

Готовы приступить к построению? Попробуйте один из наших примеров:

* **C#**
  * [Расширение системы обмена сообщениями с помощью команд на основе действий](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/51.teams-messaging-extensions-action)
  * [Расширение системы обмена сообщениями с помощью команд на основе поиска](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/50.teams-messaging-extensions-search)
* **JavaScript**
  * [Расширение системы обмена сообщениями с помощью команд на основе действий](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/51.teams-messaging-extensions-action)
  * [Расширение системы обмена сообщениями с помощью команд на основе поиска](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/50.teams-messaging-extensions-search)

## <a name="learn-more"></a>Дополнительные сведения

Создание расширения для обмена сообщениями:

* [Создание расширения обмена сообщениями](~/messaging-extensions/how-to/create-messaging-extension.md)
* [Команда определения расширения для обмена сообщениями о действиях](~/messaging-extensions/how-to/action-commands/define-action-command.md)
* [Команда определения расширения поисковых сообщений](~/messaging-extensions/how-to/search-commands/define-search-command.md)
