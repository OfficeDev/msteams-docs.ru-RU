---
title: Что такое расширения обмена сообщениями?
author: clearab
description: Обзор расширений обмена сообщениями на платформе Microsoft Teams
ms.topic: overview
ms.author: anclear
ms.openlocfilehash: 3ea9649a22ecc134e983037d1ef109be918a26b3
ms.sourcegitcommit: 7a2da3b65246a125d441a971e7e6a6418355adbe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2020
ms.locfileid: "46587799"
---
# <a name="what-are-messaging-extensions"></a><span data-ttu-id="e99c3-103">Что такое расширения обмена сообщениями?</span><span class="sxs-lookup"><span data-stu-id="e99c3-103">What are messaging extensions?</span></span>

<span data-ttu-id="e99c3-104">Расширения обмена сообщениями позволяют пользователям взаимодействовать с веб-службой с помощью кнопок и форм в клиенте Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e99c3-104">Messaging extensions allow users to interact with your web service through buttons and forms in the Microsoft Teams client.</span></span> <span data-ttu-id="e99c3-105">Они могут выполнять поиск или инициировать действия во внешней системе из области создание сообщения, команды или непосредственно из сообщения.</span><span class="sxs-lookup"><span data-stu-id="e99c3-105">They can search, or initiate actions, in an external system from the compose message area, the command box, or directly from a message.</span></span> <span data-ttu-id="e99c3-106">Затем вы можете отправить результаты этого взаимодействия обратно в клиент Microsoft Teams, как правило, в виде карточки с расширенным форматированием.</span><span class="sxs-lookup"><span data-stu-id="e99c3-106">You can then send the results of that interaction back to the Microsoft Teams client, typically in the form of a richly formatted card.</span></span>

<span data-ttu-id="e99c3-107">На снимке экрана ниже показаны расположения, из которых могут вызываться расширения обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="e99c3-107">The screenshot below shows the locations where messaging extensions can be invoked from.</span></span>

![места вызова расширения обмена сообщениями](~/assets/images/messaging-extension-invoke-locations.png)

## <a name="what-kinds-of-tasks-are-they-good-for"></a><span data-ttu-id="e99c3-109">Какие типы задач хорошо подходят?</span><span class="sxs-lookup"><span data-stu-id="e99c3-109">What kinds of tasks are they good for?</span></span>

<span data-ttu-id="e99c3-110">**Сценарий:** Мне нужна внешняя система, чтобы сделать что-то, и я хочу отправить результат действия обратно в беседу. </span><span class="sxs-lookup"><span data-stu-id="e99c3-110">**Scenario:** I need some external system to do something and I want the result of the action to be sent back to my conversation.</span></span>\
<span data-ttu-id="e99c3-111">**Пример:** Зарезервируйте ресурс и сообщите каналу, для которого зарезервированы сведения о дне и времени.</span><span class="sxs-lookup"><span data-stu-id="e99c3-111">**Example:** Reserve a resource and let the channel know what day/time you reserved it for.</span></span>

<span data-ttu-id="e99c3-112">**Сценарий:** Мне нужно найти что-то во внешней системе и хочу поделиться результатами с моим разговором. </span><span class="sxs-lookup"><span data-stu-id="e99c3-112">**Scenario:** I need to find something in an external system, and I want to share the results with my conversation.</span></span>\
<span data-ttu-id="e99c3-113">**Пример:**  Выполните поиск рабочего элемента в Azure DevOps и предоставьте ему доступ к группе в качестве адаптивной карточки.</span><span class="sxs-lookup"><span data-stu-id="e99c3-113">**Example:**  Search for a work item in Azure DevOps, and share it with the group as an adaptive card.</span></span>

<span data-ttu-id="e99c3-114">**Сценарий:** Мне нужно выполнить сложную задачу, включающую несколько шагов (или множество сведений) во внешней системе, и получить доступ к результатам с помощью беседы. </span><span class="sxs-lookup"><span data-stu-id="e99c3-114">**Scenario:** I need to complete a complex task involving multiple steps (or lots of information) in an external system, and the results should be shared with a conversation.</span></span>\
<span data-ttu-id="e99c3-115">**Пример:** Создание ошибки в системе отслеживания на основе сообщения Teams, назначение ошибки Бобу, а затем отправка карты в поток бесед с подробными сведениями об ошибке.</span><span class="sxs-lookup"><span data-stu-id="e99c3-115">**Example:** Create a bug in your tracking system based on a Teams message, assign that bug to Bob, then send a card to the conversation thread with the bug's details.</span></span>

## <a name="how-do-messaging-extensions-work"></a><span data-ttu-id="e99c3-116">Как работают расширения обмена сообщениями?</span><span class="sxs-lookup"><span data-stu-id="e99c3-116">How do messaging extensions work?</span></span>

<span data-ttu-id="e99c3-117">Расширение системы обмена сообщениями состоит из размещенной веб-службы и манифеста приложения, который определяет, где можно вызвать веб-службу в клиенте Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e99c3-117">A messaging extension consists of a web service you host and your app manifest which defines where your web service can be invoked from in the Microsoft Teams client.</span></span> <span data-ttu-id="e99c3-118">Они используют преимущества схемы обмена сообщениями и протокола Secure Communication Framework, поэтому вам также потребуется зарегистрировать веб-службу в качестве Bot в Bot-среде.</span><span class="sxs-lookup"><span data-stu-id="e99c3-118">They take advantage of the Bot Framework's messaging schema and secure communication protocol, so you'll also need to register your web service as a bot in the Bot Framework.</span></span> <span data-ttu-id="e99c3-119">Несмотря на то, что вы можете самостоятельно создать свою веб-службу, мы рекомендуем использовать [пакет SDK для ленты](https://github.com/microsoft/botframework) , чтобы упростить работу с протоколом.</span><span class="sxs-lookup"><span data-stu-id="e99c3-119">Although you can create your web service completely by hand, we recommend you take advantage of the [Bot Framework SDK](https://github.com/microsoft/botframework) to make working with the protocol simpler.</span></span>

<span data-ttu-id="e99c3-120">В манифесте приложения для приложения Microsoft Teams вы можете определить одно расширение обмена сообщениями, используя до десяти разных команд.</span><span class="sxs-lookup"><span data-stu-id="e99c3-120">In the app manifest for your Microsoft Teams app you'll define a single messaging extension with up to ten different commands.</span></span> <span data-ttu-id="e99c3-121">Каждая команда определяет тип (действие или поиск) и расположения в клиенте, из которых он может вызываться (создание области сообщений, панели команд и/или сообщения).</span><span class="sxs-lookup"><span data-stu-id="e99c3-121">Each command defines a type (action or search), and the locations in the client it can be invoked from (compose message area, command bar, and/or message).</span></span> <span data-ttu-id="e99c3-122">После вызова веб-служба получает HTTPS-сообщение с полезной нагрузкой JSON, в том числе всю необходимую информацию.</span><span class="sxs-lookup"><span data-stu-id="e99c3-122">Once invoked, your web service will receive an HTTPS message with a JSON payload including all the relevant information.</span></span> <span data-ttu-id="e99c3-123">Вы будете отвечать с помощью полезных данных JSON, позволяя клиенту Teams знать, какое взаимодействие следует включить следующим.</span><span class="sxs-lookup"><span data-stu-id="e99c3-123">You'll respond with a JSON payload, letting the Teams client know what interaction to enable next.</span></span>

## <a name="types-of-messaging-extension-commands"></a><span data-ttu-id="e99c3-124">Типы команд расширения обмена сообщениями</span><span class="sxs-lookup"><span data-stu-id="e99c3-124">Types of messaging extension commands</span></span>

<span data-ttu-id="e99c3-125">Команда тип расширения обмена сообщениями определяет элементы пользовательского интерфейса и потоки взаимодействия, доступные для веб-службы.</span><span class="sxs-lookup"><span data-stu-id="e99c3-125">The type of messaging extension command defines the UI elements and interaction flows available to your web service.</span></span> <span data-ttu-id="e99c3-126">Некоторые взаимодействия, такие как проверка подлинности и конфигурация, доступны для обоих типов команд.</span><span class="sxs-lookup"><span data-stu-id="e99c3-126">Some interactions, like authentication and configuration, are available for both types of commands.</span></span>

### <a name="action-commands"></a><span data-ttu-id="e99c3-127">Команды действий</span><span class="sxs-lookup"><span data-stu-id="e99c3-127">Action commands</span></span>

<span data-ttu-id="e99c3-128">Команды действий позволяют предоставить пользователям модальное всплывающее окно для сбора и отображения данных.</span><span class="sxs-lookup"><span data-stu-id="e99c3-128">Action commands allow you to present your users with a modal popup to collect or display information.</span></span> <span data-ttu-id="e99c3-129">При отправку формы веб-служба может ответить, вставив сообщение в беседу напрямую или вставив сообщение в область создание сообщения и разрешив пользователю отправить сообщение.</span><span class="sxs-lookup"><span data-stu-id="e99c3-129">When they submit the form, your web service can respond by inserting a message into the conversation directly, or by inserting a message into the compose message area and allowing the user to submit the message.</span></span> <span data-ttu-id="e99c3-130">Вы можете даже объединить несколько форм в цепочку для более сложных рабочих процессов.</span><span class="sxs-lookup"><span data-stu-id="e99c3-130">You can even chain multiple forms together for more complex workflows.</span></span>

<span data-ttu-id="e99c3-131">Их можно запустить из области "Создание сообщения", команды или из сообщения.</span><span class="sxs-lookup"><span data-stu-id="e99c3-131">They can be triggered from the compose message area, the command box, or from a message.</span></span> <span data-ttu-id="e99c3-132">При вызове из сообщения первоначальные полезные данные JSON, отправленные на Bot, будут включать все сообщение, из которого оно было вызвано.</span><span class="sxs-lookup"><span data-stu-id="e99c3-132">When invoked from a message, the initial JSON payload sent to your bot will include the entire message it was invoked from.</span></span>

![модуль задачи для команды действия расширения обмена сообщениями](~/assets/images/task-module.png)

### <a name="search-commands"></a><span data-ttu-id="e99c3-134">Команды поиска</span><span class="sxs-lookup"><span data-stu-id="e99c3-134">Search commands</span></span>

<span data-ttu-id="e99c3-135">Команды поиска позволяют пользователям выполнять поиск информации в внешней системе (вручную с помощью поля поиска или путем вставки ссылки на отслеживаемый домен в область сообщений), а затем вставлять результаты поиска в сообщение.</span><span class="sxs-lookup"><span data-stu-id="e99c3-135">Search commands allow your users to search an external system for information (either manually through a search box, or by pasting a link to a monitored domain into the compose message area), then insert the results of the search into a message.</span></span> <span data-ttu-id="e99c3-136">В самом основном окне команды поиска исходное сообщение вызова будет содержать строку поиска, отправленную пользователем.</span><span class="sxs-lookup"><span data-stu-id="e99c3-136">In the most basic search command flow, the initial invoke message will include the search string the user submitted.</span></span> <span data-ttu-id="e99c3-137">Вы получите ответ со списком карточек и предварительных просмотров карточек.</span><span class="sxs-lookup"><span data-stu-id="e99c3-137">You'll respond with a list of cards and card previews.</span></span> <span data-ttu-id="e99c3-138">Клиент Teams будет отображать предварительный просмотр карт в списке для выбора конечным пользователем.</span><span class="sxs-lookup"><span data-stu-id="e99c3-138">The Teams client will render the card previews in a list for the end user to select from.</span></span> <span data-ttu-id="e99c3-139">Когда пользователь выбирает карточку, в область сообщения "создать" будет вставлена карточка полного размера.</span><span class="sxs-lookup"><span data-stu-id="e99c3-139">When the user selects a card, the full-size card will be inserted into the compose message area.</span></span>

<span data-ttu-id="e99c3-140">Их можно запустить из области создать сообщение или Командная поле.</span><span class="sxs-lookup"><span data-stu-id="e99c3-140">They can be triggered from the compose message area or the command box.</span></span> <span data-ttu-id="e99c3-141">В отличие от команд действий, они не могут быть вызваны из сообщения.</span><span class="sxs-lookup"><span data-stu-id="e99c3-141">Unlike action commands, they cannot be triggered from a message.</span></span>

![команда поиска для расширения системы обмена сообщениями](~/assets/images/search-extension.png)

### <a name="link-unfurling"></a><span data-ttu-id="e99c3-143">Развернуть ссылку</span><span class="sxs-lookup"><span data-stu-id="e99c3-143">Link unfurling</span></span>

<span data-ttu-id="e99c3-144">Кроме того, имеется возможность вызвать службу при вставке URL-адреса в область сообщения создание.</span><span class="sxs-lookup"><span data-stu-id="e99c3-144">You also have the option to invoke your service when a URL is pasted in the compose message area.</span></span> <span data-ttu-id="e99c3-145">Эта функция, называемая **Link унфурлинг**, позволяет подписываться на получение вызова, когда URL-адреса, содержащие определенный домен, вставляются в область сообщения создание.</span><span class="sxs-lookup"><span data-stu-id="e99c3-145">This functionality, known as **link unfurling**, allows you to subscribe to receive an invoke when URLs containing a particular domain are pasted into the compose message area.</span></span> <span data-ttu-id="e99c3-146">Веб-служба может "унфурл" URL-адрес на детализированную карточку, предоставляя дополнительные сведения, чем стандартная карта предварительного просмотра веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="e99c3-146">Your web service can "unfurl" the URL into a detailed card, providing more information than the standard website preview card.</span></span> <span data-ttu-id="e99c3-147">Вы можете даже добавить кнопки, чтобы пользователи могли сразу же предпринять действия, не выходя из клиента Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="e99c3-147">You can even add buttons to allow your users to immediately take action without leaving the Microsoft Teams client.</span></span>

## <a name="get-started"></a><span data-ttu-id="e99c3-148">Начало работы</span><span class="sxs-lookup"><span data-stu-id="e99c3-148">Get Started</span></span>

<span data-ttu-id="e99c3-149">Готовы приступить к построению?</span><span class="sxs-lookup"><span data-stu-id="e99c3-149">Ready to get started building?</span></span> <span data-ttu-id="e99c3-150">Попробуйте один из наших примеров:</span><span class="sxs-lookup"><span data-stu-id="e99c3-150">Try one of our quickstarts:</span></span>

* <span data-ttu-id="e99c3-151">**C#**</span><span class="sxs-lookup"><span data-stu-id="e99c3-151">**C#**</span></span>
  * [<span data-ttu-id="e99c3-152">Расширение системы обмена сообщениями с помощью команд на основе действий</span><span class="sxs-lookup"><span data-stu-id="e99c3-152">Messaging extension with action-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/51.teams-messaging-extensions-action)
  * [<span data-ttu-id="e99c3-153">Расширение системы обмена сообщениями с помощью команд на основе поиска</span><span class="sxs-lookup"><span data-stu-id="e99c3-153">Messaging extension with search-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/50.teams-messaging-extensions-search)
* <span data-ttu-id="e99c3-154">**JavaScript**</span><span class="sxs-lookup"><span data-stu-id="e99c3-154">**JavaScript**</span></span>
  * [<span data-ttu-id="e99c3-155">Расширение системы обмена сообщениями с помощью команд на основе действий</span><span class="sxs-lookup"><span data-stu-id="e99c3-155">Messaging extension with action-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/51.teams-messaging-extensions-action)
  * [<span data-ttu-id="e99c3-156">Расширение системы обмена сообщениями с помощью команд на основе поиска</span><span class="sxs-lookup"><span data-stu-id="e99c3-156">Messaging extension with search-based commands</span></span>](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/50.teams-messaging-extensions-search)

## <a name="learn-more"></a><span data-ttu-id="e99c3-157">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="e99c3-157">Learn more</span></span>

<span data-ttu-id="e99c3-158">Создание расширения для обмена сообщениями:</span><span class="sxs-lookup"><span data-stu-id="e99c3-158">Build a messaging extension:</span></span>

* [<span data-ttu-id="e99c3-159">Создать расширение для обмена сообщениями</span><span class="sxs-lookup"><span data-stu-id="e99c3-159">Create a messaging extension</span></span>](~/messaging-extensions/how-to/create-messaging-extension.md)
* [<span data-ttu-id="e99c3-160">Команда определения расширения для обмена сообщениями о действиях</span><span class="sxs-lookup"><span data-stu-id="e99c3-160">Define action messaging extension command</span></span>](~/messaging-extensions/how-to/action-commands/define-action-command.md)
* [<span data-ttu-id="e99c3-161">Команда определения расширения поисковых сообщений</span><span class="sxs-lookup"><span data-stu-id="e99c3-161">Define search messaging extension command</span></span>](~/messaging-extensions/how-to/search-commands/define-search-command.md)
