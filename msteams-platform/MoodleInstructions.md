---
title: Установка интеграции Мудле с Microsoft Teams
description: Установка и настройка приложения интеграции Мудле для Microsoft Teams
keywords: Подключаемый модуль интеграции приложений Teams Мудле
ms.date: 01/31/2019
ms.openlocfilehash: 012d6e9c979386e892b5a47b7655208eca95e11a
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675138"
---
# <a name="installing-the-moodle-integration-with-microsoft-teams"></a><span data-ttu-id="3f475-104">Установка интеграции Мудле с Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="3f475-104">Installing the Moodle integration with Microsoft Teams</span></span>

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

<span data-ttu-id="3f475-105">[Мудле](https://moodle.org/), самая популярная и открытая система управления обучением (СУО) в мире теперь интегрирована с Microsoft Teams!</span><span class="sxs-lookup"><span data-stu-id="3f475-105">[Moodle](https://moodle.org/), the most popular and open-source Learning Management System (LMS) in the world, is now integrated with Microsoft Teams!</span></span> <span data-ttu-id="3f475-106">Эта интеграция помогает преподавателям и преподавателям совместно работать над курсами Мудле, задавать вопросы о своих оценках и назначениях, а также обновлять уведомления — прямо в Teams!</span><span class="sxs-lookup"><span data-stu-id="3f475-106">This integration helps educators and teachers collaborate around Moodle courses, ask questions about their grades and assignments and stay updated with notifications -- right within Teams!</span></span>

<span data-ttu-id="3f475-107">Чтобы администраторы могли легко настроить эту интеграцию, мы обновили подключаемый модуль Мудле для Office 365 с открытым кодом, используя следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="3f475-107">To help IT admins easily set this integration up, we have updated our open-source Office 365 Moodle Plugin with the following capabilities:</span></span>

* <span data-ttu-id="3f475-108">Автоматическая регистрация сервера Мудле с помощью Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3f475-108">Auto-registration of your Moodle server with Azure AD.</span></span>
* <span data-ttu-id="3f475-109">Одним щелчком мыши развернуть робота помощника по Мудле в Azure.</span><span class="sxs-lookup"><span data-stu-id="3f475-109">One-click deployment of your Moodle Assistant bot to Azure.</span></span>
* <span data-ttu-id="3f475-110">Автоматическая подготовка групп и автоматическая синхронизация регистраций групп для всех или выбора курсов Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-110">Auto-provisioning of teams and auto-synchronization of team enrollments for all or select Moodle courses.</span></span>
* <span data-ttu-id="3f475-111">Автоматическая установка вкладок Мудле и помощника Мудле в каждую синхронизированную команду.</span><span class="sxs-lookup"><span data-stu-id="3f475-111">Auto-installation of the Moodle tab and the Moodle Assistant bot into each synchronized team.</span></span> <span data-ttu-id="3f475-112">(Ожидается в ближайшее время)</span><span class="sxs-lookup"><span data-stu-id="3f475-112">(Coming soon)</span></span>
* <span data-ttu-id="3f475-113">Публикация приложения Мудле одним щелчком мыши в вашем хранилище приложений для частных рабочих групп.</span><span class="sxs-lookup"><span data-stu-id="3f475-113">One-click publishing of the Moodle app into your private Teams App Store.</span></span> <span data-ttu-id="3f475-114">(Ожидается в ближайшее время)</span><span class="sxs-lookup"><span data-stu-id="3f475-114">(Coming soon)</span></span>

<span data-ttu-id="3f475-115">Дополнительные сведения о функциональных возможностях, предоставляемых этой интеграцией, можно найти [здесь](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle).</span><span class="sxs-lookup"><span data-stu-id="3f475-115">To learn more about the functionality this integration provides, go [here](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="3f475-116">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="3f475-116">Prerequisites</span></span>

<span data-ttu-id="3f475-117">Чтобы установить и настроить это приложение, вам потребуется следующее:</span><span class="sxs-lookup"><span data-stu-id="3f475-117">In order to install and configure this application you'll need:</span></span>

1. <span data-ttu-id="3f475-118">Учетные данные администратора мудле</span><span class="sxs-lookup"><span data-stu-id="3f475-118">Moodle administrator credentials</span></span>
2. <span data-ttu-id="3f475-119">Учетные данные администратора Azure AD</span><span class="sxs-lookup"><span data-stu-id="3f475-119">Azure AD administrator credentials</span></span>
3. <span data-ttu-id="3f475-120">Подписка на Azure. Вы можете создавать новые ресурсы в</span><span class="sxs-lookup"><span data-stu-id="3f475-120">An Azure subscription you can create new resources in</span></span>

## <a name="step-1-install-the-office-365-moodle-plugin"></a><span data-ttu-id="3f475-121">Шаг 1: Установка подключаемого модуля Мудле для Office 365</span><span class="sxs-lookup"><span data-stu-id="3f475-121">Step 1: Install the Office 365 Moodle Plugin</span></span>

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

<span data-ttu-id="3f475-122">Интеграция Мудле в Microsoft Teams осуществляется с помощью [набора подключаемых модулей Office 365 мудле](https://github.com/Microsoft/o365-moodle)с открытым кодом.</span><span class="sxs-lookup"><span data-stu-id="3f475-122">The Moodle integration in Microsoft Teams is powered by the open source [Office 365 Moodle plugin set](https://github.com/Microsoft/o365-moodle).</span></span> <span data-ttu-id="3f475-123">Чтобы установить подключаемый модуль на сервере Мудле, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="3f475-123">To install the plugin in your Moodle server:</span></span>

1. <span data-ttu-id="3f475-124">Сначала скачайте [набор подключаемого модуля Office 365](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) и сохраните его на локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="3f475-124">First, download the [Office 365 plugin set](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) and save it to your local computer.</span></span> <span data-ttu-id="3f475-125">Вам потребуется использовать версию 3,5 или более новую.</span><span class="sxs-lookup"><span data-stu-id="3f475-125">You'll need to use version 3.5 or newer.</span></span>
    * <span data-ttu-id="3f475-126">При установке подключаемого модуля local_o365 также будут установлены подключаемые модули [auth_oidc](https://moodle.org/plugins/auth_oidc) и [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) .</span><span class="sxs-lookup"><span data-stu-id="3f475-126">Installing the local_o365 plugin will also install the [auth_oidc](https://moodle.org/plugins/auth_oidc) and [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) plugins.</span></span>
1. <span data-ttu-id="3f475-127">Войдите на сервер Мудле от имени администратора и выберите **Администрирование сайта** в левой панели навигации.</span><span class="sxs-lookup"><span data-stu-id="3f475-127">Login to your Moodle server as an administrator, and select **Site administration** from the left navigation panel.</span></span>
1. <span data-ttu-id="3f475-128">Перейдите на вкладку **подключаемые модули** и щелкните **установить подключаемые модули**.</span><span class="sxs-lookup"><span data-stu-id="3f475-128">Select the **Plugins** tab, and then click **Install plugins**.</span></span>
1. <span data-ttu-id="3f475-129">В разделе " **установить подключаемый модуль из ZIP-файла** " нажмите кнопку " **выбрать файл** ".</span><span class="sxs-lookup"><span data-stu-id="3f475-129">Under the **Install plugin from ZIP file** section click the **Choose a file** button.</span></span>
1. <span data-ttu-id="3f475-130">Нажмите кнопку **загрузить параметры файла** из левой панели навигации, найдите загруженный файл и нажмите **отправить этот файл**.</span><span class="sxs-lookup"><span data-stu-id="3f475-130">Select the **Upload a file** options from the left navigation, browse for the file you downloaded above and click **Upload this file**.</span></span>
1. <span data-ttu-id="3f475-131">Снова выберите пункт **Администрирование сайта** в левой панели навигации, чтобы вернуться на панель мониторинга администрирования.</span><span class="sxs-lookup"><span data-stu-id="3f475-131">Select the **Site administration** option from the left navigation panel again to return to your admin dashboard.</span></span> <span data-ttu-id="3f475-132">Прокрутите список до **локальных подключаемых модулей** и щелкните ссылку **интеграция Microsoft Office 365** .</span><span class="sxs-lookup"><span data-stu-id="3f475-132">Scroll down to the **Local plugins** and click the **Microsoft Office 365 Integration** link.</span></span> <span data-ttu-id="3f475-133">Оставьте эту страницу конфигурации открытой на отдельной вкладке браузера, так как она будет использоваться в оставшейся части этого процесса.</span><span class="sxs-lookup"><span data-stu-id="3f475-133">Keep this configuration page open in a separate browser tab as you'll be using it throughout the rest of this process.</span></span>

<span data-ttu-id="3f475-134">Дополнительные сведения о том, как установить подключаемые модули Мудле в документации по Мудле, можно найти в [документации по](https://docs.moodle.org/34/en/Installing_plugins).</span><span class="sxs-lookup"><span data-stu-id="3f475-134">You can find more information on how to install Moodle plugins in the [Moodle documentation](https://docs.moodle.org/34/en/Installing_plugins).</span></span>

<span data-ttu-id="3f475-135">**Важное замечание:** Откройте страницу Конфигурация подключаемого модуля Office 365 Мудле на отдельной вкладке браузера, после чего вы вернетесь к этому набору страниц во всем процессе.</span><span class="sxs-lookup"><span data-stu-id="3f475-135">**Important Note:** Keep your Office 365 Moodle Plugin configuration page open in a separate browser tab as you will be returning to this set of pages throughout this process.</span></span>

<span data-ttu-id="3f475-136">*У вас еще нет сайта Мудле?*</span><span class="sxs-lookup"><span data-stu-id="3f475-136">*Don't have a Moodle site already?*</span></span> <span data-ttu-id="3f475-137">Вы можете извлечь наш Мудле в [репозитории](https://github.com/azure/moodle) Azure, где можно быстро развернуть экземпляр Мудле в Azure и настроить его в соответствии со своими потребностями.</span><span class="sxs-lookup"><span data-stu-id="3f475-137">You might want to check out our Moodle on Azure [repo](https://github.com/azure/moodle) where you can quickly deploy a Moodle instance on Azure and customize it to your needs.</span></span>

## <a name="step-2-configure-the-connection-between-the-office-365-plugin-and-azure-active-directory"></a><span data-ttu-id="3f475-138">Шаг 2: Настройка подключения между подключаемым модулем Office 365 и Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="3f475-138">Step 2: Configure the connection between the Office 365 plugin and Azure Active Directory</span></span>

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

<span data-ttu-id="3f475-139">Далее вам потребуется зарегистрировать Мудле в качестве приложения в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3f475-139">Next you'll need to register Moodle as an application in your Azure Active Directory.</span></span> <span data-ttu-id="3f475-140">Мы предоставили скрипт PowerShell, который поможет вам выполнить этот процесс.</span><span class="sxs-lookup"><span data-stu-id="3f475-140">We've provided a PowerShell script to help you complete this process.</span></span> <span data-ttu-id="3f475-141">В сценарии PowerShell выполняется подготовка нового приложения Azure AD для клиента Office 365, которое будет использоваться подключаемым модулем Office 365 Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-141">The PowerShell Script provisions a new Azure AD application for your Office 365 tenant, which will be used by the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="3f475-142">Скрипт подготовит приложение для клиента O365, настроит все необходимые URL-адреса ответа и разрешения для подготовленного приложения и возвратит AppID и ключ.</span><span class="sxs-lookup"><span data-stu-id="3f475-142">The script will provision the app for your O365 tenant, set up all the required Reply URLs and Permissions for the provisioned app and return the AppID and Key.</span></span> <span data-ttu-id="3f475-143">Вы можете использовать созданные AppID и ключ на странице установки подключаемого модуля Office 365 Мудле, чтобы настроить сервер Мудле с помощью Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3f475-143">You can use the generated AppID and Key in your O365 Moodle Plugin Setup Page to configure your Moodle server with Azure AD.</span></span> <span data-ttu-id="3f475-144">Если вы хотите просмотреть подробные действия, выполняемые скриптом PowerShell для автоматизации, можно найти их в полной [документации для подключаемого модуля](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span><span class="sxs-lookup"><span data-stu-id="3f475-144">If you want to see the detailed manual steps that the PowerShell script is automating, you can find them in the full [documentation for the plugin](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span></span>

### <a name="moodle-tab-for-microsoft-teams-information-flow"></a><span data-ttu-id="3f475-145">Вкладка мудле для информационного процесса Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="3f475-145">Moodle tab for Microsoft Teams information flow</span></span>

<img width="530px" src="~/assets/images/MoodleTabInformationFlow.png" title="Вкладка мудле для информационного процесса Microsoft Teams" />

1. <span data-ttu-id="3f475-147">На странице подключаемый модуль интеграции Microsoft Office 365 выберите вкладку **Настройка** .</span><span class="sxs-lookup"><span data-stu-id="3f475-147">From the Microsoft Office 365 Integration plugin page select the **Setup** tab.</span></span>
1. <span data-ttu-id="3f475-148">Нажмите кнопку **скачать скрипт PowerShell** и сохраните ее на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="3f475-148">Click the **Download PowerShell Script** button and save it to your local computer.</span></span>
1. <span data-ttu-id="3f475-149">Вам потребуется подготовить скрипт PowerShell из ZIP-файла.</span><span class="sxs-lookup"><span data-stu-id="3f475-149">You'll need to prepare the PowerShell script from the ZIP file.</span></span> <span data-ttu-id="3f475-150">Для этого:</span><span class="sxs-lookup"><span data-stu-id="3f475-150">To do so:</span></span>
    * <span data-ttu-id="3f475-151">Скачайте и извлеките `Moodle-AzureAD-Powershell.zip` файл.</span><span class="sxs-lookup"><span data-stu-id="3f475-151">Download and extract the `Moodle-AzureAD-Powershell.zip` file.</span></span>
    * <span data-ttu-id="3f475-152">Откройте извлеченную папку.</span><span class="sxs-lookup"><span data-stu-id="3f475-152">Open the extracted folder.</span></span>
    * <span data-ttu-id="3f475-153">Щелкните `Moodle-AzureAD-Script.ps1` файл правой кнопкой мыши и выберите пункт **свойства**.</span><span class="sxs-lookup"><span data-stu-id="3f475-153">Right-click on the `Moodle-AzureAD-Script.ps1` file and select **Properties**.</span></span>
    * <span data-ttu-id="3f475-154">На вкладке **Общие** окна Свойства установите флажок `Unblock` рядом с атрибутом **Безопасность** в нижней части страницы.</span><span class="sxs-lookup"><span data-stu-id="3f475-154">Under the **General** tab of the Properties window, check the `Unblock` box next to the **Security** attribute at the bottom.</span></span>
    * <span data-ttu-id="3f475-155">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="3f475-155">Click **OK**.</span></span>
    * <span data-ttu-id="3f475-156">Скопируйте путь к извлеченной папке.</span><span class="sxs-lookup"><span data-stu-id="3f475-156">Copy the directory path of the extracted folder.</span></span>
1. <span data-ttu-id="3f475-157">Далее вы запустите PowerShell от имени администратора:</span><span class="sxs-lookup"><span data-stu-id="3f475-157">Next you'll run PowerShell as an administrator:</span></span>
    * <span data-ttu-id="3f475-158">Нажмите кнопку Начало.</span><span class="sxs-lookup"><span data-stu-id="3f475-158">Click Start.</span></span>
    * <span data-ttu-id="3f475-159">Введите PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3f475-159">Type PowerShell.</span></span>
    * <span data-ttu-id="3f475-160">Щелкните правой кнопкой мыши Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3f475-160">Right-click Windows PowerShell.</span></span>
    * <span data-ttu-id="3f475-161">Выберите пункт "Запуск от имени администратора".</span><span class="sxs-lookup"><span data-stu-id="3f475-161">Click "Run as Administrator".</span></span>
1. <span data-ttu-id="3f475-162">Перейдите к несжатому каталогу, `cd ...\...\Moodle-AzureAD-Powershell` указав `...\...` расположение пути к каталогу.</span><span class="sxs-lookup"><span data-stu-id="3f475-162">Navigate to the unzipped directory by typing `cd ...\...\Moodle-AzureAD-Powershell` where `...\...` is the path to the directory.</span></span>
1. <span data-ttu-id="3f475-163">Выполните скрипт PowerShell, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="3f475-163">Execute the PowerShell script by:</span></span>
    * <span data-ttu-id="3f475-164">Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span><span class="sxs-lookup"><span data-stu-id="3f475-164">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span></span>
    * <span data-ttu-id="3f475-165">Введите `.\Moodle-AzureAD-Script.ps1`.</span><span class="sxs-lookup"><span data-stu-id="3f475-165">Enter `.\Moodle-AzureAD-Script.ps1`.</span></span>
    * <span data-ttu-id="3f475-166">Войдите в учетную запись администратора Office 365 во всплывающем окне.</span><span class="sxs-lookup"><span data-stu-id="3f475-166">Login to your O365 Administrator account in the pop-up window.</span></span>
    * <span data-ttu-id="3f475-167">Введите имя приложения Azure AD (например,</span><span class="sxs-lookup"><span data-stu-id="3f475-167">Enter the name of the Azure AD Application (Ex.</span></span> <span data-ttu-id="3f475-168">Подключаемый модуль мудле/Мудле).</span><span class="sxs-lookup"><span data-stu-id="3f475-168">Moodle/Moodle plugin).</span></span>
    * <span data-ttu-id="3f475-169">Введите URL-адрес сервера Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-169">Enter the URL of your Moodle server.</span></span>
    * <span data-ttu-id="3f475-170">Скопируйте **идентификатор приложения** и **ключ приложения** , созданные сценарием, и сохраните их.</span><span class="sxs-lookup"><span data-stu-id="3f475-170">Copy the **Application ID** and **Application Key** generated by the script and save them.</span></span>
1. <span data-ttu-id="3f475-171">Затем необходимо добавить идентификатор и ключ в подключаемый модуль Office 365 Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-171">Next you'll need to add the Id and Key to the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="3f475-172">Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайтов > подключаемые модули > интеграция с Microsoft Office 365).</span><span class="sxs-lookup"><span data-stu-id="3f475-172">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration).</span></span>
1. <span data-ttu-id="3f475-173">На вкладке **Настройка** добавьте **идентификатор приложения** и **ключ приложения** , скопированные ранее, а затем нажмите кнопку **сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="3f475-173">On the **Setup** tab add the **Application Id** and **Application Key** you copied previously, then click **Save changes**.</span></span>
1. <span data-ttu-id="3f475-174">После обновления страницы должен отобразиться новый раздел **Выбор метода подключения**.</span><span class="sxs-lookup"><span data-stu-id="3f475-174">Once the page refreshes you should now see a new section **Choose connection method**.</span></span> <span data-ttu-id="3f475-175">Установите флажок " **по умолчанию** ", а затем снова нажмите кнопку **сохранить изменения** .</span><span class="sxs-lookup"><span data-stu-id="3f475-175">Click the checkbox labeled **Default** and then click **Save changes** again.</span></span>
1. <span data-ttu-id="3f475-176">После обновления страницы вы увидите еще один новый раздел **согласие администратора & дополнительные сведения**.</span><span class="sxs-lookup"><span data-stu-id="3f475-176">Once the page refreshes you will see another new section **Admin consent & additional information**.</span></span>
    * <span data-ttu-id="3f475-177">Щелкните ссылку **предоставить согласие администратора** , введите учетные данные глобального администратора Office3 365, а затем **примите** , чтобы предоставить разрешения.</span><span class="sxs-lookup"><span data-stu-id="3f475-177">Click the **Provide Admin Consent** link, enter your Office3 365 Global Administrator credentials, then **Accept** to grant the permissions.</span></span>
    * <span data-ttu-id="3f475-178">Рядом с полем **клиент Azure AD** нажмите кнопку **обнаружить** .</span><span class="sxs-lookup"><span data-stu-id="3f475-178">Next to the **Azure AD Tenant** field click the **Detect** button.</span></span>
    * <span data-ttu-id="3f475-179">Рядом с **URL-адресом OneDrive для бизнеса** нажмите кнопку " **обнаружить** ".</span><span class="sxs-lookup"><span data-stu-id="3f475-179">Next to the **OneDrive for Business URL** click the **Detect** button.</span></span>
    * <span data-ttu-id="3f475-180">После заполнения полей снова нажмите кнопку **сохранить изменения** .</span><span class="sxs-lookup"><span data-stu-id="3f475-180">Once the fields populate, click the **Save changes** button again.</span></span>
1. <span data-ttu-id="3f475-181">Нажмите кнопку **Обновить** , чтобы проверить установку, а затем **Сохраните изменения**.</span><span class="sxs-lookup"><span data-stu-id="3f475-181">Click the **Update** button to verify the installation, then **Save changes**.</span></span>
1. <span data-ttu-id="3f475-182">Затем необходимо синхронизировать пользователей между сервером Мудле и Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3f475-182">Next you'll need to synchronize users between your Moodle server and Azure Active Directory.</span></span> <span data-ttu-id="3f475-183">В зависимости от среды вы можете выбрать другие параметры на этом этапе.</span><span class="sxs-lookup"><span data-stu-id="3f475-183">Depending on your environment, you may select different options during this stage.</span></span> <span data-ttu-id="3f475-184">Обратите внимание, что указанная здесь конфигурация будет запускаться с каждым выполнением Мудле cron (как правило, раз в день), чтобы сохранить все в синхронизации. Чтобы приступить к работе:</span><span class="sxs-lookup"><span data-stu-id="3f475-184">Note that the configuration you set here will run with each Moodle cron run (typically once a day) to keep everything in sync. To get started:</span></span>
    * <span data-ttu-id="3f475-185">Переключение на **вкладку Параметры синхронизации**</span><span class="sxs-lookup"><span data-stu-id="3f475-185">Switch to the **Sync Settings tab**</span></span>
    * <span data-ttu-id="3f475-186">В разделе **синхронизация пользователей с Azure AD** установите флажки, применимые к среде.</span><span class="sxs-lookup"><span data-stu-id="3f475-186">In the **Sync users with Azure AD** section, select the checkboxes that apply to your environment.</span></span> <span data-ttu-id="3f475-187">Как правило, выбирается по крайней мере:</span><span class="sxs-lookup"><span data-stu-id="3f475-187">Typically you would select at least:</span></span>
        * <span data-ttu-id="3f475-188">Создание учетных записей в Мудле для пользователей в Azure AD</span><span class="sxs-lookup"><span data-stu-id="3f475-188">Create accounts in Moodle for users in Azure AD</span></span>
        * <span data-ttu-id="3f475-189">Обновление всех учетных записей в Мудле для пользователей в Azure AD</span><span class="sxs-lookup"><span data-stu-id="3f475-189">Update all accounts in Moodle for users in Azure AD</span></span>
    * <span data-ttu-id="3f475-190">В разделе **ограничение на создание пользователей** можно настроить фильтр для ограничения пользователей Azure AD, которые будут синхронизироваться с мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-190">In the **User Creation Restriction** section you can setup a filter to limit the Azure AD users that will by synced to Moodle.</span></span>
    * <span data-ttu-id="3f475-191">Раздел **сопоставления полей пользователя** позволяет настроить сопоставление полей профилей пользователей с Azure AD с мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-191">The **User Field Mapping** section will allow you to customize the Azure AD to Moodle User Profile field mapping.</span></span>
    * <span data-ttu-id="3f475-192">В разделе **Синхронизация Teams** можно выбрать автоматическое создание групп (например, Teams) для некоторых или всех существующих курсов мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-192">In the **Teams Sync** section you can choose to automatically create Groups (i.e. Teams) for some, or all, of your existing Moodle courses.</span></span>
1. <span data-ttu-id="3f475-193">Чтобы проверить задания cron (и запускать их вручную, если вы хотите выполнить первый запуск), щелкните ссылку **Страница "управление назначенными задачами** " в разделе **синхронизация пользователей с Azure AD** .</span><span class="sxs-lookup"><span data-stu-id="3f475-193">To validate the cron jobs (and run them manually if you wish to for the first run) click the **Scheduled tasks management page** link in the **Sync users with Azure AD** section.</span></span> <span data-ttu-id="3f475-194">Откроется страница " **Назначенные задания** ".</span><span class="sxs-lookup"><span data-stu-id="3f475-194">This will take you to the **Scheduled Tasks** page.</span></span>
    * <span data-ttu-id="3f475-195">Прокрутите список вниз и найдите **пользователей Синхронизация заданий с помощью задания Azure AD** , а затем нажмите кнопку **выполнить**.</span><span class="sxs-lookup"><span data-stu-id="3f475-195">Scroll down and find the job **Sync users with Azure AD** job and click **Run now**.</span></span>
    * <span data-ttu-id="3f475-196">Если вы решили создать группы на основе существующих курсов, вы также можете запустить задание **создать группы пользователей в Office 365** .</span><span class="sxs-lookup"><span data-stu-id="3f475-196">If you chose to create Groups based on existing courses, you can also run the **Create user groups in Office 365** job.</span></span>
1. <span data-ttu-id="3f475-197">Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайта > подключаемые модули > интеграция с Microsoft Office 365) и выберите страницу **Параметры Teams** .</span><span class="sxs-lookup"><span data-stu-id="3f475-197">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** page.</span></span> <span data-ttu-id="3f475-198">Необходимо настроить некоторые параметры безопасности, чтобы включить интеграцию приложений Teams.</span><span class="sxs-lookup"><span data-stu-id="3f475-198">You'll need to configure some security settings to enable the Teams app integration.</span></span>
    * <span data-ttu-id="3f475-199">Чтобы включить OpenID Connect, щелкните ссылку **Управление проверкой подлинности** и щелкните значок глаза на линии **OpenID Connect** , если он затенен.</span><span class="sxs-lookup"><span data-stu-id="3f475-199">To enable OpenID Connect, click the **Manage Authentication** link, and click the eye icon on the **OpenId Connect** line if it is greyed out.</span></span>
    * <span data-ttu-id="3f475-200">Затем необходимо включить встраивание фреймов.</span><span class="sxs-lookup"><span data-stu-id="3f475-200">Next you'll need to enable frame embedding.</span></span> <span data-ttu-id="3f475-201">Щелкните ссылку **Безопасность HTTP** , а затем установите флажок рядом с пунктом **разрешить встраивание кадров**.</span><span class="sxs-lookup"><span data-stu-id="3f475-201">Click the **HTTP Security** link, then click the checkbox next to **Allow frame embedding**.</span></span>
    * <span data-ttu-id="3f475-202">Следующий шаг — включение веб-служб, которые будут включать функции API Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-202">The next step is to enable web services which will enable the Moodle API features.</span></span> <span data-ttu-id="3f475-203">Щелкните ссылку **Дополнительные функции** , а затем убедитесь, что установлен флажок **включить веб-службы** .</span><span class="sxs-lookup"><span data-stu-id="3f475-203">Click the **Advanced Features** link, then make sure the checkbox next to **Enable web services** is checked.</span></span>
    * <span data-ttu-id="3f475-204">Наконец, вам потребуется включить внешние службы для Office 365.</span><span class="sxs-lookup"><span data-stu-id="3f475-204">Finally you'll need to enabled the external services for Office 365.</span></span> <span data-ttu-id="3f475-205">Щелкните ссылку **внешние службы** , а затем:</span><span class="sxs-lookup"><span data-stu-id="3f475-205">Click the **External services** link then:</span></span>
        * <span data-ttu-id="3f475-206">Нажмите кнопку **изменить** в строке **мудле Office 365 WebService** .</span><span class="sxs-lookup"><span data-stu-id="3f475-206">Click **Edit** on the **Moodle Office 365 Webservices** row.</span></span>
        * <span data-ttu-id="3f475-207">Установите флажок рядом с параметром **включено**, а затем нажмите кнопку **сохранить изменения**</span><span class="sxs-lookup"><span data-stu-id="3f475-207">Mark the checkbox next to **Enabled**, then click **Save Changes**</span></span>
    * <span data-ttu-id="3f475-208">Затем необходимо изменить разрешения пользователя, прошедшего проверку подлинности, чтобы разрешить им создавать токены веб-служб.</span><span class="sxs-lookup"><span data-stu-id="3f475-208">Next you'll need to edit your authenticated user permissions to allow them to create web service tokens.</span></span> <span data-ttu-id="3f475-209">Щелкните ссылку **"Пользователи, прошедшие проверку"** .</span><span class="sxs-lookup"><span data-stu-id="3f475-209">Click the **Editing role 'Authenticated user'** link.</span></span> <span data-ttu-id="3f475-210">Прокрутите список вниз и найдите функцию **создания маркера веб-службы** и установите флажок **Разрешить** .</span><span class="sxs-lookup"><span data-stu-id="3f475-210">Scroll down and find the **Create a web service token** capability and mark the **Allow** checkbox.</span></span>

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a><span data-ttu-id="3f475-211">Шаг 3: развертывание ленты помощника Мудле в Azure</span><span class="sxs-lookup"><span data-stu-id="3f475-211">Step 3: Deploy the Moodle Assistant Bot to Azure</span></span>

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

<span data-ttu-id="3f475-212">Бесплатный робот помощника по Мудле для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о курсах, назначениях, оценках и других сведениях в Мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-212">The free Moodle Assistant Bot for Microsoft Teams helps teachers and students answer questions about their courses, assignments, grades and other information in Moodle.</span></span> <span data-ttu-id="3f475-213">Bot также отправляет уведомления Мудле учащимся и преподавателям прямо в Teams.</span><span class="sxs-lookup"><span data-stu-id="3f475-213">The bot also sends Moodle notifications to students and teachers right within Teams.</span></span> <span data-ttu-id="3f475-214">Этот сервер — это проект с открытым кодом, поддерживаемый корпорацией Майкрософт, и [доступный на сайте GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span><span class="sxs-lookup"><span data-stu-id="3f475-214">This bot is an open source project maintained by Microsoft, and is [available on GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span></span>

> [!NOTE]
> <span data-ttu-id="3f475-215">В этом разделе ресурсы будут развернуты в вашей подписке Azure, а все ресурсы будут настроены с использованием **свободного** уровня.</span><span class="sxs-lookup"><span data-stu-id="3f475-215">In this section you will deploy resources to your Azure subscription, and all resources will be configured using the **free** tier.</span></span> <span data-ttu-id="3f475-216">В зависимости от использования ленты, возможно, потребуется масштабировать эти ресурсы.</span><span class="sxs-lookup"><span data-stu-id="3f475-216">Depending on the usage of your bot, you may need to scale these resources.</span></span>
> <span data-ttu-id="3f475-217">Если вы хотите просто использовать вкладку Мудле без Bot, перейдите к [шагу 4](#step-4-deploy-your-microsoft-teams-app).</span><span class="sxs-lookup"><span data-stu-id="3f475-217">If you want to just use the Moodle tab without the bot, skip to [step 4](#step-4-deploy-your-microsoft-teams-app).</span></span>

### <a name="moodle-bot-information-flow"></a><span data-ttu-id="3f475-218">Информационный процесс мудле для ленты</span><span class="sxs-lookup"><span data-stu-id="3f475-218">Moodle bot information flow</span></span>

<img width="530px" src="~/assets/images/MoodleBotInformationFlow.png" title="Мудле Bot для информационного процесса Microsoft Teams" />

<span data-ttu-id="3f475-220">Чтобы установить Bot, сначала необходимо зарегистрировать его на [платформе идентификации Майкрософт](https://identity.microsoft.com/Landing).</span><span class="sxs-lookup"><span data-stu-id="3f475-220">To install the bot, you'll first need to register it on the [Microsoft Identity Platform](https://identity.microsoft.com/Landing).</span></span> <span data-ttu-id="3f475-221">Это позволит вашему роботу выполнить проверку подлинности в конечных точках Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="3f475-221">This allows your Bot to authenticate against your Microsoft endpoints.</span></span> <span data-ttu-id="3f475-222">Чтобы зарегистрировать робота:</span><span class="sxs-lookup"><span data-stu-id="3f475-222">To register your bot:</span></span>

1. <span data-ttu-id="3f475-223">Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайта > подключаемые модули > интеграция с Microsoft Office 365) и перейдите на вкладку **Параметры Teams** .</span><span class="sxs-lookup"><span data-stu-id="3f475-223">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** tab.</span></span>
1. <span data-ttu-id="3f475-224">Щелкните ссылку **портал регистрации приложений (Майкрософт** ) и войдите с помощью идентификатора Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="3f475-224">Click the **Microsoft Application Registration Portal** link and login with your Microsoft Id.</span></span>
1. <span data-ttu-id="3f475-225">Введите имя приложения (например,</span><span class="sxs-lookup"><span data-stu-id="3f475-225">Enter a name for your app (Eg.</span></span> <span data-ttu-id="3f475-226">Мудлебот) и нажмите кнопку **Create (создать** ).</span><span class="sxs-lookup"><span data-stu-id="3f475-226">MoodleBot) and click the **Create** button.</span></span>
1. <span data-ttu-id="3f475-227">Скопируйте **идентификатор приложения** и вставьте его в поле **код приложения Bot** на странице **Параметры группы** .</span><span class="sxs-lookup"><span data-stu-id="3f475-227">Copy the **Application Id** and paste it into the **Bot Application ID** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="3f475-228">Нажмите кнопку **создать новый пароль** .</span><span class="sxs-lookup"><span data-stu-id="3f475-228">Click the **Generate New Password** button.</span></span> <span data-ttu-id="3f475-229">Скопируйте созданный пароль и вставьте его в поле **пароль приложения Bot** на странице **Параметры группы** .</span><span class="sxs-lookup"><span data-stu-id="3f475-229">Copy the generated password and and paste it into the **Bot Application Password** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="3f475-230">Прокрутите форму вниз и нажмите кнопку **сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="3f475-230">Scroll to the bottom of the form and click **Save Changes**.</span></span>

<span data-ttu-id="3f475-231">Теперь, когда вы создали идентификатор и пароль приложения, настало время выполнить развертывание ленты в Azure.</span><span class="sxs-lookup"><span data-stu-id="3f475-231">Now that you've generated your Application Id and Password, it's time to deploy your bot to Azure.</span></span> <span data-ttu-id="3f475-232">Нажмите кнопку **развернуть в Azure** и заполните форму, указав необходимые сведения (идентификатор приложения Bot, робота и секрета мудле на странице **Параметры группы** , а сведения об Azure — на странице **Настройка** ).</span><span class="sxs-lookup"><span data-stu-id="3f475-232">Click on the **Deploy to Azure** button and fill out the form with the necessary information (the Bot Application Id, Bot Application Password and the Moodle Secret are on the **Team Settings** page, and the Azure information is on the **Setup** page).</span></span> <span data-ttu-id="3f475-233">После заполнения формы установите флажок, чтобы принять условия и условия, а затем нажмите кнопку **Покупка** (все ресурсы Azure развернуты на свободном уровне).</span><span class="sxs-lookup"><span data-stu-id="3f475-233">Once you've got the form filled out, click the check box to agree to the terms and conditions then click the **Purchase** button (all Azure resources are deployed to the free tier).</span></span>

<span data-ttu-id="3f475-234">После завершения развертывания ресурсов в Azure вам потребуется настроить подключаемый модуль Office 365 Мудле с конечной точкой обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="3f475-234">Once the resources are finished deploying to Azure, you'll need to configure the Office 365 Moodle plugin with it's messaging endpoint.</span></span> <span data-ttu-id="3f475-235">Для начала вам потребуется получить конечную точку из ленты в Azure.</span><span class="sxs-lookup"><span data-stu-id="3f475-235">First, you'll need to get the endpoint from you Bot in Azure.</span></span> <span data-ttu-id="3f475-236">Для этого выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="3f475-236">To do that:</span></span>

1. <span data-ttu-id="3f475-237">Если вы еще не сделали это, войдите на [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="3f475-237">If you aren't already, log into the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="3f475-238">В левой области выберите пункт **группы ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="3f475-238">In the left pane select **Resource groups**.</span></span>
3. <span data-ttu-id="3f475-239">В списке выберите группу ресурсов, которую вы только что использовали (или создали) при развертывании Bot.</span><span class="sxs-lookup"><span data-stu-id="3f475-239">From the list select the resource group you just used (or created) while deploying your Bot.</span></span>
4. <span data-ttu-id="3f475-240">Выберите ресурс **webapp Bot** в списке ресурсов в группе.</span><span class="sxs-lookup"><span data-stu-id="3f475-240">Select the **WebApp Bot** resource from the list of resources in the group.</span></span>
5. <span data-ttu-id="3f475-241">Скопируйте **конечную точку обмена сообщениями** из раздела **Обзор** .</span><span class="sxs-lookup"><span data-stu-id="3f475-241">Copy the **Messaging Endpoint** from the **Overview** section.</span></span>
6. <span data-ttu-id="3f475-242">В Мудле откройте страницу **Параметры группы** в подключаемом модуле Office 365 мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-242">In Moodle, open the **Team Settings** page of your Office 365 Moodle Plugin.</span></span>
7. <span data-ttu-id="3f475-243">В поле **Конечная точка Bot** вставьте только что скопированный URL-адрес и измените *сообщения* Word на *веб-перехватчик*.</span><span class="sxs-lookup"><span data-stu-id="3f475-243">In the **Bot Endpoint** field paste the URL you just copied and change the word *messages* to *webhook*.</span></span> <span data-ttu-id="3f475-244">Теперь URL-адрес должен выглядеть так, как показано ниже.`https://botname.azurewebsites.net/api/webhook`</span><span class="sxs-lookup"><span data-stu-id="3f475-244">The URL should now look like `https://botname.azurewebsites.net/api/webhook`</span></span>
8. <span data-ttu-id="3f475-245">Нажмите кнопку **сохранить изменения**</span><span class="sxs-lookup"><span data-stu-id="3f475-245">Click **Save Changes**</span></span>
9. <span data-ttu-id="3f475-246">После сохранения изменений вернитесь на вкладку **Параметры группы** , нажмите кнопку **загрузить файл манифеста** и сохраните пакет манифеста на компьютере (вы будете использовать его в следующем разделе).</span><span class="sxs-lookup"><span data-stu-id="3f475-246">Once your changes have saved, go back to the **Team Settings** tab, click the **Download manifest file** button and save the manifest package to your computer (you'll use it in the next section).</span></span>

## <a name="step-4-deploy-your-microsoft-teams-app"></a><span data-ttu-id="3f475-247">Шаг 4: развертывание приложения Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="3f475-247">Step 4: Deploy your Microsoft Teams app</span></span>

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

<span data-ttu-id="3f475-248">Теперь, когда ваш Bot развернут в Azure и настроен для общения с сервером Мудле, необходимо развернуть приложение Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="3f475-248">Now that you have your Bot deployed to Azure and configured to talk to your Moodle server, it's time to deploy your Microsoft Teams app.</span></span> <span data-ttu-id="3f475-249">Для этого загрузите загруженный файл манифеста со страницы "Параметры группы подключаемого модуля Office 365 Мудле" на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="3f475-249">To do this you'll load the manifest file you downloaded from the Office 365 Moodle Plugin Team Settings page in the previous step.</span></span>

<span data-ttu-id="3f475-250">Перед установкой приложения необходимо убедиться, что включены внешние приложения и отправка приложений.</span><span class="sxs-lookup"><span data-stu-id="3f475-250">Before you can install the app you'll need to make sure external apps and uploading of apps is enabled.</span></span> <span data-ttu-id="3f475-251">Для этого можно выполнить указанные ниже [действия](https://docs.microsoft.com/microsoftteams/platform/get-started/get-started-tenant).</span><span class="sxs-lookup"><span data-stu-id="3f475-251">To do so you can follow [these steps](https://docs.microsoft.com/microsoftteams/platform/get-started/get-started-tenant).</span></span> <span data-ttu-id="3f475-252">Убедившись, что внешние приложения включены, вы можете выполнить указанные ниже действия, чтобы развернуть приложение.</span><span class="sxs-lookup"><span data-stu-id="3f475-252">Once you've ensured that external apps are enabled, you can follow the steps below to deploy your app.</span></span>

1. <span data-ttu-id="3f475-253">Откройте Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="3f475-253">Open Microsoft Teams.</span></span>
2. <span data-ttu-id="3f475-254">Щелкните значок **магазин** в нижней левой части панели навигации.</span><span class="sxs-lookup"><span data-stu-id="3f475-254">Click the **Store** icon on the lower-left of the navigation bar.</span></span>
3. <span data-ttu-id="3f475-255">Щелкните ссылку **Отправить настраиваемое приложение** из списка вариантов.</span><span class="sxs-lookup"><span data-stu-id="3f475-255">Click the **Upload a custom app** link from the list of options.</span></span> <span data-ttu-id="3f475-256">*Примечание:* Если вы выполнили вход в систему как Глобальное администрирование, вы сможете загрузить приложение в магазин приложений вашей организации, иначе вы сможете загрузить приложение только для той группы, в которой вы являетесь участником.</span><span class="sxs-lookup"><span data-stu-id="3f475-256">*Note:* If you're logged in as a global administer you'll have the option of uploading the app to your organization's app store, otherwise you'll only be able to load the app for a team of which you are a member.</span></span>
4. <span data-ttu-id="3f475-257">Выберите скачанный ранее `manifest.zip` пакет и нажмите кнопку **сохранить**.</span><span class="sxs-lookup"><span data-stu-id="3f475-257">Select the `manifest.zip` package you downloaded previously and click **Save**.</span></span> <span data-ttu-id="3f475-258">Если вы еще не скачали пакет манифеста, это можно сделать на вкладке **Параметры команды** на странице конфигурирование подключаемого модуля в мудле.</span><span class="sxs-lookup"><span data-stu-id="3f475-258">If you haven't yet downloaded the manifest package, you can do so from the **Team Settings** tab of the plugin configuration page in Moodle.</span></span>

<span data-ttu-id="3f475-259">Теперь, когда у вас установлено приложение, вы можете добавить вкладку в любой канал, к которому у вас есть доступ.</span><span class="sxs-lookup"><span data-stu-id="3f475-259">Now that you have the app installed you can add the tab to any channel that you have access to.</span></span> <span data-ttu-id="3f475-260">Для этого перейдите к каналу, щелкните **+** символ и выберите приложение из списка.</span><span class="sxs-lookup"><span data-stu-id="3f475-260">To do so navigate to the channel, click the **+** symbol and select your app from the list.</span></span> <span data-ttu-id="3f475-261">Следуйте инструкциям, чтобы завершить добавление вкладки курса Мудле в канал.</span><span class="sxs-lookup"><span data-stu-id="3f475-261">Follow the prompts to finish adding your Moodle course tab to a channel.</span></span>

<span data-ttu-id="3f475-262">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="3f475-262">That's it!</span></span> <span data-ttu-id="3f475-263">Теперь вы и ваша группа могут начать работу с курсами Мудле прямо из Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="3f475-263">You and your team, can now start working with your Moodle courses directly from Microsoft Teams.</span></span>

<span data-ttu-id="3f475-264">Чтобы поделиться своими запросами или отзывами, посетите [страницу голосовой связи пользователя](https://microsoftteams.uservoice.com/forums/916759-moodle).</span><span class="sxs-lookup"><span data-stu-id="3f475-264">To share any feature requests or feedback with us, please visit our [User Voice page](https://microsoftteams.uservoice.com/forums/916759-moodle).</span></span>
