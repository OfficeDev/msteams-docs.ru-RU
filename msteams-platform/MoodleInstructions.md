---
title: Установка интеграции Мудле с Microsoft Teams
description: Установка и настройка приложения интеграции Мудле для Microsoft Teams
keywords: Подключаемый модуль интеграции приложений Teams Мудле
ms.date: 01/31/2019
ms.openlocfilehash: 2b48cfb0bbef9a531e69ae5620c11a8258acdc64
ms.sourcegitcommit: 058b7bbd817af5f513e0e018f2ef562dc3086a84
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "43120299"
---
# <a name="installing-the-moodle-integration-with-microsoft-teams"></a>Установка интеграции Мудле с Microsoft Teams

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

[Мудле](https://moodle.org/), самая популярная и открытая система управления обучением (СУО) в мире теперь интегрирована с Microsoft Teams! Эта интеграция помогает преподавателям и преподавателям совместно работать над курсами Мудле, задавать вопросы о своих оценках и назначениях, а также обновлять уведомления — прямо в Teams!

Чтобы администраторы могли легко настроить эту интеграцию, мы обновили подключаемый модуль Мудле для Office 365 с открытым кодом, используя следующие возможности:

* Автоматическая регистрация сервера Мудле с помощью Azure AD.
* Одним щелчком мыши развернуть робота помощника по Мудле в Azure.
* Автоматическая подготовка групп и автоматическая синхронизация регистраций групп для всех или выбора курсов Мудле.
* Автоматическая установка вкладок Мудле и помощника Мудле в каждую синхронизированную команду. (ожидается в ближайшее время).
* Публикация приложения Мудле одним щелчком мыши в вашем хранилище приложений для частных рабочих групп. (ожидается в ближайшее время).

Дополнительные сведения о функциональных возможностях, предоставляемых этой интеграцией, можно найти [здесь](https://education.microsoft.com/resource/3dffb3a8).

## <a name="prerequisites"></a>Предварительные условия

Чтобы установить и настроить это приложение, вам потребуется следующее:

1. Учетные данные администратора мудле
2. Учетные данные администратора Azure AD
3. Подписка на Azure. Вы можете создавать новые ресурсы в

## <a name="step-1-install-the-office-365-moodle-plugin"></a>Шаг 1: Установка подключаемого модуля Мудле для Office 365

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

Интеграция Мудле в Microsoft Teams осуществляется с помощью [набора подключаемых модулей Office 365 мудле](https://github.com/Microsoft/o365-moodle)с открытым кодом. Чтобы установить подключаемый модуль на сервере Мудле, выполните указанные ниже действия.

1. Сначала скачайте [набор подключаемого модуля Office 365](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) и сохраните его на локальный компьютер. Вам потребуется использовать версию 3,5 или более новую.
    * При установке подключаемого модуля local_o365 также будут установлены подключаемые модули [auth_oidc](https://moodle.org/plugins/auth_oidc) и [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) .
1. Войдите на сервер Мудле от имени администратора и выберите **Администрирование сайта** в левой панели навигации.
1. Перейдите на вкладку **подключаемые модули** и щелкните **установить подключаемые модули**.
1. В разделе " **установить подключаемый модуль из ZIP-файла** " нажмите кнопку " **выбрать файл** ".
1. Нажмите кнопку **загрузить параметры файла** из левой панели навигации, найдите загруженный файл и нажмите **отправить этот файл**.
1. Снова выберите пункт **Администрирование сайта** в левой панели навигации, чтобы вернуться на панель мониторинга администрирования. Прокрутите список до **локальных подключаемых модулей** и щелкните ссылку **интеграция Microsoft Office 365** . Оставьте эту страницу конфигурации открытой на отдельной вкладке браузера, так как она будет использоваться в оставшейся части этого процесса.

Дополнительные сведения о том, как установить подключаемые модули Мудле в документации по Мудле, можно найти в [документации по](https://docs.moodle.org/34/en/Installing_plugins).

**Важное замечание:** Откройте страницу Конфигурация подключаемого модуля Office 365 Мудле на отдельной вкладке браузера, после чего вы вернетесь к этому набору страниц во всем процессе.

*У вас еще нет сайта Мудле?* Вы можете извлечь наш Мудле в [репозитории](https://github.com/azure/moodle) Azure, где можно быстро развернуть экземпляр Мудле в Azure и настроить его в соответствии со своими потребностями.

## <a name="step-2-configure-the-connection-between-the-office-365-plugin-and-azure-active-directory"></a>Шаг 2: Настройка подключения между подключаемым модулем Office 365 и Azure Active Directory

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

Далее вам потребуется зарегистрировать Мудле в качестве приложения в Azure Active Directory. Мы предоставили скрипт PowerShell, который поможет вам выполнить этот процесс. В сценарии PowerShell выполняется подготовка нового приложения Azure AD для клиента Office 365, которое будет использоваться подключаемым модулем Office 365 Мудле. Скрипт подготовит приложение для клиента O365, настроит все необходимые URL-адреса ответа и разрешения для подготовленного приложения и возвратит AppID и ключ. Вы можете использовать созданные AppID и ключ на странице установки подключаемого модуля Office 365 Мудле, чтобы настроить сервер Мудле с помощью Azure AD. Если вы хотите просмотреть подробные действия, выполняемые скриптом PowerShell для автоматизации, можно найти их в полной [документации для подключаемого модуля](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).

### <a name="moodle-tab-for-microsoft-teams-information-flow"></a>Вкладка мудле для информационного процесса Microsoft Teams

<img width="530px" src="~/assets/images/MoodleTabInformationFlow.png" title="Вкладка мудле для информационного процесса Microsoft Teams" />

1. На странице подключаемый модуль интеграции Microsoft Office 365 выберите вкладку **Настройка** .
1. Нажмите кнопку **скачать скрипт PowerShell** и сохраните ее на локальном компьютере.
1. Вам потребуется подготовить скрипт PowerShell из ZIP-файла. Для этого:
    * Скачайте и извлеките `Moodle-AzureAD-Powershell.zip` файл.
    * Откройте извлеченную папку.
    * Щелкните `Moodle-AzureAD-Script.ps1` файл правой кнопкой мыши и выберите пункт **свойства**.
    * На вкладке **Общие** окна Свойства установите флажок `Unblock` рядом с атрибутом **Безопасность** в нижней части страницы.
    * Нажмите кнопку **ОК**.
    * Скопируйте путь к извлеченной папке.
1. Далее вы запустите PowerShell от имени администратора:
    * Нажмите кнопку Начало.
    * Введите PowerShell.
    * Щелкните правой кнопкой мыши Windows PowerShell.
    * Выберите пункт "Запуск от имени администратора".
1. Перейдите к несжатому каталогу, `cd ...\...\Moodle-AzureAD-Powershell` указав `...\...` расположение пути к каталогу.
1. Выполните скрипт PowerShell, выполнив следующие действия:
    * Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.
    * Введите `.\Moodle-AzureAD-Script.ps1`.
    * Войдите в учетную запись администратора Office 365 во всплывающем окне.
    * Введите имя приложения Azure AD (например, Подключаемый модуль мудле/Мудле).
    * Введите URL-адрес сервера Мудле.
    * Скопируйте **идентификатор приложения** и **ключ приложения** , созданные сценарием, и сохраните их.
1. Затем необходимо добавить идентификатор и ключ в подключаемый модуль Office 365 Мудле. Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайтов > подключаемые модули > интеграция с Microsoft Office 365).
1. На вкладке **Настройка** добавьте **идентификатор приложения** и **ключ приложения** , скопированные ранее, а затем нажмите кнопку **сохранить изменения**.
1. После обновления страницы должен отобразиться новый раздел **Выбор метода подключения**. Установите флажок " **по умолчанию** ", а затем снова нажмите кнопку **сохранить изменения** .
1. После обновления страницы вы увидите еще один новый раздел **согласие администратора & дополнительные сведения**.
    * Щелкните ссылку **предоставить согласие администратора** , введите учетные данные глобального администратора Office3 365, а затем **примите** , чтобы предоставить разрешения.
    * Рядом с полем **клиент Azure AD** нажмите кнопку **обнаружить** .
    * Рядом с **URL-адресом OneDrive для бизнеса** нажмите кнопку " **обнаружить** ".
    * После заполнения полей снова нажмите кнопку **сохранить изменения** .
1. Нажмите кнопку **Обновить** , чтобы проверить установку, а затем **Сохраните изменения**.
1. Затем необходимо синхронизировать пользователей между сервером Мудле и Azure Active Directory. В зависимости от среды вы можете выбрать другие параметры на этом этапе. Обратите внимание, что указанная здесь конфигурация будет запускаться с каждым выполнением Мудле cron (как правило, раз в день), чтобы сохранить все в синхронизации. Чтобы приступить к работе:
    * Переключение на **вкладку Параметры синхронизации**
    * В разделе **синхронизация пользователей с Azure AD** установите флажки, применимые к среде. Как правило, выбирается по крайней мере:
        * Создание учетных записей в Мудле для пользователей в Azure AD
        * Обновление всех учетных записей в Мудле для пользователей в Azure AD
    * В разделе **ограничение на создание пользователей** можно настроить фильтр для ограничения пользователей Azure AD, которые будут синхронизироваться с мудле.
    * Раздел **сопоставления полей пользователя** позволяет настроить сопоставление полей профилей пользователей с Azure AD с мудле.
    * В разделе **Синхронизация Teams** можно выбрать автоматическое создание групп (например, Teams) для некоторых или всех существующих курсов мудле.
1. Чтобы проверить задания cron (и запускать их вручную, если вы хотите выполнить первый запуск), щелкните ссылку **Страница "управление назначенными задачами** " в разделе **синхронизация пользователей с Azure AD** . Откроется страница " **Назначенные задания** ".
    * Прокрутите список вниз и найдите **пользователей Синхронизация заданий с помощью задания Azure AD** , а затем нажмите кнопку **выполнить**.
    * Если вы решили создать группы на основе существующих курсов, вы также можете запустить задание **создать группы пользователей в Office 365** .
1. Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайта > подключаемые модули > интеграция с Microsoft Office 365) и выберите страницу **Параметры Teams** . Необходимо настроить некоторые параметры безопасности, чтобы включить интеграцию приложений Teams.
    * Чтобы включить OpenID Connect, щелкните ссылку **Управление проверкой подлинности** и щелкните значок глаза на линии **OpenID Connect** , если он затенен.
    * Затем необходимо включить встраивание фреймов. Щелкните ссылку **Безопасность HTTP** , а затем установите флажок рядом с пунктом **разрешить встраивание кадров**.
    * Следующий шаг — включение веб-служб, которые будут включать функции API Мудле. Щелкните ссылку **Дополнительные функции** , а затем убедитесь, что установлен флажок **включить веб-службы** .
    * Наконец, вам потребуется включить внешние службы для Office 365. Щелкните ссылку **внешние службы** , а затем:
        * Нажмите кнопку **изменить** в строке **мудле Office 365 WebService** .
        * Установите флажок рядом с параметром **включено**, а затем нажмите кнопку **сохранить изменения**
    * Затем необходимо изменить разрешения пользователя, прошедшего проверку подлинности, чтобы разрешить им создавать токены веб-служб. Щелкните ссылку **"Пользователи, прошедшие проверку"** . Прокрутите список вниз и найдите функцию **создания маркера веб-службы** и установите флажок **Разрешить** .

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a>Шаг 3: развертывание ленты помощника Мудле в Azure

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

Бесплатный робот помощника по Мудле для Microsoft Teams помогает преподавателям и учащимся отвечать на вопросы о курсах, назначениях, оценках и других сведениях в Мудле. Bot также отправляет уведомления Мудле учащимся и преподавателям прямо в Teams. Этот сервер — это проект с открытым кодом, поддерживаемый корпорацией Майкрософт, и [доступный на сайте GitHub](https://github.com/microsoft/Moodle-Teams-Bot).

> [!NOTE]
> В этом разделе ресурсы будут развернуты в вашей подписке Azure, а все ресурсы будут настроены с использованием **свободного** уровня. В зависимости от использования ленты, возможно, потребуется масштабировать эти ресурсы.
> Если вы хотите просто использовать вкладку Мудле без Bot, перейдите к [шагу 4](#step-4-deploy-your-microsoft-teams-app).

### <a name="moodle-bot-information-flow"></a>Информационный процесс мудле для ленты

<img width="530px" src="~/assets/images/MoodleBotInformationFlow.png" title="Мудле Bot для информационного процесса Microsoft Teams" />

Чтобы установить Bot, сначала необходимо зарегистрировать его на [платформе идентификации Майкрософт](https://identity.microsoft.com/Landing). Это позволит вашему роботу выполнить проверку подлинности в конечных точках Майкрософт. Чтобы зарегистрировать робота:

1. Вернитесь на страницу администрирования подключаемого модуля (Администрирование сайта > подключаемые модули > интеграция с Microsoft Office 365) и перейдите на вкладку **Параметры Teams** .
1. Щелкните ссылку **портал регистрации приложений (Майкрософт** ) и войдите с помощью идентификатора Майкрософт.
1. Введите имя приложения (например, Мудлебот) и нажмите кнопку **Create (создать** ).
1. Скопируйте **идентификатор приложения** и вставьте его в поле **код приложения Bot** на странице **Параметры группы** .
1. Нажмите кнопку **создать новый пароль** . Скопируйте созданный пароль и вставьте его в поле **пароль приложения Bot** на странице **Параметры группы** .
1. Прокрутите форму вниз и нажмите кнопку **сохранить изменения**.

Теперь, когда вы создали идентификатор и пароль приложения, настало время выполнить развертывание ленты в Azure. Нажмите кнопку **развернуть в Azure** и заполните форму, указав необходимые сведения (идентификатор приложения Bot, робота и секрета мудле на странице **Параметры группы** , а сведения об Azure — на странице **Настройка** ). После заполнения формы установите флажок, чтобы принять условия и условия, а затем нажмите кнопку **Покупка** (все ресурсы Azure развернуты на свободном уровне).

После завершения развертывания ресурсов в Azure вам потребуется настроить подключаемый модуль Office 365 Мудле с конечной точкой обмена сообщениями. Для начала вам потребуется получить конечную точку из ленты в Azure. Для этого выполните следующие действия.

1. Если вы еще не сделали это, войдите на [портал Azure](https://portal.azure.com).
2. В левой области выберите пункт **группы ресурсов**.
3. В списке выберите группу ресурсов, которую вы только что использовали (или создали) при развертывании Bot.
4. Выберите ресурс **webapp Bot** в списке ресурсов в группе.
5. Скопируйте **конечную точку обмена сообщениями** из раздела **Обзор** .
6. В Мудле откройте страницу **Параметры группы** в подключаемом модуле Office 365 мудле.
7. В поле **Конечная точка Bot** вставьте только что скопированный URL-адрес и измените *сообщения* Word на *веб-перехватчик*. Теперь URL-адрес должен выглядеть так, как показано ниже.`https://botname.azurewebsites.net/api/webhook`
8. Нажмите кнопку **сохранить изменения**
9. После сохранения изменений вернитесь на вкладку **Параметры группы** , нажмите кнопку **загрузить файл манифеста** и сохраните пакет манифеста на компьютере (вы будете использовать его в следующем разделе).

## <a name="step-4-deploy-your-microsoft-teams-app"></a>Шаг 4: развертывание приложения Microsoft Teams

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

Теперь, когда ваш Bot развернут в Azure и настроен для общения с сервером Мудле, необходимо развернуть приложение Microsoft Teams. Для этого загрузите загруженный файл манифеста со страницы "Параметры группы подключаемого модуля Office 365 Мудле" на предыдущем шаге.

Перед установкой приложения необходимо убедиться, что включены внешние приложения и отправка приложений. Для этого можно выполнить указанные ниже [действия](https://docs.microsoft.com/microsoftteams/platform/get-started/get-started-tenant). Убедившись, что внешние приложения включены, вы можете выполнить указанные ниже действия, чтобы развернуть приложение.

1. Откройте Microsoft Teams.
2. Щелкните значок **магазин** в нижней левой части панели навигации.
3. Щелкните ссылку **Отправить настраиваемое приложение** из списка вариантов. *Примечание:* Если вы выполнили вход в систему как Глобальное администрирование, вы сможете загрузить приложение в магазин приложений вашей организации, иначе вы сможете загрузить приложение только для той группы, в которой вы являетесь участником.
4. Выберите скачанный ранее `manifest.zip` пакет и нажмите кнопку **сохранить**. Если вы еще не скачали пакет манифеста, это можно сделать на вкладке **Параметры команды** на странице конфигурирование подключаемого модуля в мудле.

Теперь, когда у вас установлено приложение, вы можете добавить вкладку в любой канал, к которому у вас есть доступ. Для этого перейдите к каналу, щелкните **+** символ и выберите приложение из списка. Следуйте инструкциям, чтобы завершить добавление вкладки курса Мудле в канал.

Вот и все! Теперь вы и ваша группа могут начать работу с курсами Мудле прямо из Microsoft Teams.

Чтобы поделиться своими запросами или отзывами, посетите [страницу голосовой связи пользователя](https://microsoftteams.uservoice.com/forums/916759-moodle).
