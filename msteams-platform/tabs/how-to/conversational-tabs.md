---
title: Создание вкладок бесед
author: surbhigupta
description: Узнайте, как создать чат вложенной сущности беседы для вкладок канала, чтобы управлять беседами с помощью примеров кода
keywords: Настраиваемый канал вкладок teams
ms.topic: conceptual
ms.author: lomeybur
ms.localizationpriority: medium
ms.openlocfilehash: ddf14d9d7dabe5b20cc21181783dc5c33f29eff9
ms.sourcegitcommit: f15bd0e90eafb00e00cf11183b129038de8354af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2022
ms.locfileid: "65111656"
---
# <a name="create-conversational-tabs"></a>Создание вкладок бесед

Подсущности беседы позволяют пользователям беседы о вложенности на вкладке. Например, конкретная задача, пациент и возможность продажи вместо обсуждения всей вкладки, также известной как сущность. Традиционный канал или настраиваемая вкладка позволяет пользователю иметь беседу о вкладке, но пользователю требуется более усортная беседа. Требование к более подробной беседе может возникнуть либо при наличии слишком содержимого для централизованного обсуждения, либо из-за изменения содержимого с течением времени, делая беседу нерелевантной к отображаемому содержимому. Вложенность бесед обеспечивает гораздо более уделяемое внимание диалогу для динамических вкладок.

Подсущности бесед поддерживаются только в каналах. Их можно использовать на личной или статической вкладке для создания или продолжения бесед на вкладке, уже закрепленной на канале. Статическая вкладка полезна, если вы хотите предоставить пользователю одно расположение для просмотра бесед, происходящих по нескольким каналам, и доступа к ним.

## <a name="prerequisites"></a>Предварительные условия

Для поддержки подсущностей бесед ↔ веб-приложение вкладки должно иметь возможность хранить сопоставление между беседами вложенных элементов в серверной базе данных. Он `conversationId` предоставляется, но его `conversationId` необходимо сохранить и вернуть в Teams, чтобы пользователи могли продолжить беседу.

## <a name="start-a-new-conversation"></a>Начать новую беседу

Чтобы начать новую беседу, используйте функцию `openConversation()` . Запуск и продолжение беседы обрабатываются этим методом. Входные данные функции изменяются в зависимости от того, какое действие вы хотите выполнить, с точки зрения пользователя, при этом открывается панель беседы справа от экрана, чтобы начать беседу или продолжить беседу.

``` javascript
microsoftTeams.conversations.openConversation(openConversationRequest);
```

**OpenConversation** принимает следующие входные данные для начала беседы в канале:

* **subEntityId**: идентификатор конкретной подущностей. Например, задача 123.
* **entityId**: идентификатор экземпляра вкладки при его создании. Идентификатор очень важен для ссылки на тот же экземпляр вкладки.
* **channelId**: канал, в котором находится экземпляр вкладки.
   > [!NOTE]
   > Идентификатор **channelId** является необязательным для вкладок канала. Однако рекомендуется сохранить реализацию в каналах и на статических вкладах одинаково.
* **title**: заголовок, отображаемый пользователю на панели чата.

Большинство из этих значений также можно получить из `getContext` API.

```javascript
microsoftTeams.conversations.openConversation({“subEntityId”:”task-1”, “entityId”: “tabInstanceId-1”, “channelId”: ”19:baa6e71f65b948d189bf5c892baa8e5a@thread.skype”, “title”: "Task Title”});
```

На следующем рисунке показана панель беседы:

![Вложенные сущности беседы — начало беседы](~/assets/images/tabs/conversational-subentities/start-conversation.png)

Если пользователь начинает беседу, важно прослушать обратный вызов этого события, чтобы получить и сохранить **conversationId**:

```javascript
microsoftTeams.conversations.onStartConversation = (conversationResponse) => {
    // console.log(conversationReponse.conversationId)
};
```

Объект `conversationResponse` содержит сведения, связанные с запущенным диалогом. Рекомендуется сохранить все свойства этого объекта ответа для последующего использования.

## <a name="continue-a-conversation"></a>Продолжение беседы

После начала беседы последующие `openConversation()` вызовы требуются, что вы также предоставляете те же входные данные, что и при запуске новой беседы [, но](#start-a-new-conversation) также **включаете conversationId**. Откроется панель беседы для пользователей с соответствующей беседой в представлении. Пользователи могут видеть новые или входящие сообщения в режиме реального времени.

На следующем рисунке показана панель беседы с соответствующей беседой:

![Вложенные сущности беседы — продолжение беседы](~/assets/images/tabs/conversational-subentities/continue-conversation.png)

## <a name="enhance-a-conversation"></a>Улучшение беседы

Важно, чтобы вкладка отображала [глубокие ссылки на вашу подсущную сущность](~/concepts/build-and-test/deep-links.md). Например, пользователь выбирает прямую ссылку на вкладку из беседы канала. Ожидаемое поведение — получить прямую ссылку, открыть эту подсущную сущность, а затем открыть панель беседы для этой подущности.

Для поддержки подсущностей беседы с личной или статической вкладки вам не нужно ничего менять в реализации. Мы поддерживаем только начало или продолжение бесед с уже закрепленных вкладок каналов. Поддержка статических вкладок позволяет предоставить пользователям единое расположение для взаимодействия со всеми подэлементами. Важно сохранить вкладку `subEntityId``entityId``channelId` и, когда вкладка изначально создана в канале, чтобы иметь правильные свойства при открытии представления беседы на статической вкладке.

## <a name="close-a-conversation"></a>Закрытие беседы

Представление беседы можно закрыть вручную, вызвав функцию `closeConversation()` .

```javascript
microsoftTeams.conversations.closeConversation();
```

Вы также можете прослушивать событие, когда пользователь закрывает представление беседы.

```javascript
microsoftTeams.conversations.onCloseConversation = (conversationResponse) => {
    // console.log(conversationResponse)
};
```

## <a name="code-sample"></a>Пример кода

| Название примера | Описание | C# |Node.js|
|-------------|-------------|------|----|
|Вкладка "Создание беседы"| Microsoft Teams пример приложения для демонстрации создания вкладки беседы. | [View](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/tab-conversations/csharp) |  [Просмотр](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/tab-conversations/nodejs) |

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Изменения полей вкладок](~/resources/removing-tab-margins.md)

## <a name="see-also"></a>Дополнительные ресурсы

* [Teams вкладок](~/tabs/what-are-tabs.md)
* [Создание личной вкладки](~/tabs/how-to/create-personal-tab.md)
* [Создание вкладки канала или группы](~/tabs/how-to/create-channel-group-tab.md)
* [Вкладки на мобильных устройствах](~/tabs/design/tabs-mobile.md)
* [Создание вкладок с использованием адаптивных карточек](~/tabs/how-to/build-adaptive-card-tabs.md)
