---
title: Создать страницу удаления вкладки
author: surbhigupta
description: Создание страницы удаления вкладок
keywords: Teams tabs group channel configurable remove delete
ms.localizationpriority: medium
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: ea29959bf79b5e46e876f75570dcb437fa56888f
ms.sourcegitcommit: 61003a14e8a179e1268bbdbd9cf5e904c5259566
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2022
ms.locfileid: "64736863"
---
# <a name="create-a-removal-page"></a>Создать страницу удаления

Вы можете расширить и улучшить взаимодействие с пользователем за счет поддержки параметров удаления и изменения в приложении. Teams позволяет пользователям переименовывать или удалять вкладку канала или группы, и вы можете разрешить пользователям перенастройку вкладки после установки. Кроме того, функция удаления вкладок предоставляет пользователям возможность удалять или архивировать содержимое после удаления.

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a>Включение перенастройки вкладки после установки

Определяет `manifest.json` функции и возможности вкладки. Свойство экземпляра табуляции `canUpdateConfiguration` принимает логическое значение, указывающее, может ли пользователь изменить или перенастроить вкладку после ее создания. В следующей таблице приведены сведения о свойстве.

|Имя| Тип| Максимальный размер | Обязательный | Описание|
|---|---|---|---|---|
|`canUpdateConfiguration`|Логический|||Значение, указывающее, может ли пользователь обновлять конфигурацию вкладки после ее создания. Значение по умолчанию: `true`. |

Когда вкладка передается в канал или групповой чат, Teams добавляет раскрывающееся меню правой кнопкой мыши для вкладки. Доступные параметры определяются параметром`canUpdateConfiguration`. В следующей таблице приведены сведения о параметрах.

| `canUpdateConfiguration`| true   | false | description |
| ----------------------- | :----: | ----- | ----------- |
|     Settings            |   √    |       |Страница `configurationUrl` перезагружается в IFrame, что позволяет пользователю перенастроить вкладку. |
|     Переименовать              |   √    |   √   | Пользователь может изменить имя вкладки в том виде, в который она отображается на панели вкладок.          |
|     Удалить              |   √    |   √   |  Если свойство `removeURL` и значение включены на страницу конфигурации **, страница** удаления загружается в IFrame и предоставляется пользователю. Если страница удаления не включена, пользователю предоставляется диалоговое окно подтверждения.          |

## <a name="create-a-tab-removal-page-for-your-application"></a>Создание страницы удаления вкладок для приложения

Необязательная страница удаления — это размещенная HTML-страница, которая отображается при удалении вкладки. URL-адрес страницы удаления назначается методом `setSettings()` на странице конфигурации. Как и все страницы в приложении, страница удаления должна соответствовать предварительным требованиям Teams [вкладки](../../../tabs/how-to/tab-requirements.md).

### <a name="register-a-remove-handler"></a>Регистрация обработчика удаления

При необходимости в логике страницы `registerOnRemoveHandler((RemoveEvent) => {}` удаления можно вызвать обработчик событий, когда пользователь удаляет существующую конфигурацию вкладки. Метод принимает интерфейс и [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) выполняет код в обработчике, когда пользователь пытается удалить содержимое. Этот метод используется для выполнения операций очистки, таких как удаление базового ресурса, который поддерживает содержимое вкладки. Одновременно можно зарегистрировать только один обработчик удаления.

Интерфейс `RemoveEvent` описывает объект с двумя методами:

* Функция `notifySuccess()` является обязательной. Это означает, что удаление базового ресурса выполнено успешно и его содержимое можно удалить.

* Функция `notifyFailure(string)` является необязательной. Это означает, что удаление базового ресурса завершилось сбоем и его содержимое невозможно удалить. Необязательный строковый параметр указывает причину сбоя. Если этот параметр указан, эта строка отображается пользователю. в противном случае отображается общая ошибка.

#### <a name="use-the-getsettings-function"></a>Использование функции `getSettings()`

Можно использовать для `getSettings()`назначения удаляемого содержимого вкладки. Функция `getSettings((Settings) =>{})` принимает и предоставляет [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) допустимые значения свойств параметров, которые можно получить.

#### <a name="use-the-getcontext-function"></a>Использование функции `getContext()`

Можно использовать для `getContext()` получения текущего контекста, в котором выполняется кадр. Функция `getContext((Context) =>{})` принимает в .[`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) Функция предоставляет допустимые `Context` значения свойств, которые можно использовать в логике страницы удаления для определения содержимого, отображаемого на странице удаления.

#### <a name="include-authentication"></a>Включение проверки подлинности

Прежде чем разрешить пользователю удалять содержимое вкладки, требуется проверка подлинности. Сведения о контексте можно использовать для создания запросов на проверку подлинности и URL-адресов страниц авторизации. См[. Microsoft Teams проверки подлинности для вкладок](~/tabs/how-to/authentication/auth-flow-tab.md). Убедитесь, что все домены, используемые на страницах вкладок, перечислены в массиве `manifest.json` `validDomains` .

Ниже приведен пример блока кода удаления вкладки:

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>
```

Когда пользователь выбирает команду **"** Удалить" из раскрывающегося меню `removeUrl` вкладки, Teams загружает необязательную страницу **,** назначенную на странице конфигурации, в IFrame. Пользователю отображается кнопка, `onClick()` `microsoftTeams.settings.setValidityState(true)` загруженная с функцией, которая вызывает и включает кнопку "Удалить", показанную в нижней части IFrame страницы удаления.

После выполнения обработчика `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` удаления или Teams результат удаления содержимого.

>[!NOTE]
>
> * Чтобы убедиться, что авторизованный пользователь контролирует вкладку, Teams в случае успешного и неудачного выполнения.
> * После вызова обработчика `registerOnRemoveHandler` событий у вас будет 15 секунд для ответа на метод. По умолчанию Teams кнопку "**Удалить" через** пять секунд, даже если вы не вызываете ее`setValidityState(true)`.
> * Когда пользователь нажмет кнопку "Удалить **", Teams** удаляет вкладку через 30 секунд независимо от того, завершены ли действия.

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Вкладки на мобильных устройствах](~/tabs/design/tabs-mobile.md)

## <a name="see-also"></a>См. также

* [Teams вкладок](~/tabs/what-are-tabs.md)
* [Создание личной вкладки](~/tabs/how-to/create-personal-tab.md)
* [Создание вкладки канала или группы](~/tabs/how-to/create-channel-group-tab.md)
* [Создать страницу конфигурации](~/tabs/how-to/create-tab-pages/configuration-page.md)
