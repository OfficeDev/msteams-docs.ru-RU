---
title: Создать страницу удаления вкладки
author: laujan
description: Как создать страницу удаления вкладок
keywords: команды вкладок групповой канал настраиваемый удалить удалить
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: e1a1f38a2bcb3b5bc4bc54f469c8727e44d8695e
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566672"
---
# <a name="modify-or-remove-a-channel-group-tab"></a>Изменение или удаление вкладки группы каналов

Вы можете расширить и улучшить пользовательский опыт, поддерживая варианты удаления и модификации в приложении. Teams позволяет пользователям переименовать или удалить вкладку канала/группы, и вы можете разрешить пользователям перенастраивать вкладку после установки. Кроме того, ваш опыт удаления вкладок может включать в себя просмотр того, что происходит с содержимым при удалении вкладки, или предоставление пользователям опций после удаления, таких как удаление или архивирование содержимого.

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a>Включить перенастройку вкладки после установки

Ваш **manifest.jsна** определяет особенности и возможности вашей вкладки. Свойство экземпляра `canUpdateConfiguration` вкладок принимает значение Boolean, которое указывает, может ли пользователь изменять или перенастраивать вкладку после ее создания:

|Имя| Тип| Максимальный размер | Обязательный | Описание|
|---|---|---|---|---|
|`canUpdateConfiguration`|Логический|||Значение, указывающее, может ли экземпляр конфигурации вкладки обновляться пользователем после создания. по умолчанию: `true`|

Когда ваша вкладка загружена в канал или групповой чат, Teams вы добавите меню для вашей вкладки с правом нажатия кнопки. Доступные варианты определяются `canUpdateConfiguration` настройками:

| `canUpdateConfiguration`| true   | false | description |
| ----------------------- | :----: | ----- | ----------- |
|     Параметры            |   √    |       |Страница `configurationUrl` перезаряжается в IFrame, позволяя пользователю перенастроить вкладку.  |
|     Переименовать              |   √    |   √   | Пользователь может изменить имя вкладки, как это появляется в вкладке.          |
|     Удалить              |   √    |   √   |  Если  `removeURL` свойство и значение включены в **страницу конфигурации,** страница **удаления** загружается в IFrame и представляется пользователю. Если страница удаления не включена, пользователю представляется диалоговое окно подтверждения.          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a>Создание страницы удаления вкладок для приложения

Необязательная страница удаления является HTML-страницей, которую вы хост и отображается при удалении вкладки. URL-адрес страницы удаления обозначен методом `setSettings()` на странице конфигурации. Как и во всех страницах приложения, страница удаления должна соответствовать [Teams вкладок.](../../../tabs/how-to/tab-requirements.md)

### <a name="register-a-remove-handler"></a>Регистрация обработчика удаления

По желанию, в логике страницы удаления можно вызвать обработчик `registerOnRemoveHandler((RemoveEvent) => {}` событий, когда пользователь удаляет существующую конфигурацию вкладок. Метод принимает интерфейс и [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) выполняет код в обработчике, когда пользователь пытается удалить содержимое. Он используется для выполнения операций очистки, таких как удаление базового ресурса, подехав содержимого вкладки. Одновременно может быть зарегистрирован только один обработчик удаления.

Интерфейс `RemoveEvent` описывает объект двумя методами:

* Функция `notifySuccess()` необходима. Это указывает на то, что удаление базового ресурса удалось и его содержание может быть удалено.

* Функция `notifyFailure(string)` необязательна. Это указывает на то, что удаление базового ресурса не удалось и его содержание не может быть удалено. Параметр дополнительной строки указывает причину сбоя. Если предоставлено, эта строка отображается пользователю; в противном случае отображается общая ошибка.

#### <a name="use-the-getsettings-function"></a>Использование `getSettings()` функции

Вы можете использовать `getSettings()` для обозначения содержимого вкладки для удаления. Функция `getSettings((Settings) =>{})` принимает и предоставляет [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) действительные значения свойств настроек, которые могут быть извлечены.

#### <a name="use-the-getcontext-function"></a>Использование `getContext()` функции

Вы можете использовать `getContext()` для извлечения текущего контекста, в котором работает кадр. Функция `getContext((Context) =>{})` принимает и предоставляет [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) действительные значения `Context` свойств, которые можно использовать в логике страницы удаления для определения содержимого для отображения на странице удаления.

#### <a name="include-authentication"></a>Включить аутентификацию

Возможно, потребуется проверка подлинности, прежде чем разрешить пользователю удалить содержимое вкладки. Контекстная информация может быть использована для построения URL-адресов запросов на проверку подлинности и авторизации страниц. Можно [Microsoft Teams поток проверки подлинности для вкладок.](~/tabs/how-to/authentication/auth-flow-tab.md) Убедитесь, что все домены, используемые на страницах вкладок, перечислены в `manifest.json` `validDomains` массиве.

Ниже приведен пример блока кода удаления вкладок:

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

Когда пользователь выберет **Удаление из меню** выпадают из вкладки, Teams загрузит дополнительную `removeUrl` страницу (обозначенную на странице **конфигурации)** в IFrame. Здесь пользователю представлена кнопка, загруженная функцией, `onClick()` которая вызывает и позволяет удалить `microsoftTeams.settings.setValidityState(true)` **кнопку,** расположенную в нижней части страницы удаления IFrame.

После выполнения обработчика удаления или `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` уведомляет Teams результате удаления содержимого.

>[!NOTE]
> * Чтобы гарантировать, что управление авторизованным пользователем над вкладкой не будет Teams, он будет удалять вкладку как в случаях успеха, так и в случае сбоя».
> * Teams позволяет удалить **кнопку** через 5 секунд, даже если вкладка не `setValidityState()` называется».
> * Когда пользователь выбирает **Удалить Teams** вкладку через 30 секунд, независимо от того, ваши действия завершены.
