---
title: Создать страницу удаления вкладки
author: surbhigupta
description: Создание страницы удаления вкладок
keywords: группы вкладок группового канала, настраиваемые удалить удаление
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 1b4ef5435ad1be82726edbf02d7205c0b1feba06
ms.sourcegitcommit: 4d9d1542e04abacfb252511c665a7229d8bb7162
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2021
ms.locfileid: "53140196"
---
# <a name="create-a-removal-page"></a><span data-ttu-id="a70ba-104">Создать страницу удаления</span><span class="sxs-lookup"><span data-stu-id="a70ba-104">Create a removal page</span></span>

<span data-ttu-id="a70ba-105">Вы можете расширить и улучшить пользовательский интерфейс, поддержав параметры удаления и изменения в приложении.</span><span class="sxs-lookup"><span data-stu-id="a70ba-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="a70ba-106">Teams позволяет пользователям переименовать или удалить вкладку канала или группы, и вы можете разрешить пользователям перенастройку вкладки после установки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-106">Teams enables users to rename or remove a channel or group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="a70ba-107">Кроме того, функции удаления вкладок предоставляют пользователям возможность удаления или удаления контента.</span><span class="sxs-lookup"><span data-stu-id="a70ba-107">Additionally, the tab removal experience provides the users with post-removal options to delete or archive content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="a70ba-108">Включить перенастройку вкладки после установки</span><span class="sxs-lookup"><span data-stu-id="a70ba-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="a70ba-109">Ваша **manifest.jsопределяет** функции и возможности вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="a70ba-110">Свойство экземпляра вкладки принимает значение Boolean, которое указывает, может ли пользователь изменить или перенастроить вкладку после `canUpdateConfiguration` ее создания.</span><span class="sxs-lookup"><span data-stu-id="a70ba-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created.</span></span> <span data-ttu-id="a70ba-111">В следующей таблице приводится информация о свойстве:</span><span class="sxs-lookup"><span data-stu-id="a70ba-111">The following table provides the property details:</span></span>

|<span data-ttu-id="a70ba-112">Имя</span><span class="sxs-lookup"><span data-stu-id="a70ba-112">Name</span></span>| <span data-ttu-id="a70ba-113">Тип</span><span class="sxs-lookup"><span data-stu-id="a70ba-113">Type</span></span>| <span data-ttu-id="a70ba-114">Максимальный размер</span><span class="sxs-lookup"><span data-stu-id="a70ba-114">Maximum size</span></span> | <span data-ttu-id="a70ba-115">Обязательный</span><span class="sxs-lookup"><span data-stu-id="a70ba-115">Required</span></span> | <span data-ttu-id="a70ba-116">Описание</span><span class="sxs-lookup"><span data-stu-id="a70ba-116">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="a70ba-117">Логический</span><span class="sxs-lookup"><span data-stu-id="a70ba-117">Boolean</span></span>|||<span data-ttu-id="a70ba-118">Значение, указывающее, может ли экземпляр конфигурации вкладки обновляться пользователем после создания.</span><span class="sxs-lookup"><span data-stu-id="a70ba-118">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="a70ba-119">Значение по умолчанию: `true`.</span><span class="sxs-lookup"><span data-stu-id="a70ba-119">Default is `true`.</span></span> |

<span data-ttu-id="a70ba-120">Когда вкладка загружается в канал или групповой чат, Teams добавляет для вкладки выпадаемое меню правой кнопкой мыши. Доступные параметры определяются `canUpdateConfiguration` параметром.</span><span class="sxs-lookup"><span data-stu-id="a70ba-120">When your tab is uploaded to a channel or group chat, Teams adds a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting.</span></span> <span data-ttu-id="a70ba-121">В следующей таблице ниже параметров параметров:</span><span class="sxs-lookup"><span data-stu-id="a70ba-121">The following table provides the setting details:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="a70ba-122">true</span><span class="sxs-lookup"><span data-stu-id="a70ba-122">true</span></span>   | <span data-ttu-id="a70ba-123">false</span><span class="sxs-lookup"><span data-stu-id="a70ba-123">false</span></span> | <span data-ttu-id="a70ba-124">description</span><span class="sxs-lookup"><span data-stu-id="a70ba-124">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="a70ba-125">Параметры</span><span class="sxs-lookup"><span data-stu-id="a70ba-125">Settings</span></span>            |   <span data-ttu-id="a70ba-126">√</span><span class="sxs-lookup"><span data-stu-id="a70ba-126">√</span></span>    |       |<span data-ttu-id="a70ba-127">Страница `configurationUrl` перезагружается в IFrame, что позволяет пользователю перенастроить вкладку.</span><span class="sxs-lookup"><span data-stu-id="a70ba-127">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span> |
|     <span data-ttu-id="a70ba-128">Переименовать</span><span class="sxs-lookup"><span data-stu-id="a70ba-128">Rename</span></span>              |   <span data-ttu-id="a70ba-129">√</span><span class="sxs-lookup"><span data-stu-id="a70ba-129">√</span></span>    |   <span data-ttu-id="a70ba-130">√</span><span class="sxs-lookup"><span data-stu-id="a70ba-130">√</span></span>   | <span data-ttu-id="a70ba-131">Пользователь может изменить имя вкладки, как оно отображается в панели вкладок.</span><span class="sxs-lookup"><span data-stu-id="a70ba-131">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="a70ba-132">Удалить</span><span class="sxs-lookup"><span data-stu-id="a70ba-132">Remove</span></span>              |   <span data-ttu-id="a70ba-133">√</span><span class="sxs-lookup"><span data-stu-id="a70ba-133">√</span></span>    |   <span data-ttu-id="a70ba-134">√</span><span class="sxs-lookup"><span data-stu-id="a70ba-134">√</span></span>   |  <span data-ttu-id="a70ba-135">Если свойство и значение включены в страницу конфигурации, страница удаления загружается в `removeURL` IFrame и представляется пользователю.  </span><span class="sxs-lookup"><span data-stu-id="a70ba-135">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="a70ba-136">Если страница удаления не включена, пользователю будет представлен диалоговое окно с подтверждением.</span><span class="sxs-lookup"><span data-stu-id="a70ba-136">If a removal page is not included, the user is presented with a confirm dialog box.</span></span>          |

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="a70ba-137">Создание страницы удаления вкладок для приложения</span><span class="sxs-lookup"><span data-stu-id="a70ba-137">Create a tab removal page for your application</span></span>

<span data-ttu-id="a70ba-138">Необязательная страница удаления — это htmL-страница, на которую вы выводили и отображали при удалении вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-138">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="a70ba-139">URL-адрес страницы удаления назначается методом `setSettings()` на странице конфигурации.</span><span class="sxs-lookup"><span data-stu-id="a70ba-139">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="a70ba-140">Как и все страницы в приложении, страница удаления должна соответствовать требованиям Teams [вкладки.](../../../tabs/how-to/tab-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="a70ba-140">As with all pages in your app, the removal page must comply with [Teams tab prerequisites](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="a70ba-141">Регистрация обработера удаления</span><span class="sxs-lookup"><span data-stu-id="a70ba-141">Register a remove handler</span></span>

<span data-ttu-id="a70ba-142">Необязательно, в логике удаления страницы можно вызвать обработтель событий, когда пользователь удаляет `registerOnRemoveHandler((RemoveEvent) => {}` существующую конфигурацию вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-142">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="a70ba-143">Метод принимает интерфейс и выполняет код в обработнике, когда пользователь [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) пытается удалить контент.</span><span class="sxs-lookup"><span data-stu-id="a70ba-143">The method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="a70ba-144">Метод используется для выполнения операций очистки, таких как удаление основному ресурсу, вещаемому контентом вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-144">The method is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="a70ba-145">Одновременно можно зарегистрировать только один обработник удаления.</span><span class="sxs-lookup"><span data-stu-id="a70ba-145">At a time only one remove handler can be registered.</span></span>

<span data-ttu-id="a70ba-146">Интерфейс `RemoveEvent` описывает объект двумя методами:</span><span class="sxs-lookup"><span data-stu-id="a70ba-146">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="a70ba-147">Функция `notifySuccess()` необходима.</span><span class="sxs-lookup"><span data-stu-id="a70ba-147">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="a70ba-148">Это указывает на успешное удаление этого ресурса, а его содержимое можно удалить.</span><span class="sxs-lookup"><span data-stu-id="a70ba-148">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="a70ba-149">Функция `notifyFailure(string)` необязательна.</span><span class="sxs-lookup"><span data-stu-id="a70ba-149">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="a70ba-150">Это указывает на то, что удаление основному ресурсу не удалось и его содержимое невозможно удалить.</span><span class="sxs-lookup"><span data-stu-id="a70ba-150">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="a70ba-151">Необязательный параметр строки указывает причину сбоя.</span><span class="sxs-lookup"><span data-stu-id="a70ba-151">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="a70ba-152">При условии эта строка отображается пользователю; кроме того, отображается общая ошибка.</span><span class="sxs-lookup"><span data-stu-id="a70ba-152">If provided, this string is displayed to the user; else a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="a70ba-153">Использование `getSettings()` функции</span><span class="sxs-lookup"><span data-stu-id="a70ba-153">Use the `getSettings()` function</span></span>

<span data-ttu-id="a70ba-154">Вы можете `getSettings()` назначить удаляемому содержимому вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-154">You can use `getSettings()`to assign the tab content to be removed.</span></span> <span data-ttu-id="a70ba-155">Функция принимает и предоставляет допустимые значения свойств `getSettings((Settings) =>{})` [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) параметров, которые можно получить.</span><span class="sxs-lookup"><span data-stu-id="a70ba-155">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="a70ba-156">Использование `getContext()` функции</span><span class="sxs-lookup"><span data-stu-id="a70ba-156">Use the `getContext()` function</span></span>

<span data-ttu-id="a70ba-157">Вы можете использовать `getContext()` для получения текущего контекста, в котором работает кадр.</span><span class="sxs-lookup"><span data-stu-id="a70ba-157">You can use `getContext()` to get the current context in which the frame is running.</span></span> <span data-ttu-id="a70ba-158">Функция `getContext((Context) =>{})` принимает в [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) .</span><span class="sxs-lookup"><span data-stu-id="a70ba-158">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true).</span></span> <span data-ttu-id="a70ba-159">Функция предоставляет допустимые значения свойств, которые можно использовать в логике страницы удаления, чтобы определить содержимое, отображаемую `Context` на странице удаления.</span><span class="sxs-lookup"><span data-stu-id="a70ba-159">The function provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="a70ba-160">Включить проверку подлинности</span><span class="sxs-lookup"><span data-stu-id="a70ba-160">Include authentication</span></span>

<span data-ttu-id="a70ba-161">Проверка подлинности требуется, прежде чем разрешить пользователю удалять содержимое вкладки.</span><span class="sxs-lookup"><span data-stu-id="a70ba-161">Authentication is required before allowing a user to delete the tab content.</span></span> <span data-ttu-id="a70ba-162">Сведения о контексте можно использовать для создания запросов на проверку подлинности и URL-адресов страниц авторизации.</span><span class="sxs-lookup"><span data-stu-id="a70ba-162">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="a70ba-163">См. [Microsoft Teams поток проверки подлинности для вкладок.](~/tabs/how-to/authentication/auth-flow-tab.md)</span><span class="sxs-lookup"><span data-stu-id="a70ba-163">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="a70ba-164">Убедитесь, что все домены, используемые на страницах вкладок, перечислены в `manifest.json` `validDomains` массиве.</span><span class="sxs-lookup"><span data-stu-id="a70ba-164">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="a70ba-165">Ниже приводится пример блока кода удаления вкладок:</span><span class="sxs-lookup"><span data-stu-id="a70ba-165">The following is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="a70ba-166">Когда пользователь выбирает **Удаление** из выпадаемого меню вкладки, Teams загружает необязательные страницы, заданная на странице конфигурации, в `removeUrl` IFrame. </span><span class="sxs-lookup"><span data-stu-id="a70ba-166">When a user selects **Remove** from the tab's drop-down menu, Teams loads the optional `removeUrl` page assigned in your **configuration page**, into an IFrame.</span></span> <span data-ttu-id="a70ba-167">Пользователю показана кнопка, загруженная функцией, которая вызывает и включает кнопку Удалить, показанную в нижней части страницы `onClick()` `microsoftTeams.settings.setValidityState(true)` удаления IFrame. </span><span class="sxs-lookup"><span data-stu-id="a70ba-167">The user is shown a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button shown at the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="a70ba-168">После выполнения обработка удаления или Teams `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` результатов удаления контента.</span><span class="sxs-lookup"><span data-stu-id="a70ba-168">After the remove handler is executed, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="a70ba-169">Чтобы не препятствовать контролю авторизованного пользователя над вкладками, Teams удаляет вкладку как в случаях успешного, так и неудачного.</span><span class="sxs-lookup"><span data-stu-id="a70ba-169">To ensure that an authorized user's control over a tab is not inhibited, Teams removes the tab in both success and failure cases.</span></span>
> * <span data-ttu-id="a70ba-170">Teams кнопку **Удалить** через пять секунд, даже если вкладка не вызвала `setValidityState()` .</span><span class="sxs-lookup"><span data-stu-id="a70ba-170">Teams enables the **Remove** button after five seconds, even if your tab has not called `setValidityState()`.</span></span>
> * <span data-ttu-id="a70ba-171">Когда пользователь выбирает **Remove,** Teams удаляет вкладку через 30 секунд независимо от того, завершены действия или нет.</span><span class="sxs-lookup"><span data-stu-id="a70ba-171">When the user selects **Remove**, Teams removes the tab after 30 seconds regardless of whether the actions have been completed or not.</span></span>

## <a name="see-also"></a><span data-ttu-id="a70ba-172">См. также</span><span class="sxs-lookup"><span data-stu-id="a70ba-172">See also</span></span>

* [<span data-ttu-id="a70ba-173">Teams вкладки</span><span class="sxs-lookup"><span data-stu-id="a70ba-173">Teams tabs</span></span>](~/tabs/what-are-tabs.md)
* [<span data-ttu-id="a70ba-174">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="a70ba-174">Prerequisites</span></span>](~/tabs/how-to/tab-requirements.md)
* [<span data-ttu-id="a70ba-175">Создать личную вкладку</span><span class="sxs-lookup"><span data-stu-id="a70ba-175">Create a personal tab</span></span>](~/tabs/how-to/create-personal-tab.md)
* [<span data-ttu-id="a70ba-176">Создание вкладки канала или группы</span><span class="sxs-lookup"><span data-stu-id="a70ba-176">Create a channel or group tab</span></span>](~/tabs/how-to/create-channel-group-tab.md)
* [<span data-ttu-id="a70ba-177">Создать страницу контента</span><span class="sxs-lookup"><span data-stu-id="a70ba-177">Create a content page</span></span>](~/tabs/how-to/create-tab-pages/content-page.md)
* [<span data-ttu-id="a70ba-178">Создать страницу конфигурации</span><span class="sxs-lookup"><span data-stu-id="a70ba-178">Create a configuration page</span></span>](~/tabs/how-to/create-tab-pages/configuration-page.md)
* [<span data-ttu-id="a70ba-179">Получение контекста для вкладки</span><span class="sxs-lookup"><span data-stu-id="a70ba-179">Get context for your tab</span></span>](~/tabs/how-to/access-teams-context.md)
* [<span data-ttu-id="a70ba-180">Создание вкладок с использованием адаптивных карточек</span><span class="sxs-lookup"><span data-stu-id="a70ba-180">Build tabs with Adaptive Cards</span></span>](~/tabs/how-to/build-adaptive-card-tabs.md)
* [<span data-ttu-id="a70ba-181">Предварительный просмотр для ссылки "Вкладки" и представление стадий</span><span class="sxs-lookup"><span data-stu-id="a70ba-181">Tabs link unfurling and Stage View</span></span>](~/tabs/tabs-link-unfurling.md)
* [<span data-ttu-id="a70ba-182">Создание вкладок бесед</span><span class="sxs-lookup"><span data-stu-id="a70ba-182">Create conversational tabs</span></span>](~/tabs/how-to/conversational-tabs.md)
* [<span data-ttu-id="a70ba-183">Изменения полей вкладок</span><span class="sxs-lookup"><span data-stu-id="a70ba-183">Tab margin changes</span></span>](~/resources/removing-tab-margins.md)

## <a name="next-step"></a><span data-ttu-id="a70ba-184">Следующий этап</span><span class="sxs-lookup"><span data-stu-id="a70ba-184">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="a70ba-185">Вкладки на мобильных устройствах</span><span class="sxs-lookup"><span data-stu-id="a70ba-185">Tabs on mobile</span></span>](~/tabs/design/tabs-mobile.md)