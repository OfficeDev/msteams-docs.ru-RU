---
title: Создать страницу удаления вкладки
author: laujan
description: Создание страницы удаления вкладок
keywords: Удаление вкладки группы групп, настраиваемого для удаления
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 49e2df47095999e9f9eea76ea341a44215bfacb3
ms.sourcegitcommit: 4539479289b43812eaae07a1c0f878bed815d2d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49797885"
---
# <a name="modify-or-remove-a-channel-group-tab"></a>Изменение или удаление вкладки группы каналов

Вы можете расширить и улучшить пользовательский интерфейс, поддерживая параметры удаления и изменения в приложении. Teams позволяет пользователям переименовывать или удалять вкладку канала или группы, а вы можете разрешить пользователям перенастройку вкладки после установки. Кроме того, процесс удаления вкладок может включать в себя обозначение того, что происходит с содержимым при удалении вкладки, или предоставление пользователям параметров после удаления, таких как удаление или архивация содержимого.

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a>Включить перенастройку вкладки после установки

Ваша **manifest.jsопределяет** функции и возможности вкладки. Свойство экземпляра вкладки принимает boolean значение, которое указывает, может ли пользователь изменить или перенастроить вкладку после `canUpdateConfiguration` ее создания:

|Имя| Тип| Максимальный размер | Обязательный | Описание|
|---|---|---|---|---|
|`canUpdateConfiguration`|Логический|||Значение, указывающее, может ли пользователь обновить экземпляр конфигурации вкладки после создания. По умолчанию: `true`|

Когда вкладка будет загружена в канал или групповой чат, Teams добавит для нее вкладки меню с щелчком правой кнопкой мыши. Доступные параметры определяются `canUpdateConfiguration` параметром:

| `canUpdateConfiguration`| true   | false | description |
| ----------------------- | :----: | ----- | ----------- |
|     Параметры            |   √    |       |Страница `configurationUrl` перезагружается в IFrame, что позволяет пользователю перенастроить вкладку.  |
|     Переименовать              |   √    |   √   | Пользователь может изменить имя вкладки так, как оно отображается на панели вкладок.          |
|     Удалить              |   √    |   √   |  Если свойство и значение включены в страницу конфигурации, страница удаления загружается в `removeURL` IFrame и представляется пользователю.   Если страница удаления не включена, пользователь получает диалоговое окно подтверждения.          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a>Создание страницы удаления вкладок для приложения

Необязательная страница удаления — это HTML-страница, которая будет отображаться при удалении вкладки. URL-адрес страницы удаления назначается методом `setSettings()` на странице конфигурации. Как и все страницы в приложении, страница удаления должна соответствовать требованиям к вкладке [Teams.](../../../tabs/how-to/tab-requirements.md)

### <a name="register-a-remove-handler"></a>Регистрация обработера удаления

При желании в логике страницы удаления можно вызвать обработтель событий, когда пользователь удаляет `registerOnRemoveHandler((RemoveEvent) => {}` существующую конфигурацию вкладки. Метод принимает интерфейс и выполняет код в обработитере, когда пользователь [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) пытается удалить содержимое. Он используется для выполнения операций очистки, таких как удаление ресурсов, которые используются для работы с содержимым вкладок. Одновременно можно зарегистрировать только один обработок удаления.

Интерфейс `RemoveEvent` описывает объект с двумя методами:

* Функция `notifySuccess()` является обязательной. Это означает, что удаление необходимого ресурса успешно, и его содержимое можно удалить.

* Функция `notifyFailure(string)` необязательна. Это означает, что удаление необходимого ресурса не удалось и его содержимое невозможно удалить. Необязательный параметр строки указывает причину сбоя. Если она заданной, эта строка отображается пользователю; в противном случае отображается общая ошибка.

#### <a name="use-the-getsettings-function"></a>Использование `getSettings()` функции

Можно использовать `getSettings()` для назначить содержимое вкладки, которое необходимо удалить. Функция `getSettings((Settings) =>{})` принимает и предоставляет допустимые значения свойств параметров, [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) которые можно получить.

#### <a name="use-the-getcontext-function"></a>Использование `getContext()` функции

Можно использовать `getContext()` для получения текущего контекста, в котором запущен кадр. Функция принимает и предоставляет допустимые значения свойств, которые можно использовать в логике страницы удаления, чтобы определить содержимое, отображаемую `getContext((Context) =>{})` [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) на странице `Context` удаления.

#### <a name="include-authentication"></a>Включить проверку подлинности

Прежде чем разрешить пользователю удалять содержимое вкладки, может потребоваться проверка подлинности. Контекстные сведения можно использовать для создания запросов на проверку подлинности и URL-адресов страниц авторизации. См. [поток проверки подлинности Microsoft Teams для вкладок.](~/tabs/how-to/authentication/auth-flow-tab.md) Убедитесь, что все домены, используемые на страницах вкладок, указаны в `manifest.json` `validDomains` массиве.

Ниже приведен пример блока кода удаления вкладок:

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

Когда пользователь выбирает команду **"Удалить"** в выпадаемом меню вкладки, Teams загрузит необязательные страницы (указанные на странице конфигурации) в `removeUrl` IFrame. Здесь пользователь получает кнопку, загруженную функцией, которая вызывает и включает кнопку "Удалить", расположенную в нижней части `onClick()` `microsoftTeams.settings.setValidityState(true)` IFrame страницы удаления. 

После выполнения обработатора удаления или извествает `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` Teams о результатах удаления контента.

>[!NOTE]
>Чтобы убедиться, что авторизованный пользователь не блокирует управление вкладками, Teams удалит вкладку как в случае успешного, так и в случае сбоя.\
>Teams включает кнопку **"Удалить"** через 5 секунд, даже если вкладка не `setValidityState()` вызвана.\
>Когда пользователь выбирает команду **"Удалить** Teams", вкладка удаляется через 30 секунд независимо от того, были ли выполнены ваши действия.
