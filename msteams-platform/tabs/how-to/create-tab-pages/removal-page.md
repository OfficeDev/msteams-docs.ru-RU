---
title: Создание страницы удаления вкладок
author: laujan
description: Создание страницы удаления вкладок
keywords: вкладки Teams. Группа настраиваемого канала удалить удаление
ms.topic: conceptual
ms.author: ''
ms.openlocfilehash: 576a3bc88d8776a193b48868d37df204c3112fd8
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675171"
---
# <a name="modify-or-remove-a-channel-group-tab"></a>Изменение или удаление вкладки группы каналов

Вы можете расширить и улучшить взаимодействие с пользователем, дополнив поддержку параметров удаления и изменения в вашем приложении. Teams позволяет пользователям переименовывать или удалять вкладки каналов и групп, а также разрешать пользователям изменять настройку вкладки после установки. Кроме того, при удалении вкладки можно указать, что происходит с содержимым при удалении вкладки, или предоставить пользователям такие параметры, как удаление или Архивация контента.

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a>Включение повторной настройки вкладки после установки

В файле **manifest. JSON** определяются функции и возможности вкладки. Свойство экземпляра `canUpdateConfiguration` вкладки принимает логическое значение, которое указывает, может ли пользователь изменить или изменить конфигурацию вкладки после ее создания:

|Имя| Тип| Максимальный размер | Обязательный | Описание|
|---|---|---|---|---|
|`canUpdateConfiguration`|Логический|||Значение, указывающее, может ли пользователь обновлять экземпляр конфигурации вкладки после создания. Умолчани`true`|

Когда вкладка передается в канал или группу чата, Teams добавит раскрывающееся меню для вкладки. Доступные параметры определяются `canUpdateConfiguration` параметром:

| `canUpdateConfiguration`| true   | false | description |
| ----------------------- | :----: | ----- | ----------- |
|     Параметры            |   √    |       |`configurationUrl` Страница перегружается в iframe, что позволяет пользователю изменить настройку вкладки.  |
|     Переименовать              |   √    |   √   | Пользователь может изменить имя вкладки, которое отображается на панели вкладок.          |
|     Удалить              |   √    |   √   |  Если `removeURL` свойство и значение включены на **странице Конфигурация**, **Страница удаления** загружается в IFRAME и отображается для пользователя. Если страница удаления не включена, пользователь отображается диалоговое окно подтверждения.          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a>Создание страницы удаления вкладок для приложения

Необязательная страница для удаления — это HTML-страница, которую вы размещаете и отображается при удалении вкладки. URL-адрес страницы удаления назначается `setSettings()` методом на странице конфигурации. Как и в случае со всеми страницами приложения, страница удаления должна соответствовать [требованиям вкладки Teams](~/tabs/how-to/add-tab.md).

### <a name="register-a-remove-handler"></a>Регистрация обработчика удаления

Кроме того, в логике страницы удаления можно вызвать обработчик `registerOnRemoveHandler((RemoveEvent) => {}` события, когда пользователь удаляет существующую конфигурацию вкладки. Метод принимает в [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) интерфейсе код и выполняет код в обработчике при попытке пользователя удалить контент. Он используется для выполнения таких операций очистки, как удаление базового ресурса с содержимым вкладки. За один раз можно зарегистрировать только один обработчик удаления.

`RemoveEvent` Интерфейс описывает объект с двумя методами:

* `notifySuccess()` Функция является обязательной. Это означает, что удаление базового ресурса выполнено успешно и его содержимое можно удалить.

* `notifyFailure(string)` Функция является необязательной. Она указывает на то, что не удалось удалить базовый ресурс и его контент невозможно удалить. Необязательный параметр String указывает причину сбоя. Если этот параметр указан, эта строка отображается пользователю; в противном случае отображается общая ошибка.

#### <a name="use-the-getsettings-function"></a>Использование `getSettings()` функции

Можно использовать `getSettings()`для указания удаляемого содержимого вкладки. `getSettings((Settings) =>{})` Функция принимает в себя [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) и предоставляет допустимые значения свойств параметров, которые можно получить.

#### <a name="use-the-getcontext-function"></a>Использование `getContext()` функции

Можно использовать `getContext()` для получения текущего контекста, в котором выполняется кадр. `getContext((Context) =>{})` Функция принимает в себя [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) и предоставляет допустимые `Context` значения свойств, которые можно использовать в логике страницы удаления для определения контента, отображаемого на странице удаления.

#### <a name="include-authentication"></a>Включение проверки подлинности

Прежде чем разрешить пользователю удалять содержимое вкладки, может потребоваться проверка подлинности. Сведения о контексте можно использовать для создания URL-адресов страниц проверки подлинности и страниц авторизации. [В этой статье представлен процесс проверки подлинности для вкладок в Microsoft Teams](~/tabs/how-to/authentication/auth-flow-tab.md). Убедитесь, что все домены, используемые на страницах вкладок, указаны в `manifest.json` `validDomains` массиве.

Ниже приведен пример блока кода для удаления вкладок.

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

Когда пользователь выбирает команду **Удалить** из раскрывающегося меню вкладки, Teams загрузит необязательную `removeUrl` страницу (назначенную на **странице Конфигурация**) в IFRAME. Здесь пользователю предоставляется кнопка, загруженная с помощью `onClick()` функции, которая вызывает `microsoftTeams.settings.setValidityState(true)` и включает кнопку **Удалить** , расположенную в нижней части IFRAME страницы удаления.

После выполнения обработчика удаления `removeEvent.notifySuccess()` или `removeEvent.notifyFailure()` уведомления Teams о результатах удаления контента.

>[!NOTE]
>Чтобы предотвратить запрещение управления авторизованным пользователем на вкладке, Teams удалит эту вкладку как в случае успеха, так и в случае сбоя. \
>Команда "Удалить" включает кнопку " **Удалить** " через 5 секунд, даже если `setValidityState()`вкладка не вызвана. \
>Когда пользователь выбирает **Удаление** Teams, вкладка удаляется через 30 секунд независимо от того, завершено ли действие.
