---
title: Создать страницу удаления вкладки
author: laujan
description: Создание страницы удаления вкладок
keywords: вкладки Teams. Группа настраиваемого канала удалить удаление
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: a8b40911de3e2519d8194415e2d8e467d0766ef2
ms.sourcegitcommit: e8dfcb167274e996395b77d65999991a18f2051a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2020
ms.locfileid: "47818901"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="ee7c5-104">Изменение или удаление вкладки группы каналов</span><span class="sxs-lookup"><span data-stu-id="ee7c5-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="ee7c5-105">Вы можете расширить и улучшить взаимодействие с пользователем, дополнив поддержку параметров удаления и изменения в вашем приложении.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="ee7c5-106">Teams позволяет пользователям переименовывать или удалять вкладки каналов и групп, а также разрешать пользователям изменять настройку вкладки после установки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="ee7c5-107">Кроме того, при удалении вкладки можно указать, что происходит с содержимым при удалении вкладки, или предоставить пользователям такие параметры, как удаление или Архивация контента.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="ee7c5-108">Включение повторной настройки вкладки после установки</span><span class="sxs-lookup"><span data-stu-id="ee7c5-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="ee7c5-109">Ваш **manifest.js** определяет функции и возможности вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="ee7c5-110">Свойство экземпляра вкладки `canUpdateConfiguration` принимает логическое значение, которое указывает, может ли пользователь изменить или изменить конфигурацию вкладки после ее создания:</span><span class="sxs-lookup"><span data-stu-id="ee7c5-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="ee7c5-111">Имя</span><span class="sxs-lookup"><span data-stu-id="ee7c5-111">Name</span></span>| <span data-ttu-id="ee7c5-112">Тип</span><span class="sxs-lookup"><span data-stu-id="ee7c5-112">Type</span></span>| <span data-ttu-id="ee7c5-113">Максимальный размер</span><span class="sxs-lookup"><span data-stu-id="ee7c5-113">Maximum size</span></span> | <span data-ttu-id="ee7c5-114">Обязательный</span><span class="sxs-lookup"><span data-stu-id="ee7c5-114">Required</span></span> | <span data-ttu-id="ee7c5-115">Описание</span><span class="sxs-lookup"><span data-stu-id="ee7c5-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="ee7c5-116">Логический</span><span class="sxs-lookup"><span data-stu-id="ee7c5-116">Boolean</span></span>|||<span data-ttu-id="ee7c5-117">Значение, указывающее, может ли пользователь обновлять экземпляр конфигурации вкладки после создания.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="ee7c5-118">Умолчани `true`</span><span class="sxs-lookup"><span data-stu-id="ee7c5-118">Default: `true`</span></span>|

<span data-ttu-id="ee7c5-119">Когда вкладка передается в канал или группу чата, Teams добавит раскрывающееся меню для вкладки. Доступные параметры определяются `canUpdateConfiguration` параметром:</span><span class="sxs-lookup"><span data-stu-id="ee7c5-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="ee7c5-120">true</span><span class="sxs-lookup"><span data-stu-id="ee7c5-120">true</span></span>   | <span data-ttu-id="ee7c5-121">false</span><span class="sxs-lookup"><span data-stu-id="ee7c5-121">false</span></span> | <span data-ttu-id="ee7c5-122">description</span><span class="sxs-lookup"><span data-stu-id="ee7c5-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="ee7c5-123">Параметры</span><span class="sxs-lookup"><span data-stu-id="ee7c5-123">Settings</span></span>            |   <span data-ttu-id="ee7c5-124">√</span><span class="sxs-lookup"><span data-stu-id="ee7c5-124">√</span></span>    |       |<span data-ttu-id="ee7c5-125">`configurationUrl`Страница перегружается в iframe, что позволяет пользователю изменить настройку вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="ee7c5-126">Переименовать</span><span class="sxs-lookup"><span data-stu-id="ee7c5-126">Rename</span></span>              |   <span data-ttu-id="ee7c5-127">√</span><span class="sxs-lookup"><span data-stu-id="ee7c5-127">√</span></span>    |   <span data-ttu-id="ee7c5-128">√</span><span class="sxs-lookup"><span data-stu-id="ee7c5-128">√</span></span>   | <span data-ttu-id="ee7c5-129">Пользователь может изменить имя вкладки, которое отображается на панели вкладок.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="ee7c5-130">Удалить</span><span class="sxs-lookup"><span data-stu-id="ee7c5-130">Remove</span></span>              |   <span data-ttu-id="ee7c5-131">√</span><span class="sxs-lookup"><span data-stu-id="ee7c5-131">√</span></span>    |   <span data-ttu-id="ee7c5-132">√</span><span class="sxs-lookup"><span data-stu-id="ee7c5-132">√</span></span>   |  <span data-ttu-id="ee7c5-133">Если  `removeURL` свойство и значение включены на **странице Конфигурация**, **Страница удаления** загружается в IFRAME и отображается для пользователя.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="ee7c5-134">Если страница удаления не включена, пользователь отображается диалоговое окно подтверждения.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="ee7c5-135">Создание страницы удаления вкладок для приложения</span><span class="sxs-lookup"><span data-stu-id="ee7c5-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="ee7c5-136">Необязательная страница для удаления — это HTML-страница, которую вы размещаете и отображается при удалении вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="ee7c5-137">URL-адрес страницы удаления назначается `setSettings()` методом на странице конфигурации.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="ee7c5-138">Как и в случае со всеми страницами приложения, страница удаления должна соответствовать [требованиям вкладки Teams](~/tabs/how-to/add-tab.md).</span><span class="sxs-lookup"><span data-stu-id="ee7c5-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](~/tabs/how-to/add-tab.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="ee7c5-139">Регистрация обработчика удаления</span><span class="sxs-lookup"><span data-stu-id="ee7c5-139">Register a remove handler</span></span>

<span data-ttu-id="ee7c5-140">Кроме того, в логике страницы удаления можно вызвать `registerOnRemoveHandler((RemoveEvent) => {}` обработчик события, когда пользователь удаляет существующую конфигурацию вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="ee7c5-141">Метод принимает в [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) интерфейсе код и выполняет код в обработчике при попытке пользователя удалить контент.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="ee7c5-142">Он используется для выполнения таких операций очистки, как удаление базового ресурса с содержимым вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="ee7c5-143">За один раз можно зарегистрировать только один обработчик удаления.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="ee7c5-144">`RemoveEvent`Интерфейс описывает объект с двумя методами:</span><span class="sxs-lookup"><span data-stu-id="ee7c5-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="ee7c5-145">`notifySuccess()`Функция является обязательной.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="ee7c5-146">Это означает, что удаление базового ресурса выполнено успешно и его содержимое можно удалить.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="ee7c5-147">`notifyFailure(string)`Функция является необязательной.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="ee7c5-148">Она указывает на то, что не удалось удалить базовый ресурс и его контент невозможно удалить.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="ee7c5-149">Необязательный параметр String указывает причину сбоя.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="ee7c5-150">Если этот параметр указан, эта строка отображается пользователю; в противном случае отображается общая ошибка.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="ee7c5-151">Использование `getSettings()` функции</span><span class="sxs-lookup"><span data-stu-id="ee7c5-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="ee7c5-152">Можно использовать `getSettings()` для указания удаляемого содержимого вкладки.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="ee7c5-153">`getSettings((Settings) =>{})`Функция принимает в себя [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) и предоставляет допустимые значения свойств параметров, которые можно получить.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="ee7c5-154">Использование `getContext()` функции</span><span class="sxs-lookup"><span data-stu-id="ee7c5-154">Use the `getContext()` function</span></span>

<span data-ttu-id="ee7c5-155">Можно использовать `getContext()` для получения текущего контекста, в котором выполняется кадр.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="ee7c5-156">`getContext((Context) =>{})`Функция принимает в себя [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) и предоставляет допустимые `Context` значения свойств, которые можно использовать в логике страницы удаления для определения контента, отображаемого на странице удаления.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="ee7c5-157">Включение проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="ee7c5-157">Include authentication</span></span>

<span data-ttu-id="ee7c5-158">Прежде чем разрешить пользователю удалять содержимое вкладки, может потребоваться проверка подлинности.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="ee7c5-159">Сведения о контексте можно использовать для создания URL-адресов страниц проверки подлинности и страниц авторизации.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="ee7c5-160">[В этой статье представлен процесс проверки подлинности для вкладок в Microsoft Teams](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="ee7c5-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="ee7c5-161">Убедитесь, что все домены, используемые на страницах вкладок, указаны в `manifest.json` `validDomains` массиве.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="ee7c5-162">Ниже приведен пример блока кода для удаления вкладок.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="ee7c5-163">Когда пользователь выбирает команду **Удалить** из раскрывающегося меню вкладки, Teams загрузит необязательную `removeUrl` страницу (назначенную на **странице Конфигурация**) в IFRAME.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="ee7c5-164">Здесь пользователю предоставляется кнопка, загруженная с помощью `onClick()` функции, которая вызывает `microsoftTeams.settings.setValidityState(true)` и включает кнопку **Удалить** , расположенную в нижней части IFRAME страницы удаления.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="ee7c5-165">После выполнения обработчика удаления `removeEvent.notifySuccess()` или `removeEvent.notifyFailure()` уведомления Teams о результатах удаления контента.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
><span data-ttu-id="ee7c5-166">Чтобы предотвратить запрещение управления авторизованным пользователем на вкладке, Teams удалит эту вкладку как в случае успеха, так и в случае сбоя. </span><span class="sxs-lookup"><span data-stu-id="ee7c5-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
><span data-ttu-id="ee7c5-167">Команда "Удалить" включает кнопку " **Удалить** " через 5 секунд, даже если вкладка не вызвана `setValidityState()` . </span><span class="sxs-lookup"><span data-stu-id="ee7c5-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
><span data-ttu-id="ee7c5-168">Когда пользователь выбирает **Удаление** Teams, вкладка удаляется через 30 секунд независимо от того, завершено ли действие.</span><span class="sxs-lookup"><span data-stu-id="ee7c5-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
