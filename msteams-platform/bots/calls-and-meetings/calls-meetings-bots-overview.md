---
title: Боты для звонков и виртуальных собраний
description: В этом модуле вы узнаете, как ваши Microsoft Teams-приложения могут взаимодействовать с пользователями с помощью голосовых и видеофайлов с помощью API Microsoft Graph для звонков и собраний по сети, а также узнать о потоках мультимедиа в режиме реального времени.
ms.topic: conceptual
ms.localizationpriority: medium
ms.openlocfilehash: 2fe13adaf662d70e7ca9e7f1ca3d73bac0208f53
ms.sourcegitcommit: 9d318eda5589ea8f5519d05cb83e0acf3e13e2f4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2022
ms.locfileid: "66150829"
---
# <a name="calls-and-online-meetings-bots"></a>Боты для звонков и виртуальных собраний

Боты, взаимодействующие со звонками и собраниями Teams в реальном времени с помощью голосовых команд, видео и демонстрации экрана. С помощью [API Microsoft Graph для звонков и онлайн-собраний](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true) приложения Microsoft Teams теперь могут взаимодействовать с пользователями посредством голосовых вызовов и видеосвязи. Эти API позволяют добавлять следующие новые функции:

* Рабочие процессы интерактивного автоответчика (IVR)
* Управление вызовами.
* Доступ к аудио- и видеопотокам в режиме реального времени, в том числе общий доступ к классическим и мобильным приложениям.

Чтобы использовать эти Graph API в приложении Teams, создайте бот и укажите некоторые дополнительные данные и разрешения.

Кроме того, платформа мультимедиа в реальном времени позволяет ботам взаимодействовать со звонками и собраниями Teams с помощью голосовой связи, видео и демонстрации экрана в режиме реального времени. Бот, участвующий в аудио- или видеозвонках и виртуальных собраниях - это обычный бот Microsoft Teams с несколькими дополнительными функциями, используемыми для регистрации бота.

Манифест Teams с двумя дополнительными параметрами `supportsCalling` и `supportsVideo`, разрешения Graph для идентификатора приложения Майкрософт бота и согласие администратора клиента - вот всё, что нужно для регистрации бота. При регистрации бота для звонков и собраний Teams нужно указать URL-адрес веб-перехватчика, который является конечной точкой веб-перехватчика для всех входящих вызовов, адресованных боту. Боту-мультимедиа, размещенному в приложении, для доступа к аудио- и видеопотокам мультимедиа требуется библиотека Microsoft.Graph.Communications.Calls.Media .NET, а сам бот должен быть развернут на компьютере Windows Server или гостевой операционной системе сервера Windows Server в Azure. Боты на Teams поддерживают только определенный набор форматов мультимедиа для аудио- и видеосодержимого.

Теперь необходимо разобраться в некоторых основных понятиях, терминах и соглашениях.

## <a name="terminologies"></a>Термины

Следующие основные понятия, термины и соглашения помогут вам начать пользоваться ботами для звонков и виртуальных собраний.

* Голосовые или видеозвонки
* Типы звонков
* Сигналы
* Звонки и собрания по сети
* Мультимедиа в реальном времени

### <a name="audio-or-video-calls"></a>Голосовые или видеозвонки

Звонки в Teams могут использовать только аудиосвязь или комбинацию аудио и видео. Вместо терминов "голосовой звонок" и "видеозвонок" используется термин "вызов".

### <a name="call-types"></a>Типы звонков

Вызовы — это одноранговые сеансы связи между пользователем и ботом или многопользовательские сеансы связи между ботом и несколькими пользователями (групповой вызов).

:::image type="content" source="~/assets/images/calls-and-meetings/call-types.png" alt-text="Типы вызовов"border="true":::

Ниже приведены различные типы вызовов и разрешения, необходимые для вызова:

* Пользователь может инициировать одноранговый звонок с помощью вашего бота или пригласить бота в существующую многопользовательскую конференцию. Многопользовательский вызов еще не реализован в пользовательском интерфейсе Teams.

    > [!NOTE]
    > Вызовы бота, инициированные пользователем, в настоящее время не поддерживаются на Teams мобильной платформе.

* Пользователю не обязательно иметь разрешения Graph, чтобы инициировать одноранговый вызов с ботом. Боту, чтобы участвовать в многопользовательском вызове или инициировать одноранговый вызов с пользователем, требуются дополнительные разрешения.
* Вызов может начинаться как одноранговый и позже стать многопользовательским. Ваш бот может инициировать многопользовательский вызов, пригласив других пользователей, если у него есть разрешение на инициацию группового звонка. Если у бота нет разрешений на участие в групповых вызовах и участник добавляет в вызов другого участника, бот удаляется из вызова.

### <a name="signals"></a>Сигналы

Существует два типа сигналов: входящий и вызывающий. Ниже приведены различные функции сигналов.

* Чтобы получать входящие звонки, введите конечную точку в параметрах бота. Эта конечная точка получает уведомление при инициации входящего вызова. Вы можете ответить на звонок, отклонить его или перенаправить его другому пользователю.

     :::image type="content" source="~/assets/images/calls-and-meetings/call-handling.png" alt-text="Обработка вызовов"border="true":::

* Когда бот участвует в вызове, существуют API-интерфейсы для отключения и включения звука бота, а также для запуска и прекращения общего доступа к содержимому видео или рабочего стола, предоставляемого ботом другим участникам.
* Бот также может получать доступ к списку участников, приглашать новых участников и отключать им звук.

### <a name="calls-and-online-meetings"></a>Звонки и собрания по сети

С точки Teams пользователя существует два вида онлайн-собраний: нерегламентированные и запланированные. С точки зрения бота между этими типами онлайн-собраний нет никакой разницы. Для бота онлайн-собрание — это многопользовательский звонок между набором участников, который включает в себя координаты собрания. Координаты собрания — это метаданные собрания, в том числе `botId`, `chatId`, связанный с собранием, `joinUrl`, `startTime` или `endTime` и т. д.

### <a name="real-time-media"></a>Мультимедиа в реальном времени

Когда бот участвует в звонках или виртуальных собраниях, он должен работать со звуковым и видеопотоком. Когда пользователь общается с ботом голосом во время вызова, показывает себя боту на веб-камере или предоставляет боту доступ к экранам в ходе вызова, он представлен в виде аудио- и видеопотоков. Если бот хочет произнести что-нибудь, даже совсем простое, например **нажать 0, чтобы связаться с оператором** в сценарии интерактивного голосового ответа (IVR), для этого необходимо воспроизвести . WAV-файл. В совокупности это называется мультимедиа или мультимедиа в режиме реального времени.

Мультимедиа в режиме реального времени — это сценарии, в которых мультимедиа должны обрабатываться в режиме реального времени, а не воспроизводить ранее записанные аудио или видео. Работа с потоками мультимедиа, особенно в режиме реального времени, очень сложна. Корпорация Майкрософт создала платформу работы с мультимедиа в режиме реального времени для обработки этих сценариев, чтобы взять на себя как можно большую часть традиционной интенсивной обработки мультимедиа в режиме реального времени. Когда бот отвечает на входящий вызов или присоединяется к новому или существующему вызову, он должен сообщить платформе мультимедиа в реальном времени, как будет обрабатываться мультимедиа. При создании системы интерактивного голосового ответа (IVR) можно отказаться от дорогостоящей обработки аудио, переложив его на Майкрософт. Кроме того, если боту требуется прямой доступ к потокам мультимедиа, этот сценарий также поддерживается. Существует два типа обработки мультимедиа:

* **Размещение мультимедиа в службе**: боты фокусируются на управлении рабочим процессом приложения, в частности - маршрутизации вызовов, а обработка звука перепоручается платформе Майкрософт для работы с мультимедиа в режиме реального времени. При размещении мультимедиа в службе существует несколько вариантов реализации и размещения вашего бота. Бот для мультимедийного содержимого, размещенного в службе, можно реализовать в виде службы без отслеживания состояния, так как он не обрабатывает мультимедиа в локальном расположении. Боты мультимедиа, размещенные в службе, могут использовать следующие API:

  * `PlayPrompt` для воспроизведения звукового клипа.
  * `Record` для записи звуковых клипов.
  * `SubscribeToTone` для подписки на двойные тоны с несколькими частотами (DTMF).

    Например, чтобы знать, когда пользователь нажал **0** для связи с оператором.

* **Размещение мультимедиа в приложении**: для прямого доступа к мультимедиа боту потребуется определенное разрешение Graph. После того как бот получит разрешение, [библиотека мультимедиа в режиме реального времени](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) и [пакет SDK для вызовов Graph](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder) помогают создавать богатые возможностями мультимедиа в режиме реального времени и вызывать ботов. Бот, размещенный в приложении, должен располагаться в среде Windows. Дополнительные сведения см. в разделе [Боты мультимедиа, размещаемые в приложениях](./requirements-considerations-application-hosted-media-bots.md).

## <a name="code-sample"></a>Пример кода

| **Название примера** | **Описание** | **Microsoft Graph** |
|---------------|----------|--------|
| Коммуникации Graph | Коммуникации Graph для взаимодействия с платформой связи Майкрософт. | [Просмотр](https://github.com/microsoftgraph/microsoft-graph-comms-samples) |

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Звонки и собрания в реальном времени](~/bots/calls-and-meetings/real-time-media-concepts.md)

## <a name="see-also"></a>Дополнительные ресурсы

* [Справочники по API Graph](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true)
* [Примеры приложений](https://github.com/microsoftgraph/microsoft-graph-comms-samples)
* [Регистрация бота для поддержки вызовов и онлайн-собраний](./registering-calling-bot.md)
* [Разрешения Graph для ботов звонков и онлайн-собраний](./registering-calling-bot.md#add-graph-permissions)
* [Разработка ботов для звонков и виртуальных собраний на вашем компьютере](./debugging-local-testing-calling-meeting-bots.md)
* [Требования и рекомендации для ботов мультимедиа, размещаемых в приложениях](./requirements-considerations-application-hosted-media-bots.md)
* [Техническая информация по обработке уведомлений о входящих звонках](./call-notifications.md)
* [Настройка автосекретаря](/microsoftteams/create-a-phone-system-auto-attendant)
* [Настройка автоматического ответа для Комнаты Microsoft Teams на видеотелефонных устройствах Teams](/microsoftteams/set-up-auto-answer-on-teams-android)
* [Политика записей Teams](/MicrosoftTeams/teams-recording-policy)
* [Работа с API коммуникаций в Microsoft Graph](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true)
