---
title: Боты для звонков и собраний по сети
description: Узнайте, как ваши Microsoft Teams-приложения могут взаимодействовать с пользователями с помощью голосовых и видео с помощью API Microsoft Graph для звонков и собраний по сети, а также узнайте о потоках мультимедиа в режиме реального времени.
ms.topic: conceptual
ms.localizationpriority: medium
keywords: вызов аудиозвонка видео iVR голосовых онлайн-собраний в режиме реального времени, бот потоков мультимедиа
ms.openlocfilehash: a7b9dbe81304e2556b8b8b868f1f9e29f8bba284
ms.sourcegitcommit: e40383d9081bf117030f7e6270140e6b94214e8b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2022
ms.locfileid: "65102507"
---
# <a name="calls-and-online-meetings-bots"></a>Боты для звонков и собраний по сети

Боты могут взаимодействовать Teams звонками и собраниями с помощью голосовой связи, видео и демонстрации экрана в режиме реального времени. Благодаря [API Graph](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true) Майкрософт для звонков и собраний по сети Teams приложения теперь могут взаимодействовать с пользователями с помощью голосовых и видеофайлов для улучшения взаимодействия. Эти API позволяют добавлять следующие новые функции:

* Интерактивный голосовой ответ (IVR).
* Управление вызовом.
* Доступ к аудио- и видеопотокам в режиме реального времени, включая общий доступ к классическим приложениям и приложениям.

Чтобы использовать эти Graph API в Teams, создайте бот и укажите некоторые дополнительные сведения и разрешения.

Кроме того, платформа мультимедиа в реальном времени позволяет ботам взаимодействовать с Teams звонками и собраниями с помощью голосовой связи, видео и демонстрации экрана в режиме реального времени. Бот, участвующий в аудио- или видеозвонках и собраниях по сети, является обычным Microsoft Teams ботом с несколькими дополнительными функциями, используемыми для регистрации бота.

Манифест Teams `supportsCalling` `supportsVideo`с двумя дополнительными параметрами и разрешениями Graph для идентификатора приложения Майкрософт бота и согласия администратора клиента позволяют зарегистрировать бота. При регистрации бота для звонков и собраний для Teams упоминается URL-адрес веб-перехватчика, который является конечной точкой веб-перехватчика для всех входящих вызовов бота. Для бота мультимедиа, размещенного в приложении, требуется корпорация Майкрософт. Graph. Библиотека Communications.Calls.Media .NET для доступа к аудио- и видеопотокам мультимедиа, а бот должен быть развернут на компьютере Windows Server или гостевой операционной системе сервера Windows Server в Azure. Боты на Teams поддерживают только определенный набор форматов мультимедиа для аудио- и видеосодержимого.

Теперь необходимо разобраться в некоторых основных понятиях, терминологии и соглашениях.

## <a name="terminologies"></a>Термины

Следующие основные понятия, терминология и соглашения пошаговом руководстве по использованию ботов для звонков и собраний по сети.

* Голосовые или видеозвонки
* Типы звонков
* Сигналы
* Звонки и собрания по сети
* Мультимедиа в режиме реального времени

### <a name="audio-or-video-calls"></a>Голосовые или видеозвонки

Вызовы в Teams могут быть исключительно аудио- или аудио- и видеосвязи. Вместо голосового или видеозвонка используется термин "звонок".

### <a name="call-types"></a>Типы звонков

Вызовы — это одноранговые звонки между пользователем и ботом или многопользовательские звонки между ботом и двумя или несколькими пользователями в групповом вызове.

:::image type="content" source="~/assets/images/calls-and-meetings/call-types.png" alt-text="Типы вызовов"border="true":::

Ниже приведены различные типы вызовов и разрешения, необходимые для вызова:

* Пользователь может инициировать одноранговый вызов с ботом или пригласить бота в существующий многопользовательский вызов. Многопользовательский вызов еще не включен в Teams пользовательском интерфейсе.

    > [!NOTE]
    > Вызовы бота, инициированные пользователем, в настоящее время не поддерживаются на Microsoft Teams мобильной платформе.

* Graph разрешения не являются необходимыми для пользователя, чтобы инициировать одноранговый вызов с ботом. Для участия бота в многопользовательском вызове или для инициации однорангового звонка с пользователем требуются дополнительные разрешения.
* Вызов может начинаться как одноранговый и в конечном итоге стать многопользовательским. Бот может инициировать многопользовательские вызовы, пригласив других пользователей при условии, что у бота есть соответствующие разрешения. Если у бота нет разрешений на участие в групповых вызовах и участник добавляет в вызов другого участника, бот удаляется из вызова.

### <a name="signals"></a>Сигналы

Существует два типа сигналов: входящий и вызывающий. Ниже приведены различные функции сигналов.

* Чтобы получить входящий звонок, введите конечную точку в параметрах бота. Эта конечная точка получает уведомление при инициации входящего вызова. Вы можете ответить на звонок, отклонить его или перенаправить его другому пользователю.

     :::image type="content" source="~/assets/images/calls-and-meetings/call-handling.png" alt-text="Обработка вызовов"border="true":::

* Когда бот вызывается, существуют API-интерфейсы для отключения и отключения бота, а также для запуска или остановки общего доступа к содержимому видео или рабочего стола с другими участниками.
* Бот также может получить доступ к списку участников, пригласить новых участников и отключить их.

### <a name="calls-and-online-meetings"></a>Звонки и собрания по сети

С точки Teams пользователя существует два вида онлайн-собраний: нерегламентированные и запланированные. С точки зрения бота, оба онлайн-собрания одинаковы. Для бота онлайн-собрание — это многопользовательский звонок между набором участников и включает координаты собрания. Координаты собрания — это метаданные `botId`для собрания, включая, `chatId` связанные с собранием, `joinUrl``startTime` или `endTime`и т. д.

### <a name="real-time-media"></a>Мультимедиа в режиме реального времени

Когда бот участвует в звонках или собраниях по сети, он должен работать со звуковым и видеопотоком. Когда пользователь общается по звонку, показывает себя на веб-камере или показывает свои экраны на собрании боту, он отображается в виде аудио- и видеопотоков. Если бот хочет произнести что-то простое, нажмите **0** , чтобы связаться с оператором в сценарии интерактивного голосового ответа (IVR), необходимо воспроизвести . WAV-файл. В совокупности это называется мультимедиа или мультимедиа в режиме реального времени.

Мультимедиа в режиме реального времени — это сценарии, в которых мультимедиа должны обрабатываться в режиме реального времени, а не воспроизводить ранее записанные аудио или видео. Работа с потоками мультимедиа, особенно потоками мультимедиа в режиме реального времени, очень сложна. Корпорация Майкрософт создала платформу мультимедиа в режиме реального времени для обработки этих сценариев и разгрузки как можно большей части традиционной интенсивной обработки мультимедиа в режиме реального времени. Когда бот отвечает на входящий вызов или присоединяется к новому или существующему вызову, он должен сообщить платформе мультимедиа в режиме реального времени, как обрабатывается мультимедиа. Если вы создаете приложение IVR, вы можете разгрузить ресурсоемкие процессы обработки звука в корпорацию Майкрософт. Кроме того, если боту требуется прямой доступ к потокам мультимедиа, этот сценарий также поддерживается. Существует два типа обработки мультимедиа:

* **Носитель,** размещенный в службе: боты фокусируются на управлении рабочим процессом приложения, например маршрутизации вызовов и разгрузке обработки звука на платформу мультимедиа Майкрософт в режиме реального времени. С помощью носителя, размещенного в службе, вы можете реализовать и разместить бот несколькими способами. Бот для мультимедийного содержимого, размещенного в службе, можно реализовать в виде службы без отслеживания состояния, так как он не обрабатывает мультимедиа в локальном расположении. Боты мультимедиа, размещенные в службе, могут использовать следующие API:

  * `PlayPrompt` для воспроизведения звукового клипа.
  * `Record` для записи звуковых клипов.
  * `SubscribeToTone` для подписки на двойной тон с несколькими тонами частоты (DTMF).

    Например, если пользователь нажал **0** , чтобы связаться с оператором.

* **Носитель, размещенный** в приложении: для получения ботом прямого доступа к носителу ему требуется определенное Graph доступа. После того как у бота есть разрешение[](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), библиотека мультимедиа в режиме реального времени и пакет [SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder) для Graph вызовов помогают создавать полнофункциональные носители в режиме реального времени и вызывать ботов. Бот, размещенный в приложении, должен располагаться в среде Windows. Дополнительные сведения см. [в разделе о ботах мультимедиа, размещаемых в приложениях](./requirements-considerations-application-hosted-media-bots.md).

## <a name="code-sample"></a>Пример кода

| **Название примера** | **Описание** | **Microsoft Graph** |
|---------------|----------|--------|
| Graph связи | Graph взаимодействия для взаимодействия с платформой связи Майкрософт. | [View](https://github.com/microsoftgraph/microsoft-graph-comms-samples) |

## <a name="next-step"></a>Следующий этап

> [!div class="nextstepaction"]
> [Звонки и собрания в реальном времени](~/bots/calls-and-meetings/real-time-media-concepts.md)

## <a name="see-also"></a>См. также

* [API Graph справки](/graph/api/resources/communications-api-overview?view=graph-rest-beta&preserve-view=true)
* [Примеры приложений](https://github.com/microsoftgraph/microsoft-graph-comms-samples)
* [Регистрация бота, который поддерживает звонки и собрания по сети](./registering-calling-bot.md)
* [Graph разрешения для звонков и онлайн-ботов собраний](./registering-calling-bot.md#add-graph-permissions)
* [Разработка ботов для звонков и собраний по сети на компьютере](./debugging-local-testing-calling-meeting-bots.md)
* [Требования и рекомендации для ботов мультимедиа, размещаемых в приложениях](./requirements-considerations-application-hosted-media-bots.md)
* [Техническая информация об обработке уведомлений о входящих звонках](./call-notifications.md)
* [Настройка автосекретаря](/microsoftteams/create-a-phone-system-auto-attendant)
* [Настройка автоматического ответа для Комнаты Microsoft Teams на устройствах с Teams телефонов](/microsoftteams/set-up-auto-answer-on-teams-android)
* [Teams записи](/MicrosoftTeams/teams-recording-policy)