---
title: Требования и рекомендации для Боты мультимедиа, размещаемых в приложении
description: Важные требования и вопросы, связанные с созданием носителей боты с размещением приложений для Microsoft Teams.
keywords: Виртуальная машина Windows Server Azure с размещением в приложении
ms.date: 11/16/2018
ms.openlocfilehash: f5b721edacb11e867d05c8213b74036cb51f419c
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675329"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a><span data-ttu-id="50dd5-104">Требования и рекомендации для Боты мультимедиа, размещаемых в приложении</span><span class="sxs-lookup"><span data-stu-id="50dd5-104">Requirements and considerations for application-hosted media bots</span></span>

<span data-ttu-id="50dd5-105">Не все рекомендации по разработке обмена сообщениями и интерактивным голосовым ответом (IVR) боты применяются одинаково к созданию мультимедийных Боты, размещаемых в приложении.</span><span class="sxs-lookup"><span data-stu-id="50dd5-105">Not all guidance for developing messaging and Interactive Voice Response (IVR) bots applies equally to building application-hosted media bots.</span></span> <span data-ttu-id="50dd5-106">В этой статье описываются некоторые важные требования и рекомендации по разработке и запуску приложения Media Bot.</span><span class="sxs-lookup"><span data-stu-id="50dd5-106">This article describes some of the important requirements and considerations for developing and running an application-hosted media bot.</span></span>

> [!NOTE]
> <span data-ttu-id="50dd5-107">Так как платформа мультимедиа Microsoft реального времени для Боты находится в предварительной версии для разработчиков, рекомендации, приведенные в этой статье, могут быть изменены.</span><span class="sxs-lookup"><span data-stu-id="50dd5-107">Because the Microsoft Real-time Media Platform for Bots is in developer preview, the guidance in this article is subject to change.</span></span>

## <a name="application-hosted-media-bot-development-requires-cnet-and-windows-server"></a><span data-ttu-id="50dd5-108">Для разработки почтовых приложений, размещаемых в приложении, требуется C#/.нет и Windows Server</span><span class="sxs-lookup"><span data-stu-id="50dd5-108">Application-hosted media bot development requires C#/.NET and Windows Server</span></span>

- <span data-ttu-id="50dd5-109">Для почтовых роботов, размещаемых в приложении, требуется библиотека `Microsoft.Graph.Communications.Calls.Media` .NET ([доступная здесь](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) для доступа к потокам аудио-и видеоданных, а программа-Bot должна быть развернута на компьютере с Windows Server (или в гостевой ОС Windows Server в Azure).</span><span class="sxs-lookup"><span data-stu-id="50dd5-109">An application-hosted media bot requires the `Microsoft.Graph.Communications.Calls.Media` .NET library ([available here](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) to access the audio and video media streams, and the bot must be deployed on a Windows Server machine (or Windows Server guest OS in Azure).</span></span> <span data-ttu-id="50dd5-110">Таким образом, для начала необходимо разработать язык C#, а также стандартную платформу .NET Framework и развернуть ее в Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="50dd5-110">Therefore, the bot must be developed in C# and the standard .NET Framework and deployed in Microsoft Azure.</span></span> <span data-ttu-id="50dd5-111">Вы не можете использовать API C++ или Node. js для доступа к мультимедиа в реальном времени и .NET Core не поддерживается для размещаемого в приложении робота-робота.</span><span class="sxs-lookup"><span data-stu-id="50dd5-111">You can't use C++ or Node.js APIs to access real-time media and .NET Core is not supported for an application-hosted media bot.</span></span>

- <span data-ttu-id="50dd5-112">Размещаемая в приложении Bot робота может быть размещена в одной из следующих сред службы Azure:</span><span class="sxs-lookup"><span data-stu-id="50dd5-112">An application-hosted media bot can be hosted within one of the following Azure service environments:</span></span>
  - <span data-ttu-id="50dd5-113">Облачная служба.</span><span class="sxs-lookup"><span data-stu-id="50dd5-113">Cloud Service.</span></span>
  - <span data-ttu-id="50dd5-114">Fabric Service Sets (ВМСС).</span><span class="sxs-lookup"><span data-stu-id="50dd5-114">Service Fabric with Virtual Machine Scale Sets (VMSS).</span></span>
  - <span data-ttu-id="50dd5-115">Инфраструктура как виртуальная машина (ВМ).</span><span class="sxs-lookup"><span data-stu-id="50dd5-115">Infrastructure as a Service (IaaS) Virtual Machine (VM).</span></span>  
  
- <span data-ttu-id="50dd5-116">Размещаемый в приложении робот не может быть развернут в качестве веб-приложения Azure.</span><span class="sxs-lookup"><span data-stu-id="50dd5-116">An application-hosted media bot can't be deployed as an Azure Web App.</span></span>

- <span data-ttu-id="50dd5-117">Размещенный на размещенном приложении робот должен работать на последней версии библиотеки `Microsoft.Graph.Communications.Calls.Media` .NET.</span><span class="sxs-lookup"><span data-stu-id="50dd5-117">An application-hosted media bot must be running on a recent version of the `Microsoft.Graph.Communications.Calls.Media` .NET library.</span></span> <span data-ttu-id="50dd5-118">В интерфейсе робота должен использоваться либо последняя доступная версия [пакета NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), либо версия, не превышающая три месяца.</span><span class="sxs-lookup"><span data-stu-id="50dd5-118">The bot should use either the newest available version of the [NuGet package](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), or a version that is not more than three months old.</span></span> <span data-ttu-id="50dd5-119">Более ранние версии библиотеки станут устаревшими и могут не работать по истечении нескольких месяцев.</span><span class="sxs-lookup"><span data-stu-id="50dd5-119">Older versions of the library will be deprecated and may not work after a few months.</span></span> <span data-ttu-id="50dd5-120">Поддержание актуальности `Microsoft.Graph.Communications.Calls.Media` библиотеки обеспечит оптимальное взаимодействие между Bot и Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="50dd5-120">Keeping the `Microsoft.Graph.Communications.Calls.Media` library up-to-date will ensure the best interoperability between the bot and Microsoft Teams.</span></span>

## <a name="real-time-media-calls-stay-on-the-machine-where-they-were-created"></a><span data-ttu-id="50dd5-121">Звонки мультимедиа реального времени остаются на том компьютере, на котором они были созданы.</span><span class="sxs-lookup"><span data-stu-id="50dd5-121">Real-time media calls stay on the machine where they were created</span></span>

- <span data-ttu-id="50dd5-122">Вызов мультимедиа в режиме реального времени закреплен на экземпляре виртуальной машины, который принял или инициировал вызов.</span><span class="sxs-lookup"><span data-stu-id="50dd5-122">A real-time media call is pinned to the virtual machine (VM) instance that accepted or started the call.</span></span> <span data-ttu-id="50dd5-123">Носители, поступающие из вызовов или собраний Microsoft Teams, будут передаваться на этот экземпляр виртуальной машины, а носители, отправляемые в Microsoft Teams, также должны исходить из этой виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="50dd5-123">Media from a Microsoft Teams call or meeting will flow to that VM instance, and media the bot sends back to Microsoft Teams must also originate from that VM.</span></span>
- <span data-ttu-id="50dd5-124">Если при остановке виртуальной машины выполняется любой вызов мультимедиа в реальном времени, эти вызовы будут остановлены.</span><span class="sxs-lookup"><span data-stu-id="50dd5-124">If there are any real-time media calls in progress when the VM is stopped, those calls will be abruptly terminated.</span></span> <span data-ttu-id="50dd5-125">Если в интерфейсе Bot имеются сведения о завершении выполнения ожидающей виртуальной машины, он может попробовать "корректно" завершить вызовы.</span><span class="sxs-lookup"><span data-stu-id="50dd5-125">If the bot has prior knowledge of the pending VM shutdown, it can try to "gracefully" end the calls.</span></span>

## <a name="application-hosted-media-bots-must-be-directly-accessible-on-the-internet"></a><span data-ttu-id="50dd5-126">Боты мультимедиа, размещаемые в приложении, должны быть доступны в Интернете напрямую</span><span class="sxs-lookup"><span data-stu-id="50dd5-126">Application-hosted media bots must be directly accessible on the internet</span></span>

- <span data-ttu-id="50dd5-127">Каждый экземпляр виртуальной машины, на котором размещена почтовая робота в Azure, должен быть напрямую доступен из Интернета с помощью общедоступного IP-адреса уровня экземпляра (ИЛПИП).</span><span class="sxs-lookup"><span data-stu-id="50dd5-127">Each VM instance hosting an application-hosted media bot in Azure must be directly accessible from the internet using an instance-level public IP address (ILPIP).</span></span>
  - <span data-ttu-id="50dd5-128">Для получения и настройки ИЛПИП для облачной службы Azure, ознакомьтесь с [обзором общедоступный IP-адрес на уровне экземпляра (классический)](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span><span class="sxs-lookup"><span data-stu-id="50dd5-128">For obtaining and configuring an ILPIP for an Azure Cloud Service, see [Instance level public IP (Classic) overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span></span>
  - <span data-ttu-id="50dd5-129">Для настройки ИЛПИП для набора масштабирования ВИРТУАЛЬНЫХ [машин просмотрите общедоступный IPv4 на виртуальной машине](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="50dd5-129">For configuring an ILPIP for a VM Scale Set, see [Public IPv4 per virtual machine](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span></span>
- <span data-ttu-id="50dd5-130">Служба, на которой размещено устройство робота, на котором размещено приложение, также должна настраивать каждый экземпляр виртуальной машины с общедоступным портом, который сопоставляется с определенным экземпляром.</span><span class="sxs-lookup"><span data-stu-id="50dd5-130">The service hosting an application-hosted media bot must also configure each VM instance with a public-facing port which maps to the specific instance.</span></span>
  - <span data-ttu-id="50dd5-131">Для облачной службы Azure для этого требуется входная конечная точка экземпляра. в этой статье приведены [сведения о включении связи для экземпляров ролей в Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span><span class="sxs-lookup"><span data-stu-id="50dd5-131">For an Azure Cloud Service, this requires an instance input endpoint; see [Enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span></span>
  - <span data-ttu-id="50dd5-132">Для набора масштабирования VM необходимо настроить правило NAT в подсистеме балансировки нагрузки; Ознакомьтесь [с виртуальными сетями и виртуальными машинами в Azure](/azure/virtual-machines/windows/network-overview).</span><span class="sxs-lookup"><span data-stu-id="50dd5-132">For a VM Scale Set, a NAT rule on the load balancer must be configured; see [Virtual networks and virtual machines in Azure](/azure/virtual-machines/windows/network-overview).</span></span>
- <span data-ttu-id="50dd5-133">Боты мультимедиа, размещаемые в приложении, не поддерживаются эмулятором Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="50dd5-133">Application-hosted media bots aren't supported by the Bot Framework Emulator.</span></span>

## <a name="scalability-and-performance-considerations"></a><span data-ttu-id="50dd5-134">Рекомендации по масштабируемости и производительности</span><span class="sxs-lookup"><span data-stu-id="50dd5-134">Scalability and performance considerations</span></span>

- <span data-ttu-id="50dd5-135">Для среды Боты, размещаемой в приложении, требуется больше вычислительной мощности и сети (пропускной способности), чем для Боты системы обмена сообщениями и может значительно повысить эксплуатационные расходы</span><span class="sxs-lookup"><span data-stu-id="50dd5-135">Application-hosted media bots require more compute and network (bandwidth) capacity than messaging bots and may incur significantly higher operational costs.</span></span> <span data-ttu-id="50dd5-136">Разработчик Media Bot в режиме реального времени должен тщательно измерять масштабируемость Bot и гарантировать, что она не принимает более одновременных вызовов, чем она может управлять.</span><span class="sxs-lookup"><span data-stu-id="50dd5-136">A real-time media bot developer must carefully measure the bot's scalability, and ensure the bot doesn't accept more simultaneous calls than it can manage.</span></span> <span data-ttu-id="50dd5-137">С помощью видеоролика, поддерживающего видео, может поддерживаться только один или два одновременных сеанса мультимедиа на ядро ЦП (при использовании "RAW" RGB24 или NV12 Video Format).</span><span class="sxs-lookup"><span data-stu-id="50dd5-137">A video-enabled bot may be able to sustain only one or two concurrent media sessions per CPU core (if using the "raw" RGB24 or NV12 video formats).</span></span>
- <span data-ttu-id="50dd5-138">В настоящее время на платформе мультимедиа в режиме реального времени не используются все графические процессоры, доступные в виртуальной машине, для отключения кодирования и декодирования изображения H. 264.</span><span class="sxs-lookup"><span data-stu-id="50dd5-138">The Real-time Media Platform doesn't currently take advantage of any Graphics Processing Units (GPU) available on the VM to off-load H.264 video encoding/decoding.</span></span> <span data-ttu-id="50dd5-139">Вместо этого кодирование и декодирование видео выполняется программно на ЦП.</span><span class="sxs-lookup"><span data-stu-id="50dd5-139">Instead, video encode and decode are done in software on the CPU.</span></span> <span data-ttu-id="50dd5-140">Если доступен графический процессор, Bot может использовать его для собственной отрисовки графики (например, если для ленты используется модуль 3D Graphics).</span><span class="sxs-lookup"><span data-stu-id="50dd5-140">If a GPU is available, the bot may take advantage of it for its own graphics rendering (e.g. if the bot is using a 3D graphics engine).</span></span>
- <span data-ttu-id="50dd5-141">Экземпляр виртуальной машины, на котором размещен канал мультимедиа Bot в режиме реального времени, должен иметь по крайней мере 2 ядра процессора.</span><span class="sxs-lookup"><span data-stu-id="50dd5-141">The VM instance hosting the real-time media bot must have at least 2 CPU cores.</span></span> <span data-ttu-id="50dd5-142">Для Azure рекомендуется использовать виртуальную машину Dv2-Series.</span><span class="sxs-lookup"><span data-stu-id="50dd5-142">For Azure, a Dv2-series virtual machine is recommended.</span></span> <span data-ttu-id="50dd5-143">Для других типов ВМ Azure система с 4 виртуальными процессорами (Вкпу) является минимальным требуемым размером.</span><span class="sxs-lookup"><span data-stu-id="50dd5-143">For other Azure VM types, a system with 4 virtual CPUs (vCPU) is the minimum size required.</span></span> <span data-ttu-id="50dd5-144">Подробные сведения о типах виртуальных машин Azure доступны в [документации по Azure](/azure/virtual-machines/windows/sizes-general).</span><span class="sxs-lookup"><span data-stu-id="50dd5-144">Detailed information about Azure VM types is available in the [Azure documentation](/azure/virtual-machines/windows/sizes-general).</span></span>

## <a name="samples-and-additional-resources"></a><span data-ttu-id="50dd5-145">Примеры и дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="50dd5-145">Samples and Additional Resources</span></span>

- [<span data-ttu-id="50dd5-146">Примеры приложений</span><span class="sxs-lookup"><span data-stu-id="50dd5-146">Sample applications</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [<span data-ttu-id="50dd5-147">Документация по вызовам Graph в комплекте SDK</span><span class="sxs-lookup"><span data-stu-id="50dd5-147">Graph Calling SDK Documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)
