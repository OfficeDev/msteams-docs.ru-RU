---
title: Требования и рекомендации для Боты мультимедиа, размещаемых в приложении
description: Важные требования и вопросы, связанные с созданием носителей боты с размещением приложений для Microsoft Teams.
keywords: Виртуальная машина Windows Server Azure с размещением в приложении
ms.date: 11/16/2018
ms.openlocfilehash: f5b721edacb11e867d05c8213b74036cb51f419c
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675329"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a>Требования и рекомендации для Боты мультимедиа, размещаемых в приложении

Не все рекомендации по разработке обмена сообщениями и интерактивным голосовым ответом (IVR) боты применяются одинаково к созданию мультимедийных Боты, размещаемых в приложении. В этой статье описываются некоторые важные требования и рекомендации по разработке и запуску приложения Media Bot.

> [!NOTE]
> Так как платформа мультимедиа Microsoft реального времени для Боты находится в предварительной версии для разработчиков, рекомендации, приведенные в этой статье, могут быть изменены.

## <a name="application-hosted-media-bot-development-requires-cnet-and-windows-server"></a>Для разработки почтовых приложений, размещаемых в приложении, требуется C#/.нет и Windows Server

- Для почтовых роботов, размещаемых в приложении, требуется библиотека `Microsoft.Graph.Communications.Calls.Media` .NET ([доступная здесь](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) для доступа к потокам аудио-и видеоданных, а программа-Bot должна быть развернута на компьютере с Windows Server (или в гостевой ОС Windows Server в Azure). Таким образом, для начала необходимо разработать язык C#, а также стандартную платформу .NET Framework и развернуть ее в Microsoft Azure. Вы не можете использовать API C++ или Node. js для доступа к мультимедиа в реальном времени и .NET Core не поддерживается для размещаемого в приложении робота-робота.

- Размещаемая в приложении Bot робота может быть размещена в одной из следующих сред службы Azure:
  - Облачная служба.
  - Fabric Service Sets (ВМСС).
  - Инфраструктура как виртуальная машина (ВМ).  
  
- Размещаемый в приложении робот не может быть развернут в качестве веб-приложения Azure.

- Размещенный на размещенном приложении робот должен работать на последней версии библиотеки `Microsoft.Graph.Communications.Calls.Media` .NET. В интерфейсе робота должен использоваться либо последняя доступная версия [пакета NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), либо версия, не превышающая три месяца. Более ранние версии библиотеки станут устаревшими и могут не работать по истечении нескольких месяцев. Поддержание актуальности `Microsoft.Graph.Communications.Calls.Media` библиотеки обеспечит оптимальное взаимодействие между Bot и Microsoft Teams.

## <a name="real-time-media-calls-stay-on-the-machine-where-they-were-created"></a>Звонки мультимедиа реального времени остаются на том компьютере, на котором они были созданы.

- Вызов мультимедиа в режиме реального времени закреплен на экземпляре виртуальной машины, который принял или инициировал вызов. Носители, поступающие из вызовов или собраний Microsoft Teams, будут передаваться на этот экземпляр виртуальной машины, а носители, отправляемые в Microsoft Teams, также должны исходить из этой виртуальной машины.
- Если при остановке виртуальной машины выполняется любой вызов мультимедиа в реальном времени, эти вызовы будут остановлены. Если в интерфейсе Bot имеются сведения о завершении выполнения ожидающей виртуальной машины, он может попробовать "корректно" завершить вызовы.

## <a name="application-hosted-media-bots-must-be-directly-accessible-on-the-internet"></a>Боты мультимедиа, размещаемые в приложении, должны быть доступны в Интернете напрямую

- Каждый экземпляр виртуальной машины, на котором размещена почтовая робота в Azure, должен быть напрямую доступен из Интернета с помощью общедоступного IP-адреса уровня экземпляра (ИЛПИП).
  - Для получения и настройки ИЛПИП для облачной службы Azure, ознакомьтесь с [обзором общедоступный IP-адрес на уровне экземпляра (классический)](/azure/virtual-network/virtual-networks-instance-level-public-ip).
  - Для настройки ИЛПИП для набора масштабирования ВИРТУАЛЬНЫХ [машин просмотрите общедоступный IPv4 на виртуальной машине](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).
- Служба, на которой размещено устройство робота, на котором размещено приложение, также должна настраивать каждый экземпляр виртуальной машины с общедоступным портом, который сопоставляется с определенным экземпляром.
  - Для облачной службы Azure для этого требуется входная конечная точка экземпляра. в этой статье приведены [сведения о включении связи для экземпляров ролей в Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).
  - Для набора масштабирования VM необходимо настроить правило NAT в подсистеме балансировки нагрузки; Ознакомьтесь [с виртуальными сетями и виртуальными машинами в Azure](/azure/virtual-machines/windows/network-overview).
- Боты мультимедиа, размещаемые в приложении, не поддерживаются эмулятором Bot Framework.

## <a name="scalability-and-performance-considerations"></a>Рекомендации по масштабируемости и производительности

- Для среды Боты, размещаемой в приложении, требуется больше вычислительной мощности и сети (пропускной способности), чем для Боты системы обмена сообщениями и может значительно повысить эксплуатационные расходы Разработчик Media Bot в режиме реального времени должен тщательно измерять масштабируемость Bot и гарантировать, что она не принимает более одновременных вызовов, чем она может управлять. С помощью видеоролика, поддерживающего видео, может поддерживаться только один или два одновременных сеанса мультимедиа на ядро ЦП (при использовании "RAW" RGB24 или NV12 Video Format).
- В настоящее время на платформе мультимедиа в режиме реального времени не используются все графические процессоры, доступные в виртуальной машине, для отключения кодирования и декодирования изображения H. 264. Вместо этого кодирование и декодирование видео выполняется программно на ЦП. Если доступен графический процессор, Bot может использовать его для собственной отрисовки графики (например, если для ленты используется модуль 3D Graphics).
- Экземпляр виртуальной машины, на котором размещен канал мультимедиа Bot в режиме реального времени, должен иметь по крайней мере 2 ядра процессора. Для Azure рекомендуется использовать виртуальную машину Dv2-Series. Для других типов ВМ Azure система с 4 виртуальными процессорами (Вкпу) является минимальным требуемым размером. Подробные сведения о типах виртуальных машин Azure доступны в [документации по Azure](/azure/virtual-machines/windows/sizes-general).

## <a name="samples-and-additional-resources"></a>Примеры и дополнительные ресурсы

- [Примеры приложений](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [Документация по вызовам Graph в комплекте SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)
