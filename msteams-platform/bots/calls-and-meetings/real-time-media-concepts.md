---
title: Вызовы мультимедиа в режиме реального времени и встречи с Microsoft Teams
description: Понимание ключевых понятий в создании бота, который может проводить аудио- и видеозвоки в режиме реального времени, а также собрания в Интернете.
ms.topic: conceptual
localization_priority: Normal
keywords: аудиопоток видеопотока аудио- и видеосвязи собрания в режиме реального времени мультимедиа-приложений, размещенной в средствах массовой информации, размещенной в средствах массовой информации
ms.openlocfilehash: deedc47f67fe6848cf7f84457247d2271257e3f0
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020157"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a><span data-ttu-id="783b5-104">Вызовы и встречи с Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="783b5-104">Real-time media calls and meetings with Microsoft Teams</span></span>

<span data-ttu-id="783b5-105">Медиаплатформа в режиме реального времени позволяет ботам взаимодействовать с Microsoft Teams и собраниями с помощью обмена голосом, видео и экранами в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="783b5-105">The Real-time Media Platform enables bots to interact with Microsoft Teams calls and meetings using real-time voice, video, and screen sharing.</span></span> <span data-ttu-id="783b5-106">Это расширенный потенциал, который позволяет боту отправлять и получать кадр голосового и видеоконтента по кадру.</span><span class="sxs-lookup"><span data-stu-id="783b5-106">This is an advanced capability that allows the bot to send and receive voice and video content frame by frame.</span></span> <span data-ttu-id="783b5-107">Бот имеет необработанные доступ к потокам мультимедиа для обмена голосом, видео и экранами.</span><span class="sxs-lookup"><span data-stu-id="783b5-107">The bot has raw access to the voice, video, and screen sharing media streams.</span></span> <span data-ttu-id="783b5-108">Существуют более простые медиа-боты, которые используют медиаплатформу в режиме реального времени для всех средств обработки мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="783b5-108">There are simpler service-hosted media bots that rely on the Real-time Media Platform for all media processing.</span></span> <span data-ttu-id="783b5-109">Боты, которые сами обработать носители, называются медиа-ботами с хостингом приложений.</span><span class="sxs-lookup"><span data-stu-id="783b5-109">Bots that process media themselves are called application-hosted media bots.</span></span>

<span data-ttu-id="783b5-110">Например, при вызове 1:1 с ботом, как говорит пользователь, бот получает 50 аудиорамок в секунду, каждый кадр содержит 20 миллисекунд (ms) звука.</span><span class="sxs-lookup"><span data-stu-id="783b5-110">For example, in a 1:1 call with a bot, as the user speaks, the bot receives 50 audio frames per second, with each frame containing 20 milliseconds (ms) of audio.</span></span> <span data-ttu-id="783b5-111">В режиме реального времени при приеме аудиокадров может выполняться распознавание речи в режиме реального времени, а не ждать записи после того, как пользователь перестает говорить.</span><span class="sxs-lookup"><span data-stu-id="783b5-111">An application-hosted media bot can perform real-time speech recognition as the audio frames are received, rather than having to wait for a recording after the user has stopped speaking.</span></span> <span data-ttu-id="783b5-112">Кроме того, бот может отправлять и получать видео с высоким разрешением, в том числе контент для совместного доступа к экранам на основе видео.</span><span class="sxs-lookup"><span data-stu-id="783b5-112">The bot can also send and receive high-definition-resolution video, including video-based screen sharing content.</span></span>

<span data-ttu-id="783b5-113">Платформа предоставляет простой API, похожий на розетку, для бота для отправки и получения мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="783b5-113">The platform provides a simple socket-like API for the bot to send and receive media.</span></span> <span data-ttu-id="783b5-114">Он обрабатывает кодировки и декодирования аудио- или видео пакетов в режиме реального времени с помощью кодеков, таких как SILK и G.722 для аудио и H.264 для видео.</span><span class="sxs-lookup"><span data-stu-id="783b5-114">It handles the real-time encoding and decoding of audio or video packets using codecs such as SILK and G.722 for audio and H.264 for video.</span></span> <span data-ttu-id="783b5-115">Платформа также обрабатывает все шифрование пакетов мультимедиа или расшифровку и передачу пакетов сети автоматически.</span><span class="sxs-lookup"><span data-stu-id="783b5-115">The platform also handles all media packet encryption or decryption and packet network transmission automatically.</span></span> <span data-ttu-id="783b5-116">Бот имеет дело только с фактическим аудио- или видеоконтентом.</span><span class="sxs-lookup"><span data-stu-id="783b5-116">The bot is only concerned with the actual audio or video content.</span></span> <span data-ttu-id="783b5-117">Медиа-бот в режиме реального времени участвует в вызовах 1:1, а также в собраниях с несколькими участниками.</span><span class="sxs-lookup"><span data-stu-id="783b5-117">A real-time media bot participates in 1:1 calls as well as meetings with multiple participants.</span></span>

## <a name="media-session"></a><span data-ttu-id="783b5-118">Сеанс мультимедиа</span><span class="sxs-lookup"><span data-stu-id="783b5-118">Media session</span></span>

<span data-ttu-id="783b5-119">Когда медиа-бот в режиме реального времени отвечает на входящий вызов или присоединяется к собранию Teams, он должен объявить, какие методы он должен поддерживать.</span><span class="sxs-lookup"><span data-stu-id="783b5-119">When a real-time media bot answers an incoming call or joins a Teams meeting, it must declare what modalities it must support.</span></span> <span data-ttu-id="783b5-120">Для каждого поддерживаемого модальности бот объявляет, может ли он отправлять и получать носителю, получать только или отправлять только.</span><span class="sxs-lookup"><span data-stu-id="783b5-120">For each supported modality, the bot declares whether it can send and receive media, receive only, or send only.</span></span> <span data-ttu-id="783b5-121">Например, бот, предназначенный для обработки вызовов 1:1 Teams, должен отправлять и получать звук, но только отправлять видео, так как для получения видео вызываемого не требуется.</span><span class="sxs-lookup"><span data-stu-id="783b5-121">For example, a bot designed to handle 1:1 Teams calls, requires to both send and receive audio, but only send video as it does not require to receive the video of the caller.</span></span> <span data-ttu-id="783b5-122">Набор режимов аудио- и видеосвязи, установленных между ботом и Teams или собранием, называется сеансом мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="783b5-122">The set of audio and video modalities established between the bot and the Teams caller or meeting is called the media session.</span></span>

<span data-ttu-id="783b5-123">Поддерживаются два типа видео- и видео- и видеоконференции.</span><span class="sxs-lookup"><span data-stu-id="783b5-123">Two types of video modalities are supported, main video and video-based screen sharing.</span></span> <span data-ttu-id="783b5-124">Основное видео используется для транспортировки видео с веб-камеры пользователя.</span><span class="sxs-lookup"><span data-stu-id="783b5-124">The main video is used to transport the video from a user's webcam.</span></span> <span data-ttu-id="783b5-125">Совместное использование экрана на основе видео позволяет пользователю делиться своим экраном в качестве видеопотока.</span><span class="sxs-lookup"><span data-stu-id="783b5-125">The video-based screen sharing allows a user to share his or her screen as a video stream.</span></span> <span data-ttu-id="783b5-126">Платформа позволяет боту отправлять и получать оба типа видео.</span><span class="sxs-lookup"><span data-stu-id="783b5-126">The platform allows a bot to send and receive both video types.</span></span>

<span data-ttu-id="783b5-127">Когда к собранию Teams, бот может получать несколько основных видеопотоков одновременно до десяти за сеанс мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="783b5-127">When joined to a Teams meeting, a bot can receive multiple main video streams simultaneously up to ten per media session.</span></span> <span data-ttu-id="783b5-128">Это позволяет боту видеть несколько участников собрания.</span><span class="sxs-lookup"><span data-stu-id="783b5-128">This allows the bot to see more than one participant in the meeting.</span></span>

<span data-ttu-id="783b5-129">В следующем разделе приводится подробная информация о отправке и получении средства массовой информации в качестве последовательности кадров.</span><span class="sxs-lookup"><span data-stu-id="783b5-129">The next section provides details about the bot sending and receiving media as a sequence of frames.</span></span>

## <a name="frames-and-frame-rate"></a><span data-ttu-id="783b5-130">Частота кадров и кадров</span><span class="sxs-lookup"><span data-stu-id="783b5-130">Frames and frame rate</span></span>

<span data-ttu-id="783b5-131">Медиа-бот в режиме реального времени напрямую взаимодействует с режимами аудио- и видеосвязи сеанса мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="783b5-131">A real-time media bot interacts directly with the audio and video modalities of a media session.</span></span> <span data-ttu-id="783b5-132">Это означает, что бот отправляет и получает носителю в качестве последовательности кадров, где каждый кадр представляет собой единицу контента.</span><span class="sxs-lookup"><span data-stu-id="783b5-132">This means the bot is sending and receiving media as a sequence of frames, where each frame represents a unit of content.</span></span> <span data-ttu-id="783b5-133">Одна секунда звука передается в качестве последовательности из 50 кадров, каждый кадр содержит 20 мс, что составляет 1/50 секунды содержимого речи.</span><span class="sxs-lookup"><span data-stu-id="783b5-133">One second of audio is transmitted as a sequence of 50 frames, with each frame containing 20 ms that is 1/50th of a second of speech content.</span></span> <span data-ttu-id="783b5-134">Одна секунда видео передается в качестве последовательности из 30 неуявных изображений, каждая из которых предназначена для просмотра всего за 33,3 мс, что составляет 1/30 секунды до отображения следующего кадра видео.</span><span class="sxs-lookup"><span data-stu-id="783b5-134">One second of video is transmitted as a sequence of 30 still images, each intended to be viewed for just 33.3 ms that is 1/30th of a second before the next video frame is displayed.</span></span> <span data-ttu-id="783b5-135">Количество передаваемых или отрисовок кадров в секунду называется частотой кадров.</span><span class="sxs-lookup"><span data-stu-id="783b5-135">The number of frames transmitted or rendered per second is called the frame rate.</span></span>

<span data-ttu-id="783b5-136">В следующем разделе приводится подробная информация о аудио- и видеоформате, используемом для звонков и собраний в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="783b5-136">The next section provides details about the audio and video format used in real-time media calls and meetings.</span></span>

## <a name="audio-and-video-format"></a><span data-ttu-id="783b5-137">Формат аудио и видео</span><span class="sxs-lookup"><span data-stu-id="783b5-137">Audio and video format</span></span>

<span data-ttu-id="783b5-138">В аудиоформате каждая секунда звука представлена в виде 16 000 образцов, каждый пример которых содержит 16-битные данные.</span><span class="sxs-lookup"><span data-stu-id="783b5-138">In audio format, each second of audio is represented as 16,000 samples, with each sample containing 16-bits of data.</span></span> <span data-ttu-id="783b5-139">Аудиорамка 20 мс содержит 320 образцов, что составляет 640 bytes данных.</span><span class="sxs-lookup"><span data-stu-id="783b5-139">A 20 ms audio frame contains 320 samples that is 640 bytes of data.</span></span>

<span data-ttu-id="783b5-140">В формате видео поддерживаются несколько форматов.</span><span class="sxs-lookup"><span data-stu-id="783b5-140">In video format, several formats are supported.</span></span> <span data-ttu-id="783b5-141">Двумя ключевыми свойствами формата видео являются размер кадра и цветной формат.</span><span class="sxs-lookup"><span data-stu-id="783b5-141">Two key properties of a video format are its frame size and color format.</span></span> <span data-ttu-id="783b5-142">Поддерживаемые размеры кадров включают 640x360, то есть 360 пикселей, 1280x720 — 720 пикселей, а 1920x1080 — 1080 пикселей.</span><span class="sxs-lookup"><span data-stu-id="783b5-142">Supported frame sizes include 640x360 that is 360 pixels, 1280x720 that is 720 pixels, and 1920x1080 that is 1080 pixels.</span></span> <span data-ttu-id="783b5-143">Поддерживаемые цветовые форматы включают NV12 размером 12 бит на пиксель и RGB24 — 24 бита на пиксель.</span><span class="sxs-lookup"><span data-stu-id="783b5-143">Supported color formats include NV12 that is 12 bits per pixel and RGB24 that is 24 bits per pixel.</span></span>

<span data-ttu-id="783b5-144">Видеокадр 720p содержит 921 600 пикселей, что в 1280 раз больше 720 пикселей.</span><span class="sxs-lookup"><span data-stu-id="783b5-144">A 720p video frame contains 921,600 pixels that is 1280 times 720.</span></span> <span data-ttu-id="783b5-145">В цветовом формате RGB24 каждый пиксель представлен в виде 3-битных 24-битных компоненты красного, зеленого и синего цветов.</span><span class="sxs-lookup"><span data-stu-id="783b5-145">In the RGB24 color format, each pixel is represented as 3 bytes that is 24-bits comprised of one byte each of red, green, and blue color components.</span></span> <span data-ttu-id="783b5-146">Таким образом, для одной видеокадры RGB24 с объемом 720p требуется 2 764 800 бет данных, что составляет 921 600 пикселей, а это 3 б.п. на пиксель.</span><span class="sxs-lookup"><span data-stu-id="783b5-146">Therefore, a single 720p RGB24 video frame requires 2,764,800 bytes of data that is 921,600 pixels times 3 bytes per pixel.</span></span> <span data-ttu-id="783b5-147">При частоте кадров 30 fps отправка видеорамок RGB24 720p означает обработку примерно 80 мегабайт в секунду контента, который существенно сжимается видео-кодеком H.264 перед сетевой передачей.</span><span class="sxs-lookup"><span data-stu-id="783b5-147">At a frame rate of 30 fps, sending 720p RGB24 video frames means processing approximately 80 megabytes per second of content, which is substantially compressed by the H.264 video codec before network transmission.</span></span>

<span data-ttu-id="783b5-148">Расширенные возможности платформы позволяют боту отправлять или получать видео в качестве закодированной кадров H.264.</span><span class="sxs-lookup"><span data-stu-id="783b5-148">An advanced capability of the platform allows a bot to send or receive video as encoded H.264 frames.</span></span> <span data-ttu-id="783b5-149">Это поддерживает ботов, которые предоставляют собственный коддер или декодер H.264 или не требуют декодирования видеопотока в необработанные битм-карты RGB24 или NV12.</span><span class="sxs-lookup"><span data-stu-id="783b5-149">This supports bots which provide their own H.264 encoder or decoder, or do not require the video stream decoded into raw RGB24 or NV12 bitmaps.</span></span>

<span data-ttu-id="783b5-150">В следующем разделе приводится подробная информация о том, какие участники собрания говорят, которые являются активными и доминирующими ораторами.</span><span class="sxs-lookup"><span data-stu-id="783b5-150">The next section provides details about which meeting participants are speaking that is which are active and dominant speakers.</span></span>

## <a name="active-and-dominant-speakers"></a><span data-ttu-id="783b5-151">Активные и доминирующие динамики</span><span class="sxs-lookup"><span data-stu-id="783b5-151">Active and dominant speakers</span></span>

<span data-ttu-id="783b5-152">Когда к собранию Teams, состоящему из нескольких участников, бот может определить, какие участники собрания в настоящее время говорят.</span><span class="sxs-lookup"><span data-stu-id="783b5-152">When joined to a Teams meeting consisting of multiple participants, a bot can identify which meeting participants are currently speaking.</span></span> <span data-ttu-id="783b5-153">Активные динамики определяют, какие участники слышны в каждом полученном звуковом кадре.</span><span class="sxs-lookup"><span data-stu-id="783b5-153">Active speakers identify which participants are being heard in each received audio frame.</span></span> <span data-ttu-id="783b5-154">Доминирующие динамики определяют, какие участники в настоящее время являются наиболее активными или доминирующими в групповой беседе, даже если их голос не слышен в каждом звуковом кадре.</span><span class="sxs-lookup"><span data-stu-id="783b5-154">Dominant speakers identify which participants are currently most active or dominant in the group conversation, even though their voice is not heard in every audio frame.</span></span> <span data-ttu-id="783b5-155">Набор доминирующих динамиков может изменяться по мере того, как разные участники по очереди говорят.</span><span class="sxs-lookup"><span data-stu-id="783b5-155">The set of dominant speakers can change as different participants take turns speaking.</span></span>

<span data-ttu-id="783b5-156">В следующем разделе приводится подробная информация о запросах на подписку на видео, сделанных ботом.</span><span class="sxs-lookup"><span data-stu-id="783b5-156">The next section provides details about video subscription requests made by a bot.</span></span>

## <a name="video-subscription"></a><span data-ttu-id="783b5-157">Подписка на видео</span><span class="sxs-lookup"><span data-stu-id="783b5-157">Video subscription</span></span>

<span data-ttu-id="783b5-158">При вызове 1:1 бот автоматически получает видео вызываемого, если бот включен для получения видео.</span><span class="sxs-lookup"><span data-stu-id="783b5-158">In a 1:1 call, the bot automatically receives the video of the caller if the bot is enabled to receive the video.</span></span> <span data-ttu-id="783b5-159">Во время Teams, бот должен указать платформе, какие участники он хочет видеть.</span><span class="sxs-lookup"><span data-stu-id="783b5-159">In a Teams meeting, the bot must indicate to the platform which participants it wants to see.</span></span> <span data-ttu-id="783b5-160">Подписка на видео — это запрос бота на получение основного видео или контента для обмена экранами участника.</span><span class="sxs-lookup"><span data-stu-id="783b5-160">A video subscription is a request by the bot to receive a participant’s main video or screen-sharing content.</span></span> <span data-ttu-id="783b5-161">По мере того как участники собрания ведут беседу, бот изменяет нужные подписки на видео на основе обновлений доминирующего набора динамиков или уведомлений, указывающих, какой участник в настоящее время обменивается экранами.</span><span class="sxs-lookup"><span data-stu-id="783b5-161">As the participants in the meeting conduct their conversation, the bot modifies its desired video subscriptions based on updates of the dominant speaker set or notifications indicating which participant is currently screen sharing.</span></span>

<span data-ttu-id="783b5-162">В следующем разделе приводится подробная информация о том, что необходимо установить, а также требования к разработке медиа-бота с хостингом приложения.</span><span class="sxs-lookup"><span data-stu-id="783b5-162">The next section provides details about what you must install and the requirements to develop an application-hosted media bot.</span></span>

## <a name="developer-resources"></a><span data-ttu-id="783b5-163">Ресурсы разработчика</span><span class="sxs-lookup"><span data-stu-id="783b5-163">Developer resources</span></span>

<span data-ttu-id="783b5-164">Чтобы разработать медиа-бот с хостингом приложения, необходимо установить [Microsoft.Graph. Библиотека Calls.Media .NET NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) в рамках Visual Studio проекта.</span><span class="sxs-lookup"><span data-stu-id="783b5-164">To develop an application-hosted media bot, you must install the [Microsoft.Graph.Calls.Media .NET library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) NuGet package within your Visual Studio project.</span></span>

<span data-ttu-id="783b5-165">Для веб-ботов мультимедиа с приложениями требуется .NET или C# и Windows Server.</span><span class="sxs-lookup"><span data-stu-id="783b5-165">Application-hosted media bots require .NET or C# and Windows Server.</span></span> <span data-ttu-id="783b5-166">Дополнительные сведения см. в дополнительных сведениях о требованиях и соображениях к медийным ботам с [хостингом приложений.](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development)</span><span class="sxs-lookup"><span data-stu-id="783b5-166">For more information, see [requirements and considerations for application-hosted media bots](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development).</span></span>

## <a name="next-step"></a><span data-ttu-id="783b5-167">Следующий этап</span><span class="sxs-lookup"><span data-stu-id="783b5-167">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="783b5-168">Регистрация бота вызовов</span><span class="sxs-lookup"><span data-stu-id="783b5-168">Register a calling bot</span></span>](~/bots/calls-and-meetings/registering-calling-bot.md)
