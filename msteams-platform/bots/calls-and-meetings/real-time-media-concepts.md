---
title: Звонки и собрания по сети в реальном времени с помощью Microsoft Teams
description: Основные понятия, связанные с созданием Bot, которые могут выполнять голосовые и видеозвонки в режиме реального времени и собраний по сети.
keywords: поток аудио аудио-и видеоконференций для собраний мультимедиа в режиме реального времени, размещенной в службе мультимедиа
ms.openlocfilehash: 0ec99d1caa8810d292170c7c70a1518de7301873
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675330"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a><span data-ttu-id="4312a-104">Звонки и собрания в режиме реального времени с помощью Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="4312a-104">Real-time media calls and meetings with Microsoft Teams</span></span>

<span data-ttu-id="4312a-105">Платформа мультимедиа реального времени позволяет Боты взаимодействовать с вызовами и собраниями Microsoft Teams с помощью голосовой связи, видео и демонстрации экрана в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="4312a-105">The Real-time Media Platform enables bots to interact with Microsoft Teams calls and meetings using real-time voice, video, and screen sharing.</span></span> <span data-ttu-id="4312a-106">Это расширенная возможность, позволяющая интерфейсу Bot отправлять и принимать голосовые и видеоконтенты *по кадрам*.</span><span class="sxs-lookup"><span data-stu-id="4312a-106">This is an advanced capability which allows the bot to send and receive voice and video content *frame by frame*.</span></span> <span data-ttu-id="4312a-107">У Bot есть доступ к потокам мультимедиа голосовой, видео и экрана.</span><span class="sxs-lookup"><span data-stu-id="4312a-107">The bot has "raw" access to the voice, video, and screen sharing media streams.</span></span> <span data-ttu-id="4312a-108">(Боты, какие самоработающие носители называются _размещенными на сервере_ Боты, в отличие от более простых _размещенных в службах носителей_ Боты, которые полагаются на мультимедийную платформу реального времени для обработки мультимедиа.)</span><span class="sxs-lookup"><span data-stu-id="4312a-108">(Bots which process media themselves are called _application-hosted media_ bots, as opposed to simpler _service-hosted media_ bots that rely on the Real-time Media platform for all media processing.)</span></span>

<span data-ttu-id="4312a-109">Например, при вызове 1:1 с помощью Bot, когда пользователь говорит, Bot будет получать звуковые кадры 50 в секунду с каждым кадром, содержащим 20 миллисекунд (МС) звукового сигнала.</span><span class="sxs-lookup"><span data-stu-id="4312a-109">For example, in a 1:1 call with a bot, as the user speaks, the bot will receive 50 audio frames per second, with each frame containing 20 milliseconds (ms) of audio.</span></span> <span data-ttu-id="4312a-110">Размещаемый в приложении робот Media поддерживает распознавание речи в режиме реального времени при получении звуковых кадров, а не ждет записи после того, как пользователь перестает говориться.</span><span class="sxs-lookup"><span data-stu-id="4312a-110">An application-hosted media bot can perform real-time speech recognition as the audio frames are received, rather than having to wait for a recording after the user has stopped speaking.</span></span> <span data-ttu-id="4312a-111">С помощью Bot вы также можете отправлять и получать видео с разрешением высокого разрешения, в том числе видеоконтент для демонстрации экрана.</span><span class="sxs-lookup"><span data-stu-id="4312a-111">The bot can also send and receive high-definition-resolution video, including video-based screen sharing content.</span></span>

<span data-ttu-id="4312a-112">Платформа предоставляет простой API, подобный сокету, для отправки и получения носителей, а также поддерживает кодирование аудио-и видеосигналов в режиме реального времени с помощью кодеков, таких как SILK и G. 722 для аудио и H. 264 для видео.</span><span class="sxs-lookup"><span data-stu-id="4312a-112">The platform provides a simple socket-like API for the bot to send and receive media, and handles the real-time encoding and decoding of audio/video packets using codecs such as SILK and G.722 for audio and H.264 for video.</span></span> <span data-ttu-id="4312a-113">Платформа также обрабатывает все данные шифрования, расшифровки и расшифровки пакетов мультимедиа автоматически, поэтому программа-робот просто должна самостоятельно подделаться с реальными аудио-и видеоматериалами.</span><span class="sxs-lookup"><span data-stu-id="4312a-113">The platform also handles all media packet encryption/decryption and packet network transmission automatically, so the bot just needs to concern itself with the actual audio/video content.</span></span> <span data-ttu-id="4312a-114">Поносительный робот в реальном времени может участвовать в вызовах 1:1, а также собраниях с несколькими участниками.</span><span class="sxs-lookup"><span data-stu-id="4312a-114">A real-time media bot may participate in 1:1 calls as well as meetings with multiple participants.</span></span>

<span data-ttu-id="4312a-115">В этой статье описываются основные понятия, связанные с созданием Bot, который может выполнять аудио-и видеозвонки в режиме реального времени с помощью Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="4312a-115">This article introduces key concepts related to building a bot that can conduct real-time audio/video calls with Microsoft Teams.</span></span>

## <a name="media-session"></a><span data-ttu-id="4312a-116">Сеанс мультимедиа</span><span class="sxs-lookup"><span data-stu-id="4312a-116">Media session</span></span>

<span data-ttu-id="4312a-117">Когда поток мультимедиа Bot в реальном времени отвечает на входящий звонок или присоединяется к собранию Microsoft Teams, он должен объявлять, какую модальности он намеревается поддерживать.</span><span class="sxs-lookup"><span data-stu-id="4312a-117">When a real-time media bot answers an incoming call or joins a Microsoft Teams meeting, it must declare what modalities it intends to support.</span></span> <span data-ttu-id="4312a-118">Для каждого поддерживаемого модальности Bot указывает, может ли он отправлять и получать мультимедиа, только получение или только отправку.</span><span class="sxs-lookup"><span data-stu-id="4312a-118">For each supported modality, the bot declares whether it can send and receive media, receive only, or send only.</span></span> <span data-ttu-id="4312a-119">Например, Bot, предназначенный для обработки вызовов 1:1 Teams, могут отправлять и получать звук, а только *отправлять* видео (так как им не нужно получать видео абонента).</span><span class="sxs-lookup"><span data-stu-id="4312a-119">For example, a bot designed to handle 1:1 Teams calls may wish to both send and receive audio, but only *send* video (as it does not need to receive the video of the caller).</span></span> <span data-ttu-id="4312a-120">Набор аудио-и видеомодальности, установленный между Bot и вызывающим абонентом или собранием Teams, называется **сеансом мультимедиа**.</span><span class="sxs-lookup"><span data-stu-id="4312a-120">The set of audio and video modalities established between the bot and the Teams caller or meeting is called the **media session**.</span></span>

<span data-ttu-id="4312a-121">Поддерживаются два типа видео модальности: **основной** **Видеообмен и видео на основе видео**.</span><span class="sxs-lookup"><span data-stu-id="4312a-121">Two types of video modalities are supported: **main video** and **video-based screen sharing**.</span></span> <span data-ttu-id="4312a-122">Основное видео используется для передачи видео с веб-камеры пользователя.</span><span class="sxs-lookup"><span data-stu-id="4312a-122">Main video is used to transport the video from a user's webcam.</span></span> <span data-ttu-id="4312a-123">Средство демонстрации экрана с видео позволяет пользователю предоставлять общий доступ к экрану в виде видеопотока.</span><span class="sxs-lookup"><span data-stu-id="4312a-123">Video-based screen sharing allows a user to share his or her screen as a video stream.</span></span> <span data-ttu-id="4312a-124">Платформа позволяет использовать для отправки и/или приема *видеороликов* .</span><span class="sxs-lookup"><span data-stu-id="4312a-124">The platform allows a bot to send and/or receive *both* video types.</span></span>

<span data-ttu-id="4312a-125">Когда вы присоединяетесь к собранию Teams, Bot может одновременно получать несколько основных потоков видео — до 10 для каждого сеанса мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="4312a-125">When joined to a Teams meeting, a bot can receive multiple main video streams simultaneously — up to 10 per media session.</span></span> <span data-ttu-id="4312a-126">Это позволяет Bot "видеть" несколько участников собрания.</span><span class="sxs-lookup"><span data-stu-id="4312a-126">This allows the bot to "see" more than one participant in the meeting.</span></span>

## <a name="frames-and-frame-rate"></a><span data-ttu-id="4312a-127">Частота кадров и кадров</span><span class="sxs-lookup"><span data-stu-id="4312a-127">Frames and frame rate</span></span>

<span data-ttu-id="4312a-128">Media Bot в реальном времени взаимодействует напрямую с аудио и видео модальности сеанса мультимедиа.</span><span class="sxs-lookup"><span data-stu-id="4312a-128">A real-time media bot interacts directly with the audio and video modalities of a media session.</span></span> <span data-ttu-id="4312a-129">Это означает, что Bot отправляет и/или получает носитель в виде последовательности **кадров**, где каждый кадр представляет единицу содержимого.</span><span class="sxs-lookup"><span data-stu-id="4312a-129">This means the bot is sending and/or receiving media as a sequence of **frames**, where each frame represents a unit of content.</span></span> <span data-ttu-id="4312a-130">Одна секунда звука может быть передаваться в виде последовательности из 50 кадров, каждая из которых содержит 20 миллисекунд (МС) — 1/50-е секунды для речевого контента.</span><span class="sxs-lookup"><span data-stu-id="4312a-130">One second of audio may be transmitted as a sequence of 50 frames, with each frame containing 20 milliseconds (ms) —1/50th of a second — of speech content.</span></span> <span data-ttu-id="4312a-131">Одна секунда видео может быть разрезаться как последовательность из 30 неподвижных изображений, каждый из которых предназначен для просмотра только для 33.3 MS — 1/30-30 секунд — перед отображением следующего кадра видеосвязи.</span><span class="sxs-lookup"><span data-stu-id="4312a-131">One second worth of video may be sliced as a sequence of 30 still images, each intended to be viewed for just 33.3ms — 1/30th of a second — before the next video frame is displayed.</span></span> <span data-ttu-id="4312a-132">Количество кадров, передаваемых или отображаемых в секунду, называется **частотой кадров**.</span><span class="sxs-lookup"><span data-stu-id="4312a-132">The number of frames transmitted or rendered per second is called the **frame rate**.</span></span> <span data-ttu-id="4312a-133">"30fps" указывает 30 кадров в секунду.</span><span class="sxs-lookup"><span data-stu-id="4312a-133">"30fps" indicates 30 frames per second.</span></span>

## <a name="audio-format"></a><span data-ttu-id="4312a-134">Формат звука</span><span class="sxs-lookup"><span data-stu-id="4312a-134">Audio format</span></span>

<span data-ttu-id="4312a-135">Каждая секунда звука представлена **как 16 000-примерами**, каждый из которых содержит 16-разрядные данные.</span><span class="sxs-lookup"><span data-stu-id="4312a-135">Each second of audio is represented as 16,000 **samples**, with each sample containing 16-bits of data.</span></span> <span data-ttu-id="4312a-136">Звуковая рамка 20 мс содержит 320 образцов (640 байт данных).</span><span class="sxs-lookup"><span data-stu-id="4312a-136">A 20ms audio frame contains 320 samples (640 bytes of data).</span></span>

## <a name="video-format"></a><span data-ttu-id="4312a-137">Формат видео</span><span class="sxs-lookup"><span data-stu-id="4312a-137">Video format</span></span>

<span data-ttu-id="4312a-138">Для видео поддерживается несколько форматов.</span><span class="sxs-lookup"><span data-stu-id="4312a-138">There are several formats supported for video.</span></span> <span data-ttu-id="4312a-139">Двумя ключевыми свойствами видеоформата являются размер и **цветовой формат** **кадра** .</span><span class="sxs-lookup"><span data-stu-id="4312a-139">Two key properties of a video format are its **frame size** and **color format**.</span></span> <span data-ttu-id="4312a-140">Поддерживаемые размеры кадров включают 640x360 ("360p"), 1280x720 ("720p") и 1920x1080 ("1080p").</span><span class="sxs-lookup"><span data-stu-id="4312a-140">Supported frame sizes include 640x360 ("360p"), 1280x720 ("720p"), and 1920x1080 ("1080p").</span></span> <span data-ttu-id="4312a-141">Поддерживаемые цветовые форматы включают NV12 (12 бит на пиксель) и RGB24 (24 бита на пиксель).</span><span class="sxs-lookup"><span data-stu-id="4312a-141">Supported color formats include NV12 (12 bits per pixel) and RGB24 (24 bits per pixel).</span></span>

<span data-ttu-id="4312a-142">Видеокадр "720p" содержит 921 600 пикселей (1280 раз 720).</span><span class="sxs-lookup"><span data-stu-id="4312a-142">A "720p" video frame contains 921,600 pixels (1280 times 720).</span></span> <span data-ttu-id="4312a-143">В цветном формате RGB24 каждая точка представляется как 3 байта (24 бита), состоящие из одного байта, в каждом из компонентов красного, зеленого и синего цвета.</span><span class="sxs-lookup"><span data-stu-id="4312a-143">In the RGB24 color format, each pixel is represented as 3 bytes (24-bits) comprised of one byte each of red, green, and blue color components.</span></span> <span data-ttu-id="4312a-144">Таким образом, для одного кадра RGB24 видео 720p требуется 2 764 800 байт данных (921 600 пикселей по 3 байт/пиксель).</span><span class="sxs-lookup"><span data-stu-id="4312a-144">Therefore, a single 720p RGB24 video frame requires 2,764,800 bytes of data (921,600 pixels times 3 bytes/pixel).</span></span> <span data-ttu-id="4312a-145">При частоте кадров 30fps отправка 720p RGB24 видеокадров означает обработку примерно 80 МБ/с содержимого (которое значительно сжимается с помощью видеокодека H. 264 до передачи по сети).</span><span class="sxs-lookup"><span data-stu-id="4312a-145">At a frame rate of 30fps, sending 720p RGB24 video frames means processing approximately 80 MB/s of content (which is substantially compressed by the H.264 video codec before network transmission).</span></span>

<span data-ttu-id="4312a-146">Расширенная возможность платформы позволяет использовать для отправки и получения видеороликов в виде **закодированных** кадров H. 264.</span><span class="sxs-lookup"><span data-stu-id="4312a-146">An advanced capability of the platform allows a bot to send/receive video as **encoded** H.264 frames.</span></span> <span data-ttu-id="4312a-147">Это поддерживает Боты, которые предоставляют собственные кодировщики и декодеры H. 264 или не требуют декодирования видеопотока в необработанные изображения RGB24 или NV12.</span><span class="sxs-lookup"><span data-stu-id="4312a-147">This supports bots which provide their own H.264 encoder/decoder, or do not need the video stream decoded into raw RGB24 or NV12 bitmaps.</span></span>

## <a name="active-and-dominant-speakers"></a><span data-ttu-id="4312a-148">Активный и главный динамики</span><span class="sxs-lookup"><span data-stu-id="4312a-148">Active and dominant speakers</span></span>

<span data-ttu-id="4312a-149">При присоединении к собранию Teams, состоящей из нескольких участников, Bot могут определять, какие участники собрания в данный момент говорят.</span><span class="sxs-lookup"><span data-stu-id="4312a-149">When joined to a Teams meeting consisting of multiple participants, a bot can identify which meeting participants are currently speaking.</span></span> <span data-ttu-id="4312a-150">**Активные динамики** определяют, какие участники будут слышаться в каждом полученном звуковом кадре.</span><span class="sxs-lookup"><span data-stu-id="4312a-150">**Active speakers** identify which participants are being heard in each received audio frame.</span></span> <span data-ttu-id="4312a-151">**Доминирующие динамики** определяют, какие участники в настоящее время являются наиболее активными (или "главными") в беседе группы, хотя голосовые сообщения могут не присутствовать в каждом звуковом кадре.</span><span class="sxs-lookup"><span data-stu-id="4312a-151">**Dominant speakers** identify which participants are currently most active (or "dominant") in the group conversation, even though their voice may not be heard in every audio frame.</span></span> <span data-ttu-id="4312a-152">Набор доминирующего динамика может измениться по мере того, как они переходят на другой участник.</span><span class="sxs-lookup"><span data-stu-id="4312a-152">The set of dominant speakers can change as different participants take turns speaking.</span></span>

## <a name="video-subscription"></a><span data-ttu-id="4312a-153">Подписка на видео</span><span class="sxs-lookup"><span data-stu-id="4312a-153">Video subscription</span></span>

<span data-ttu-id="4312a-154">При вызове 1:1 Bot автоматически получает видео абонента, если для ленты включено получение видео.</span><span class="sxs-lookup"><span data-stu-id="4312a-154">In a 1:1 call, the bot will automatically receive the video of the caller if the bot is enabled to receive video.</span></span> <span data-ttu-id="4312a-155">В собрании Teams Bot должен указывать на платформу, для которой он хочет просмотреть.</span><span class="sxs-lookup"><span data-stu-id="4312a-155">In a Teams meeting, the bot must indicate to the platform which participants it wants to see.</span></span> <span data-ttu-id="4312a-156">**Видеоподписка** — это запрос, получающий основной ролик или общий доступ к содержимому участника с экрана.</span><span class="sxs-lookup"><span data-stu-id="4312a-156">A **video subscription** is a request by the bot to receive a participant’s main video or screen-sharing content.</span></span> <span data-ttu-id="4312a-157">По мере того как участники собрания выполняют свои беседы, Bot могут изменить свои подписку на видео на основе обновлений главного набора динамиков или уведомлений, указывающих на то, какой участник в данный момент использует общий доступ к экрану.</span><span class="sxs-lookup"><span data-stu-id="4312a-157">As the participants in the meeting conduct their conversation, the bot may modify its desired video subscriptions based on updates of the dominant speaker set or notifications indicating which participant is currently screen sharing.</span></span>

## <a name="developer-resources"></a><span data-ttu-id="4312a-158">Ресурсы для разработчиков</span><span class="sxs-lookup"><span data-stu-id="4312a-158">Developer resources</span></span>

<span data-ttu-id="4312a-159">Чтобы разработать размещенный в приложении робот, необходимо установить следующий пакет NuGet в проекте Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="4312a-159">To develop an application-hosted media bot, you must install the following NuGet package within your Visual Studio project:</span></span>

- [<span data-ttu-id="4312a-160">Библиотека Microsoft. Graph. Calls. Media .NET</span><span class="sxs-lookup"><span data-stu-id="4312a-160">Microsoft.Graph.Calls.Media .NET library</span></span>](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)

<span data-ttu-id="4312a-161">Для среды Боты, размещаемой в приложении, требуется .NET/C# и Windows Server, как подробно описано в статье [требования и рекомендации для среды Боты, размещаемой у приложения](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server).</span><span class="sxs-lookup"><span data-stu-id="4312a-161">Application-hosted media bots require .NET/C# and Windows Server, as described in detail in [Requirements and considerations for application-hosted media bots](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server).</span></span>
