---
title: Основные сведения о Bot
author: clearab
description: Общие сведения о Боты в Teams.
ms.topic: conceptual
ms.author: anclear
ms.openlocfilehash: e1b0c79b73ae89c8ab76ba0a1ff045603ab0b932
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "41675333"
---
# <a name="bot-basics"></a>Основные сведения о Bot

Это введение, которое создает, [как боты работает](https://aka.ms/how-bots-work) в основной [документации по основной среде](https://aka.ms/azure-bot-service-docs). Вы можете найти эту статью и другие статьи в разделе *Основные понятия* , которые можно использовать.

Основное отличие в Боты, разработанной для Microsoft Teams, заключается в том, как обрабатываются действия. Обработчик действий Microsoft Teams является производным от обработчика действий в среде Bot для маршрутизации всех действий Teams, прежде чем разрешить обработку любых действий, не связанных с Teams.

## <a name="teams-activity-handlers"></a>Обработчики действий Teams

Когда Bot для Microsoft Teams получает действие, оно передается его *обработчикам действий*. В рамках этой процедуры существует один базовый обработчик, называемый *обработчиком*, который выполняет маршрутизацию всех действий через. *Обработчик переворота* вызывает необходимый обработчик действий для обработки любого типа полученного действия. В отличие от приложения Bot, разработанного для Microsoft Teams, он `TeamsActivityHandler` является производным от класса, производного от `ActivityHandler` класса Bot Framework.

# <a name="ctabcsharp"></a>[C#](#tab/csharp)

Как и в случае с любыми Bot, созданными с помощью Microsoft Bot Framework, если Bot получает действие сообщения, обработчик переводит видит, что это входящее `OnMessageActivityAsync` действие и отправляет его обработчику действий. В Teams эта функциональная возможность остается прежней. Если Bot получает действие обновления беседы, обработчик переводит видит, что это входящее действие, и отправляет его `OnConversationUpdateActivityAsync` обработчику действий *Teams* , который сначала проверяет наличие определенных событий Teams и передает его в обработчик действий, выполняемый в среде Bot, если ничего не найдено.

В классе обработчика действий Teams существует два основных обработчика действий Teams `OnConversationUpdateActivityAsync` , которые направляют все действия по обновлению беседы и `OnInvokeActivityAsync` направляют все действия по вызову Teams.

Чтобы реализовать логику для определенных обработчиков действий в Teams, вы переопределите эти методы в интерфейсе Bot, как показано в разделе " [логика ленты ленты](#bot-logic) ". Для каждого из этих обработчиков не существует базовой реализации, поэтому просто добавьте логику, которую нужно использовать в переопределении.

# <a name="javascripttabjavascript"></a>[JavaScript](#tab/javascript)

Как и в случае с любыми Bot, созданными с помощью Microsoft Bot Framework, если Bot получает действие сообщения, обработчик переводит видит, что это входящее `onMessage` действие и отправляет его обработчику действий. В Teams эта функциональная возможность остается прежней. Если Bot получает действие обновления беседы, обработчик переводит видит, что это входящее действие, и отправляет его `dispatchConversationUpdateActivity` обработчику действий *Teams* , который сначала проверяет наличие определенных событий Teams и передает его в обработчик действий Bot Frameworks, если ничего не найдено.

В классе обработчика действий Teams существует два основных обработчика действий Teams `dispatchConversationUpdateActivity` , которые направляют все действия по обновлению беседы и `onInvokeActivity` направляют все действия по вызову Teams.

Чтобы реализовать логику для определенных обработчиков действий в Teams, вы переопределите эти методы в интерфейсе Bot, как показано в разделе " [логика ленты ленты](#bot-logic) ". Для каждого из этих обработчиков определите логику ленты, а затем **обязательно вызовите `next()` ее в конце**. Вызывая `next()` гарантию, вы гарантируете выполнение следующего обработчика.

---

## <a name="bot-logic"></a>Логика Bot

Логика Bot обрабатывает входящие действия из одного или нескольких каналов ленты и создает исходящие действия в ответе.  Это по-прежнему относится к Боты, производному от класса обработчика действий Teams, который сначала проверяет действия Teams, а затем передает все остальные действия обработчику действий Bot Frameworks.

# <a name="ctabcsharp"></a>[C#](#tab/csharp)

#### <a name="core-bot-framework-handlers"></a>Основные обработчики ленты

Все описанные ниже обработчики действий продолжают работать так же, как и при работе с роботом, не являющимся участником Teams, за исключением того, что *добавленные* члены и участники *удалили* действия, они будут отличаться в контексте команды, в которой новый участник добавляется в группу, а не в цепочку сообщений.

Обработчики, определенные `ActivityHandler` в, описаны ниже.

| Событие | Событий | Описание |
| :-- | :-- | :-- |
| Любой тип действия, полученный | `OnTurnAsync` | Вызывает один из других обработчиков в зависимости от типа полученного действия. |
| Получено сообщений об активности | `OnMessageActivityAsync` | Переопределите это `Message` действие, чтобы обработать действие. |
| Получено действие обновления беседы | `OnConversationUpdateActivityAsync` | При работе `ConversationUpdate` с действием вызывается обработчик, если участники, отличные от присоединенных к началу или левой стороне объекта. |
| Участники, не являющиеся участниками Bot, присоединились к беседе | `OnMembersAddedAsync` | Переопределите этот метод для обработки членов, присоединяющихся к беседе. |
| Участники, не являющиеся участниками Bot, оставили беседу | `OnMembersRemovedAsync` | Переопределите этот метод, чтобы элементы обрабатывали беседу. |
| Получено действий с событиями | `OnEventActivityAsync` | Для `Event` действия вызывает обработчик, зависящий от типа события. |
| Получено действий с событиями Token и Response | `OnTokenResponseEventAsync` | Переопределите этот метод, чтобы обрабатывать события ответа маркеров. |
| Получено действий событий, не связанных с маркером и откликом | `OnEventAsync` | Переопределите этот метод, чтобы обрабатывать события других типов. |
| Получен другой тип действия | `OnUnrecognizedActivityTypeAsync` | Переопределите это значение, чтобы обработать любой тип действия, не обработанный в обратном случае. |

#### <a name="teams-specific-handlers"></a>Обработчики, зависящие от Teams

Далее `TeamsActivityHandler` приведен список обработчиков, приведенных выше, для включения следующих элементов:

| Событие | Событий | Описание |
| :-- | :-- | :-- |
| чаннелкреатед | `OnTeamsChannelCreatedAsync` | Переопределите этот метод для обработки создаваемого канала Teams. Для получения дополнительных сведений см [канал, созданный](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) в разделе [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |
| чаннелделетед | `OnTeamsChannelDeletedAsync` | Переопределите это значение, чтобы обработать удаленный канал команд. Дополнительные сведения см. [канал, удаленный](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|
| чаннелренамед | `OnTeamsChannelRenamedAsync` | Переопределите этот метод для обработки переименования канала Teams. Дополнительные сведения см. в разделе [Переименование канала](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|
| теамренамед | `OnTeamsTeamRenamedAsync` | `return Task.CompletedTask;`Переопределите это для обработки переименования команды Teams. Дополнительные сведения см. в разделе [Переименование](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|
| мемберсаддед | `OnTeamsMembersAddedAsync` | Вызывает `OnMembersAddedAsync` метод в `ActivityHandler`файле. Переопределите это, чтобы участники группы выполнили присоединение к ней. Дополнительные сведения см. в статье [Добавление члена группы](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added) в [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|
| мемберсремовед | `OnTeamsMembersRemovedAsync` | Вызывает `OnMembersRemovedAsync` метод в `ActivityHandler`файле. Переопределите этот метод, чтобы обрабатывать участников, открывая команду. Дополнительные сведения об [удалении члена группы](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed) в разделе [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|

#### <a name="teams-invoke--activities"></a>Действия при вызове Teams

Ниже приведен список всех обработчиков действий Teams, вызываемых из `OnInvokeActivityAsync` обработчика действий _Teams_ :

| Типы Invoke                    | Событий                              | Описание                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| Кардактион. Invoke               | `OnTeamsCardActionInvokeAsync`       | Вызов действия карточки Teams. |
| Филеконсент/Invoke              | `OnTeamsFileConsentAcceptAsync`      | Принятие согласия для файлов Teams. |
| Филеконсент/Invoke              | `OnTeamsFileConsentAsync`            | Разрешение на файл Teams. |
| Филеконсент/Invoke              | `OnTeamsFileConsentDeclineAsync`     | Разрешение на файл Teams. |
| Актионаблемессаже/executeAction | `OnTeamsO365ConnectorCardActionAsync` | Действие соединительной карточки Teams O365. |
| Вход/Верифистате              | `OnTeamsSigninVerifyStateAsync`      | Проверка состояния входа в Microsoft Teams. |
| задача/получение                      | `OnTeamsTaskModuleFetchAsync`        | Загрузка модуля задач Teams. |
| задача и отправляются                     | `OnTeamsTaskModuleSubmitAsync`       | Отправляются модули задач Teams. |

Приведенные выше действия по вызываемым вопросам относятся к боты в Teams. Пакет SDK для Bot Framework также поддерживает вызовы, относящиеся к расширениям обмена сообщениями. Дополнительные сведения см. в разделе [что такое расширения обмена сообщениями](https://aka.ms/azure-bot-what-are-messaging-extensions)

# <a name="javascripttabjavascript"></a>[JavaScript](#tab/javascript)

Все описанные ниже обработчики действий продолжают работать так же, как и при работе с Bot-роботом, за исключением обработки *добавленных* участников и участников, *удаленных* действий, они будут отличаться в контексте команды, в которой новый участник добавляется в группу, а не в цепочку сообщений.

#### <a name="core-bot-framework-handlers"></a>Основные обработчики ленты

Обработчики, определенные `ActivityHandler` в, описаны ниже.

| Событие | Событий | Описание |
| :-- | :-- | :-- |
| Любой тип действия, полученный | `onTurn` | Вызывает один из других обработчиков в зависимости от типа полученного действия. |
| Получено сообщений об активности | `onMessage` | Предоставьте функцию для этого, чтобы обработать `Message` действие. |
| Получено действие обновления беседы | `onConversationUpdate` | При работе `ConversationUpdate` с действием вызывается обработчик, если участники, отличные от присоединенных к началу или левой стороне объекта. |
| Участники, не являющиеся участниками Bot, присоединились к беседе | `onMembersAdded` | Предоставьте функцию для обработки членов, присоединяющихся к беседе. |
| Участники, не являющиеся участниками Bot, оставили беседу | `onMembersRemoved` | Предоставьте функцию для этого, чтобы обрабатывать элементы, оставив беседу. |
| Получено действий с событиями | `onEvent` | Для `Event` действия вызывает обработчик, зависящий от типа события. |
| Получено действий с событиями Token и Response | `onTokenResponseEvent` | Предоставьте функцию для этого, чтобы обрабатывать события ответа маркеров. |
| Получен другой тип действия | `onUnrecognizedActivityType` | Предоставление функции для обработки любого типа действий в ином случае необработанным. |
| Обработчики действий завершены | `onDialog` | Предоставляет функцию для обработки любой обработки, которая должна выполняться в конце выполнения, после завершения всех обработчиков действий. |

#### <a name="teams-specific-handlers"></a>Обработчики, зависящие от Teams

Далее `TeamsActivityHandler` приведен список обработчиков, приведенных выше, для включения следующих элементов:

| Событие | Событий | Описание |
| :-- | :-- | :-- |
| чаннелкреатед | `OnTeamsChannelCreatedAsync` | Переопределите этот метод для обработки создаваемого канала Teams. Для получения дополнительных сведений см [канал, созданный](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) в разделе [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |
| чаннелделетед | `OnTeamsChannelDeletedAsync` | Переопределите это значение, чтобы обработать удаленный канал команд. Дополнительные сведения см. [канал, удаленный](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events).|
| чаннелренамед | `OnTeamsChannelRenamedAsync` | Переопределите этот метод для обработки переименования канала Teams. Дополнительные сведения см. в разделе [Переименование канала](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |
| теамренамед | `OnTeamsTeamRenamedAsync` | `return Task.CompletedTask;`Переопределите это для обработки переименования команды Teams. Дополнительные сведения см. в разделе [Переименование](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) в [событиях обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |
| мемберсаддед | `OnTeamsMembersAddedAsync` | Вызывает `OnMembersAddedAsync` метод в `ActivityHandler`файле. Переопределите это, чтобы участники группы выполнили присоединение к ней. Дополнительные сведения см. в статье [Добавление члена группы](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added) в [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |
| мемберсремовед | `OnTeamsMembersRemovedAsync` | Вызывает `OnMembersRemovedAsync` метод в `ActivityHandler`файле. Переопределите этот метод, чтобы обрабатывать участников, открывая команду. Дополнительные сведения об [удалении члена группы](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed) в разделе [события обновления беседы](https://aka.ms/azure-bot-subscribe-to-conversation-events). |

#### <a name="teams-invoke-activities"></a>Действия при вызове Teams

Ниже приведен список всех обработчиков действий Teams, вызываемых из `onInvokeActivity` обработчика действий _Teams_ :

| Типы Invoke                    | Событий                              | Описание                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| Кардактион. Invoke               | `handleTeamsCardActionInvoke`       | Вызов действия карточки Teams. |
| Филеконсент/Invoke              | `handleTeamsFileConsentAccept`      | Принятие согласия для файлов Teams. |
| Филеконсент/Invoke              | `handleTeamsFileConsent`            | Разрешение на файл Teams. |
| Филеконсент/Invoke              | `handleTeamsFileConsentDecline`     | Разрешение на файл Teams. |
| Актионаблемессаже/executeAction | `handleTeamsO365ConnectorCardAction` | Действие соединительной карточки Teams O365. |
| Вход/Верифистате              | `handleTeamsSigninVerifyState`      | Проверка состояния входа в Microsoft Teams. |
| задача/получение                      | `handleTeamsTaskModuleFetch`        | Загрузка модуля задач Teams. |
| задача и отправляются                     | `handleTeamsTaskModuleSubmit`       | Отправляются модули задач Teams. |

Приведенные выше действия по вызываемым вопросам относятся к боты в Teams. Пакет SDK для Bot Framework также поддерживает вызовы, относящиеся к расширениям обмена сообщениями. Дополнительные сведения см. в разделе [что такое расширения обмена сообщениями](https://aka.ms/azure-bot-what-are-messaging-extensions)

---
