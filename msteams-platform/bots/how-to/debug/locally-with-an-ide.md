---
title: Локальное тестирование и отладка бота
author: surbhigupta
description: Узнайте о локальном тестировании и отладке бота в интегрированной среде разработки Teams с помощью загрузки неопубликованных приложений, вне Teams с помощью эмулятора бота и посредством прямого общения с ботом.
ms.topic: overview
ms.localizationpriority: medium
ms.author: anclear
ms.openlocfilehash: da6e04e4df8824f4dc13d63e0aa4cd5bb6afb48a
ms.sourcegitcommit: 430bf416bb8d1b74f926c8b5d5ffd3dbb0782286
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2022
ms.locfileid: "65297228"
---
# <a name="test-and-debug-your-bot-locally"></a>Локальное тестирование и отладка бота

При тестировании своего бота вы должны учитывать как контексты, в которых вы хотите, чтобы бот работал, так и любые функции, которые вы, возможно, добавили в свой бот, для которых требуются данные, специфичные для Microsoft Teams. Убедитесь, что выбранный вами метод тестирования бота соответствует его функциональным возможностям.

## <a name="test-by-uploading-to-teams"></a>Тестирование путем отправки в Teams

Самый полный способ тестирования бота — создание пакета приложения и отправка его в Teams. Это единственный метод проверки всех функциональных возможностей, доступных боту, во всех областях.

Существует два способа отправки приложения:

* Используйте [App Studio](~/concepts/build-and-test/app-studio-overview.md).
* [Создайте пакет приложения](~/concepts/build-and-test/apps-package.md) вручную, а затем [отправьте его](~/concepts/deploy-and-publish/apps-upload.md).

> [!NOTE]
> Чтобы изменить манифест и повторно отправить приложение, [удалите бот](#delete-a-bot-from-teams) перед отправкой измененного пакета приложения.
> Чтобы протестировать бот, разрешите загрузку неопубликованных приложений Teams. См. раздел [Включение загрузки неопубликованных приложений](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant#enable-custom-teams-apps-and-turn-on-custom-app-uploading).

## <a name="debug-your-bot-locally"></a>Локальная отладка бота

Если вы размещаете свой бот локально во время разработки, вам нужно использовать службу туннелирования, например [ngrok](https://ngrok.com/), чтобы протестировать своего бота. После скачивания и установки ngrok добавьте `ngrok` к пути и выполните следующую команду, чтобы запустить службу туннелирования:

```bash
ngrok http <port> -host-header=localhost:<port>
```

Используйте конечную точку HTTPS, предоставленную ngrok, в манифесте вашего приложения.

> [!NOTE]
> Если закрыть командное окно и перезапустить его, будет создан новый URL-адрес, и для дальнейшего использования бота вам потребуется обновить адрес его конечной точки.

## <a name="test-your-bot-without-uploading-to-teams"></a>Тестирование бота без отправки в Teams

Иногда необходимо протестировать бот, не устанавливая его как приложение в Teams. Мы предоставляем два метода для тестирования бота. Тестирование вашего бота без его установки в качестве приложения может быть полезно, чтобы убедиться, что ваш бот доступен и отвечает, однако это не позволит вам протестировать весь спектр функций Microsoft Teams, которые вы добавили в свой бот. Если вы хотите полностью протестировать свой бот, см. [Тестирование загрузкой файлов ](#test-by-uploading-to-teams).

### <a name="use-the-bot-emulator"></a>Использование эмулятора бота

Bot Framework Emulator - классическое приложение, которое позволяет разработчикам тестировать и отлаживать боты локально или удаленно. Эмулятор помогает общаться с ботом в чате и проверять сообщения, отправляемые и получаемые ботом. Это полезно, чтобы убедиться, что ваш бот доступен и отвечает. Однако эмулятор не позволяет тестировать какие-либо специфичные для Teams функции, которые вы добавили в бот, а ответы вашего бота не являются точным визуальным представлением того, как они отображаются в Teams. Если вам нужно протестировать любой из них, лучше всего [загрузить свой бот](#test-by-uploading-to-teams).

Дополнительные сведения см. в [полных инструкциях по Эмулятору Bot Framework](/azure/bot-service/bot-service-debug-emulator?view=azure-bot-service-4.0&preserve-view=true).

### <a name="talk-to-your-bot-directly-by-id"></a>Общение с ботом напрямую по идентификатору

> [!Important]
> Беседа с ботом по идентификатору предназначена только для тестирования на самом базовом уровне. Никакие добавленные вами в бот функции, специфичные для Teams, работать не будут.

Вы можете начать разговор со своим ботом, используя его идентификатор. Когда бот добавляется с помощью одного из этих методов, к нему нельзя обращаться в беседах канала, и вы не можете использовать другие возможности приложения Microsoft Teams, такие как вкладки или расширения сообщений. Инициировать беседу можно одним из указанных ниже способов.

* На странице [панели мониторинга бота](https://dev.botframework.com/bots) в разделе **Каналы** нажмите кнопку **Добавить в Microsoft Teams**. Microsoft Teams запускает личный чат с ботом.

* Ссылайтесь напрямую на идентификатор приложения бота в Microsoft Teams:
   1. На странице [панели мониторинга бота](https://dev.botframework.com/bots) в разделе **Сведения** скопируйте **идентификатор приложения бота Майкрософт**.
  
      ![Получение appID для бота](~/assets/images/bots_appid_botframework.png)
  
   2. Откройте Microsoft Teams, в области **чата** щелкните значок **Добавить чат**. В поле **Кому** вставьте идентификатор приложения Майкрософт бота.
  
      ![Отправка ботов](~/assets/images/bots_uploading.png)

      Идентификатор приложения должен разрешаться в имя бота.

   3. Выберите бота и отправьте сообщение, чтобы инициировать беседу.
      Кроме того, вы можете вставить идентификатор приложения бота в поле поиска в левом верхнем углу Microsoft Teams. На странице результатов поиска перейдите на вкладку **Люди**, чтобы увидеть свой бот и начать с ним общение.

> [!Note]
> Чтобы Microsoft Teams мог ссылаться на идентификатор приложения бота, разрешите загрузку [неопубликованных приложений](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant#enable-custom-teams-apps-and-turn-on-custom-app-uploading).

Бот получает событие `conversationUpdate` при добавлении ботов в команду без сведений о команде в объекте `channelData`.

## <a name="block-a-bot-in-personal-chat"></a>Блокировка бота в личном чате

Пользователи могут запретить боту отправлять сообщения в личных чатах. Для этого запрета нужно щелкнуть бота правой кнопкой мыши в канале чата и выбрать **Блокировать беседу бота**. Это означает, что ваши боты продолжают отправлять сообщения, однако пользователь не получает сообщения.

![Блокировка бота](~/assets/images/bots/botdisable.png)

## <a name="remove-a-bot-from-a-team"></a>Удаление бота из группы

Пользователи могут удалить бота, щелкнув значок корзины в списке ботов в представлении команды. Это только удаляет бот из досягаемости данной команды; отдельные пользователи по-прежнему смогут взаимодействовать с ним в контексте личного чата. Боты в личном контексте не могут быть отключены или удалены пользователями.

## <a name="disable-a-bot-in-teams"></a>Отключение бота в Teams

Чтобы запретить боту получать сообщения, перейдите на **панель мониторинга бота** и измените канал Teams. Снимите флажок **Включить в Microsoft Teams**. Это не позволяет пользователям взаимодействовать с ботом, однако его по-прежнему можно обнаружить, и пользователи могут добавить его в Teams.

## <a name="delete-a-bot-from-teams"></a>Удаление бота из Teams

Чтобы полностью удалить свой бот из Teams, перейдите на **панель мониторинга ботов** и измените канал Teams. В нижней части страницы нажмите кнопку **Удалить**. Теперь пользователи не смогут обнаруживать бота, добавлять его и взаимодействовать с ним. Это не удаляет бот из экземпляров Teams других пользователей, однако он также перестает работать для них.

## <a name="see-also"></a>Дополнительные ресурсы

* [Отладка бота с помощью ПО промежуточного слоя для проверки](/azure/bot-service/bot-service-debug-inspection-middleware)
* [Локальная отладка бота для звонков и собраний](~/bots/calls-and-meetings/debugging-local-testing-calling-meeting-bots.md)
