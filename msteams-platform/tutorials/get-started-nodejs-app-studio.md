---
title: Учебник. Создание первого приложения с помощью Node.js
description: Узнайте, как начать создание приложений Microsoft Teams с помощью Node.js.
keywords: начало работы node.js nodejs App Studio
ms.topic: tutorial
ms.custom: scenarios:getting-started; languages:JavaScript,Node.js
ms.openlocfilehash: 03dcf79a46266321e54c7e99bf01cdd2a87075fa
ms.sourcegitcommit: fa64b83c0b534bf7a89f256880d5b5ca193e4b04
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "50037048"
---
# <a name="create-your-first-microsoft-teams-app-using-nodejs"></a>Создайте свое первое приложение Microsoft Teams с помощью Node.js

Это руководство поможет вам при создании приложения Microsoft Teams с помощью Node.js.

[!include [prepare your environment](~/includes/prepare-environment.md)]

<a name="DownloadAndHost"></a>

## <a name="download-and-host-your-app"></a>Скачивание и хостинг приложения

Выполните следующие действия, чтобы скачать и провести простое приложение "Hello world" в Teams.

<a name="GetPrerequisites"></a>

### <a name="get-prerequisites"></a>Получить необходимые условия

Для выполнения этого руководства необходимы следующие средства. Если их еще нет, их можно установить по этим ссылкам.

- [Git](https://git-scm.com/downloads)
- [Node.js и NPM](https://nodejs.org/)
- Получите любой текстовый редактор или IDE. Вы можете установить и [использовать Visual Studio code](https://code.visualstudio.com/download) бесплатно.

Если во время установки вы видите параметры для добавления `git` `node` , и `npm` `code` path, выберите это сделать. Это будет удобно.

Убедитесь, что эти средства доступны, вы можете запускать следующие средства в окне терминала:

> [!NOTE]
> Используйте окно терминала, наиболее удобное для вашей платформы. В этих примерах используется Bash (включенный в Git), но эти сценарии будут работать на большинстве платформ.

```bash
$ git --version
git version 2.19.0.windows.1

$ node -v
v8.9.3

$ npm -v
5.5.1

$ gulp -v
CLI version 2.3.0
Local version 4.0.2
```

У вас может быть другая версия этих приложений. Это не должно быть проблемой, за исключением gulp. Для gulp необходимо использовать версию 4.0.0 или более поздней.

Если вы не установили gulp (или у вас установлена неправильная версия), сделайте это сейчас, за `npm install gulp` запущенным в окне терминала.

Если вы установили Visual Studio кода, вы можете проверить установку, вы можете:

```bash
code --version
1.28.2
929bacba01ef658b873545e26034d1a8067445e9
```

Вы можете продолжать использовать это окно терминала для запуска команд, которые следуют в этом руководстве.

<a name="DownloadSample"></a>

### <a name="download-the-sample"></a>Скачать пример

Мы предоставили простой [привет, мир!](https://github.com/OfficeDev/msteams-samples-hello-world-nodejs) пример для начала работы. В окне терминала запустите следующую команду, чтобы клонировать образец репозитория на локальный компьютер:

```bash
git clone https://github.com/OfficeDev/msteams-samples-hello-world-nodejs.git
```

> [!TIP]
> Вы можете [раздвоить](https://help.github.com/articles/fork-a-repo/) этот репозиционный репозитарий, если хотите изменить и проверить изменения в репозитарии GitHub для дальнейшей ссылки. [](https://github.com/OfficeDev/msteams-samples-hello-world-nodejs)

<a name="BuildRun"></a>

### <a name="build-and-run-the-sample"></a>Сборка и запуск примера

После клонирования репо перенаменуем в каталог, в который будет вмещаться пример:

```bash
cd msteams-samples-hello-world-nodejs
```

Чтобы создать пример, необходимо установить все его зависимости. Для этого запустите следующую команду:

```bash
npm install
```

Вы увидите, что устанавливается множество зависимостей. Завершив их, вы можете запустить приложение:

```bash
npm start
```

Когда приложение hello-world запускается, оно отображается `App started listening on port 3333` в окне терминала.

> [!NOTE]
> Если в вышеуказанном сообщении отображается другой номер порта, это необходимо потому, что у вас установлена переменная среды PORT. Вы можете продолжать использовать этот порт или изменить переменную среды на 3333.

На этом этапе можно открыть окно браузера и перейти по следующим URL-адресам, чтобы убедиться, что загружаются все URL-адреса приложений:

- [http://localhost:3333](http://localhost:3333)
- [http://localhost:3333/hello](http://localhost:3333/hello)
- [http://localhost:3333/first](http://localhost:3333/first)
- [http://localhost:3333/second](http://localhost:3333/second)

<a name="HostSample"></a>

### <a name="host-the-sample-app"></a>Хост-приложение для примера

Помните, что приложения в Microsoft Teams — это веб-приложения, которые предлагают одну или несколько возможностей. Чтобы платформа Teams загружала ваше приложение, ваше приложение должно быть доступно из Интернета. Чтобы ваше приложение было доступно из Интернета, необходимо провести *его.*

Для локального тестирования можно запустить приложение на локальном компьютере и создать для него туннель с веб-конечной точкой. [ngrok](https://ngrok.com) — это бесплатное средство, которое позволяет сделать именно это. С *помощью ngrok* можно получить веб-адрес, например `https://d0ac14a5.ngrok.io` (этот URL-адрес является лишь примером). Вы можете [скачать и установить](https://ngrok.com/download) *ngrok* для своей среды. Убедитесь, что вы добавили его в расположение в вашем `PATH` .

После установки можно открыть новое окно терминала и выполнить следующую команду, чтобы создать туннель. В примере используется порт 3333, поэтому не забудьте указать его здесь.

```bash
ngrok http 3333 -host-header=localhost:3333
```

*Ngrok* будет прослушивать запросы из Интернета и маршрутит их в ваше приложение, запущенного через порт 3333. Вы можете проверить, открыв браузер и загрузив страницу `https://d0ac14a5.ngrok.io/hello` hello приложения. Вместо этого URL-адреса используйте адрес переадрикии, отображающийся *ngrok* в сеансе консоли.

> [!NOTE]
> Если вы использовали другой порт [](#build-and-run-the-sample) в сборке и на шаге выше, убедитесь, что для настройки туннеля *ngrok* используется один и тот же номер порта.
> [!TIP]
> Лучше запустить *ngrok* в другом окне терминала, чтобы не мешать приложению узла, которое впоследствии может потребоваться остановить, перестроить и повторно запустить. Сеанс *ngrok* возвращает полезные сведения об отладке в этом окне.

Существует платная версия *ngrok,* которая разрешает постоянные имена. Если вы используете бесплатную версию, ваше приложение будет доступно только во время текущего сеанса на компьютере разработчика. Если компьютер выключен или переводится в спящий режим, служба будет недоступна. Помните об этом при совместном использовании приложения для тестирования другими пользователями. Если вам нужно перезапустить службу, она возвратит новый адрес, и вам придется обновить все места, где используется этот адрес.

Обратите внимание на URL-адрес приложения, так как он понадобится вам позже при регистрации приложения в Teams с помощью App studio. Для этой цели хорошо работает Блокнот.

<a name="DeployToTeams"></a>

## <a name="deploy-your-app-to-microsoft-teams"></a>Развертывание приложения в Microsoft Teams

На этом этапе у вас есть приложение, которое находится в Интернете, но вы еще не можете сказать Teams, где его искать или даже что ваше приложение называется. Для этого необходимо создать пакет приложения. Это не более чем текстовый файл, содержащий манифест приложения и некоторые значки, которые клиент Teams будет использовать для правильного отображения и фирменой символики приложения. Вы можете вручную создать этот пакет приложения или использовать App Studio— средство, которое работает в Teams, что упростит процесс регистрации приложения. App Studio — это рекомендуемый способ создания и обновления пакета приложения.

Для обоих методов вам потребуется следующее:

- URL-адрес приложения в Интернете.
- Значки, которые Teams будет использовать для фирменой символики вашего приложения. Пример поставляется со значками-замесятелями, расположенными в "src\static\images". App Studio также предоставляет значки по умолчанию при необходимости.

[!include[Use App Studio to configure the app package](~/includes/get-started/get-started-use-app-studio.md)]

## <a name="update-your-hosted-app"></a>Обновление ведущего приложения

Пример приложения требует, чтобы для следующих переменных среды были установлены значения, которые вы ранее заметили.

```
MICROSOFT_APP_ID=<YOUR BOT'S APP ID>
MICROSOFT_APP_PASSWORD=<YOUR BOT'S PASSWORD>
WEBSITE_NODE_DEFAULT_VERSION=8.9.4
```

То, как это сделать, зависит от того, как было организовано приложение. Важно использовать переменные среды, так как эти значения являются частью вашей среды. К ним можно получить доступ с помощью кода вашего приложения, но они не будут доступны третьим лицам, которые могут изучить файлы, составляющие сайт.

Если вы используете приложение с помощью ngrok, вам потребуется настроить некоторые локальные переменные среды. Это можно сделать множеством способов, но проще всего добавить конфигурацию запуска, если вы используете Visual Studio [Code:](https://code.visualstudio.com/Docs/editor/debugging#_launch-configurations)

``` 
{
    "type": "node",
    "request": "launch",
    "name": "Launch - Teams Debug",
    "program": "${workspaceRoot}/src/app.js",
    "cwd": "${workspaceFolder}/src",
    "env": {
        "BASE_URI": "https://yourNgrokURL.ngrok.io",
        "MICROSOFT_APP_ID": "00000000-0000-0000-0000-000000000000",
        "MICROSOFT_APP_PASSWORD": "yourBotAppPassword",
        "NODE_DEBUG": "botbuilder",
        "SUPPRESS_NO_CONFIG_WARNING": "y",
        "NODE_CONFIG_DIR": "../config"
    }
}
```

Где:

MICROSOFT_APP_ID и MICROSOFT_APP_PASSWORD это ИД и пароль, соответственно, для вашего бота.
NODE_DEBUG покажите, что происходит в вашем боте в консоли Visual Studio отлаживка кода.
NODE_CONFIG_DIR указывает на каталог в корне репозитория (по умолчанию при локальном запуске приложения оно ищет его в папке src).

> [!Note]
> Если вы еще не остановили npm из предыдущего руководства, вам потребуется выполнить его, чтобы Visual Studio Code правильно подберет переменные конфигурации `npm stop` запуска.

<a name="ConfigureTheAppTab"></a>

## <a name="configure-the-app-tab"></a>Настройка вкладки приложения

После установки приложения в команде необходимо настроить его для показа содержимого. Перейдите на канал в команде и нажмите кнопку **"+",** чтобы добавить новую вкладку. Затем можно выбрать `Hello World` в списке **"Добавить** вкладку". После этого вам будет представлено диалоговое окно конфигурации. Это диалоговое окно позволит выбрать вкладку, отображаемую в этом канале. Выбрав вкладку и щелкнув ее, вы увидите вкладку, загруженную `Save` `Hello World` выбранной вкладками.

<img width="430px" src="~/assets/images/samples-hello-world-tab-configure.png" alt-text="Screenshot of configure" />

### <a name="test-your-bot-in-teams"></a>Тестирование бота в Teams

Теперь вы можете взаимодействовать с ботом в Teams. Выберите канал в команде, в которой вы зарегистрировали приложение, и введите `@your-bot-name` (за ним следует сообщение). Это называется **\@ упоминанием.** Все сообщения, отправляемые боту, будут отправлены вам в качестве ответа.

<img width="450px" alt-text="Bot responses" src="~/assets/images/samples-hello-world-bot.png" />

<a name="ComposeRichMessages"></a>

### <a name="test-your-messaging-extension"></a>Проверка расширения обмена сообщениями

Чтобы протестировать расширение обмена сообщениями, можно щелкнуть три точки под полем ввода в представлении беседы. В меню будет всплывающее меню с приложением **"Hello World".** Щелкнув его, вы увидите несколько произвольных текстов. Вы можете выбрать любой из них, и он будет вставлен в беседу.

<img width="430px" alt-text="Messaging extension menu" src="~/assets/images/samples-hello-world-messaging-extensions-menu.png" />

<img width="430px" alt-text="Messaging extension result" src="~/assets/images/samples-hello-world-messaging-extensions-result.png" />

Выберите один из случайных текстов, и внизу отформатированная карточка будет готова к отправке с собственным сообщением.

<img width="430px" alt-text="Messaging extension send" src="~/assets/images/samples-hello-world-messaging-extensions-send.png" />
