### YamlMime:Tutorial
title: Создание пузырька содержимого собрания
metadata:
  title: Создание пузырька содержимого собрания
  description: В этом учебном модуле вы узнаете, как отправить ответ на пузырьок содержимого собрания с помощью бота в Teams с участниками.
  audience: Developer
  level: Beginner
  ms.date: 12/03/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: apps-in-teams-meetings/enable-and-configure-your-app-for-teams-meetings.md
  nextTutorialTitle: Дополнительные сведения о включении и настройке приложений для собраний
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: a986edd250c738409806ea016eff755c7555296a
  ms.sourcegitcommit: c1032ea4f48c4bbf5446798ff7d46d7e6e9f55d2
  ms.translationtype: MT
  ms.contentlocale: ru-RU
  ms.lasthandoff: 09/27/2022
  ms.locfileid: "68027209"
items:
- durationInMinutes: 1
  content: "Teams помогает создавать пузырьки содержимого и взаимодействовать с ними с помощью бота.\n\n**Основные функции пузырька содержимого собрания**:\n\n* Просмотр элементов повесткы дня, перечисленных в адаптивной карточке.\n* Выберите любой вариант в заданной повестке дня.\n* Отправьте свой отзыв о пузырьке содержимого или адаптивной карточке, отправленной в чате.\n\n> [!NOTE]\n> Пузырьок содержимого собрания доступен только для Azure AD пользователей, а не для анонимных пользователей.\n\nЭто пошаговое руководство поможет создать пузырьок содержимого собрания с помощью бота на собрании Teams с участниками. Вы увидите следующие выходные данные:\n\n  :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/desktop-and-mobile-image-final.png\" alt-text=\"Общие сведения о пузырьке содержимого собрания\":::\n\n \n"
- title: Предварительные требования
  durationInMinutes: 1
  content: "Установите следующие средства и настройте среду разработки:  \n\n* [Microsoft Teams с](https://teams.microsoft.com/) действительной учетной записью\n* [Последняя версия пакета SDK для .NET Core](https://dotnet.microsoft.com/download) \n* [Последняя версия Visual Studio](https://visualstudio.microsoft.com/downloads/)\n* [Последняя версия ngrok](https://ngrok.com/download) только для тестирования devbox или любого эквивалентного решения для туннелирования\n\n  > [!NOTE]\n  > После скачивания ngrok зарегистрируйтесь и установите [authtoken](https://ngrok.com/download).\n\nУбедитесь, что у вас есть опыт работы [с C#](/dotnet/csharp/fundamentals/tutorials/how-to-display-command-line-arguments).\n"
- title: Настройка локальной среды
  durationInMinutes: 1
  content: "\n1. Откройте [примеры Microsoft Teams](https://github.com/OfficeDev/Microsoft-Teams-Samples).\n1. Выберите **\"Код\"**.\n1. В раскрывающемся меню выберите \" **Открыть с помощью GitHub Desktop\"**.\n\n  :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-clonerepository.png\" alt-text=\"Клонирование репозитория\":::\n\n1. Выберите **\"Клонировать\"**. \n\n    > [!NOTE]\n    > Если возникает ошибка \"Слишком длинное имя файла\", примените команду Git \"git config --system core.longpaths true\" в терминале администратора по выбору.\n"
- title: Создание и регистрация бота
  durationInMinutes: 5
  content: "Следующие действия помогут вам создать и зарегистрировать бот в портал Azure.\n\n* Создайте ресурс Azure Bot для регистрации бота в Azure Служба Bot.\n* Создайте секрет клиента, чтобы включить проверку подлинности единого входа бота.\n* Добавьте канал Teams для развертывания бота.\n* Используйте ngrok для создания туннеля к конечным точкам веб-сервера.\n* Добавьте конечную точку обмена сообщениями в созданный туннель ngrok.\n\n**Создание ресурса Azure Bot**\n\n1. Перейдите на [портал Azure](https://portal.azure.com/).\n1. Выберите **Создать ресурс**.\n1. В поле поиска введите **Azure Bot**.\n1. Выберите **ВВОД**.\n1. Выберите **Azure Bot**.\n\n    :::image type=\"content\" source=\"./assets/images/azure-bot.png\" alt-text=\"Azure Bot.\":::\n\n1. Нажмите **Создать**.\n1. Введите необходимое имя дескриптора бота в **дескрипторах бота**.\n1. Выберите свою **подписку** в раскрывающемся списке.\n1. Выберите свою **группу ресурсов** в раскрывающемся списке.\n \n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-review-plus-create.png\" alt-text=\"Создание ресурса Бота Azure\":::\n\n   Чтобы создать группу ресурсов (выберите **\"Создать новый** > введите имя ресурса> нажмите кнопку \"ОК **\"**). Выберите необходимое расположение в раскрывающемся списке **\"** Новое расположение группы ресурсов\".\n   \n     :::image type=\"content\" source=\"~/assets/images/bots/newresource.png\" alt-text=\"Создание ресурса Бота Azure\":::\n\n1. В разделе **\"Идентификатор приложения Майкрософт** \" по умолчанию выбран параметр **\"Создать новый** идентификатор приложения Майкрософт\". \n\n   Можно либо выбрать \"Использовать существующую регистрацию **приложения**\", ввести существующий идентификатор приложения и пароль существующего **приложения, либо** выбрать \"Создать  **новый идентификатор приложения Майкрософт\"**.\n\n   > [!NOTE]\n   > Вы не можете создать несколько ботов с одинаковым **идентификатором приложения Майкрософт**.\n\n1. Выберите **тип приложения в качестве** **мультитенантного**.\n\n1. Выберите **Проверить и создать**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/Review-create.png\" alt-text=\"Проверка создания\":::\n\n1. Если проверка пройдена, нажмите **Создать**.\n\n    Подготовка службы бота займет несколько секунд.\n\n1. Выберите пункт **Перейти к ресурсу**. \n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-botdeployment.png\" alt-text=\"Развертывание приложения\":::\n    \n    Ваш бот Azure создан.\n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-creating-resource-group.png\" alt-text=\"Созданный ресурс бота Azure\":::\n\n**Создание секрета клиента**\n\n  Если вы создали новый идентификатор приложения Майкрософт, выполните **следующие действия**:\n\n1. На левой панели выберите \" **Конфигурация\"**. \n\n   > [!TIP]\n   > Сохраните **идентификатор приложения Майкрософт или** **идентификатор клиента для** дальнейшей справки.      \n\n1. Рядом с **идентификатором приложения Майкрософт** выберите \" **Управление\"**.\n\n   :::image type=\"content\" source=\"~/assets/images/manage-bot-label.png\" alt-text=\"Управляющим\":::\n\n1. В разделе **\"Секреты клиента** \" выберите \" **Новый секрет клиента\"**. \n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-newclientsecret.png\" alt-text=\"Новый секрет клиента\":::\n    \n   **Появится окно \"Добавление секрета** клиента\".  \n\n1. **Введите описание**.\n\n1. Нажмите **Добавить**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-clientsecret.png\" alt-text=\"Добавление секрета клиента в приложение\":::\n\n1. В **столбце \"Значение** \" выберите \" **Копировать в буфер обмена\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-client-secret.png\" alt-text=\"Значение секрета клиента\":::\n   \n   > [!TIP]\n   > Сохраните значение **секретов клиента** или пароль приложения для дальнейшей ссылки.\n\n**Добавление канала Teams**\n\n1. Нажмите **Главная**.\n\n1. Выберите бот из списка **последних ресурсов**.\n\n1. Выберите **\"Каналы\"** в левой области и выберите **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>.\n\n    :::image type=\"content\" source=\"~/assets/images/adaptive-cards/channel-teams.png\" alt-text=\"Выбор Teams в каналах\":::\n\n1. Выбор **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>.\n\n1. Установите флажок, чтобы принять **условия обслуживания**.\n\n1. Выберите **\"Принять**\".\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-terms.png\" alt-text=\"Условия обслуживания\":::\n\n1. Нажмите **Применить**.\n\n**Создание туннеля для локального веб-сервера**\n\nИспользуйте ngrok или командную строку для создания туннеля для общедоступных конечных точек HTTPS локального веб-сервера. Выполните следующую команду в ngrok:\n\n ```bash\n ngrok http --host-header=localhost 3978\n ```\n\n > [!NOTE]\n > При создании туннеля ngrok используйте вместо того, `localhost 5000` `3978` чтобы выбрать командную **строку** для запуска приложения.\n \n > [!TIP]\n > Если вы **столкнулись ERR_NGROK_4018**, выполните действия, описанные в командной строке, чтобы зарегистрироваться и проверить подлинность ngrok. Затем выполните команду `ngrok http --host-header=localhost 3978` .\n\n\n**Добавление конечной точки обмена сообщениями**\n\n1. Скопируйте URL-адрес HTTPS из ngrok.\n\n   :::image type=\"content\" source=\"../msteams-platform/assets/images/ngrok-url.png\" alt-text=\"URL-адрес HTTPS ngrok\":::\n\n    > [!NOTE]\n    > URL-адрес HTTPS в ngrok — это полное доменное имя.\n    > Это `WebAppDomain` полное доменное имя, которое не включается `https://` в него.\n\n1. В **разделе \"Параметры** \" для созданного бота Azure выберите \" **Конфигурация\"**.\n\n1. В **конечной точке обмена** сообщениями используйте URL-адрес HTTPS, доступный в ngrok, и в конце URL-адреса добавьте **/api/messages**.\n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-config-messaging-end-point.png\" alt-text=\"Конечная точка обмена сообщениями\":::\n\n1. Нажмите **Применить**.\n\n    Вы успешно настроили бот в Azure Служба Bot.\n"
- title: Обновление регистрации Azure AD приложения
  durationInMinutes: 1
  content: "\n1. Перейдите на [портал Azure](https://portal.azure.com/).\n\n1. Выберите **Azure Active Directory**.\n\n1. На панели навигации слева выберите \" **Регистрация приложений\"**.\n\n1. Выберите бота.\n\n1. В разделе **Управление** выберите **Предоставление API**.\n\n1. Выберите **\"Задать\"**.\n\n1. **Задайте URI идентификатора** приложения в виде `api://your ngrok/botid-{AppID}`.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-set-api.png\" alt-text=\"Установка ссылки\":::\n\n   На следующем рисунке показано доменное имя:\n    \n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-exposeapi.png\" alt-text=\"URI кода надстройки\":::\n\n    > [!NOTE]\n    > Если вы используете службу туннелирования, например ngrok, обязательно обновляйте значение при каждом изменении поддомена ngrok.\n    > `For example: api://f631****.ngrok.io/92c11075-c629-4a1e-ab58-02b4fd4204c2`, где `f631****.ngrok.io` новое имя поддомена ngrok.\n\n1. Нажмите **Добавить область**. \n\n    :::image type=\"content\" source=\"~/assets/images/meetings-side-panel/selectscope.png\" alt-text=\"Добавление области\":::\n        \n1. На отображаемой панели введите `access_as_user` имя **области**.\n\n1. **Указать, кто может дать согласие?** `Admins and users`\n\n1. Чтобы настроить запросы согласия `access_as_user` администратора и пользователя с соответствующими значениями для области, укажите следующие сведения в полях:</br>\n\n     * Введите `Teams can access the user’s profile` **Администратор отображаемое имя согласия**.\n\n     * Введите `Allows Teams to call the app’s web APIs as the current user` **Администратор согласия**.\n\n     * Введите `Teams can access the user profile and make requests on the user’s behalf` **отображаемое имя согласия пользователя**.\n\n     * Введите `Enable Teams to call this app’s APIs with the same rights as the user` описание **согласия пользователя**.\n\n   На следующем рисунке показаны поля и значения:\n\n      :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-access-as-user.png\" alt-text=\"Добавление области\":::\n\n1. Убедитесь, что параметру **Состояние** присвоено значение **Включено**.\n\n1. Выберите **\"Добавить область** для сохранения\".\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/add-scope.png\" alt-text=\"Добавление области\":::\n\n   > [!NOTE]\n   > Имя **области должно совпадать** с универсальным кодом ресурса (URI) **идентификатора** приложения, `/access_as_user` добавленным в конце.</br>\n       `api://****.ngrok.io/00000000-0000-0000-0000-000000000000/access_as_user`\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-add-scope.png\" alt-text=\"Scope\":::\n\n1. В разделе **Авторизованные клиентские приложения** укажите приложения, которые необходимо авторизовать для веб-приложения вашего приложения. \n\n1. Выберите **Добавить клиентское приложение**. \n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-selectclientapp.png\" alt-text=\"Добавление клиентского приложения\":::\n\n1. **Введите идентификатор клиента** для мобильного `1fec8e78-bce4-4aaf-ab1b-5451cc387264` или настольного приложения Teams. \n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-addclientapp1.png\" alt-text=\"Добавление клиентского приложения 1\":::\n\n   Вы можете **ввести идентификатор клиента**: `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` для веб-приложения Teams.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-addclientapp2.png\" alt-text=\"Добавление клиентского приложения 2\":::\n\n1. Выберите **авторизованные области**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-add-client-app.png\" alt-text=\"Добавление клиентского приложения\":::\n\n   На следующем рисунке показан идентификатор клиента:\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-client-applications.png\" alt-text=\"Клиентские приложения\":::\n\n1. На панели слева выберите **разрешения API**. \n\n   > [!NOTE]\n   > Пользователи должны дать согласие на эти разрешения, только если Azure AD зарегистрирован в другом клиенте.\n\n1. Выберите **Добавить разрешение**.\n\n    :::image type=\"content\" source=\"~/assets/images/meetings-side-panel/addpermission.png\" alt-text=\"Добавление разрешения\":::\n\n1. Выберите **Microsoft Graph**.\n\n1. Выберите **Делегированные разрешения**.\n\n1. Добавьте указанные ниже разрешения.</br>\n     * **email**\n     * **offline_access**\n     * **Openid**\n     * **profile**\n     * **User.Read**\n\n1. Выберите **Добавить разрешения**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-otherpermissions.png\" alt-text=\"Другие разрешения\":::\n\n1. На панели слева выберите \" **Проверка подлинности\"** , чтобы задать URI перенаправления. \n\n   > [!NOTE]\n   > Если приложению не предоставлено согласие ИТ-администратора, пользователи должны предоставить согласие при первом использовании приложения.\n           \n     1. Выберите **Добавить платформу**.\n     1. Выберите платформу **Веб**.\n\n         :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-platform-web.png\" alt-text=\"Web\":::\n\n     1. Введите URI перенаправления для приложения, `auth-end` введя полное доменное имя:</br> \n       `https://your ngrok/auth-end`. </br>\n\n     1. **Включите неявное предоставление и гибридные** потоки, установите следующие флажки:\n         * **Маркеры идентификаторов**\n         * **Маркеры доступа**\n\n     1. Нажмите **Настроить**.\n\n         :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-content-bubble-config-web.png\" alt-text=\"Окончание проверки подлинности\":::\n"
- title: Настройка параметров приложения
  durationInMinutes: 1
  content: "1. Перейдите **к файлу appsettings.json** в клонированном репозитории.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/navigate-to-meeting-content-bubble-repo.png\" alt-text=\"Расположение параметров приложения\":::\n\n1. Откройте **файл appsettings.json** в Visual Studio и обновите следующие сведения:  \n\n     * Задайте `\"MicrosoftAppId\"` идентификатор приложения **Майкрософт для бота**.\n     * Задайте `\"MicrosoftAppPassword\"` значение идентификатора секрета клиента бота.\n     * Задайте `\"BaseURL\"` для параметра . `webAppDomain`.\n\n      :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/appsettings-json1.png\" alt-text=\"Параметры приложения\":::\n"
- title: Настройка файла манифеста
  durationInMinutes: 1
  content: >
    1. Перейдите **к файлу manifest.json** в клонированном репозитории.


    1. Откройте **файл manifest.json** в Visual Studio и внесите следующие изменения:

         * Задайте `id` **идентификатор приложения Майкрософт**.
         * Задайте `botId` **идентификатор приложения Майкрософт**.
         * Задайте `validDomains` **доменное имя веб-приложения**.

          > [!NOTE]
          > `WebAppDomain` — это ваш домен ngrok.

         :::image type="content" source="~/assets/images/meeting-content-bubble/manifest-set.png" alt-text="Изображение манифеста1":::
- title: Сборка и запуск службы
  durationInMinutes: 1
  content: "**Создание и запуск службы с помощью Visual Studio**\n\n   1. Откройте **Visual Studio**.\n   1. Перейдите к **файлу** > **\"Открыть проект** > **или решение\"**.\n\n       :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/meeting-token-generator-VSopenfile.png\" alt-text=\"Открытие файла\":::\n\n   1. Откройте **файл ContentBubbleBot.sln** .\n\n       :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/proj-sln.png\" alt-text=\"Открытие файла\":::\n\n   1. Нажмите **клавишу F5** , чтобы запустить проект.\n\n      Откроется веб-страница с сообщением о том, что **ваш бот готов!**.\n\n       :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/your-bot-is-ready.png\" alt-text=\"Приложение готово\"::: \n"
- title: Добавление пузырькового приложения для содержимого собрания в Teams
  durationInMinutes: 1
  content: "\n1. В клонированном репозитории перейдите к **csharp > Resources > Manifest**.\n\n1. Создайте .zip со следующими файлами, которые находятся в **папке манифеста** : \n   * manifest.json\n   * icon-outline.png\n   * icon-color.png\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/create-manifest-zip.png\" alt-text=\"ZIP-файл\"::: \n\n1. Создайте собрание с несколькими выступающими и участниками.\n\n1. После создания собрания выберите \"**+****Добавить приложение\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/add-an-app.png\" alt-text=\"Добавление приложения\"::: \n\n1. Во всплывающем окне выберите \" **Управление приложениями\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/manage-apps.png\" alt-text=\"Управление приложениями\"::: \n\n1. Выберите **Отправить пользовательское приложение**. \n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/upload-custom-app.png\" alt-text=\"Отправка пользовательского приложения\"::: \n\n1. Нажмите **кнопку \"** Открыть\", чтобы .zip файл, созданный в **папке манифеста** .\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/Zip-file.png\" alt-text=\"Отправка ZIP-приложения\":::\n\n1. Нажмите **Добавить**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/content-bubble-demo.png\" alt-text=\"Добавление приложения\"::: \n\n1. В **разделе \"** Управление приложениями\" отображается список приложений.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/Manage.png\" alt-text=\"Управление приложениями\"::: \n\n1. Перейдите в чат собрания Teams.\n\n1. **Демонстрационное приложение content Bubble** отправляет автоматический ответ в чат собрания.\n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/content-bubble-demo-first-reply.png\" alt-text=\"Демонстрационный ответ для пузырьков содержимого\"::: \n\n1. Отправка **приветского** сообщения боту.\n\n     :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/content-bubble-demo-second-reply.png\" alt-text=\"Упоминание бота\"::: \n\n1. Бот отправляет вам элементы повестки дня, перечисленные в адаптивной карточке.\n\n1. Выберите любой параметр и нажмите **кнопку \"Отправить повестку дня** \", чтобы отправить ответ.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/push-agenda.png\" alt-text=\"Бот отправляет адаптивную карточку\"::: \n\n1. Бот отправляет **адаптивную карточку** обратной связи.\n\n1. Выберите **\"Да** \" или **\"Нет\"**.\n\n1. Выберите **Отправить**.\n\n    :::image type=\"content\" source=\"~/assets/images/meeting-content-bubble/content-bubble-feedback.png\" alt-text=\"Бот отправляет вам карточку отзыва\"::: \n\n    Бот отправляет отзыв.\n  \n"
- title: Полный запрос
  durationInMinutes: 1
  content: >
    У вас возникла такая проблема?

     :::image type="content" source="~/assets/images/meeting-content-bubble/desktop-and-mobile-image-final.png" alt-text="Демонстрация содержимого для настольных компьютеров и мобильных устройств":::
- content: Вы завершили работу с руководством, чтобы приступить к созданию пузырькового приложения для содержимого собрания.
