### YamlMime:Tutorial
title: Создание бота с проверкой подлинности единого входа
metadata:
  title: Создание бота с проверкой подлинности единого входа
  description: В этом руководстве описано, как создать бот с проверкой подлинности единого входа.
  audience: Developer
  level: Beginner
  ms.date: 08/24/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/how-to/authentication/auth-aad-sso-bots.md
  nextTutorialTitle: Дополнительные сведения о проверке подлинности бота
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: 8e7795aa86c06b2958600492539427a7eea359db
  ms.sourcegitcommit: c1032ea4f48c4bbf5446798ff7d46d7e6e9f55d2
  ms.translationtype: MT
  ms.contentlocale: ru-RU
  ms.lasthandoff: 09/27/2022
  ms.locfileid: "68027069"
items:
- durationInMinutes: 1
  content: >
    Боты Teams — это боты для общения, которые выполняют повторяющиеся автоматизированные задачи, выполняемые пользователями, например службу поддержки клиентов. Пользователю необходимо выполнить вход несколько раз без проверки подлинности единого входа. С помощью методов проверки подлинности единого входа пользователям не нужно выполнять вход в бот несколько раз.


    Бот ведет себя по-разному в зависимости от беседы, в которых он участвует:


    * Боты в чатах каналов и групповых бесед требуют, чтобы пользователи @mention бота.

    * Ботам в личной беседе не требуют @упоминания. Все сообщения, отправленные пользователем, направляются в бот.


    Это пошаговое руководство поможет вам создать бот с проверкой подлинности единого входа. Вы увидите следующие выходные данные:

     :::image type="content" source="~/assets/images/bots/sbs-desktop-mobile.png" alt-text="Мобильный вход в бот":::
- title: Предварительные требования
  durationInMinutes: 1
  content: "Установите следующие средства и настройте среду разработки:  \n\n* [Последняя версия ngrok или любое](https://ngrok.com/download) эквивалентное решение для туннелирования\n\n  > [!NOTE]\n  > После скачивания ngrok зарегистрируйтесь и установите [authtoken](https://ngrok.com/download).\n\n* [Последняя версия Visual Studio](https://visualstudio.microsoft.com/downloads/)\n\nУбедитесь, что у вас есть следующие учетные записи, и настройте среду разработки: \n\n* [Учетная запись](https://teams.microsoft.com/) Майкрософт\n\n  > [!TIP]\n  > Убедитесь, что учетная запись Microsoft Teams не является гостевой.\n\n* [Учетная запись разработчика Microsoft 365](https://developer.microsoft.com/en-us/microsoft-365/dev-program) или доступ к учетной записи Teams с соответствующими разрешениями на установку приложения  \n\n## <a name=\"set-up-your-teams-development-tenant\"></a>Настройка клиента разработки Teams\n\n   Клиент **—** это пространство или контейнер, в котором вы беседируете, делитесь файлами и выполняете собрания для своей организации в Teams. Вы также можете загрузить неопубликованный файл и протестировать приложение.\n\n### <a name=\"check-for-sideloading-option\"></a>Проверка параметра загрузки неопубликованных приложений\n\n   После создания приложения необходимо загрузить это приложение в Teams, не распространяя его. Это называется загрузкой неопубликованных приложений. Войдите в учетную запись Microsoft 365, чтобы просмотреть этот параметр.\n\n   > [!NOTE]\n   > Загрузка неопубликованных приложений необходима для предварительного просмотра и тестирования приложений в локальной среде Teams. Включите загрузку неопубликованных приложений для локального просмотра и тестирования приложения в Teams.\n\n   У вас уже есть клиент и у вас есть доступ администратора? Давайте посмотрим, действительно ли вы работаете!\n\nЧтобы проверить загрузку неопубликованных приложений в Teams, выполните следующее.\n\n1. В клиенте Teams выберите **Store**.\n1. Выберите **Управление приложениями**\n1. Выберите **Опубликовать приложение**.\n1. Найдите параметр для **отправки пользовательского приложения**. Если вы видите этот параметр, загрузка неопубликованных приложений включена.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/upload-custom-app1.png\" alt-text=\"На рисунке показан параметр для отправки пользовательского приложения в Teams.\":::\n\n    > [!NOTE]\n    > Обратитесь к администратору Teams, если у вас нет возможности отправить пользовательское приложение.\n\n### <a name=\"create-a-free-teams-developer-tenant-optional\"></a>Создание бесплатного клиента разработчика Teams (необязательно)\n\nЕсли у вас нет учетной записи разработчика Teams, ее можно получить бесплатно. Присоединяйтесь к программе для разработчиков Microsoft 365!\n\n1. Перейдите в [программу для разработчиков Microsoft 365](https://developer.microsoft.com/microsoft-365/dev-program).\n1. Нажмите **кнопку \"Присоединиться сейчас** \" и следуйте инструкциям на экране.\n1. Выберите **\"Настроить подписку E5** \" на экране приветствия.\n1. Настройка учетной записи администратора. После завершения отобразится следующий экран.\n\n      :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/microsoft-365.png\" alt-text=\"Корпорация Майкрософт\":::\n\n1. Войдите в Teams с помощью новой учетной записи администратора. Теперь у вас должен быть параметр **\"Отправить пользовательское приложение** \".\n"
- title: Создание и регистрация бота
  durationInMinutes: 5
  content: "Следующие действия помогут вам создать и зарегистрировать бота в портал Azure.\n\n1. Создайте ресурс Azure Bot для регистрации бота в Azure Служба Bot.\n1. Создайте секрет клиента, чтобы включить проверку подлинности единого входа бота.\n1. Добавьте канал Teams для развертывания бота.\n1. Используйте ngrok для создания туннеля к конечным точкам веб-сервера.\n1. Добавьте конечную точку обмена сообщениями в созданный туннель ngrok.\n\n**Создание ресурса Azure Bot**\n\n1. Перейдите на [портал Azure](https://portal.azure.com/). Он может запросить вход с учетными данными учетной записи Майкрософт.\n\n1. Выберите **Создать ресурс**.\n\n   :::image type=\"content\" source=\"~/assets/images/bots/Createaresource.png\" alt-text=\"Снимок экрана: выбор элемента &quot;Создать ресурс&quot;.\":::\n\n1. В поле поиска введите **бот Azure**.\n\n   :::image type=\"content\" source=\"~/assets/images/bots/searchazurebot.png\" alt-text=\"Снимок экрана: поиск бота Azure.\":::\n\n1. Выберите **ВВОД**.\n\n1. Выберите **Azure Bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectazurebot.png\" alt-text=\"Снимок экрана: выбор бота Azure.\":::\n\n1. Нажмите **Создать**.\n\n    :::image type=\"content\" source=\"./assets/images/azure-bot.png\" alt-text=\"Снимок экрана: выбор параметра create.\":::\n\n   Появится страница создания Azure Bot.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/azurebotpage.png\" alt-text=\"Снимок экрана: страница бота Azure.\":::\n\n1. Введите следующие сведения, чтобы создать бот Azure.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Azurebotcreate.png\" alt-text=\"Снимок экрана: сведения о создании ресурса azure bot.\":::\n\n    1. Введите необходимое имя **дескриптора** бота в дескрипторах бота, и это уникальный идентификатор бота.\n\n    1. Выберите свою **подписку** в раскрывающемся списке.\n\n    1. Выберите **группу ресурсов из** раскрывающегося списка, который вы хотите подготовить для бота.\n    \n       Вы также можете создать группу ресурсов, выполнив следующие действия.\n\n          1. Чтобы создать группу ресурсов, нажмите **кнопку \"** > введите имя ресурса> \"ОК **\"**. Выберите необходимое расположение в раскрывающемся списке **\"Новое расположение** группы ресурсов\".\n\n               :::image type=\"content\" source=\"~/assets/images/bots/newresourcecreation.png\" alt-text=\"Снимок экрана: выбор новой группы ресурсов.\":::\n\n               :::image type=\"content\" source=\"~/assets/images/bots/newresource.png\" alt-text=\"Снимок экрана: новое расположение группы ресурсов.\":::\n\n    1. Выберите **тип приложения в качестве** **мультитенантного**.\n\n        :::image type=\"content\" source=\"~/assets/images/bots/Review-Create.png\" alt-text=\"Снимок экрана: выбор варианта с несколькими клиентами. \":::\n\n    1. В разделе **\"Идентификатор приложения Майкрософт** \" по умолчанию выбран параметр **\"Создать новый** идентификатор приложения Майкрософт\".\n\n       Можно либо выбрать \"Использовать существующую регистрацию **приложения**\", ввести существующий идентификатор приложения и пароль существующего **приложения, либо** выбрать \"Создать  **новый идентификатор приложения Майкрософт\"**.\n\n       > [!NOTE]\n       > Вы не можете создать несколько ботов с одинаковым **идентификатором приложения Майкрософт**.\n\n    1. Выберите **Проверить и создать**.\n\n1. После завершения проверки нажмите кнопку \" **Создать\"**.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/validationpass.png\" alt-text=\"Снимок экрана, показывающий проход проверки.\":::\n\n   Подготовка службы бота занимает несколько секунд и откроется следующую страницу:\n\n     :::image type=\"content\" source=\"~/assets/images/bots/provisionpage.png\" alt-text=\"Снимок экрана: страница подготовки.\":::\n\n1. Выберите пункт **Перейти к ресурсу**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/gotoresource.png\" alt-text=\"Снимок экрана: переход к параметру перейти к ресурсу.\":::\n\n   Бот Azure создан, и вы увидите группу **ресурсов** и **идентификатор подписки** в боте Azure.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/Azurebotresource.png\" alt-text=\"Снимок экрана: создаваемый ресурс бота Azure\":::\n\n**Создание секрета клиента**\n\n Чтобы создать секрет клиента, выполните следующие действия.\n\n1. На левой панели выберите \" **Конфигурация\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectconfigure.png\" alt-text=\"Снимок экрана: выбор параметра настройки\":::\n\n   > [!Important]\n   > Сохраните **идентификатор приложения Майкрософт или** **идентификатор клиента для** дальнейшей справки.\n\n1. Рядом с **идентификатором приложения Майкрософт** выберите \" **Управление\"**.\n\n   :::image type=\"content\" source=\"~/assets/images/manage-bot-label.png\" alt-text=\"управление ботом\":::\n\n1. В разделе **\"Секреты клиента** \" выберите \" **Новый секрет клиента\"**.\n\n      :::image type=\"content\" source=\"~/assets/images/bots/newclientsecret.png\" alt-text=\"Снимок экрана: выбор нового секрета клиента.\":::\n\n   **Появится окно \"Добавление секрета** клиента\".\n\n1. **Введите описание**.\n\n1. Нажмите **Добавить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/addclientsecret.png\" alt-text=\"Снимок экрана: добавление секрета клиента в приложение.\":::\n\n1. В **столбце \"Значение** \" выберите \" **Копировать в буфер обмена\"**. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/valueclientsecret.png\" alt-text=\"Снимок экрана: значение секрета клиента, скопированное в буфер обмена.\":::\n\n   > [!Important]\n   > Сохраните значение **секретов клиента** или пароль приложения для дальнейшей ссылки.\n   \n**Добавление бота в канал Teams**\n\n1. Нажмите **Главная**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selecthome.png\" alt-text=\"Снимок экрана: выбор домашней страницы.\":::\n\n1. Выберите бот из списка **последних ресурсов**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectrecentresources.png\" alt-text=\"Снимок экрана: выбор последних ресурсов.\":::\n\n1. Выберите **\"Каналы\"** в левой области и выберите **Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>. \n\n    :::image type=\"content\" source=\"~/assets/images/adaptive-cards/channel-teams.png\" alt-text=\"Выбор Teams в каналах\":::\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectchannel.png\" alt-text=\"Снимок экрана: выбор канала.\":::\n\n1. Выбор **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectmicrosoftteams.png\" alt-text=\"Снимок экрана: выбор Microsoft Teams\":::\n\n1. Установите флажок, чтобы принять **условия обслуживания**.\n\n1. Выберите **\"Принять**\".\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Terms-of-service.png\" alt-text=\"Снимок экрана: термины.\":::\n\n1. Нажмите **Применить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/apply.png\" alt-text=\"Снимок экрана: параметр &quot;Применить&quot;\":::\n\n**Создание туннеля для локального веб-сервера**\n\nИспользуйте ngrok для создания туннеля к общедоступным конечным точкам HTTPS локального веб-сервера. Выполните следующую команду в ngrok:\n\n   ```bash\n   ngrok http --host-header=localhost 3978\n   ```\n   > [!TIP]\n   > При **обнаружении ERR_NGROK_4018** выполните действия, как показано в командной строке для регистрации и проверки подлинности ngrok. Затем выполните команду `ngrok http --host-header=localhost 3978` .\n\n**Добавление конечной точки обмена сообщениями**\n\n1. Скопируйте URL-адрес HTTPS из ngrok.\n\n   :::image type=\"content\" source=\"../msteams-platform/assets/images/ngrok-url.png\" alt-text=\"URL-адрес HTTPS ngrok\":::\n\n    > [!NOTE]\n    > URL-адрес HTTPS в ngrok — это полное доменное имя.\n    > Это `WebAppDomain` полное доменное имя, которое не включается `https://` в него.\n\n1. Назад к портал Azure.\n\n1. В **разделе \"Параметры** \" для созданного бота Azure выберите \" **Конфигурация\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectconfiguration.png\" alt-text=\"Снимок экрана: выбор конфигурации\":::\n\n1. В **конечной точке обмена** сообщениями используйте URL-адрес HTTPS, доступный в ngrok, и в конце URL-адреса добавьте **/api/messages**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/messagingURL.png\" alt-text=\"Снимок экрана: конечная точка обмена сообщениями.\":::\n\n1. Нажмите **Применить**.\n\n    Вы успешно настроили бот в Azure Служба Bot.\n"
- title: Настройка единого входа для бота
  durationInMinutes: 5
  content: "**Добавление URI перенаправления в ресурс бота Azure**\n\n1. Выберите **Управление**.\n\n   :::image type=\"content\" source=\"~/assets/images/manage-bot-label.png\" alt-text=\"Снимок экрана: управление параметрами.\":::\n\n1. В левой области выберите \" **Проверка подлинности\"**.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/selectauthentication.png\" alt-text=\"Снимок экрана: выбор проверки подлинности.\":::\n\n1. В **разделе \"Конфигурации платформы**\" выберите **\"** Добавить платформу\", чтобы выбрать платформу, на которой вы хотите разместить приложение бота. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/addaplatform.png\" alt-text=\"Снимок экрана: параметр добавления платформы.\":::\n\n1. В этом руководстве выберите \" **Интернет\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectweb.png\" alt-text=\"Снимок экрана: выбор веб-сайта.\":::\n    \n1. **Введите URI перенаправления**`https://token.botframework.com/.auth/web/redirect`, и это URI, по которому Azure AD будет отправлять ответ на проверку подлинности пользователя.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/redirectURI1.png\" alt-text=\"Снимок экрана: URL-адрес перенаправления\":::\n\n1. **Включите неявное предоставление и гибридные** потоки, установите следующие флажки:\n\n    * **Маркеры идентификаторов**\n    * **Маркеры доступа**\n\n1. Нажмите **Настроить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectimplictgrant.png\" alt-text=\"Снимок экрана, показывающий выбор настройки.\":::\n\n    URI перенаправления добавляется в ресурс бота Azure.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/redirectURIadded.png\" alt-text=\"Снимок экрана: URI перенаправления, добавленный в ресурс бота.\":::\n\n**Предоставление конечной точки API**\n\n1. В левой области выберите \" **Предоставить API\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/exposeanapi.png\" alt-text=\"Снимок экрана, показывающий выбор предоставления API.\":::\n\n1. Выберите **\"Задать\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/appidURI.png\" alt-text=\"Снимок экрана: параметр set.\":::\n\n1. Используйте отображаемый URI идентификатора приложения и **добавьте api://botid в** начале URI.\n\n1. Нажмите кнопку **Сохранить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/exposeAPI.png\" alt-text=\"Снимок экрана: параметр &quot;Сохранить&quot;.\":::\n\n   > [!Important]\n   > Сохраните **URI идентификатора приложения** для дальнейшей ссылки.\n\n1. Нажмите **Добавить область**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Addascope.png\" alt-text=\"Снимок экрана: добавление области.\":::\n\n   Появится панель добавления области.\n\n1. Введите данные для конфигурации области действия.    \n\n     :::image type=\"content\" source=\"~/assets/images/bots/addscope.png\" alt-text=\"Снимок экрана: настройка области.\":::\n\n      1. Введите `access_as_user` имя **области**.\n\n         > [!NOTE]\n         > Имя **области должно совпадать** с универсальным кодом ресурса (URI) **идентификатора** приложения, `/access_as_user` добавленным в конце.\n\n      1. **Указать, кто может дать согласие?** `Admins and users`\n\n      1. Чтобы настроить запросы согласия `access_as_user` администратора и пользователя с соответствующими значениями для области, укажите следующие сведения в полях:</br>\n\n          * Введите `Teams can access the user’s profile` **Администратор отображаемое имя согласия**.\n\n          * Введите `Allows Teams to call the app’s web APIs as the current user` **Администратор согласия**.\n\n          * Введите `Teams can access the user profile and make requests on the user’s behalf` **отображаемое имя согласия пользователя**.\n\n          * Введите `Enable Teams to call this app’s APIs with the same rights as you have` описание **согласия пользователя**.\n\n      1. Убедитесь, что параметру **Состояние** присвоено значение **Включено**.\n\n1. Выберите **\"Добавить область** для сохранения\".\n\n   URI идентификатора приложения создается с **именем области**.\n\n      :::image type=\"content\" source=\"~/assets/images/bots/ExposeAPIandaddscope.png\" alt-text=\"Снимок экрана: доступ к API и добавленная область.\":::\n\n1. В разделе **Авторизованные клиентские приложения** укажите приложения, которые необходимо авторизовать для веб-приложения вашего приложения.\n\n1. Выберите **Добавить клиентское приложение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/addaclientapplication.png\" alt-text=\"Снимок экрана: добавление клиентского приложения.\":::\n\n   Появится панель добавления клиентского приложения.\n\n1. Введите идентификатор клиента для рабочего стола и веб-приложения отдельно, которые требуется авторизовать. Это идентификатор клиентского приложения, которое требуется авторизовать.\n   \n   |**Идентификатор клиента**|**Для авторизации**|\n   |--------|-------------|\n   | `1fec8e78-bce4-4aaf-ab1b-5451cc387264` | Классические или мобильные приложения Teams |\n   | `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` | Веб-приложение Teams |\n\n1. Выберите **\"Авторизованные области** \", чтобы определить, какой тип маркера будет возвращен службой.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/add-desktop-app.png\" alt-text=\"Снимок экрана: выбор авторизованных областей.\":::\n   \n1. Нажмите кнопку **Добавить приложение**.\n\n    На следующем рисунке показан идентификатор клиента:\n\n      :::image type=\"content\" source=\"~/assets/images/bots/clientapps.png\" alt-text=\"Снимок экрана: добавление идентификатора клиента.\":::\n\n**Настройка разрешений Graph**\n\n1. На панели слева выберите **разрешения API**.\n\n      :::image type=\"content\" source=\"~/assets/images/bots/selectapipermissions.png\" alt-text=\"Снимок экрана: выбор разрешений API.\":::\n\n   > [!NOTE]\n   > Пользователи должны дать согласие на разрешения API только в том случае, если приложение бота зарегистрировано в другом клиенте.\n\n1. Выберите **Добавить разрешение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/configure-permission.png\" alt-text=\"Снимок экрана: разрешения пользователя API.\":::\n\n   Появится страница разрешений API запроса:\n\n1. Выберите **Microsoft Graph**.\n    \n    :::image type=\"content\" source=\"~/assets/images/bots/selectmicrosoftgraph.png\" alt-text=\"Снимок экрана: выбор Microsoft Graph.\":::\n\n1. Выберите **Делегированные разрешения**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-graph-permissions.png\" alt-text=\"Снимок экрана: выбор делегированных разрешений.\":::\n\n1. Выберите **разрешение User.Read** в раскрывающемся списке **\"** Пользователь\".\n\n1. Выберите **Добавить разрешения**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/userread.png\" alt-text=\"Снимок экрана: выбор элемента &quot;Чтение пользователя&quot;.\":::\n\n**Обновление манифеста**\n\n1. В левой области выберите \" **Манифест\"**.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/selectmanifest.png\" alt-text=\"Снимок экрана: выбор манифеста.\":::\n\n1. Убедитесь, что для элемента конфигурации задано значение **\"accessTokenAcceptedVersion\": 2**. В противном случае измените его значение на **2** и нажмите кнопку **\"Сохранить\"**.\n\n   > [!NOTE]\n   > Если вы уже тестируете бот в Teams, необходимо выйти из этого приложения и Teams. Затем войдите еще раз, чтобы увидеть это изменение.</br>\n    \n      :::image type=\"content\" source=\"~/assets/images/bots/update-manifest.png\" alt-text=\"Снимок экрана: обновление манифеста.\":::\n\n**Настройка подключения службы Бота**\n\n1. На **странице \"Конфигурация**\" выберите **\"Добавить параметры подключения OAuth\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectconfiguration1.png\" alt-text=\"Снимок экрана: выбор configuration1.\":::\n\n    :::image type=\"content\" source=\"~/assets/images/bots/botserviceconnection.png\" alt-text=\"Снимок экрана: подключение службы бота.\":::\n\n1. На **странице \"Параметры нового** подключения\" введите следующие сведения:\n\n    | Поле | Значение или описание |\n    | ----- | ----- |\n    | Имя | Введите имя нового параметра подключения. Имя можно использовать в параметрах кода службы бота. |\n    | Service Provider | Выберите **Azure Active Directory версии 2**. |\n    | Идентификатор клиента | Сохранено ранее в качестве **идентификатора приложения Майкрософт**. |\n    | Секрет клиента | Сохранено ранее **в качестве значения** идентификатора секрета клиента. |\n    | URL-адрес exchange маркеров | Используйте **URL-адрес идентификатора приложения, полученный** ранее при раскрытии конечной точки API. |\n    | Идентификатор клиента | Введите **общее**. |\n    | Scopes | **Введите User.Read**, а также добавьте  все области, необходимые при указании разрешений для подчиненных API. |\n\n1. Нажмите кнопку **Сохранить**.\n\n1. Нажмите **Применить**.\n\n   Теперь вы настроите единый вход для бота.\n"
- title: Настройка и запуск примера бота
  durationInMinutes: 1
  content: "1. Откройте **Visual Studio**.\n\n1. Выберите **\"Клонировать репозиторий\"**.\n\n1. В **расположении репозитория** введите `https://github.com/OfficeDev/Microsoft-Teams-Samples.git`. Запишите путь **,** по которому клонирован репозиторий.\n\n1. Перейдите к **файлу** > **\"Открыть проект** > **или решение\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/project-solution.png\" alt-text=\"Снимок экрана: навигация по проекту или решению.\":::\n\n1. Выберите **файл BotSSOCSharp.csproj** из **csharp_dotnetcore папки** .\n\n    :::image type=\"content\" source=\"~/assets/images/bots/filepath.png\" alt-text=\"Снимок экрана: путь к папке.\":::\n\n1. Откройте файл **appsettings.json** .\n\n1. **Обновите конфигурацию appsettings.json** для бота, чтобы использовать и `MicrosoftAppId` `MicrosoftAppPassword`. Используйте имя подключения OAuth в качестве **имени подключения**.\n\n    > [!NOTE]\n    > Вы можете получить эту страницу `MicrosoftAppId` на странице конфигурации бота. Значение `MicrosoftAppPassword` идентификатора секрета клиента, сохраненное ранее в Azure.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/appsettingsjson.png\" alt-text=\"Снимок экрана: параметр appsettings json.\":::\n\n1. Нажмите **клавишу F5**  , чтобы запустить проект.\n\n1. Выберите **Да**, если появится следующий диалог:\n\n    :::image type=\"content\" source=\"~/assets/images/bots/certificate.png\" alt-text=\"Снимок экрана: выбор параметра &quot;Да&quot; при появлении диалогового окна.\":::\n\n   Откроется веб-страница с сообщением \" **Бот готов\"**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/yourbot.png\" alt-text=\"Снимок экрана: веб-страница с сообщением о готовности бота.\":::\n    \n    <br>\n\n    <details>\n\n    <summary><b>Устранение неполадок</b></summary>\n\n    Если вы получаете сообщение **об ошибке \"Не удается найти пакет** \", выполните следующие действия.\n\n    1.  Перейдите к **параметрам диспетчера** >  пакетов **Диспетчера пакетов NuGet** > **tools.**\n    1.  В **отобразимом** окне \"Параметры\" выберите источники пакетов **диспетчера пакетов** >  **NuGet**.\n    1.  Нажмите **Добавить**.\n    1.  В **поле \"Имя**\" введите `nuget.org` и **введите \"Источник**\" `https://api.nuget.org/v3/index.json`.\n    1.  Нажмите **кнопку \"Обновить** \" и \" **ОК\"**.\n    1.  Перестройте проект.\n    <br>\n\n    </details>\n"
- title: Настройка и запуск приложения Teams
  durationInMinutes: 2
  content: "1. В Visual Studio откройте **папку appPackage** .\n\n1. Откройте файл **manifest.json** .\n\n1. Замените все **вхождения {TODO: MicrosoftAppId}** идентификатором **приложения Майкрософт бота**.\n\n1. В клонированном репозитории перейдите к **папке bot-conversation-sso-quickstart > csharp_dotnetcore > appPackage** .\n\n1. Создайте .zip со следующими файлами, которые находятся в **папке манифеста** : \n   * manifest.json\n   * icon-outline.png\n   * icon-color.png\n\n    :::image type=\"content\" source=\"~/assets/images/bots/manifest.png\" alt-text=\"Снимок экрана, показывающий, как заархивируйте папку манифеста\":::\n\n1. Перейдите в клиент Teams.\n1. Выберите **\"Магазин\"**.\n1. Выберите **Управление приложениями**\n\n    :::image type=\"content\" source=\"~/assets/images/bots/manage-your-app.png\" alt-text=\"Снимок экрана: выбор элемента управления приложением.\":::\n\n1. Выберите **Отправить пользовательское приложение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/upload-custom-app.png\" alt-text=\"Снимок экрана: отправка пользовательского приложения.\":::\n\n1. Нажмите **кнопку** \"Открыть\", чтобы .zip файл, созданный в **папке манифеста** .\n\n    :::image type=\"content\" source=\"~/assets/images/bots/open-app.png\" alt-text=\"Открытие приложения\":::\n\n1. Нажмите **кнопку \"** Добавить\", чтобы добавить бот беседы в чат.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/add-conversation-bot.png\" alt-text=\"Снимок экрана: параметр добавления бота беседы.\":::\n\n    Вы можете взаимодействовать с ботом, отправляя сообщение. Бот обменивает маркер единого входа и вызывает API Graph от вашего имени. При этом вы войдете в систему, если не отправите сообщение для **входа**.\n\n1. Отправьте сообщение боту. Бот беседы запрашивает согласие в первый раз.\n\n1. Выберите **\"Продолжить** \", чтобы предоставить клиенту Teams разрешения на доступ к боту.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/sbsdesktop-mobile-consent-request1.png\" alt-text=\"Снимок экрана, показывающий выбор предоставления разрешений боту\":::\n    \n    > [!NOTE]\n    > Теперь вы настроите единый вход с приложением-ботом, и это единственный раз, когда необходимо предоставить согласие.\n\n1. Для мобильного устройства выберите **\"Принять** для **запрашиваемых разрешений\"**.\n\n    > [!NOTE]\n    > Теперь вы настроите единый вход с приложением бота на мобильных устройствах, и это единственный раз, когда вам потребуется дать согласие.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/sbsdesktop-mobile-consent-request.png\" alt-text=\"Снимок экрана: мобильный телефон, вошед в бот.\":::\n"
- title: Полный запрос
  durationInMinutes: 1
  content: >
    У вас возникла такая проблема?

     :::image type="content" source="~/assets/images/bots/sbs-desktop-mobile.png" alt-text="Снимок экрана: окончательные выходные данные.":::
- content: Вы завершили работу с руководством, чтобы приступить к созданию бота с проверкой подлинности единого входа.
