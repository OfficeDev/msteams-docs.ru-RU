### YamlMime:Tutorial
title: Создание бота с проверкой подлинности единого входа
metadata:
  title: Создание бота с проверкой подлинности единого входа
  description: В этом руководстве описано, как создать бот с проверкой подлинности единого входа.
  audience: Developer
  level: Beginner
  ms.date: 08/24/2021
  ms.topic: interactive-tutorial
  nextTutorialHref: bots/how-to/authentication/auth-aad-sso-bots.md
  nextTutorialTitle: Дополнительные сведения о проверке подлинности бота
  ms.custom: mvc
  ms.localizationpriority: high
  ms.openlocfilehash: fcfff8a5fc1f38c4afdb7b6b64e752dc2234512f
  ms.sourcegitcommit: 6926cf5eee55d5047c11ca13afc7f6f23e270396
  ms.translationtype: MT
  ms.contentlocale: ru-RU
  ms.lasthandoff: 10/27/2022
  ms.locfileid: "68740744"
items:
- durationInMinutes: 1
  content: >
    Боты Teams — это диалоговые боты, которые выполняют повторяющиеся автоматические задачи, выполняемые пользователями, например обслуживание клиентов. Пользователю необходимо выполнить вход несколько раз без проверки подлинности единого входа. При использовании методов проверки подлинности единого входа пользователям не нужно входить в бот несколько раз.


    Бот ведет себя по-разному в зависимости от беседы, в которую он участвует:


    * Боты в беседах в каналах и групповых чатах требуют, чтобы пользователи @mention бота.

    * Ботам в личной беседе не требуют @упоминания. Все сообщения, отправленные пользователем, направляются боту.


    Это пошаговое руководство поможет вам создать бота с проверкой подлинности единого входа. Вы увидите следующие выходные данные:

     :::image type="content" source="~/assets/images/bots/sbs-desktop-mobile.png" alt-text="Мобильный вход в бот":::
- title: Предварительные требования
  durationInMinutes: 1
  content: "Убедитесь, что вы установили следующие средства и настроили среду разработки:  \n\n | &nbsp; | Установка | Для использования... |\n | --- | --- | --- |\n | **Required** | &nbsp; | &nbsp; |\n | &nbsp; | [Microsoft Teams с учетной записью (не гостевой учетной записью)](https://www.microsoft.com/microsoft-teams/download-app) |  Microsoft Teams для совместной работы со всеми, с кем вы работаете, с помощью приложений для чата, собраний, звонков и всех в одном месте. |\n | &nbsp; | [Visual Studio 2022 версии 17.3](https://visualstudio.microsoft.com)<br> Установите одну из следующих двух рабочих нагрузок:<br> • ASP.NET и веб-разработка <br> • Кроссплатформенная разработка .NET Core | Вы можете установить корпоративную версию в Visual Studio 2022 и установить рабочие нагрузки. |\n | &nbsp; | [Учетная запись разработчика Microsoft 365](/microsoftteams/platform/concepts/build-and-test/prepare-your-o365-tenant) | Доступ к учетной записи Teams с соответствующими разрешениями для установки приложения. |\n | &nbsp; | [ngrok](https://ngrok.com/download) | Функции приложений Teams (диалоговые боты, расширения сообщений и входящие веб-перехватчики) требуют входящих подключений. Туннель соединяет систему разработки с Teams. Он не требуется для приложений, которые содержат только вкладки. Этот пакет устанавливается в каталоге проекта (с помощью npm `devDependencies`). |\n\n  > [!NOTE]\n  > После скачивания ngrok зарегистрируйтесь и установите [authtoken](https://ngrok.com/download).\n\n## <a name=\"set-up-your-teams-development-tenant\"></a>Настройка клиента разработки Teams\n\n**Клиент** похож на пространство или контейнер, в котором вы общаетесь, обмениваются файлами и выполняете собрания для своей организации в Teams. Вы также можете загрузить и протестировать неопубликованное приложение.\n\n### <a name=\"check-for-sideloading-option\"></a>Проверка параметра загрузки неопубликованных приложений\n\nПосле создания приложения необходимо загрузить это приложение в Teams, не распространяя его. Эта загрузка называется загрузкой неопубликованных приложений. Войдите в учетную запись Microsoft 365, чтобы просмотреть этот параметр.\n\n > [!NOTE]\n > Загрузка неопубликованных приложений необходима для предварительного просмотра и тестирования приложений в локальной среде Teams. Включите загрузку неопубликованных приложений для предварительного просмотра и тестирования приложения в Teams локально.\n\nУ вас уже есть клиент и есть ли у вас доступ администратора? Давайте проверим, действительно ли вы делаете!\n\nЧтобы проверить загрузку неопубликованных приложений в Teams, выполните приведенные далее действия.\n\n1. В клиенте Teams выберите **Приложения**.\n1. Выберите **Управление приложениями** > **Отправка приложения**.\n1. Найдите параметр **Отправить пользовательское приложение**. Если параметр отображается, загрузка неопубликованных приложений включена.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/upload-custom-app1_1.png\" alt-text=\"На рисунке показан параметр для отправки пользовательского приложения в Teams.\":::\n\n    > [!NOTE]\n    > Если у вас нет возможности отправить пользовательское приложение, обратитесь к администратору Teams.\n\n### <a name=\"create-a-free-teams-developer-tenant-optional\"></a>Создание бесплатного клиента разработчика Teams (необязательно)\n\nЕсли у вас нет учетной записи разработчика Teams, ее можно получить бесплатно. Присоединяйтесь к программе для разработчиков Microsoft 365!\n\n1. Перейдите в [программу для разработчиков Microsoft 365](https://developer.microsoft.com/microsoft-365/dev-program).\n1. Выберите **Присоединиться** и следуйте инструкциям на экране.\n1. Выберите **Настройка подписки E5** на экране приветствия.\n1. Настройка учетной записи администратора. После завершения отобразится следующий экран.\n\n      :::image type=\"content\" source=\"~/assets/images/teams-toolkit-v2/prerequisites/microsoft-365.png\" alt-text=\"Корпорация Майкрософт\":::\n\n1. Войдите в Teams с помощью новой учетной записи администратора. Теперь у вас должен быть параметр **Отправить пользовательское приложение** .\n"
- title: Создание и регистрация бота
  durationInMinutes: 5
  content: "Следующие действия помогут вам создать и зарегистрировать бота в портал Azure.\n\n1. Создайте ресурс Azure Bot для регистрации бота в Azure Служба Bot.\n1. Создайте секрет клиента, чтобы включить проверку подлинности бота с единым входом.\n1. Добавьте канал Teams для развертывания бота.\n1. Создайте туннель к конечным точкам веб-сервера с помощью ngrok.\n1. Добавьте конечную точку обмена сообщениями в созданный туннель ngrok.\n\n**Создание ресурса Azure Bot**\n\n1. Перейдите на [портал Azure](https://portal.azure.com/).\n\n1. Выберите **Создать ресурс**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Createaresource_1.png\" alt-text=\"Создание ресурса\":::\n\n1. В поле поиска введите **Бот Azure**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/searchazurebot_1.png\" alt-text=\"Создание ресурса\":::\n\n1. Выберите **ВВОД**.\n\n1. Выберите **Azure Bot**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectazurebot_1.png\" alt-text=\"Выбор Бота Azure\":::\n\n1. Нажмите **Создать**.\n\n    :::image type=\"content\" source=\"./assets/images/bots/azure-bot_1.png\" alt-text=\"Бот Azure.\":::\n\n   Откроется окно **Создание бота Azure** .\n\n    :::image type=\"content\" source=\"~/assets/images/bots/azurebotpage.png\" alt-text=\"Снимок экрана: страница бота Azure.\":::\n\n1. Введите следующие сведения, чтобы создать бот Azure.\n\n    1. Введите необходимое имя дескриптора бота в **поле Дескриптор бота**.\n\n    1. Выберите **подписку** и **группу ресурсов** в раскрывающемся списке.\n\n         :::image type=\"content\" source=\"~/assets/images/bots/Azurebotcreate.png\" alt-text=\"Снимок экрана: сведения о создании бота Azure для ресурса.\":::\n  \n    1. Чтобы создать новую группу ресурсов, выберите **Создать >** введите имя ресурса > **ОК**. Теперь выберите требуемое расположение в раскрывающемся **списке Расположение новой группы ресурсов** .\n    \n         :::image type=\"content\" source=\"~/assets/images/bots/newresource.png\" alt-text=\"Снимок экрана: новое расположение группы ресурсов\":::\n    \n    1. Выберите **Тип приложения в** качестве **мультитенантного**. \n\n    1. В разделе **Идентификатор приложения Майкрософт** по умолчанию выбран параметр **Создать новый идентификатор приложения Майкрософт** .\n\n       Можно также выбрать **Использовать существующую регистрацию приложения** и ввести **существующий идентификатор приложения**, **идентификатор клиента приложения** и **идентификатор ресурса MSI**.\n\n         :::image type=\"content\" source=\"~/assets/images/bots/Review-Create_1.png\" alt-text=\"Снимок экрана: выбор мультитенантного параметра. \":::\n\n       > [!NOTE]\n       > Вы не можете создать несколько ботов с одним **идентификатором приложения Майкрософт**.\n\n    1. Выберите **Проверить и создать**.\n\n1. После прохождения проверки нажмите кнопку **Создать**.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/validationpass_1.png\" alt-text=\"Снимок экрана: проверка пройдена.\":::\n\n   Подготовка службы бота займет несколько секунд.\n\n1. Выберите пункт **Перейти к ресурсу**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/gotoresource_1.png\" alt-text=\"Ресурс\":::\n\n   Бот Azure создан. Сведения о **группе ресурсов** и **идентификаторе подписки** можно просмотреть в боте Azure.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/Azurebotresource_1.png\" alt-text=\"Созданный ресурс бота Azure\":::\n\n**Создание секрета клиента**\n\n Чтобы создать секрет клиента, выполните следующие действия.\n\n1. В левой области выберите **Конфигурация**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectconfigure_1.png\" alt-text=\"Выберите Настроить.\":::\n\n   > [!Tip]\n   > Сохраните **идентификатор приложения Майкрософт** или **идентификатор клиента** для дальнейшего использования.\n\n1. Рядом с **полем Идентификатор приложения Майкрософт** выберите **Управление**.\n\n   :::image type=\"content\" source=\"~/assets/images/manage-bot-label_1.png\" alt-text=\"управление ботом\":::\n\n1. В разделе **Секреты клиента** выберите **Новый секрет клиента**.\n\n      :::image type=\"content\" source=\"~/assets/images/bots/newclientsecret_2.png\" alt-text=\"Снимок экрана: выбор нового секрета клиента.\":::\n\n   Откроется окно **Добавление секрета клиента** .\n\n1. Введите **Описание**.\n\n1. Нажмите **Добавить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/addclientsecret_1.png\" alt-text=\"Снимок экрана: добавление секрета клиента в приложение.\":::\n\n1. В столбце **Значение** щелкните значок копирования в буфер обмена, чтобы скопировать сведения о значении. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/valueclientsecret.png\" alt-text=\"Снимок экрана: значение секрета клиента, скопированного в буфер обмена.\":::\n\n   > [!Tip]\n   > Сохраните значение **Секреты клиента** или пароль приложения для дальнейшего использования.\n   \n**Добавление бота в канал Teams**\n\n1. Нажмите **Главная**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/selecthome_1.png\" alt-text=\"Домашняя страница\":::\n\n1. Выберите бота в **разделе Последние ресурсы**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-recent-resources_1.png\" alt-text=\"Выбор последних ресурсов\":::\n\n1. Выберите **Каналы** в области слева. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/selectchannel_1.png\" alt-text=\"Выберите последние\":::\n\n1. Выберите **Microsoft Teams** <img src=\"~/assets/images/bots/teamsicon.png\" alt=\"Teams icon\" width=\"20\"/>. \n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-microsoft-teams_1.png\" alt-text=\"Выберите Microsoft Teams\":::\n\n1. Установите флажок, чтобы принять **условия предоставления услуг**.\n\n1. Выберите **Принять**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Terms-of-service_1.png\" alt-text=\"Условия\":::\n\n1. Нажмите **Применить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/apply_1.png\" alt-text=\"Снимок экрана: параметр &quot;Применить&quot;\":::\n\n**Создание туннеля для локального веб-сервера**\n\nИспользуйте ngrok, чтобы создать туннель к общедоступным конечным точкам HTTPS локально работающего веб-сервера. Выполните следующую команду в ngrok:\n\n   ```bash\n   ngrok http --host-header=localhost 3978\n   ```\n   > [!TIP]\n   > Если вы столкнулись **с ERR_NGROK_4018**, выполните действия, как показано в командной строке, чтобы зарегистрироваться и проверить подлинность ngrok. Затем выполните `ngrok http --host-header=localhost 3978` команду .\n\n**Добавление конечной точки обмена сообщениями**\n\n1. Скопируйте URL-адрес HTTPS из ngrok.\n\n   :::image type=\"content\" source=\"../msteams-platform/assets/images/ngrok-url1_1.png\" alt-text=\"URL-адрес HTTPS ngrok\":::\n\n    > [!NOTE]\n    > URL-адрес HTTPS в ngrok — это полное доменное имя.\n    > — `WebAppDomain` это полное доменное имя, которое не включает `https://` в него.\n\n1. Назад к портал Azure.\n\n1. В **разделе Параметры** для созданного бота Azure выберите **Конфигурация**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-configuration_1.png\" alt-text=\"Выбор конфигурации\":::\n\n1. В **конечной точке обмена сообщениями** используйте URL-адрес HTTPS, доступный из ngrok, и в конце URL-адреса добавьте **/api/messages**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/messagingURL_2.png\" alt-text=\"Конечная точка обмена сообщениями\":::\n\n1. Нажмите **Применить**.\n\n    Вы успешно настроили бот в Azure Служба Bot.\n"
- title: Настройка единого входа для бота
  durationInMinutes: 5
  content: "**Добавление URI перенаправления в ресурс бота Azure**\n\n1. Выберите **Домашняя страница** > **Azure Active Directory**.\n\n1. В левой области выберите **Регистрация приложений**.\n\n1. Выберите бота.\n\n1. В области слева выберите **Проверка подлинности** , чтобы задать URI перенаправления.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/select-authentication_1.png\" alt-text=\"Выбор проверки подлинности\":::\n\n1. В **разделе Конфигурации платформы** выберите **Добавить платформу** , чтобы выбрать платформу, на которой вы хотите разместить приложение бота. \n\n1. Для работы с этим руководством выберите **Интернет**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-web_1.png\" alt-text=\"Снимок экрана: выбор веб-страницы.\":::\n    \n1. Введите **URI перенаправления** как `https://token.botframework.com/.auth/web/redirect` и этот URI, по которому Azure AD будет отправлять ответ для проверки подлинности пользователя.\n\n1. Включите **неявное предоставление и гибридные потоки** , установив следующие флажки:\n\n    * **Маркеры идентификаторов**\n    * **Маркеры доступа**\n\n1. Нажмите **Настроить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-implict-grant_1.png\" alt-text=\"Снимок экрана: выбор параметра configure.\":::\n\n    URI перенаправления добавляется в ресурс бота Azure.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/redirectURIadded.png\" alt-text=\"Снимок экрана: URI перенаправления, добавленный в ресурс бота.\":::\n\n**Предоставление конечной точки API**\n\n1. В области слева выберите **Предоставить API**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/expose-an-api_1.png\" alt-text=\"Предоставление API\":::\n\n1. Выберите **Задать**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/appidURI.png\" alt-text=\"Снимок экрана: параметр set.\":::\n\n1. Задайте универсальный код ресурса (URI) идентификатора `api://botid-{your AppID}`приложения в формате .\n\n1. Нажмите кнопку **Сохранить**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/exposeAPI_1.png\" alt-text=\"Снимок экрана: параметр сохранения.\":::\n\n   > [!NOTE]\n   > Если вы используете службу туннелирования, например ngrok, обязательно обновляйте значение при каждом изменении поддомена ngrok.\n   > Например: `api://f631****.ngrok.io/92c11075-c629-4a1e-ab58-02b4fd4204c2`, где `f631****.ngrok.io` — имя нового поддомена ngrok.\n\n1. Нажмите **Добавить область**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/Addascope_1.png\" alt-text=\"Снимок экрана: добавление области.\":::\n\n   Откроется окно **Добавление области** .\n\n1. Введите сведения для настройки области.    \n\n      1. Введите `access_as_user` имя **области**.\n\n         > [!NOTE]\n         > **Имя области** должно совпадать с URI **идентификатора приложения** с `/access_as_user` добавлением в конце.\n\n      1. Установите для свойства **Кто может предоставить согласие?** значение `Admins and users`.\n\n      1. Чтобы настроить запросы на согласие администратора и пользователя с соответствующими значениями для `access_as_user` области, укажите в полях следующие сведения:</br>\n\n          * Введите `Teams can access the user’s profile` **Администратор отображаемое имя согласия**.\n\n          * Введите `Allows Teams to call the app’s web APIs as the current user` **как Администратор описание согласия**.\n\n          * Введите `Teams can access the user profile and make requests on the user’s behalf` **отображаемое имя согласия пользователя**.\n\n          * Введите `Enable Teams to call this app’s APIs with the same rights as you have` **в качестве описания согласия пользователя**.\n\n      1. Убедитесь, что параметру **Состояние** присвоено значение **Включено**.\n\n      1. Выберите **Добавить область** для сохранения.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/addscope.png\" alt-text=\"Снимок экрана: настройка области.\":::\n\n   URI идентификатора приложения создается с **именем области**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/ExposeAPI_2.png\" alt-text=\"Снимок экрана: предоставляемый API и добавлена область.\":::\n\n1. В разделе **Авторизованные клиентские приложения** укажите приложения, которые необходимо авторизовать для веб-приложения вашего приложения.\n\n1. Выберите **Добавить клиентское приложение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/addaclientapplication.png\" alt-text=\"Снимок экрана: добавление клиентского приложения.\":::\n\n   Откроется окно **Добавление клиентского приложения** .\n\n1. Введите идентификатор клиента для классического и веб-приложения отдельно, для которого требуется авторизоваться. Это идентификатор клиентского приложения, которое вы хотите авторизовать.\n   \n   |**Идентификатор клиента**|**Для авторизации**|\n   |--------|-------------|\n   | `1fec8e78-bce4-4aaf-ab1b-5451cc387264` | Классическое или мобильное приложение Teams |\n   | `5e3ce6c0-2b1f-4285-8d4b-75ee78787346` | Веб-приложение Teams |\n\n1. Выберите **Авторизованные области** , чтобы определить, какой тип маркера будет возвращен службой.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/add-desktop-app.png\" alt-text=\"Снимок экрана: выбор авторизованных областей.\":::\n   \n1. Нажмите кнопку **Добавить приложение**.\n\n    На следующем рисунке отображается идентификатор клиента:\n\n      :::image type=\"content\" source=\"~/assets/images/bots/clientapps.png\" alt-text=\"Снимок экрана: добавление идентификатора клиента.\":::\n\n**Настройка разрешений Graph**\n\n1. В левой области выберите **Разрешения API**.\n\n      :::image type=\"content\" source=\"~/assets/images/bots/select-api-permissions_1.png\" alt-text=\"Выбор разрешений API\":::\n\n   > [!NOTE]\n   > Пользователям требуется согласие на разрешения API, только если приложение бота зарегистрировано в другом клиенте.\n\n1. Выберите **Добавить разрешение**.\n\n   Откроется окно **Разрешения API запроса** .\n\n1. Выберите **Microsoft Graph**.\n    \n    :::image type=\"content\" source=\"~/assets/images/bots/select-microsoft-graph_2.png\" alt-text=\"Снимок экрана: выбор Microsoft Graph.\":::\n\n1. Выберите **Делегированные разрешения**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-graph-permissions.png\" alt-text=\"Снимок экрана: выбор делегированных разрешений.\":::\n\n1. Выберите **Разрешение User.Read** в раскрывающемся списке **Пользователь** .\n\n1. Выберите **Добавить разрешения**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/userread.png\" alt-text=\"Снимок экрана: выбор элемента &quot;Чтение пользователя&quot;.\":::\n\n**Обновление манифеста**\n\n1. В левой области выберите **Манифест**.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/select-manifest_1.png\" alt-text=\"Выберите манифест\":::\n\n1. Убедитесь, что для элемента конфигурации задано значение **\"accessTokenAcceptedVersion\": 2**. Если нет, измените его значение на **2** и нажмите кнопку **Сохранить**.\n\n   > [!NOTE]\n   > Если вы уже тестируете бот в Teams, необходимо выйти из этого приложения и Teams. Затем войдите еще раз, чтобы увидеть это изменение.</br>\n    \n      :::image type=\"content\" source=\"~/assets/images/bots/update-manifest.png\" alt-text=\"Снимок экрана: обновление манифеста.\":::\n\n**Настройка подключения службы Bot**\n\n1. На **странице Конфигурация** выберите **Добавить параметры подключения OAuth**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/select-configuration_2.png\" alt-text=\"Выбор конфигурации1\":::\n\n   Откроется окно **Новый параметр подключения** .\n\n     \n\n1. В поле **Новый параметр подключения** введите следующие сведения:\n\n    | Поле | Значение или описание |\n    | ----- | ----- |\n    | Имя | Введите имя для нового параметра подключения. Имя можно использовать в параметрах кода службы бота. |\n    | Service Provider | Выберите **Azure Active Directory версии 2**. |\n    | Идентификатор клиента | Ранее сохранено в качестве **идентификатора приложения Майкрософт**. |\n    | Секрет клиента | Ранее сохранено как **значение** идентификатора секрета клиента. |\n    | URL-адрес обмена токенами | Используйте **URL-адрес идентификатора приложения** , полученный ранее при предоставлении доступа к конечной точке API. |\n    | Идентификатор клиента | Введите **common**. |\n    | Scopes | Введите **User.Read** , а также добавьте все **необходимые области** , указав разрешения для подчиненных API. |\n\n    :::image type=\"content\" source=\"~/assets/images/bots/botserviceconnection.png\" alt-text=\"Снимок экрана: подключение службы бота.\":::\n\n1. Нажмите кнопку **Сохранить**.\n\n   Теперь вы настроили единый вход для бота.\n"
- title: Настройка и запуск примера бота
  durationInMinutes: 1
  content: "1. Откройте **Visual Studio**.\n\n1. Выберите **Клонировать репозиторий**.\n\n1. В **расположении репозитория** введите `https://github.com/OfficeDev/Microsoft-Teams-Samples.git`. Обязательно обратите внимание на **путь** , по которому клонируется репозиторий.\n\n1. Перейдите в раздел **Файл** > **Открыть** > **проект или решение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/project-solution_1.png\" alt-text=\"Снимок экрана: переход к проекту или решению.\":::\n\n1. Выберите **Файл BotSSOCSharp.csproj** в **папке csharp_dotnetcore** .\n\n    :::image type=\"content\" source=\"~/assets/images/bots/filepath_1.png\" alt-text=\"Снимок экрана: путь к папке.\":::\n\n1. Откройте файл **appsettings.json** .\n\n1. Обновите конфигурацию **appsettings.json** , чтобы бот использовал `MicrosoftAppId` и `MicrosoftAppPassword`. Используйте имя подключения OAuth в качестве **имени подключения**.\n\n    > [!NOTE]\n    > Вы можете получить на `MicrosoftAppId` странице конфигурации бота. — `MicrosoftAppPassword` это значение для идентификатора секрета клиента, сохраненное ранее в Azure.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/appsettingsjson.png\" alt-text=\"Снимок экрана с параметром json appsettings.\"lightbox=\"~/assets/images/bots/appsettingsjson.png\":::\n\n1. Выберите **F5**  , чтобы запустить проект.\n\n1. Выберите **Да**, если появится следующий диалог:\n\n    :::image type=\"content\" source=\"~/assets/images/bots/certificate.png\" alt-text=\"Снимок экрана: выбор параметра Да при появлении диалогового окна.\":::\n\n   Откроется веб-страница с сообщением **Бот готов**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/yourbot.png\" alt-text=\"Снимок экрана: веб-страница с сообщением о том, что бот готов.\":::\n    \n    <br>\n\n    <details>\n\n    <summary><b>Устранение неполадок</b></summary>\n\n    Если возникает ошибка **Не удается найти пакет** , выполните следующие действия.\n\n    1.  Перейдите в **раздел Сервис** > **Диспетчер пакетов** >  NuGet **Параметры диспетчера пакетов**.\n    1.  В появившемся окне **Параметры** выберите **NuGet Package Manager Package Sources (Источники пакетов диспетчера** >  **пакетов NuGet**).\n    1.  Нажмите **Добавить**.\n    1.  В поле **Имя** введите `nuget.org` , а в поле **Источник** введите `https://api.nuget.org/v3/index.json`.\n    1.  Выберите **Обновить** и **ОК**.\n    1.  Перестройте проект.\n    <br>\n\n    </details>\n"
- title: Настройка и запуск приложения Teams
  durationInMinutes: 2
  content: "1. В Visual Studio откройте папку **appPackage** .\n\n1. Откройте файл **manifest.json** .\n\n1. Замените все вхождения **{TODO: MicrosoftAppId}** **идентификатором приложения Майкрософт** бота.\n\n1. В клонированных репозитория перейдите в раздел **bot-conversation-sso-quickstart > csharp_dotnetcore > папку appPackage** .\n\n1. Создайте .zip со следующими файлами, которые находятся в папке **Manifest** : \n   * manifest.json\n   * icon-outline.png\n   * icon-color.png\n\n    :::image type=\"content\" source=\"~/assets/images/bots/manifest_1.png\" alt-text=\"Снимок экрана: запаковка папки манифеста\":::\n\n1. Перейдите в клиент Teams.\n1. Выберите **Магазин**.\n1. Выберите **Управление приложениями**\n\n    :::image type=\"content\" source=\"~/assets/images/bots/manage-apps_3.png\" alt-text=\"Снимок экрана: выбор элемента управления приложением.\":::\n\n1. Выберите **Отправить пользовательское приложение**.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/upload-custom-app.png\" alt-text=\"Снимок экрана: отправка настраиваемого приложения.\":::\n\n1. Выберите **Открыть** , чтобы отправить файл .zip, созданный в папку **Манифест** .\n\n    :::image type=\"content\" source=\"~/assets/images/bots/open-app.png\" alt-text=\"Открыть приложение\":::\n\n1. Нажмите **кнопку Добавить** , чтобы добавить бот беседы в чат.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/add-conversation-bot_1.png\" alt-text=\"Снимок экрана: параметр добавления бота беседы.\":::\n\n    Вы можете взаимодействовать с ботом, отправив ему сообщение. Бот обменивается маркером единого входа и вызывает API Graph от вашего имени. Он сохраняет вход, если вы не отправите сообщение для **выхода**.\n\n1. Отправьте сообщение боту. Бот беседы впервые запрашивает согласие.\n\n1. Нажмите **кнопку Продолжить** , чтобы предоставить клиенту Teams разрешения на доступ к боту.\n\n     :::image type=\"content\" source=\"~/assets/images/bots/sbsdesktop-mobile-consent-request1.png\" alt-text=\"Снимок экрана: выбор разрешения для бота\":::\n    \n    > [!NOTE]\n    > Теперь вы настроили единый вход в приложение бота, и это единственный раз, когда вам придется дать согласие.\n\n1. Для мобильного устройства выберите **Принять** для **запрошенных разрешений**.\n\n    > [!NOTE]\n    > Теперь вы настроили единый вход с приложением бота на мобильном устройстве, и это единственный раз, когда вам придется дать согласие.\n\n    :::image type=\"content\" source=\"~/assets/images/bots/sbsdesktop-mobile-consent-request.png\" alt-text=\"Снимок экрана: мобильный вход в бот.\":::\n"
- title: Выполнение задачи
  durationInMinutes: 1
  content: >
    Ты придумала что-то вроде этого?

     :::image type="content" source="~/assets/images/bots/sbs-desktop-mobile.png" alt-text="Снимок экрана: окончательные выходные данные.":::
- content: Вы завершили руководство, чтобы приступить к созданию бота с проверкой подлинности единого входа.
